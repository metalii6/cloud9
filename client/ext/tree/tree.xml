<a:application xmlns:a="http://ajax.org/2005/aml">
        
    <a:script><![CDATA[
        function filesort(value, args, xmlNode) {
            return (xmlNode.tagName == "folder" ? 0 : 1) + value;
        }
        
        SupportedIcons = {
        	"application/xhtml+xml":'html',
        	"text/css": "css",
        	"text/html":'html',
            "application/pdf":'pdf',
            "image":'image',
            "application/x-shockwave-flash":'swf',
            "application/xml":'xml',
            "video":'movie',
            "audio": 'audio',
            "text/plain": 'page_white_text',
            "application/javascript": 'page_white_code'
        };
        
        function getIcon(xmlNode){
            var mime = xmlNode.getAttribute('contenttype').split(";")[0];
            var icon = SupportedIcons[mime] || SupportedIcons[mime.split("/")[0]] || "page_white_text";
            return icon + ".png";
        }
        
    ]]></a:script>
    
    <a:webdav id="davProject" url="{location.protocol + '//' + location.host}/workspace" />
    <a:model id="mdlFiles" src="{davProject.getroot()}" />

	<a:tree id="trFiles" flex="1" autoselect="false" 
	  model     = "mdlFiles"
	  each      = "[file|folder]">
        <a:bindings>
            <a:insert match="[node()[@type='folder']]" get="{davProject.readdir([@id])}" />
            <a:each match="[file|folder]" sort="[@name]" sort-method="filesort" />
            <a:caption match="[@name]" />
            <a:icon match="[folder]" value="folder.png" />
            <a:icon match="[file]" value="{getIcon(%[.])}" />
            <a:actions>
               <a:add type="folder" get="{davProject.mkdir([@id], 'New Folder')}" />
               <a:add type="file" get="{davProject.create([@id], 'New File.txt', '')}" />
               <a:rename set="{davProject.rename([@name], [@id])}"/>
               <a:copy match="[.]" set="{davProject.copy([@id], [../@id])}"/>
               <a:move match="[.]" set="{davProject.move([@id], [../@id])}"/>
               <a:remove match="[.]" set="{davProject.remove([@id])}"/>
            </a:actions>
            <!--a:dragdrop>
                <a:allow-drag match="folder|file" />
                <a:allow-drop match="folder|file" target="folder"
                    operation="tree-append" copy-condition="event.ctrlKey" />
            </a:dragdrop-->
        </a:bindings>
	</a:tree>  
    
</a:application>