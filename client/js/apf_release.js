var apf={VERSION:"3.0beta",CDN:"",READY:false,NODE_HIDDEN:101,NODE_VISIBLE:102,NODE_O3:103,KEYBOARD:2,KEYBOARD_MOUSE:true,SUCCESS:1,TIMEOUT:2,ERROR:3,OFFLINE:4,debug:false,includeStack:[],initialized:false,AppModules:[],autoLoadSkin:false,started:false,crypto:{},config:{},_GET:{},$asyncObjects:{"apf.oHttp":1,"apf.ajax":1},basePath:"",ns:{apf:"http://ajax.org/2005/aml",aml:"http://ajax.org/2005/aml",xsd:"http://www.w3.org/2001/XMLSchema",xhtml:"http://www.w3.org/1999/xhtml",xslt:"http://www.w3.org/1999/XSL/Transform",xforms:"http://www.w3.org/2002/xforms",ev:"http://www.w3.org/2001/xml-events"},xPathAxis:{self:1,"following-sibling":1,ancestor:1},hasRequireJS:window.require&&typeof require.def=="function",availHTTP:[],releaseHTTP:function(b){if(apf.brokenHttpAbort){return;}if(self.XMLHttpRequestUnSafe&&b.constructor==XMLHttpRequestUnSafe){return;}b.onreadystatechange=function(){};b.abort();this.availHTTP.push(b);},browserDetect:function(){if(this.$bdetect){return;}this.$bdetect=true;var m=navigator.userAgent.toLowerCase()||"",c=(typeof/./)[0]=="f"?+"1\0"?3:2:+"1\0"?5:1-"\0"?1:+{valueOf:function(b){return !b;}}?4:0;if((typeof/./)[0]=="f"&&parseFloat((m.match(/(?:firefox|minefield)\/([\d\.]+)/i)||{})[1])<=2){c=0;}if(c==2&&m.indexOf("chrome")==-1){c=3;}this.isOpera=c===4||c===5;this.isKonqueror=c===5;this.isSafari=c===3;this.isSafariOld=false;this.isIphone=m.indexOf("iphone")!=-1||m.indexOf("aspen simulator")!=-1;this.isChrome=c===2;this.isWebkit=this.isSafari||this.isChrome||this.isKonqueror;if(this.isWebkit){var k=m.match(/applewebkit\/(\d+)/);if(k){this.webkitRev=parseInt(k[1]);this.isSafariOld=parseInt(k[1])<420;}}this.isAIR=m.indexOf("adobeair")!=-1;this.isGecko=c===0;this.isGecko3=this.isGecko;this.isGecko35=this.isGecko&&(/a/[-1]&&Object.getPrototypeOf)?true:false;this.versionGecko=this.isGecko?parseFloat(m.match(/(?:gecko)\/([\d\.]+)/i)[1]):-1;this.versionFF=this.isGecko?parseFloat(m.match(/(?:firefox(-[\d.]+)?|minefield)\/([\d.]+)/i)[2]):-1;this.versionSafari=this.isSafari&&!this.isAIR?parseFloat(m.match(/(?:version)\/([\d\.]+)/i)[1]):-1;this.versionChrome=this.isChrome?parseFloat(m.match(/(?:chrome)\/([\d\.]+)/i)[1]):-1;this.versionOpera=this.isOpera?parseFloat(m.match(c===4?/(?:version)\/([\d\.]+)/i:/(?:opera)\/([\d\.]+)/i)[1]):-1;var g;this.isIE=c===1;if(this.isIE){this.isIE=parseFloat(m.match(/msie ([\d\.]*)/)[1]);}this.isIE8=this.isIE==8&&(g=true);this.isIE7=!g&&this.isIE==7&&(g=true);if(document.documentMode==7){apf.isIE7=true;apf.isIE8=false;apf.isIE7Emulate=true;apf.isIE=7;}this.isIE6=!g&&this.isIE==6&&(g=true);var d=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase();this.isWin=(d=="win");this.isMac=(d=="mac");this.isLinux=(d=="linux");},setCompatFlags:function(){this.TAGNAME=apf.isIE?"baseName":"localName";this.styleSheetRules=apf.isIE?"rules":"cssRules";this.brokenHttpAbort=apf.isIE6;this.canUseHtmlAsXml=apf.isIE;this.supportNamespaces=!apf.isIE;this.cannotSizeIframe=apf.isIE;this.hasConditionCompilation=apf.isIE;this.supportOverflowComponent=apf.isIE;this.hasFlexibleBox=apf.versionGecko>2||apf.webkitRev>2;this.hasEventSrcElement=apf.isIE;this.canHaveHtmlOverSelects=!apf.isIE6&&!apf.isIE5;this.hasInnerText=apf.isIE;this.hasMsRangeObject=apf.isIE;this.descPropJs=apf.isIE;this.hasClickFastBug=apf.isIE;this.hasExecScript=window.execScript?true:false;this.canDisableKeyCodes=apf.isIE;this.hasTextNodeWhiteSpaceBug=apf.isIE||apf.isIE>=8;this.hasCssUpdateScrollbarBug=apf.isIE;this.canUseInnerHtmlWithTables=!apf.isIE;this.hasSingleResizeEvent=!apf.isIE;this.hasStyleFilters=apf.isIE;this.supportOpacity=!apf.isIE;this.supportPng24=!apf.isIE6&&!apf.isIE5;this.cantParseXmlDefinition=apf.isIE50;this.hasDynamicItemList=!apf.isIE||apf.isIE>=7;this.canImportNode=apf.isIE;this.hasSingleRszEvent=!apf.isIE;this.hasXPathHtmlSupport=!apf.isIE;this.hasFocusBug=apf.isIE;this.hasHeightAutoDrawBug=apf.isIE&&apf.isIE<8;this.hasReadyStateBug=apf.isIE50;this.dateSeparator=apf.isIE?"-":"/";this.canCreateStyleNode=!apf.isIE;this.supportFixedPosition=!apf.isIE||apf.isIE>=7;this.hasHtmlIdsInJs=apf.isIE&&apf.isIE<8||apf.isWebkit;this.needsCssPx=!apf.isIE;this.hasCSSChildOfSelector=!apf.isIE||apf.isIE>=8;this.hasStyleAnchors=!apf.isIE||apf.isIE>=8;this.styleAttrIsObj=apf.isIE<8;this.hasAutocompleteXulBug=apf.isGecko;this.loadsLocalFilesSync=apf.isIE||apf.isGecko;this.mouseEventBuffer=apf.isIE?20:6;this.hasComputedStyle=typeof document.defaultView!="undefined"&&typeof document.defaultView.getComputedStyle!="undefined";this.w3cRange=Boolean(window.getSelection);this.locale=(apf.isIE?navigator.userLanguage:navigator.language).toLowerCase();this.characterSet=document.characterSet||document.defaultCharset||"utf-8";var k=document.createElement("div");this.hasContentEditable=(typeof k.contentEditable=="string"||typeof k.contentEditable=="boolean");apf.hasContentEditableContainerBug=apf.isWebkit;var m=["transform","OTransform","KhtmlTransform","MozTransform","WebkitTransform"],o=["","O","Khtml","Moz","Webkit"],c=["","o-","khtml-","moz-","webkit-"],g=["transitionend","transitionend","transitionend","transitionend","webkitTransitionEnd"],d=0,b=5;this.supportCSSAnim=false;this.supportCSSTransition=false;for(;d<b&&!this.supportCSSAnim;++d){if(typeof k.style[m[d]]=="undefined"){continue;}this.supportCSSAnim=m[d];this.runtimeStylePrefix=o[d];this.classNamePrefix=c[d];this.cssAnimEvent=g[d];}k=null;delete k;this.supportVML=apf.isIE;this.supportSVG=!apf.isIE||apf.isIE>8;this.hasHtml5XDomain=apf.versionGecko>=3.5;this.supportCanvas=!!document.createElement("canvas").getContext;this.supportCanvasText=!!(this.supportCanvas&&typeof document.createElement("canvas").getContext("2d").fillText=="function");this.hasVideo=!!document.createElement("video")["canPlayType"];this.hasAudio=!!document.createElement("audio")["canPlayType"];this.supportHashChange=("onhashchange" in self)&&(!apf.isIE||apf.isIE>=8);if(self.XMLHttpRequest){var n=new XMLHttpRequest();this.hasXhrProgress=!!n.upload;if(this.hasXhrBinary=!!(n.sendAsBinary||n.upload)){this.hasHtml5File=!!(File&&File.prototype.getAsDataURL);this.hasHtml5FileSlice=!!(File&&File.prototype.slice);}}else{this.hasXhrProgress=this.hasXhrBinary=this.hasHtml5File=this.hasHtml5FileSlice=false;}this.windowHorBorder=this.windowVerBorder=apf.isIE8&&(!self.frameElement||parseInt(self.frameElement.frameBorder))?4:0;this.enableAnim=!apf.isIE||apf.isIE>8;this.animSteps=apf.isIE?0.3:1;this.animInterval=apf.isIE?7:1;this.CSSFLOAT=apf.isIE?"styleFloat":"cssFloat";this.CSSPREFIX=apf.isGecko?"Moz":(apf.isWebkit?"webkit":"");this.CSSPREFIX2=apf.isGecko?"-moz":(apf.isWebkit?"-webkit":"");this.INLINE=apf.isIE&&apf.isIE<8?"inline":"inline-block";this.needZoomForLayout=apf.isIE&&apf.isIE<8;this.maxHttpRetries=apf.isOpera?0:3;this.percentageMatch=new RegExp();this.percentageMatch.compile("([\\-\\d\\.]+)\\%","g");this.reMatchXpath=new RegExp();this.reMatchXpath.compile("(^|\\|)(?!\\@|[\\w-]+::)","g");},hasGeoLocation:function(){return false;},extend:function(c,g){var k,d,b=!c.notNull;if(arguments.length==2){for(k in g){if(b||g[k]){c[k]=g[k];}}return c;}for(d=1;d<arguments.length;d++){g=arguments[d];for(k in g){if(b||g[k]){c[k]=g[k];}}}return c;},$extend:function(b,c){for(var d in c){b[d]=c[d];}return b;},ajax:(function(){var b=function(){return this.oHttp.get.apply(this.oHttp,arguments);};b.exec=function(m,d,k,c){if(m=="ajax"&&d[0]){var g=d[1]||{};return this.oHttp.exec(g.method||"GET",[d[0]],g.callback,apf.extend(c||{},g));}};return b;})(),start:function(){this.started=true;var t=location.href.split("#")[0].split("?")[0];this.host=location.hostname&&t.replace(/(\/\/[^\/]*)\/.*$/,"$1");this.hostPath=t.replace(/\/[^\/]*$/,"")+"/";this.setCompatFlags();if(apf.onstart&&apf.onstart()===false){return false;}if(this.isIE){apf.runIE();}if(apf.isWebkit){apf.runWebkit();}if(this.isOpera){apf.runOpera();}if(this.isGecko||!this.isIE&&!apf.isWebkit&&!this.isOpera){apf.runGecko();}for(var u,g,x,q,d,c,y,b=location.href.split(/[?&]/),r=b.length,s=1;s<r;s++){if(q=b[s].match(/(.*?)(\..*?|\[.*?\])?=([^#]*)/)){d=decodeURI(q[1]).toLowerCase(),c=this._GET;if(q[2]){for(x=decodeURI(q[2]).replace(/\[\s*\]/g,"[-1]").split(/[\.\[\]]/),u=0,g=x.length;u<g;u++){y=x[u],c=c[d]?c[d]:c[d]=(parseInt(y)==y)?[]:{},d=y.replace(/^["\'](.*)["\']$/,"$1");}}c[d!="-1"?d:c.length]=unescape(decodeURI(q[3]));}}this.oHttp=new this.http();this.Init.addConditional(this.parseAppMarkup,apf,["body"]);try{if(apf.isIE){document.execCommand("BackgroundImageCache",false,true);}}catch(w){}this.started=true;if(this.load_done){this.execDeferred();}this.root=true;for(var u=0;u<apf.$required.length;u++){apf.include(apf.$required[u]);}apf.require=apf.include;},nsqueue:{},findPrefix:function(c,g){var d;if(c.nodeType==9){if(!c.documentElement){return false;}if(c.documentElement.namespaceURI==g){return c.prefix||c.scopeName;}d=c.documentElement;}else{if(c.namespaceURI==g){return c.prefix||c.scopeName;}d=c.ownerDocument.documentElement;if(d&&d.namespaceURI==g){return c.prefix||c.scopeName;}while(c.parentNode){c=c.parentNode;if(c.namespaceURI==g){return c.prefix||c.scopeName;}}}if(d){for(var b=0;b<d.attributes.length;b++){if(d.attributes[b].nodeValue==g){return d.attributes[b][apf.TAGNAME];}}}return false;},importClass:function(c,b,g){if(!c){throw new Error(apf.formatErrorString(1018,null,"importing class","Could not load reference. Reference is null"));}if(!b){return apf.jsexec(c.toString(),g);}var d=c.toString().replace(/^\s*function\s*\w*\s*\([^\)]*\)\s*\{/,"").replace(/\}\s*$/,"");return apf.jsexec(d,g);},toString:function(){return"[Ajax.org Platform (apf)]";},all:[],implement:function(d){if(arguments.length==1){d.call(this);}else{for(var c,g=0,b=arguments.length;g<b;g++){c=arguments[g];arguments[g].call(this);}}return this;},uniqueHtmlIds:0,setUniqueHtmlId:function(b){var c;b.setAttribute("id",c="q"+this.uniqueHtmlIds++);return c;},getUniqueId:function(){return this.uniqueHtmlIds++;},lookup:function(b){return this.all[b];},findHost:function(c){while(c&&c.parentNode){try{if((c.host||c.host===false)&&typeof c.host!="string"){return c.host;}}catch(b){}c=c.parentNode;}return null;},setReference:function(b,c){return self[b]&&self[b].hasFeature?0:(self[b]=c);},console:{debug:function(d,b,c){},time:function(d,b,c){},log:function(d,b,c){},info:function(d,b,c){},warn:function(d,b,c){},error:function(d,b,c){},dir:function(c){var b=apf.$debugwin.$serializeObject(c,"Inspected via apf.console.dir");if(typeof b=="string"){this.write(b,"custom",null,null,null,true);}else{this.write(c?"Could not serialize object: "+b.message:c,"error",null,null,null,true);}}},html_entity_decode:function(b){return b;},htmlentities:function(b){return b;},formatErrorString:function(d,k,g,c,n,m,b){apf.lastErrorMessage=c;return c;},getDirname:function(b){return((b||"").match(/^([^#]*\/)[^\/]*(?:$|\#)/)||{})[1];},getFilename:function(b){return((b||"").split("?")[0].match(/(?:\/|^)([^\/]+)$/)||{})[1];},getAbsolutePath:function(c,b){return b&&b.charAt(0)=="/"?b:(!b||!c||b.match(/^\w+\:\/\//)?b:c.replace(/\/$/,"")+"/"+b.replace(/^\//,""));},include:function(g,b,m,n,o){var c=b?apf.getAbsolutePath(apf.basePath||"",g):g;var k=document.getElementsByTagName("head")[0],d=document.createElement("script");if(m){d.setAttribute("_apf_type",m);}if(n){if(apf.isIE){window.execScript(n);}else{d.text=n;}}else{d.src=c;}k.appendChild(d);if(o){d[apf.isIE?"onreadystatechange":"onload"]=o;}return d;},$required:[],require:function(){var c=apf.getDirname(location.href),d=0,b=arguments.length;for(;d<b;d++){this.$required.push(apf.getAbsolutePath(c,arguments[d]));}},Init:{queue:[],cond:{combined:[]},done:{},add:function(b,c){if(this.inited){b.call(c);}else{if(b){this.queue.push([b,c]);}}},addConditional:function(c,d,b){if(typeof b!="string"){if(this.checkCombined(b)){return c.call(d);}this.cond.combined.push([c,d,b]);}else{if(self[b]){c.call(d);}else{if(!this.cond[b]){this.cond[b]=[];}this.cond[b].push([c,d]);this.checkAllCombined();}}},checkAllCombined:function(){for(var b=0;b<this.cond.combined.length;b++){if(!this.cond.combined[b]){continue;}if(this.checkCombined(this.cond.combined[b][2])){this.cond.combined[b][0].call(this.cond.combined[b][1]);this.cond.combined[b]=null;}}},checkCombined:function(b){for(var c=0;c<b.length;c++){if(!this.done[b[c]]){return false;}}return true;},run:function(b){this.inited=this.done[b]=true;this.checkAllCombined();var d=b?this.cond[b]:this.queue;if(!d){return;}for(var c=0;c<d.length;c++){d[c][0].call(d[c][1]);}}},amlParts:[],parseStrategy:0,parsePartialAml:function(g){var m;if(apf.isIE){m=function(D){try{var A={IMG:1,LINK:1,META:1,INPUT:1,BR:1,HR:1,AREA:1,BASEFONT:1},C=new RegExp(D.outerHTML.replace(/([\(\)\|\\\.\^\$\{\}\[\]])/g,"\\$1")+".*"+D.tagName),y=D.parentNode.outerHTML.replace(/\n/g,"").match(C),F=y[0]+">".replace(/(\w+)\s*=\s*([^\>="'\s ]+)( |\s|\>|\/\>)/g,'$1="$2"$3').replace(/ disabled /g," disabled='true' ").replace(/\]\]\&gt;/g,"]]>").replace(/<(\w+)(\s[^>]*[^\/])?>/g,function(H,G,I){if(A[G]){return"<"+G+(I||"")+"/>";}else{return H;}});}catch(E){return;}var B=apf.getAmlDocFromString("<div jid='"+(b++)+"' "+k+">"+F+"</div>").documentElement;while(B.childNodes.length>1){B.removeChild(B.lastChild);}apf.AppNode.appendChild(B);};}else{m=function(A){var B=A.outerHTML.replace(/ _moz-userdefined=""/g,""),y=apf.getAmlDocFromString("<div jid='"+(b++)+"' "+k+">"+B+"</div>").documentElement;while(y.childNodes.length>1){y.removeChild(y.lastChild);}if(apf.isWebkit){y=apf.AppNode.ownerDocument.importNode(y,true);}apf.AppNode.appendChild(y);};}var o=document.body.outerHTML.match(/(\w+)\s*=\s*["']http:\/\/ajax\.org\/2005\/aml["']/);if(!o){return false;}var k="xmlns:"+o[0],r=(RegExp.$1||"").toUpperCase();if(apf.isOpera){r=r.toLowerCase();}if(!r){return false;}r+=":";apf.AppNode=apf.getAmlDocFromString("<"+r.toLowerCase()+"application "+k+" />").documentElement;var w,q,t,c=false,b=0,d=document.body;while(d){c=d.nodeType==1&&d.tagName.substr(0,2)==r;if(c){m(t=d);if(apf.isIE){q=d;var s=1,n=q.nextSibling;if(n){q.parentNode.removeChild(q);while(n&&(n.nodeType!=1||n.tagName.indexOf(r)>-1)){if(n.nodeType==1){s+=n.tagName.charAt(0)=="/"?-1:1;}if(s==0){if(w){w.parentNode.removeChild(w);}w=n;break;}n=(q=n).nextSibling;if(!n){n=q;break;}if(q.nodeType==1){q.parentNode.removeChild(q);if(w){w.parentNode.removeChild(w);w=null;}}else{if(w){w.parentNode.removeChild(w);}w=q;}}d=n;}else{if(w){w.parentNode.removeChild(w);}w=q;}}else{if(w){w.parentNode.removeChild(w);}w=d;}if(apf.amlParts.length&&apf.amlParts[apf.amlParts.length-1][1]==t){apf.amlParts[apf.amlParts.length-1][1]=-1;}apf.amlParts.push([d.parentNode,apf.isIE?d.nextSibling:d.nextSibling]);}else{if(d.tagName=="SCRIPT"&&d.getAttribute("src")&&(d.getAttribute("src").indexOf("ajax.org")>-1)){var x=d.outerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/<SCRIPT[^>]*\>\s*<\!\[CDATA\[>?/i,"").replace(/<SCRIPT[^>]*\>(?:<\!\-\-)?/i,"").replace(/(\/\/)?\s*\&\#8211;>\s*<\/SCRIPT>/i,"").replace(/\-\->\s*<\/SCRIPT>/i,"").replace(/\]\](?:\&gt\;|>)\s*<\/SCRIPT>/i,"").replace(/<\/SCRIPT>$/mi,"").replace(/<\/?\s*(?:p|br)\s*\/?>/ig,"").replace(/<\!--\s*.*?\s*-->\s*<script.*/ig,"").replace(/\\+(['"])/g,"$1");if(x.trim()){var u=apf.getAmlDocFromString("<div jid='"+(b++)+"' "+k+">"+x+"</div>").documentElement;if(apf.isWebkit){u=apf.AppNode.ownerDocument.importNode(u,true);}apf.AppNode.appendChild(u);apf.amlParts.push([d.parentNode,d.nextSibling]);}}}if(!c&&d.firstChild||d.nextSibling){if(!c&&d.firstChild){d=d.firstChild;}else{d=d.nextSibling;}}else{do{d=d.parentNode;if(d.tagName=="BODY"){d=null;}}while(d&&!d.nextSibling);if(d){d=d.nextSibling;}}}if(w){w.parentNode.removeChild(w);}},parseAppMarkup:function(b){var c=false;if(this.parseStrategy==1||!this.parseStrategy&&!b&&document.documentElement.outerHTML.split(">",1)[0].indexOf(apf.ns.aml)==-1){this.parsePartialAml(b);if(this.parseStrategy==1||apf.amlParts.length){apf.isParsingPartial=true;apf.loadAmlIncludes(apf.AppNode);if(!self.ERROR_HAS_OCCURRED){apf.initialize();}return;}else{c=true;}}if(c&&document.documentElement.outerHTML.split(">",1)[0].indexOf(apf.ns.aml)==-1){return false;}if(this.parseStrategy==21||!this.parseStrategy&&!b){return apf.oHttp.get((apf.alternativeAml||document.body&&document.body.getAttribute("xmlurl")||location.href).split(/#/)[0],{callback:function(n,m,d){if(m!=apf.SUCCESS){var q=new Error(apf.formatErrorString(0,null,"Loading XML application data","Could not load XML from remote source: "+d.message));if(d.tpModule.retryTimeout(d,m,null,q)===true){return true;}throw q;}var o=n.replace(/\<\!DOCTYPE[^>]*>/,"").replace(/^[\r\n\s]*/,"");if(!apf.supportNamespaces){o=o.replace(/xmlns\=\"[^"]*\"/g,"");}if(self.ERROR_HAS_OCCURRED){return;}if(apf.isIE){document.body.innerHTML="";}else{var g=document.body.childNodes;for(var k=g.length-1;k>=0;k--){g[k].parentNode.removeChild(g[k]);}}document.documentElement.style.display="block";document.body.style.display="block";apf.initialize(o);},ignoreOffline:true});}else{document.body.style.display="block";if(!self.ERROR_HAS_OCCURRED){apf.initialize(b.outerHTML||b.xml);}}},namespaces:{},setNamespace:function(b,c){this.namespaces[b]=c;c.namespaceURI=b;},initialize:function(q){apf.console.info("Initializing...");clearInterval(apf.Init.interval);apf.Init.run();var k=parseFloat(apf.getStyle(document.body,"marginTop"));apf.doesNotIncludeMarginInBodyOffset=(document.body.offsetTop!==k);if(apf.isParsingPartial){apf.config.setDefaults();apf.hasSingleRszEvent=true;var c=document.body;var d=c.lastChild;apf.AmlParser.parseMoreAml(apf.AppNode,c,null,true,false);var r,b,o,g,n=null,m=c.lastChild;while(m&&d!=m){g=apf.amlParts[m.getAttribute("jid")];o=m.previousSibling;if(g){r=g[0];if("P".indexOf(r.tagName)>-1){n=r.parentNode.insertBefore(apf.getNode(m,[0]),r);}else{b=apf.getNode(m,[0]);while(b){if(b){n=r.insertBefore(b,typeof g[1]=="number"?n:g[1]);}else{n=typeof g[1]=="number"?n:g[1];}b=apf.getNode(m,[0]);}}m.parentNode.removeChild(m);}m=o;}$setTimeout("apf.layout.forceResize();");}else{apf.window.init(q);}},execDeferred:function(){var b=apf.load_events.length;while(b--){(apf.load_events.shift())();}},load_events:[],load_timer:null,load_done:false,load_init:null,addDomLoadEvent:function(m){if(!this.$bdetect){this.browserDetect();}if(apf.load_done){return m();}if(!apf.load_init){apf.load_init=function(){if(apf.load_done){return;}clearInterval(apf.load_timer);apf.load_timer=null;apf.load_done=true;if(apf.started){apf.execDeferred();}};}apf.load_events.push(m);if(m&&apf.load_events.length==1){var n=document,d="undefined";if((typeof n.readyState!=d&&n.readyState=="complete")||(n.getElementsByTagName("body")[0]||n.body)){return apf.load_init();}if(n.addEventListener&&!apf.isOpera){window.addEventListener("DOMContentLoaded",apf.load_init,false);}else{if(apf.isIE&&window==top){apf.load_timer=setInterval(function(){try{n.documentElement.doScroll("left");}catch(o){$setTimeout(arguments.callee,0);return;}apf.load_init();},10);}else{if(apf.isOpera){n.addEventListener("DOMContentLoaded",function(){apf.load_timer=setInterval(function(){for(var q=0,o=n.styleSheets.length;q<o;q++){if(n.styleSheets[q].disabled){return;}}apf.load_init();},10);},false);}else{if(apf.isWebkit&&!apf.isIphone){var k=n.getElementsByTagName("link"),c=k.length,g;for(;c>=0;c++){if(!k[c]||k[c].getAttribute("rel")!="stylesheet"){k.splice(c,0);}}g=k.length;apf.load_timer=setInterval(function(){if(/loaded|complete/.test(n.readyState)&&n.styleSheets.length==g){apf.load_init();}},10);}else{var b=window.onload;window.onload=function(){apf.load_init();if(b){b();}};}}}}}},fireEvent:function(d,c,g,b){if(d.dispatchEvent){d.dispatchEvent(c,g,b);}else{d.fireEvent("on"+c,g);}},addListener:function(d,c,b){if(d.addEventListener){d.addEventListener(c,b,false);}else{if(d.attachEvent){d.attachEvent("on"+c,b);}}return this;},removeListener:function(d,c,b){if(d.removeEventListener){d.removeEventListener(c,b,false);}else{if(d.detachEvent){d.detachEvent("on"+c,b);}}return this;},stopEvent:function(b){this.stopPropagation(b).preventDefault(b);return false;},stopPropagation:function(b){if(b.stopPropagation){b.stopPropagation();}else{b.cancelBubble=true;}return this;},preventDefault:function(b){if(b.preventDefault){b.preventDefault();}else{b.returnValue=false;}return this;},unload:function(c){this.isDestroying=true;this.popup.destroy();var g,d=0,b=this.all.length;for(;d<b;d++){g=this.all[d];if(g&&g!=c&&g.destroy&&!g.apf){g.destroy(false);}}for(d=0,b=this.availHTTP.length;d<b;d++){this.availHTTP[d]=null;}this.availHTTP.length=0;if(apf.xmldb){apf.xmldb.unbind(apf.window);}this.isDestroying=false;}};var $xmlns=function(c,b,g,d){if(!apf.supportNamespaces){if(!d){d=apf.findPrefix(c,g);}if(c.style||c==document){return c.getElementsByTagName(b);}else{if(d){(c.nodeType==9?c:c.ownerDocument).setProperty("SelectionNamespaces","xmlns:"+d+"='"+g+"'");}return c.selectNodes(".//"+(d?d+":":"")+b);}}return c.getElementsByTagNameNS(g,b);};var $setTimeout=setTimeout;var $setInterval=setInterval;apf.setTimeout=function(c,b){apf.$eventDepth++;return $setTimeout(function(){c();if(--apf.$eventDepth==0){apf.queue.empty();}},b);};document.documentElement.className+=" has_apf";document.documentElement.style.display="none";apf.browserDetect();apf.Init.run("apf");apf.Class=function(){};apf.Class.prototype=new (function(){var FUN="function",OBJ="object",UNDEF="undefined",SEL="model",PROP="prop.",MODEL="model",VALUE="value";this.$regbase=0;this.hasFeature=function(test){return this.$regbase&test;};this.$initStack=[];this.$bufferEvents=[];this.$init=function(callback,nodeFunc,struct){if(typeof callback==FUN||callback===true){this.$bufferEvents=this.$bufferEvents.slice();if(callback===true){return this;}this.$initStack=this.$initStack.slice();this.$initStack.push(callback);return this;}this.addEventListener=realAddEventListener;if(this.nodeType!=2){this.$uniqueId=apf.all.push(this)-1;}this.$captureStack={};this.$eventsStack={};this.$funcHandlers={};var i=0,l=this.$initStack.length;for(;i<l;i++){this.$initStack[i].apply(this,arguments);}for(i=0,l=this.$bufferEvents.length;i<l;i++){this.addEventListener.apply(this,this.$bufferEvents[i]);}delete realAddEventListener;delete this.$initStack;delete this.$bufferEvents;if(struct&&(struct.htmlNode||this.nodeFunc==apf.NODE_HIDDEN)){this.$pHtmlNode=struct.htmlNode;this.ownerDocument.$domParser.$continueParsing(this);apf.queue.empty();}return this;};this.implement=apf.implement;this.$handlePropSet=function(prop,value){this[prop]=value;};this.$bindProperty=function(myProp,bObject,bProp,fParsed,bRecip){if(!fParsed){return bObject.$handlePropSet(bProp,this[myProp]);}var eventName=PROP+myProp,eFunc,isBeingCalled,isLang;(this.$eventsStack[eventName]||(this.$eventsStack[eventName]=[])).push(eFunc=function(e){if(isBeingCalled){return;}isBeingCalled=true;try{if(fParsed.asyncs){return fParsed.call(bObject,bObject.xmlRoot,function(value){bObject.setProperty(bProp,value,true,false,10);isBeingCalled=false;});}else{var value=fParsed.call(bObject,bObject.xmlRoot);}}catch(e){apf.console.warn("[331] Could not execute binding for property "+bProp+"\n\n"+e.message);isBeingCalled=false;return;}bObject.setProperty(bProp,value,true,false,10);isBeingCalled=false;});if(bRecip){eventName=PROP+bProp;var _self=this;(bObject.$eventsStack[eventName]||(bObject.$eventsStack[eventName]=[])).push(eFunc.recip=function(){if(isBeingCalled){return;}isBeingCalled=true;_self.setProperty(myProp,bObject[bProp],true,false,10);isBeingCalled=false;});}return eFunc;};this.$attrExcludePropBind=false;this.$setDynamicProperty=function(prop,pValue){var exclNr=this.$attrExcludePropBind[prop],options;if(SEL.indexOf(prop)>-1||exclNr==3){options={xpathmode:2};}else{if(exclNr==2){options={nostring:true};}else{if(exclNr===0){options={parsecode:true};}}}if(this.liveedit){(options||(options={})).liveedit=true;}if(pValue&&pValue.dataType==apf.FUNCTION){var fParsed=pValue;pValue="";}else{var fParsed=apf.lm.compile(pValue,options);}if(prop==MODEL){(this.$modelParsed=fParsed).instruction=pValue;}if(fParsed.type==2){this[prop]=!pValue;return this.setProperty(prop,fParsed.str,null,null,10);}var check=1;if(exclNr==2||fParsed.xpaths.length&&exclNr!=1){if(!this.hasFeature(apf.__DATABINDING__)){this.implement(apf.StandardBinding);if(this.$attrExcludePropBind[prop]==1){check=0;}}if(check){this.$addAttrBind(prop,fParsed,pValue);}}var matches=exclNr&&exclNr!=3&&prop!=MODEL?{}:fParsed.props,found=false,_self=this,o,node,bProp,p;for(p in matches){o=p.split(".");if(o.length>2){bProp=o.pop();try{node=eval(o.join("."));}catch(e){if(arguments[2]){apf.console.warn("[287] Could not execute binding test : "+pValue.replace(/</g,"&lt;")+"\n\n"+e.message);}else{apf.queue.add(prop+":"+this.$uniqueId,function(){_self.$clearDynamicProperty(prop);_self.$setDynamicProperty(prop,pValue,true);});}continue;}if(!node||typeof node!=OBJ||(!node.$regbase&&node.$regbase!==0)){bProp=o[1];node=self[o[0]];}else{o.push(bProp);}}else{bProp=o[1];node=self[o[0]]||o[0]=="this"&&this;}if(!node){if(arguments[2]){apf.console.warn("[287] Could not create property binding:  '"+o[0]+"' does not exist. \n"+pValue.replace(/</g,"&lt;").substr(0,400));var _self=this;apf.nameserver.waitFor(o[0],function(){_self.$setDynamicProperty(prop,pValue);});return;}else{apf.queue.add(prop+":"+this.$uniqueId,function(){_self.$clearDynamicProperty(prop);_self.$setDynamicProperty(prop,pValue,true);});return;}}if(!node.$bindProperty){continue;}if(!this.$funcHandlers[prop]){this.$funcHandlers[prop]=[];}var last;this.$funcHandlers[prop].push(last={amlNode:node,prop:bProp,handler:node.$bindProperty(bProp,this,prop,fParsed,fParsed.type==4&&SEL.indexOf(prop)==-1)});found=true;}if(found){last.handler({initial:true});}else{if(exclNr){return this.setProperty(prop,pValue,null,null,10);}try{if(fParsed.asyncs){return fParsed.call(this,this.xmlRoot,function(value){_self.setProperty(prop,value,true,null,10);});}else{var value=fParsed.call(this,this.xmlRoot);}}catch(e){apf.console.warn("[331] Could not execute binding test or: "+pValue.replace(/</g,"&lt;")+"\n\n"+e.message);return;}this[prop]=!value;this.setProperty(prop,value,true,null,10);}};this.$clearDynamicProperty=function(prop){if(this.$removeAttrBind){this.$removeAttrBind(prop);}if(this.$inheritProperties){delete this.$inheritProperties[prop];}if(prop==MODEL){this.$modelParsed=null;}var f,i,l,h=this.$funcHandlers[prop];if(h&&typeof h!=FUN){for(i=0,l=h.length;i<l;i++){(f=h[i]).amlNode.removeEventListener(PROP+f.prop,f.handler);if(f.handler&&f.handler.recip){this.removeEventListener(PROP+prop,f.handler.recip);}}delete this.$funcHandlers[prop];}};this.watch=function(propName,callback){var eventName=PROP+propName,wrapper=function(e){callback.call(this,propName,e.oldvalue,e.value);};wrapper.callback=callback;(this.$eventsStack[eventName]||(this.$eventsStack[eventName]=[])).push(wrapper);};this.unwatch=function(propName,callback){var list,eventName=PROP+propName;if(!(list=this.$eventsStack[eventName])){return;}for(var i=0,l=list.length;i<l;i++){if(list[i].callback==callback){list.remove(i);return;}}};this.getAvailableProperties=function(){return this.$supportedProperties.slice();};this.setProperty=function(prop,value,forceOnMe,setAttr,inherited){var s,r,arr,e,i,l,oldvalue=this[prop],eventName=PROP+prop;try{var isChanged=(typeof value==OBJ)?value!=(typeof oldvalue==OBJ?oldvalue:null):String(oldvalue)!==String(value);}catch(e){var isChanged=true;}if(isChanged){if(!forceOnMe){if(typeof value!=OBJ&&(!(s=this.$attrExcludePropBind[prop]))&&(r=(this.$attrBindings&&this.$attrBindings[prop]||prop!=VALUE&&this.xmlRoot&&this.$bindings[prop]&&this.$bindings[prop][0]))){if(r.cvalue.type==3){return apf.setNodeValue(this.$getDataNode(prop.toLowerCase(),this.xmlRoot,true),value,true);}}}if(setAttr){this.setAttribute(prop,value,true);}if(this.$handlePropSet(prop,value,forceOnMe)===false){return;}value=this[prop];}if(arr=this.$eventsStack[eventName]){if(this.dispatchEvent(eventName,{prop:prop,value:value,oldvalue:oldvalue,changed:isChanged})===false){e.returnValue=false;}}if((aci||(aci=apf.config.$inheritProperties))[prop]){var resetting=value===""||typeof value=="undefined";if(inherited!=10&&!value){delete this.$inheritProperties[prop];if(this.$setInheritedAttribute(prop)){return;}}else{if(inherited!=10){this.$inheritProperties[prop]=inherited||-1;}}if(this.$amlLoaded&&(!e||e.returnValue!==false)&&this.childNodes){var inheritType=aci[prop];(function recur(nodes){var i,l,node,n;for(i=0,l=nodes.length;i<l;i++){node=nodes[i];if(node.nodeType!=1&&node.nodeType!=7){continue;}n=node.$inheritProperties[prop];if(inheritType==1&&!n){recur(node.childNodes);}else{if(!(n<0)){if(n==3||inherited==3){var sameValue=node[prop];node[prop]=null;}node.setProperty(prop,n!=3?value:sameValue,false,false,n||2);}}}})(this.childNodes);}}return value;};var aci;this.getProperty=function(prop){return this[prop];};apf.$eventDepth=0;this.$eventDepth=0;this.dispatchEvent=function(eventName,options,e){var arr,result,rValue,i,l;apf.$eventDepth++;this.$eventDepth++;e=options&&options.name?options:e;if((!e||!e.currentTarget)&&(!options||!options.currentTarget)){if(!(options||(options={})).currentTarget){options.currentTarget=this;}if(arr=this.$captureStack[eventName]){for(i=0,l=arr.length;i<l;i++){rValue=arr[i].call(this,e||(e=new apf.AmlEvent(eventName,options)));if(typeof rValue!=UNDEF){result=rValue;}}}}if(options&&options.captureOnly){return e&&typeof e.returnValue!=UNDEF?e.returnValue:result;}else{if(this["on"+eventName]){result=this["on"+eventName].call(this,e||(e=new apf.AmlEvent(eventName,options)));}if(arr=this.$eventsStack[eventName]){for(i=0,l=arr.length;i<l;i++){if(!arr[i]){continue;}rValue=arr[i].call(this,e||(e=new apf.AmlEvent(eventName,options)));if(typeof rValue!=UNDEF){result=rValue;}}}}if((e&&e.bubbles&&!e.cancelBubble||!e&&options&&options.bubbles)&&this!=apf){rValue=(this.parentNode||this.ownerElement||apf).dispatchEvent(eventName,options,e);if(typeof rValue!=UNDEF){result=rValue;}}if(--apf.$eventDepth==0&&this.ownerDocument&&!this.ownerDocument.$domParser.$parseContext&&!apf.isDestroying&&apf.loaded&&apf.queue){apf.queue.empty();}this.$eventDepth--;if(options){try{delete options.currentTarget;}catch(ex){options.currentTarget=null;}}return e&&typeof e.returnValue!=UNDEF?e.returnValue:result;};this.addEventListener=function(a,b,c){this.$bufferEvents.push([a,b,c]);};var realAddEventListener=function(eventName,callback,useCapture){if(eventName.substr(0,2)=="on"){eventName=eventName.substr(2);}var s,stack=useCapture?this.$captureStack:this.$eventsStack;if(!(s=stack[eventName])){s=stack[eventName]=[];}if(s.indexOf(callback)>-1){return;}s.unshift(callback);var f;if(f=this.$eventsStack["$event."+eventName]){f[0].call(this,callback);}};this.removeEventListener=function(eventName,callback,useCapture){var stack=(useCapture?this.$captureStack:this.$eventsStack)[eventName];if(stack){if(this.$eventDepth){stack=(useCapture?this.$captureStack:this.$eventsStack)[eventName]=stack.slice();}stack.remove(callback);if(!stack.length){delete (useCapture?this.$captureStack:this.$eventsStack)[eventName];}}};this.hasEventListener=function(eventName){return(this.$eventsStack[eventName]&&this.$eventsStack[eventName].length>0);};this.destroy=function(deep,clean){if(typeof this.$uniqueId==UNDEF&&this.nodeType!=2){return;}this.$amlLoaded=false;this.$amlDestroyed=true;if(this.$destroy){this.$destroy();}this.dispatchEvent("DOMNodeRemoved",{relatedNode:this.parentNode,bubbles:!apf.isDestroying});this.dispatchEvent("DOMNodeRemovedFromDocument");apf.all[this.$uniqueId]=undefined;if(!this.nodeFunc&&!this.nodeType){try{if(this.id||this.name){self[this.id||this.name]=null;}}catch(ex){}return;}if(this.$ext&&!this.$ext.isNative){if(this.nodeType==1&&this.localName!="a"){this.$ext.oncontextmenu=this.$ext.host=null;}if(clean){if(this.localName!="collection"){this.$ext.parentNode.removeChild(this.$ext);}}}if(this.$int&&!this.$int.isNative&&this.$int.nodeType==1&&this.localName!="a"){this.$int.host=null;}this.$aml=null;if(deep&&this.childNodes){var nodes=this.childNodes;for(i=nodes.length-1;i>=0;i--){if(nodes[i].destroy){nodes[i].destroy(true,clean&&this.localName=="collection");}}this.childNodes=null;}if(this.parentNode&&this.removeNode){this.removeNode();}else{if(this.ownerElement&&!this.ownerElement.$amlDestroyed){this.ownerElement.removeAttributeNode(this);}}if(this.$focussable&&this.focussable){apf.window.$removeFocus(this);}if(this.attributes){var attr=this.attributes;for(var i=attr.length-1;i>=0;i--){this.$clearDynamicProperty(attr[i].nodeName);attr[i].destroy();}}try{if(this.id||this.name){self[this.id||this.name]=null;}}catch(ex){}apf.nameserver.remove(this.localName,this);};})();apf.extend(apf,new apf.Class().$init());apf.Init.run("class");apf.color={colorshex:{aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662680,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14184595,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},fixHSB:function(b){return{h:Math.min(360,Math.max(0,b.h)),s:Math.min(100,Math.max(0,b.s)),b:Math.min(100,Math.max(0,b.b))};},fixRGB:function(b){return{r:Math.min(255,Math.max(0,b.r)),g:Math.min(255,Math.max(0,b.g)),b:Math.min(255,Math.max(0,b.b))};},fixHex:function(d){var b=6-d.length;if(b>0){var g=[],c=0;for(;c<b;c++){g.push("0");}g.push(d);d=g.join("");}return d;},hexToRGB:function(b){b=parseInt(((b.indexOf("#")>-1)?b.substring(1):b),16);return{r:b>>16,g:(b&65280)>>8,b:(b&255)};},hexToHSB:function(b){return this.RGBToHSB(this.hexToRGB(b));},RGBToHSB:function(d){var c={h:0,s:0,b:0};var g=Math.min(d.r,d.g,d.b),b=Math.max(d.r,d.g,d.b),k=b-g;c.b=b;if(b!=0){}c.s=b!=0?255*k/b:0;if(c.s!=0){if(d.r==b){c.h=(d.g-d.b)/k;}else{if(d.g==b){c.h=2+(d.b-d.r)/k;}else{c.h=4+(d.r-d.g)/k;}}}else{c.h=-1;}c.h*=60;if(c.h<0){c.h+=360;}c.s*=100/255;c.b*=100/255;return c;},HSBToRGB:function(b){var d={},n=Math.round(b.h),m=Math.round(b.s*255/100),c=Math.round(b.b*255/100);if(m==0){d.r=d.g=d.b=c;}else{var o=c,k=(255-m)*c/255,g=(o-k)*(n%60)/60;if(n==360){n=0;}if(n<60){d.r=o,d.b=k,d.g=k+g;}else{if(n<120){d.g=o,d.b=k,d.r=o-g;}else{if(n<180){d.g=o,d.r=k,d.b=k+g;}else{if(n<240){d.b=o,d.r=k,d.g=o-g;}else{if(n<300){d.b=o,d.g=k,d.r=k+g;}else{if(n<360){d.r=o,d.g=k,d.b=o-g;}else{d.r=0,d.g=0,d.b=0;}}}}}}}return{r:Math.round(d.r),g:Math.round(d.g),b:Math.round(d.b)};},RGBToHex:function(b){return("00000"+(b.r<<16|b.g<<8|b.b).toString(16)).slice(-6);},HSBToHex:function(b){return this.RGBToHex(this.HSBToRGB(b));}};apf.AbstractEvent=function(b,g){g=g||window;var d=g.document;b=b||g.event;if(b.$extended){return b;}this.$extended=true;this.event=b;this.type=b.type;this.target=b.target||b.srcElement;while(this.target&&this.target.nodeType==3){this.target=this.target.parentNode;}if(this.type.indexOf("key")!=-1){this.code=b.which||b.keyCode;}else{if(this.type.match(/(click|mouse|menu)/i)){d=(!d.compatMode||d.compatMode=="CSS1Compat")?d.html:d.body;this.page={x:b.pageX||b.clientX+(d?d.scrollLeft:0),y:b.pageY||b.clientY+(d?d.scrollTop:0)};this.client={x:(b.pageX)?b.pageX-g.pageXOffset:b.clientX,y:(b.pageY)?b.pageY-g.pageYOffset:b.clientY};if(this.type.match(/DOMMouseScroll|mousewheel/)){this.wheel=(b.wheelDelta)?b.wheelDelta/120:-(b.detail||0)/3;}this.rightClick=(b.which==3)||(b.button==2);this.relatedTarget=null;if(this.type.match(/over|out/)){if(this.type=="mouseover"){this.relatedTarget=b.relatedTarget||b.fromElement;}else{if(this.type=="mouseout"){this.relatedTarget=b.relatedTarget||b.toElement;}else{try{while(this.relatedTarget&&this.relatedTarget.nodeType==3){this.relatedTarget=this.relatedTarget.parentNode;}}catch(c){}}}}}}this.shift=Boolean(b.shiftKey);this.control=Boolean(b.ctrlKey);this.alt=Boolean(b.altKey);this.meta=Boolean(b.metaKey);this.stop=function(){return this.stopPropagation().preventDefault();};this.stopPropagation=function(){if(this.event.stopPropagation){this.event.stopPropagation();}else{this.event.cancelBubble=true;}return this;};this.preventDefault=function(){if(this.event.preventDefault){this.event.preventDefault();}else{this.event.returnValue=false;}return this;};};apf.AbstractEvent.KEYS={enter:13,up:38,down:40,left:37,right:39,esc:27,space:32,backspace:8,tab:9,"delete":46,fromCode:function(c){for(var b in this){if(this[b]==c){return b;}return null;}}};apf.AbstractEvent.stop=function(b){return(new apf.AbstractEvent(b)).stop();};apf.asyncForEach=function(k,g,m){var c=0;var b=k.length;if(!b){return m(null,[]);}g(k[c],function d(n){if(n){return m(n);}c++;if(c<b){g(k[c],d,c);}else{m(null);}},c);};apf.asyncWhile=function(k,d,g){var b=0;d(b,function c(m){if(m){return g?g(m,b):null;}++b;if(k(b)){d(b,c);}else{g&&g(null,b);}});};apf.asyncMap=function(g,m,n){var c=0;var b=g.length;if(!b){return n(null,[]);}var k=[];async(g[c],function d(o,q){if(o){return n(o);}k[c]=q;c++;if(c<b){async(g[c],d);}else{n(null,k);}});};apf.asyncChain=function(c){var d=0;var b=c.length;function g(){var k=c[d++];if(d==b){k();}else{k(g);}}g();};if(typeof isFinite=="undefined"){function isFinite(b){return b+1!=b;}}apf.NUMBER=1;apf.BOOLEAN=2;apf.STRING=3;apf.ARRAY=4;apf.DATE=5;apf.REGEXP=6;apf.FUNCTION=7;Array.prototype.dataType=apf.ARRAY;Number.prototype.dataType=apf.NUMBER;Date.prototype.dataType=apf.DATE;Boolean.prototype.dataType=apf.BOOLEAN;String.prototype.dataType=apf.STRING;RegExp.prototype.dataType=apf.REGEXP;Function.prototype.dataType=apf.FUNCTION;apf.getCgiString=function(b,g,d){var m=[];function k(r,n){var s;if(apf.isArray(r)){for(var q=0;q<r.length;q++){k(r[q],n+"%5B%5D");}}else{if(typeof r=="object"){for(s in r){if(apf.isSafariOld&&(!r[s]||typeof p[s]!="object")){continue;}if(typeof r[s]=="function"){continue;}k(r[s],n+"%5B"+encodeURIComponent(s)+"%5D");}}else{m.push(n+"="+encodeURIComponent(r));}}}if(g){m.push("func="+d);for(var c=0;c<b[0].length;c++){k(b[0][c],"f%5B"+c+"%5D");}}else{for(prop in b){if(apf.isSafariOld&&(!b[prop]||typeof b[prop]=="function")){continue;}k(b[prop],prop);}}return m.join("&");};apf.fromCgiString=function(c){if(!c){return false;}var n={};c=c.split("&");for(var k,g=0;g<c.length;g++){k=c[g].split("=");k[0]=decodeURIComponent(k[0]);var m=k[0].replace(/\]/g,"").split("[");var d=n;for(var b=0;b<m.length;b++){if(d[m[b]]){d=d[m[b]];}else{if(m.length==b+1){if(m[b]){d[m[b]]=decodeURIComponent(k[1]);}else{d.push(decodeURIComponent(k[1]));}break;}else{d[m[b]]=!m[b+1]?[]:{};d=d[m[b]];}}}}return n;};Function.prototype.extend=function(){apf.extend.apply(this,[this].concat(Array.prototype.slice.call(arguments)));return this;};Function.prototype.bindWithEvent=function(){var b=this,c=Array.prototype.slice.call(arguments),g=c.shift(),d=c.shift();return function(k){if(!k){k=window.event;}if(d===true){k=new apf.AbstractEvent(k,window);}return b.apply(g,[k].concat(c).concat(Array.prototype.slice.call(arguments)));};};if(!Function.prototype.bind){Function.prototype.bind=function(g){if(typeof this!=="function"){throw new TypeError();}var k=Array.prototype.slice.call(arguments,1),m=this,c=Array.prototype.concat,b=function(){return m.apply(this instanceof d?this:g,c.apply(k,arguments));},d=function(){};d.prototype=m.prototype;b.prototype=new d();return b;};}Array.prototype.copy=function(){var b=[];for(var d=0,c=this.length;d<c;d++){b[d]=this[d]&&this[d].copy?this[d].copy():this[d];}return b;};Array.prototype.merge=function(){for(var g=0,c=arguments.length;g<c;g++){for(var d=0,b=arguments[g].length;d<b;d++){this.push(arguments[g][d]);}}};Array.prototype.arrayAdd=function(){var m=this.copy();for(var g=0,c=arguments.length;g<c;g++){for(var d=0,b=m.length;d<b;d++){m[d]+=arguments[g][d];}}return m;};Array.prototype.equals=function(d){for(var c=0,b=this.length;c<b;c++){if(this[c]!=d[c]){return false;}}return true;};Array.prototype.makeUnique=function(){var b,d,c=[];for(b=0,d=this.length;b<d;b++){if(c.indexOf(this[b])==-1){c.push(this[b]);}}this.length=0;for(b=0,d=c.length;b<d;b++){this.push(c[b]);}return this;};Array.prototype.contains=function(b,c){return this.indexOf(b,c)!=-1;};Array.prototype.indexOf=Array.prototype.indexOf||function(d,g){var b=this.length;for(var c=(g<0)?Math.max(0,b+g):g||0;c<b;c++){if(this[c]===d){return c;}}return -1;};Array.prototype.lastIndexOf=Array.prototype.lastIndexOf||function(d,g){var b=this.length;for(var c=(g>=b)?b-1:(g<0)?g+b:b-1;c>=0;c--){if(this[c]===d){return c;}}return -1;};Array.prototype.pushUnique=function(){var d,c=0,b=arguments.length;for(;c<b;++c){d=arguments[c];if(this.indexOf(d)==-1){this.push(d);}}return this;};Array.prototype.search=function(){for(var c=0,d=arguments.length;c<d;c++){if(typeof this[c]!="array"){continue;}for(var b=0;b<d;b++){if(this[c][b]!=arguments[b]){break;}else{if(b==(d-1)){return this[c];}}}}};Array.prototype.each=Array.prototype.forEach=Array.prototype.forEach||function(d){for(var c=0,b=this.length;c<b;c++){d.call(this,this[c],c,this)===false;}return this;};Array.prototype.remove=function(c){for(var b=this.length-1;b>=0;b--){if(this[b]!=c){continue;}this.splice(b,1);}return this;};Array.prototype.removeIndex=function(b){if(!this.length){return null;}return this.splice(b,1);};Array.prototype.insertIndex=function(c,b){this.splice(b,0,c);};Array.prototype.invert=Array.prototype.reverse=Array.prototype.reverse||function(){var b=this.length-1;for(var c,d=0;d<Math.ceil(0.5*b);d++){c=this[d];this[d]=this[b-d];this[b-d]=c;}return this;};Array.prototype.filter=Array.prototype.filter||function(g,k){var d=[];for(var c=0,b=this.length;c<b;c++){if(g.call(k,this[c],c,this)){d.push(this[c]);}}return d;};Array.prototype.every=Array.prototype.every||function(d,g){for(var c=0,b=this.length;c<b;c++){if(!d.call(g,this[c],c,this)){return false;}}return true;};Array.prototype.map=Array.prototype.map||function(g,k){var d=[];for(var c=0,b=this.length;c<b;c++){d[c]=g.call(k,this[c],c,this);}return d;};Array.prototype.some=Array.prototype.some||function(d,g){for(var c=0,b=this.length;c<b;c++){if(d.call(g,this[c],c,this)){return true;}}return false;};Number.prototype.toPrettyDigit=Number.prototype.toPrettyDigit||function(){var b=this.toString();return(b.length==1)?"0"+b:b;};RegExp.prototype.getNativeFlags=function(){return(this.global?"g":"")+(this.ignoreCase?"i":"")+(this.multiline?"m":"")+(this.extended?"x":"")+(this.sticky?"y":"");};RegExp.prototype.addFlags=function(b){return new RegExp(this.source,(b||"")+this.getNativeFlags());};String.prototype.uCaseFirst=function(){return this.substr(0,1).toUpperCase()+this.substr(1);};String.prototype.trim=function(){return this.replace(/[\s\n\r]*$/,"").replace(/^[\s\n\r]*/,"");};String.prototype.repeat=function(b){return Array(b+1).join(this);};String.prototype.count=function(b){return this.split(b).length-1;};String.prototype.stripTags=function(){return this.replace(/<\/?[^>]+>/gi,"");};String.prototype.escape=function(){return escape(this);};String.prototype.toXml=function(){var d=apf.getXml("<root>"+this+"</root>");if(d.childNodes.length==1){return d.childNodes[0];}else{var c=d.ownerDocument.createDocumentFragment(),b=d.childNodes;while(b.length){c.appendChild(b[0]);}return c;}};if(typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement=="function"){String.prototype.escapeHTML=function(){this.escapeHTML.text.data=this;return this.escapeHTML.div.innerHTML;};String.prototype.unescapeHTML=function(){var d=document.createElement("div");d.innerHTML=this.stripTags();if(d.childNodes[0]){if(d.childNodes.length>1){var b=[];for(var c=0;c<d.childNodes.length;c++){b.push(d.childNodes[c].nodeValue);}return b.join("");}else{return d.childNodes[0].nodeValue;}}return"";};String.prototype.escapeHTML.div=document.createElement("div");String.prototype.escapeHTML.text=document.createTextNode("");String.prototype.escapeHTML.div.appendChild(String.prototype.escapeHTML.text);if("<\n>".escapeHTML()!=="&lt;\n&gt;"){String.prototype.escapeHTML=null;}if("&lt;\n&gt;".unescapeHTML()!=="<\n>"){String.prototype.unescapeHTML=null;}}if(!String.prototype.escapeHTML){String.prototype.escapeHTML=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");};}if(!String.prototype.unescapeHTML){String.prototype.unescapeHTML=function(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");};}String.prototype.truncate=function(c,b){return this.length>=c?this.substring(0,c-(b?4:1))+(b?"...":""):this;};String.prototype.pad=function(b,d,c){return c?(this+Array(b).join(d)).slice(0,b):(Array(b).join(d)+this).slice(-b);};apf.PAD_LEFT=false;apf.PAD_RIGHT=true;String.prototype.splitSafe=function(d,b,c){return(c&&this.toLowerCase()||this).replace(/(?:^\s+|\n|\s+$)/g,"").split(new RegExp("[\\s ]*"+d+"[\\s ]*","g"),b||999);};String.prototype.appendRandomNumber=function(d){for(var b=[],c=1;c<=d;c++){b.push(apf.randomGenerator.generate(1,9));}return this.toString()+b.join("");};String.prototype.prependRandomNumber=function(d){for(var b=[],c=1;c<=d;c++){b.push(apf.randomGenerator.generate(1,9));}return b.join("")+this.toString();};String.prototype.sprintf=function(){var g=this.toString(),b=0,d=g.indexOf("%s");while(d>=0){var c=arguments[b++]||" ";g=g.substr(0,d)+c+g.substr(d+2);d=g.indexOf("%s");}return g;};if(!Date.now){Date.now=function now(){return +new Date();};}apf.hotkeys={};(function(){var g={ctrl:1,alt:2,option:2,shift:4,meta:8,command:8};this.keyNames={"8":"Backspace","9":"Tab","13":"Enter","27":"Esc","32":"Space","33":"PageUp","34":"PageDown","35":"End","36":"Home","37":"Left","38":"Up","39":"Right","40":"Down","45":"Insert","46":"Del","107":"+","112":"F1","113":"F2","114":"F3","115":"F4","116":"F5","117":"F6","118":"F7","119":"F8","120":"F9","121":"F10","122":"F11","123":"F12","188":",","219":"[","221":"]"};var d={meta:"\u2318",command:"\u2318",alt:"\u2325",option:"\u2325",shift:"\u21E7",esc:"\u238B",control:"\u2303",backspace:"\u232B",del:"\u2326",enter:"\u21A9"};var c={meta:"&#8984;",command:"&#8984;",alt:"&#8997;",option:"&#8997;",shift:"&#8679;",esc:"&#9099;",control:"&#2303;",backspace:"&#232B;",del:"&#2326;",enter:"&#21A9;"};this.$keys={};var b=this;apf.registerHotkey=this.register=function(k,q){var o,s=0,r=k.splitSafe("\\-",null,true),n=0,m=r.length;for(;n<m;++n){if(g[r[n]]){s=s|g[r[n]];}else{o=r[n]||"-";}}(b.$keys[s]||(b.$keys[s]={}))[o]=q;};this.$exec=function(o){var n=0|(o.ctrlKey?1:0)|(o.altKey?2:0)|(o.shiftKey?4:0)|(o.metaKey?8:0);var k=b.keyNames[o.keyCode];if(!n&&!k){return;}var m=(b.$keys[n]||{})[(k||String.fromCharCode(o.keyCode)).toLowerCase()];if(m){m();o.returnValue=false;apf.queue.empty();}return o.returnValue;};apf.removeHotkey=this.remove=this.unregister=function(k){b.register(k,null);};this.toMacNotation=function(k,r){var o,q=k.splitSafe("\\-"),n=0,m=q.length;for(;n<m;++n){if(!q[n]){continue;}if(o=(r?c:d)[q[n].toLowerCase()]){q[n]=o;}}return q.join(" ");};apf.addEventListener("keydown",function(m){var n=m.htmlEvent;if(
/*eInfo.isTextInput && */
b.$exec(m)===false||m.returnValue===false){apf.stopEvent(n);if(apf.canDisableKeyCodes){try{n.keyCode=0;}catch(n){}}return false;}var k=[];if(n.altKey){k.push("Alt");}if(n.ctrlKey){k.push("Ctrl");}if(n.shiftKey){k.push("Shift");}if(n.metaKey){k.push("Meta");}if(b.keyNames[n.keyCode]){k.push(b.keyNames[n.keyCode]);}if(k.length){if(n.keyCode>46&&!b.keyNames[n.keyCode]){k.push(String.fromCharCode(n.keyCode));}apf.setProperty("hotkey",k.join("-"));}});}).call(apf.hotkeys);apf.json2xml_Obj={};apf.json2xml_Attr={};apf.json2xml_ObjByAttr={};apf.json2Xml=(function(){var b=function(w,g,u,s){var r,k,o,x;function d(m){return m.replace(/&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;");}if(!s){if(g!=(o=g.replace(/[^a-zA-Z0-9_-]/g,"_"))){apf.console.warn("Json2XML, invalid characters found in JSON tagname '"+g,"json2Xml");}g=o;}if(apf.isArray(w)){for(r=0,k=w.length;r<k;r++){b(w[r],g,u);}}else{if(typeof w=="object"){var q=false,c=null;if(!s){u.push("<",g);}for(r in w){if((k=apf.json2xml_Attr[r])||r.charAt(0)=="@"){if(!k&&!c){c=apf.json2xml_ObjByAttr[r.slice(1)];}if(!s){u.push(" ",k?k:r.slice(1),'="',d(w[r].toString()),'"');}}else{q=true;}}if(q){if(!s){u.push(">");}if(x=(c||apf.json2xml_Obj[g])){if(x==1){x={child:g.replace(/(.*)s$/,"$1")||g,key:"name",value:"value"};}for(r in w){if(r.charAt(0)!="@"&&!apf.json2xml_Attr[r]){if(typeof(o=w[r])=="object"){if(apf.json2xml_Obj[r]){b(o,r,u);}else{u.push("<",x.child," ",x.key,'="',d(r.toString()),'" >');b(o,r,u,true);u.push("</",x.child,">\n");}}else{u.push("<",x.child," ",x.key,'="',r,'" ');if(x.value){if(x.value==1){u.push("/>");}else{u.push(x.value,'="',d(w[r].toString()),'"/>');}}else{u.push(">",d(w[r].toString()),"</",x.child,">");}}}}if(!s){u.push("</",g,">\n");}}else{for(r in w){if(!apf.json2xml_Attr[r]&&r.charAt(0)!="@"){if(r.match(/[^a-zA-Z0-9_-]/g)){apf.console.warn("Json2XML, invalid characters found in JSON tagname: '"+r,"json2Xml");}else{b(w[r],r,u,false);}}}if(!s){u.push("</",g,">");}}}else{if(!s){u.push("/>");}}}else{if(!s){u.push("<",g,">",d(w.toString()),"</",g,">");}else{u.push(d(w.toString()));}}}};return function(m,c,d){var n=(typeof m=="string"&&apf.isJson(m))?JSON.parse(m.replace(/""/g,'" "')):m,g=[],k;b(n,"jsondoc",g,false);return apf.getXmlDom(g.join("").replace(/\t|\n/g,""),c,true);};})();apf.xml2json=function(d,G){var g,K={},C,E=d.childNodes,k,J,I,D,F,y,x,r,B,A,c,L,b,q,M;if(!G){if(F=(d.attributes)){for(y=0,x=F.length;y<x;y++){A=apf.json2xml_Attr[r=F[y].nodeName]||("@"+r);if(A.indexOf("@a_")!=0){K[A]=F[y].nodeValue,g=true;}}}}for(var J=0,I=E.length;J<I;J++){if((D=E[J]).nodeType!=1){continue;}M=D.tagName;g=true;A=B=null,C={};if(F=(D.attributes)){for(y=0,x=F.length;y<x;y++){C["@"+(r=F[y].nodeName)]=F[y].nodeValue;if(!B){B=apf.json2xml_ObjByAttr[r];}}}if(A=B||apf.json2xml_Obj[M]){if(A==1){A={key:"name",value:"value"};}for(k=D.childNodes,y=0,x=k.length;y<x;y++){if((B=k[y]).nodeType!=1){continue;}if(q=apf.json2xml_Obj[B.nodeName]){var H={};for(c=B.childNodes,L=0,b=c.length;L<b;L++){if((s1=c[L]).nodeType!=1){continue;}if(r=s1.getAttribute(q.key)){H[r]=(q.value==1?(s1.childNodes.length?apf.xml2json(s1,1):1):(s1.getAttribute(q.value||"value"))||apf.xml2json(s1,1));}}C[B.nodeName]=H;}else{if(r=B.getAttribute(A.key)){C[r]=(A.value==1?(B.childNodes.length?apf.xml2json(B,1):1):(B.getAttribute(A.value||"value"))||apf.xml2json(B,1));}}}}else{C=apf.xml2json(D);}if(K[M]!==undefined){if((B=K[M]).dataType!=apf.ARRAY){K[M]=[B,C];}else{K[M].push(C);}}else{K[M]=C;}}return g?K:apf.queryValue(d,"text()");};apf.isJson=(function(){var c=/\\["\\\/bfnrtu@]/g,b=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,g=/(?:^|:|,)(?:\s*\[)+/g,d=/^[\],:{}\s]*$/;return function(k){if(!k){return false;}return d.test(k.replace(c,"@").replace(b,"]").replace(g,""));};})();if(!self.JSON){if(!this.JSON){this.JSON={};}(function(){function f(n){return n<10?"0"+n:n;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key);}if(typeof rep==="function"){value=rep.call(holder,key,value);}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null";}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null";}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v;}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v;}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" ";}}else{if(typeof space==="string"){indent=space;}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify");}return str("",{"":value});};}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}return reviver.call(holder,key,value);}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j;}throw new SyntaxError("JSON.parse");};}}());}apf.serialize=function(b){return self.JSON.stringify(b);};apf.unserialize=function(b){if(!b){return b;}return self.JSON.parse(b);};apf.nameserver={lookup:{},add:function(b,c){if(!this.lookup[b]){this.lookup[b]=[];}return this.lookup[b].push(c)-1;},register:function(c,k,d){if(!this.lookup[c]){this.lookup[c]={};}if(this.waiting[k]){var g=this.waiting[k];for(var b=0;b<g.length;b++){g[b]();}delete this.waiting[k];}return(this.lookup[c][k]=d);},waiting:{},waitFor:function(b,c){(this.waiting[b]||(this.waiting[b]=[])).push(c);},remove:function(b,c){var d=this.lookup[b];if(d){for(var g in d){if(d[g]==c){delete d[g];}}}},get:function(b,c){return this.lookup[b]?this.lookup[b][c]:null;},getAll:function(k){var d,b=[],c=this.lookup[k];if(!c){return b;}if(c.dataType==apf.ARRAY){for(var g=0;g<c.length;g++){b.push(c[g]);}}else{for(d in c){b.push(c[d]);}}return b;},getAllNames:function(d){var c,b=[];for(c in this.lookup[d]){if(parseInt(c)==c){continue;}b.push(c);}return b;}};apf.registry=apf.extend({put:function(b,d,c){this.register(c,b,d);},getNamespaces:function(){},getKeys:function(b){return this.getAllNames(b);},remove:function(b,c){delete this.lookup[c][b];},clear:function(b){this.lookup={};},$export:function(d){var c,b;for(c in this.lookup){for(b in this.lookup[c]){d.put(b,this.lookup[b][c],c);}}}},apf.nameserver);apf.registry.lookup={};apf.registry.get=function(b,c){return this.lookup[c]?this.lookup[c][b]:null;};apf.Init.run("nameserver");apf.plane={$set:[],$lookup:{},$find:function(c){if(this.$lookup[c]){return this.$lookup[c];}var b=this.$set.pop();if(!b){b=this.$factory();}this.$lookup[c]=b;return b;},get:function(b){return this.$find(b&&b.protect||"default");},show:function(k,m,d,b,c){var g=this.$find(c&&c.protect||"default");g.show(k,m,d,b,c);},hide:function(c,b){var d=this.$lookup[c||"default"];if(d){d.hide(b);delete this.$lookup[c||"default"];this.$set.push(d);}},$factory:function(){var b=document.body.appendChild(document.createElement("DIV"));b.style.background="url(images/spacer.gif)";b.style.position="fixed";b.style.left=0;b.style.top=0;b.host=false;return{host:this,plane:b,lastCursor:null,show:function(c,r,k,d,u){var n=this.plane;this.plane.style.background=u&&u.color||"url(images/spacer.gif)";this.animate=u&&u.animate;this.protect=u&&u.protect;if(this.protect){apf.setProperty("planes",(apf.planes||0)+1);}if(c){this.current=c;if(r){this.$originalPlace=[c.parentNode,c.nextSibling];this.plane.appendChild(c);}}apf.window.zManager.set("plane",this.plane,!r&&c);d=apf.isIE;var g=(n.parentNode==document.body?d?document.documentElement.offsetWidth:apf.getWindowWidth():n.parentNode.offsetWidth);var t=(n.parentNode==document.body?d?document.documentElement.offsetHeight:apf.getWindowHeight():n.parentNode.offsetHeight);if(k){if(this.lastCursor===null){this.lastCursor=document.body.style.cursor;}document.body.style.cursor=apf.getStyle(c,"cursor");}this.plane.style.display="block";var m=parseFloat(u&&u.opacity)||1;if(this.animate){var q=this;apf.setOpacity(this.plane,0);setTimeout(function(){apf.tween.single(q.plane,{steps:5,interval:10,type:"fade",from:0,to:m});},100);}else{apf.setOpacity(this.plane,m);}var s=apf.getDiff(n);this.plane.style.width="100%";this.plane.style.height="100%";return n;},hide:function(g){if(this.protect){apf.setProperty("planes",apf.planes-1);}var d;try{d=apf.isChildOf(this.plane,document.activeElement);}catch(k){d=false;}if(this.current&&this.current.parentNode==this.plane){this.$originalPlace[0].insertBefore(this.current,this.$originalPlace[1]);}if(this.animate&&!g){var c=this;setTimeout(function(){apf.tween.single(c.plane,{steps:5,interval:10,type:"fade",from:apf.getOpacity(c.plane),to:0,onfinish:function(){c.plane.style.display="none";if(c.current){apf.window.zManager.clear(c.current);}}});},100);}else{apf.setOpacity(this.plane,0);if(this.current){apf.window.zManager.clear(this.plane,this.current);}this.plane.style.display="none";}if(d&&apf.document.activeElement){if(!apf.isIE){document.activeElement.focus();}apf.document.activeElement.$focus();}this.current=null;if(this.lastCursor!==null){document.body.style.cursor=this.lastCursor;this.lastCursor=null;}return this.plane;}};}};apf.popup={cache:{},focusFix:{INPUT:1,TEXTAREA:1,SELECT:1},setContent:function(k,g,d,c,b){if(!this.popup){this.init();}this.cache[k]={content:g,style:d,width:c,height:b};g.style.position="absolute";g.onmousedown=function(m){if(!m){m=event;}if(apf.hasFocusBug&&!apf.popup.focusFix[(m.srcElement||m.target).tagName]){apf.window.$focusfix();}apf.cancelBubble(m,null,true);};return g.ownerDocument;},removeContent:function(b){this.cache[b]=null;delete this.cache[b];},init:function(){this.popup={};apf.addEventListener("hotkey",function(b){if(b.keyCode=="27"||b.altKey){apf.popup.forceHide();}});},show:function(c,d){if(!this.popup){this.init();}d=apf.extend({x:0,y:0,animate:false,ref:null,width:null,height:null,callback:null,draggable:false,resizable:false,allowTogether:false,autoCorrect:true,noleft:false},d);if((!d.allowTogether||d.allowTogether!=this.last)&&this.last!=c){this.hide();}var s=this.cache[c];s.options=d;var t,b=s.content,D=false,g=false;apf.window.zManager.set("popup",s.content);if((t=s.content.style.display)&&t.indexOf("none")>-1){s.content.style.display="";}var q=d.x;var n=d.y;var m=d.ref;while(m&&m.nodeType==1){if(g=apf.getStyle(m,"position")=="fixed"){break;}m=m.parentNode||m.$parentNode;}if(!g){if(m){var k=apf.getAbsolutePosition(d.ref,s.content.offsetParent||s.content.parentNode);q=(q||0)+k[0];n=(n||0)+k[1];}if(d.width||s.width){b.style.width=((d.width||s.width)-3)+"px";}b.style.position="absolute";var r=apf.getOverflowParent(s.content);var w=(r==document.documentElement?(apf.isIE?r.offsetHeight:(window.innerHeight+window.pageYOffset))+r.scrollTop:r.offsetHeight+r.scrollTop);D=d.autoCorrect&&(n+(d.height||s.height||s.content.offsetHeight))>w;if(D){var u;if(m){u=(k[1]-(d.height||s.height||s.content.offsetHeight));}else{u=(w-(d.height||s.height||s.content.offsetHeight));}b.style.top=u<0?n:u+"px";}else{b.style.top=n+"px";}if(!d.noleft){var A=(r==document.documentElement?(apf.isIE?r.offsetWidth:(window.innerWidth+window.pageXOffset))+r.scrollLeft:r.offsetWidth+r.scrollLeft);moveLeft=d.autoCorrect&&(q+(d.width||s.width||s.content.offsetWidth))>A;if(moveLeft){var u=(A-(d.width||s.width||s.content.offsetWidth));b.style.left=u<0?q:u+"px";}else{b.style.left=q+"px";}}}else{k=apf.getAbsolutePosition(d.ref,m);n=(n||0)+k[1]+m.offsetTop;k[0]+=m.offsetLeft;b.style.position="fixed";b.style.top=n+"px";if(!d.noleft){b.style.left=q+"px";}}apf.setStyleClass(b,D?"upward":"downward",[D?"downward":"upward"]);if(d.animate){if(d.animate=="fade"){apf.tween.single(b,{type:"fade",from:0,to:1,anim:apf.tween.NORMAL,steps:d.steps||15*apf.animSteps});}else{var E,C=apf.isIE8?5:7,B=0;E=setInterval(function(){var o=++B*((d.height||s.height)/C);b.style.height=o+"px";if(D){b.style.top=(n-o-(d.y||0))+"px";}else{(d.container||b).scrollTop=-1*(B-C)*((d.height||s.height)/C);}b.style.display="block";if(B>=C){clearInterval(E);if(d.callback){d.callback(b);}}},10);}}else{if(!m){if(d.height||s.height){b.style.height=(d.height||s.height)+"px";}b.style.top=n+"px";}b.style.display="block";if(d.callback){d.callback(b);}}$setTimeout(function(){apf.popup.last=c;});if(d.draggable){d.id=c;this.makeDraggable(d);}},hide:function(){if(this.isDragging){return;}var b=this.cache[this.last];if(b){if(b.content){b.content.style.display="none";}if(b.options&&b.options.onclose){b.options.onclose(apf.extend(b.options,{htmlNode:b.content}));b.options.onclose=false;}}},isShowing:function(b){return this.last&&this.last==b&&this.cache[this.last]&&this.cache[this.last].content.style.display!="none";},isDragging:false,makeDraggable:function(b){if(!apf.Interactive||this.cache[b.id].draggable){return;}var c=this.cache[b.id].content;this.cache[b.id].draggable=true;var d={$propHandlers:{},minwidth:10,minheight:10,maxwidth:10000,maxheight:10000,dragOutline:false,resizeOutline:false,draggable:true,resizable:b.resizable,$ext:c,oDrag:c.firstChild};c.onmousedown=c.firstChild.onmousedown=function(g){if(!g){g=event;}if(apf.hasFocusBug&&!apf.popup.focusFix[(g.srcElement||g.target).tagName]){apf.window.$focusfix();}(g||event).cancelBubble=true;};apf.implement.call(d,apf.Interactive);d.$propHandlers.draggable.call(d,true);d.$propHandlers.resizable.call(d,true);},forceHide:function(){if(this.last&&!apf.plane.current&&this.isShowing(this.last)&&this.cache[this.last]&&this.cache[this.last].options&&this.cache[this.last].options.autohide!==false){var b=apf.lookup(this.last);if(!b){this.last=null;}else{if(b.dispatchEvent("popuphide")!==false){this.hide();}}}},destroy:function(){for(var b in this.cache){if(this.cache[b]){this.cache[b].content.onmousedown=null;apf.destroyHtmlNode(this.cache[b].content);this.cache[b].content=null;this.cache[b]=null;}}if(!this.popup){return;}}};apf.setStyleRule=function(c,o,q,b,m){c=c.toLowerCase();if(!b){var k=(m||self).document.styleSheets;for(var d=k.length-1;d>=0;d--){try{var r=k[d][apf.styleSheetRules];for(var g=0;g<r.length;g++){if(r.item(g).selectorText.toLowerCase()==c){r.item(g).style[o]=q;return true;}}}catch(n){}}}else{var r=(m||self).document.styleSheets[b||0][apf.styleSheetRules];for(var g=0;g<r.length;g++){if(r.item(g).selectorText.toLowerCase()==c){r.item(g).style[o]=q;return true;}}}return false;};apf.getStyleRule=function(c,o,b,m){c=c.toLowerCase();if(!b){var k=(m||self).document.styleSheets;for(var d=k.length-1;d>=0;d--){try{var q=k[d][apf.styleSheetRules];for(var g=0;g<q.length;g++){if(q.item(g).selectorText.toLowerCase()==c){return q.item(g).style[o];}}}catch(n){}}}else{var q=(m||self).document.styleSheets[b||0][apf.styleSheetRules];for(var g=0;g<q.length;g++){if(q.item(g).selectorText.toLowerCase()==c){return q.item(g).style[o];}}}return false;};apf.setStyleClass=function(d,c,g,k){if(!d||k&&this.disabled){return;}if(c){if(g){g[g.length]=c;}else{g=[c];}}var b=new RegExp("(^| +)(?:"+(g?g.join("|"):"")+")","gi");d.className!=null?(d.className=d.className.replace(b," ")+(c?" "+c:"")):d.setAttribute("class",(d.getAttribute("class")||"").replace(b," ")+(c?" "+c:""));return d;};apf.importCssString=function(c,k,g){k=k||document;var d=k.getElementsByTagName("head")[0];if(apf.canCreateStyleNode){var b=k.createElement("style");b.appendChild(k.createTextNode(c));if(g){b.setAttribute("media",g);}d.appendChild(b);}else{d.insertAdjacentHTML("beforeend",".<style media='"+(g||"all")+"'>"+c+"</style>");}};apf.getStyleRecur=function(b,d){var c=apf.hasComputedStyle?document.defaultView.getComputedStyle(b,"").getPropertyValue(d.replace(/([A-Z])/g,function(g,k){return"-"+k.toLowerCase();})):b.currentStyle[d];return((!c||c=="transparent"||c=="inherit")&&b.parentNode&&b.parentNode.nodeType==1)?this.getStyleRecur(b.parentNode,d):c;};apf.importStylesheet=function(c,d){for(var b=0;b<c.length;b++){if(!c[b][1]){continue;}if(apf.isIE){(d||window).document.styleSheets[0].addRule(c[b][0],c[b][1]);}else{(d||window).document.styleSheets[0].insertRule(c[b][0]+" {"+c[b][1]+"}",0);}}};apf.isInRect=function(c,b,g){var d=this.getAbsolutePosition(c);if(b<d[0]||g<d[1]||b>c.offsetWidth+d[0]-10||g>c.offsetHeight+d[1]-10){return false;}return true;};apf.getOverflowParent=function(b){b=b.offsetParent;while(b&&(this.getStyle(b,"overflow")!="hidden"||"absolute|relative".indexOf(this.getStyle(b,"position"))==-1)){b=b.offsetParent;}return b||document.documentElement;};apf.getPositionedParent=function(b){b=b.offsetParent;while(b&&b.tagName.toLowerCase()!="body"&&"absolute|relative".indexOf(this.getStyle(b,"position"))==-1){b=b.offsetParent;}return b||document.documentElement;};apf.getAbsolutePosition=function(c,r,d){if("getBoundingClientRect" in document.documentElement){if(apf.doesNotIncludeMarginInBodyOffset&&c==document.body){return[c.offsetLeft+(parseFloat(apf.getStyle(c,"marginLeft"))||0),+(c.scrollLeft||0),c.offsetTop+(parseFloat(apf.getStyle(c,"marginTop"))||0)+(c.scrollTop||0)];}var m=c.getBoundingClientRect(),x=m.top,g=m.left,t=(apf.isIE&&apf.isIE<8);if(r&&r!=document.body){var w=apf.getAbsolutePosition(r,null,true);x-=w[1];g-=w[0];}if(!(apf.isIE&&c==document.documentElement)){g+=(r||document.body).scrollLeft||document.documentElement.scrollLeft||0;x+=(r||document.body).scrollTop||document.documentElement.scrollTop||0;}if(d&&!r){g+=parseInt(apf.getStyle(c,"borderLeftWidth"))||0;x+=parseInt(apf.getStyle(c,"borderTopWidth"))||0;}return[g-(t?2:0),x-(t?2:0)];}var n=d?0:c.offsetLeft,y=d?0:c.offsetTop;c=d?c:c.offsetParent||c.parentNode;if(apf.isIE8&&r){u=this.getStyle(c,"borderLeftWidth");n-=(apf.isIE&&c.currentStyle.borderLeftStyle!="none"&&u=="medium"?2:parseInt(u)||0);k=this.getStyle(c,"borderTopWidth");y-=(apf.isIE&&c.currentStyle.borderTopStyle!="none"&&k=="medium"?2:parseInt(k)||0);}var u,k,A;while(c&&c!=r){u=apf.isOpera||apf.isIE8?0:this.getStyle(c,"borderLeftWidth");n+=(apf.isIE&&c.currentStyle.borderLeftStyle!="none"&&u=="medium"?2:parseInt(u)||0)+c.offsetLeft;if(apf.isIE&&!apf.isIE8&&apf.getStyle(c,"styleFloat")=="none"&&apf.getStyle(c,"position")=="relative"){var b=c.previousSibling;while(b){if(b.nodeType==1){A=apf.getStyle(b,"styleFloat");if(A=="left"){n-=parseInt(apf.getStyle(c,"marginLeft"))||0;break;}else{if(A=="right"){break;}}}b=b.previousSibling;}}k=apf.isOpera||apf.isIE8?0:this.getStyle(c,"borderTopWidth");y+=(apf.isIE&&c.currentStyle.borderTopStyle!="none"&&k=="medium"?2:parseInt(k)||0)+c.offsetTop;if(!apf.isGecko&&c!=r&&(c.tagName!="HTML"||c.ownerDocument!=document)){n-=c.scrollLeft;y-=c.scrollTop;}if(c.tagName.toLowerCase()=="table"){y-=parseInt(c.border||0)+parseInt(c.cellSpacing||0);n-=parseInt(c.border||0)+parseInt(c.cellSpacing||0)*2;}else{if(c.tagName.toLowerCase()=="tr"){var s;y-=(s=parseInt(c.parentNode.parentNode.cellSpacing));while(c.previousSibling){y-=(c=c.previousSibling).offsetHeight+s;}}}if(apf.isIE&&!c.offsetParent&&c.parentNode.nodeType==1){n-=c.parentNode.scrollLeft;y-=c.parentNode.scrollTop;}c=c.offsetParent;}return[n,y];};apf.getHorBorders=function(b){return Math.max(0,(parseInt(apf.getStyle(b,"borderLeftWidth"))||0)+(parseInt(apf.getStyle(b,"borderRightWidth"))||0));};apf.getVerBorders=function(b){return Math.max(0,(parseInt(apf.getStyle(b,"borderTopWidth"))||0)+(parseInt(apf.getStyle(b,"borderBottomWidth"))||0));};apf.getWidthDiff=function(b){if(apf.hasFlexibleBox&&apf.getStyle(b,apf.CSSPREFIX+"BoxSizing")!="content-box"){return 0;}return Math.max(0,(parseInt(apf.getStyle(b,"paddingLeft"))||0)+(parseInt(apf.getStyle(b,"paddingRight"))||0)+(parseInt(apf.getStyle(b,"borderLeftWidth"))||0)+(parseInt(apf.getStyle(b,"borderRightWidth"))||0));};apf.getHeightDiff=function(b){if(apf.hasFlexibleBox&&apf.getStyle(b,apf.CSSPREFIX+"BoxSizing")!="content-box"){return 0;}return Math.max(0,(parseInt(apf.getStyle(b,"paddingTop"))||0)+(parseInt(apf.getStyle(b,"paddingBottom"))||0)+(parseInt(apf.getStyle(b,"borderTopWidth"))||0)+(parseInt(apf.getStyle(b,"borderBottomWidth"))||0));};apf.getDiff=function(b){if(apf.hasFlexibleBox&&apf.getStyle(b,apf.CSSPREFIX+"BoxSizing")!="content-box"){return[0,0];}return[Math.max(0,(parseInt(apf.getStyle(b,"paddingLeft"))||0)+(parseInt(apf.getStyle(b,"paddingRight"))||0)+(parseInt(apf.getStyle(b,"borderLeftWidth"))||0)+(parseInt(apf.getStyle(b,"borderRightWidth"))||0)),Math.max(0,(parseInt(apf.getStyle(b,"paddingTop"))||0)+(parseInt(apf.getStyle(b,"paddingBottom"))||0)+(parseInt(apf.getStyle(b,"borderTopWidth"))||0)+(parseInt(apf.getStyle(b,"borderBottomWidth"))||0))];};apf.getMargin=function(b){return[(parseInt(apf.getStyle(b,"marginLeft"))||0)+(parseInt(apf.getStyle(b,"marginRight"))||0),(parseInt(apf.getStyle(b,"marginTop"))||0)+(parseInt(apf.getStyle(b,"marginBottom"))||0)];};apf.getHtmlInnerWidth=function(b){return(b.offsetWidth-(parseInt(apf.getStyle(b,"borderLeftWidth"))||0)-(parseInt(apf.getStyle(b,"borderRightWidth"))||0));};apf.getHtmlInnerHeight=function(b){return(b.offsetHeight-(parseInt(apf.getStyle(b,"borderTopWidth"))||0)-(parseInt(apf.getStyle(b,"borderBottomWidth"))||0));};apf.getViewPort=function(c){c=c||window;var b=(!c.document.compatMode||c.document.compatMode=="CSS1Compat")?c.document.html||c.document.documentElement:c.document.body;return{x:c.pageXOffset||b.scrollLeft,y:c.pageYOffset||b.scrollTop,width:c.innerWidth||b.clientWidth,height:c.innerHeight||b.clientHeight};};apf.pasteWindow=function(c){var b=window.open("about:blank");b.document.write(c);};apf.xmlEntityMap={quot:"34",amp:"38",apos:"39",lt:"60",gt:"62",nbsp:"160",iexcl:"161",cent:"162",pound:"163",curren:"164",yen:"165",brvbar:"166",sect:"167",uml:"168",copy:"169",ordf:"170",laquo:"171",not:"172",shy:"173",reg:"174",macr:"175",deg:"176",plusmn:"177",sup2:"178",sup3:"179",acute:"180",micro:"181",para:"182",middot:"183",cedil:"184",sup1:"185",ordm:"186",raquo:"187",frac14:"188",frac12:"189",frac34:"190",iquest:"191",agrave:"192",aacute:"193",acirc:"194",atilde:"195",auml:"196",aring:"197",aelig:"198",ccedil:"199",egrave:"200",eacute:"201",ecirc:"202",euml:"203",igrave:"204",iacute:"205",icirc:"206",iuml:"207",eth:"208",ntilde:"209",ograve:"210",oacute:"211",ocirc:"212",otilde:"213",ouml:"214",times:"215",oslash:"216",ugrave:"217",uacute:"218",ucirc:"219",uuml:"220",yacute:"221",thorn:"222",szlig:"223",agrave:"224",aacute:"225",acirc:"226",atilde:"227",auml:"228",aring:"229",aelig:"230",ccedil:"231",egrave:"232",eacute:"233",ecirc:"234",euml:"235",igrave:"236",iacute:"237",icirc:"238",iuml:"239",eth:"240",ntilde:"241",ograve:"242",oacute:"243",ocirc:"244",otilde:"245",ouml:"246",divide:"247",oslash:"248",ugrave:"249",uacute:"250",ucirc:"251",uuml:"252",yacute:"253",thorn:"254",yuml:"255",oelig:"338",oelig:"339",scaron:"352",scaron:"353",yuml:"376",fnof:"402",circ:"710",tilde:"732",alpha:"913",beta:"914",gamma:"915",delta:"916",epsilon:"917",zeta:"918",eta:"919",theta:"920",iota:"921",kappa:"922",lambda:"923",mu:"924",nu:"925",xi:"926",omicron:"927",pi:"928",rho:"929",sigma:"931",tau:"932",upsilon:"933",phi:"934",chi:"935",psi:"936",omega:"937",alpha:"945",beta:"946",gamma:"947",delta:"948",epsilon:"949",zeta:"950",eta:"951",theta:"952",iota:"953",kappa:"954",lambda:"955",mu:"956",nu:"957",xi:"958",omicron:"959",pi:"960",rho:"961",sigmaf:"962",sigma:"963",tau:"964",upsilon:"965",phi:"966",chi:"967",psi:"968",omega:"969",thetasym:"977",upsih:"978",piv:"982",ensp:"8194",emsp:"8195",thinsp:"8201",zwnj:"8204",zwj:"8205",lrm:"8206",rlm:"8207",ndash:"8211",mdash:"8212",lsquo:"8216",rsquo:"8217",sbquo:"8218",ldquo:"8220",rdquo:"8221",bdquo:"8222",dagger:"8224",dagger:"8225",bull:"8226",hellip:"8230",permil:"8240",prime:"8242",prime:"8243",lsaquo:"8249",rsaquo:"8250",oline:"8254",frasl:"8260",euro:"8364",image:"8465",weierp:"8472",real:"8476",trade:"8482",alefsym:"8501",larr:"8592",uarr:"8593",rarr:"8594",darr:"8595",harr:"8596",crarr:"8629",larr:"8656",uarr:"8657",rarr:"8658",darr:"8659",harr:"8660",forall:"8704",part:"8706",exist:"8707",empty:"8709",nabla:"8711",isin:"8712",notin:"8713",ni:"8715",prod:"8719",sum:"8721",minus:"8722",lowast:"8727",radic:"8730",prop:"8733",infin:"8734",ang:"8736",and:"8743",or:"8744",cap:"8745",cup:"8746","int":"8747",there4:"8756",sim:"8764",cong:"8773",asymp:"8776",ne:"8800",equiv:"8801",le:"8804",ge:"8805",sub:"8834",sup:"8835",nsub:"8836",sube:"8838",supe:"8839",oplus:"8853",otimes:"8855",perp:"8869",sdot:"8901",lceil:"8968",rceil:"8969",lfloor:"8970",rfloor:"8971",lang:"9001",rang:"9002",loz:"9674",spades:"9824",clubs:"9827",hearts:"9829",diams:"9830"};apf.htmlentities=function(b){return b.escapeHTML();};apf.xmlentities=function(b){return b.replace(/&([a-z]+);/gi,function(d,c){if(apf.xmlEntityMap[c=c.toLowerCase()]){return"&#"+apf.xmlEntityMap[c]+";";}return d;});};apf.html_entity_decode=function(b){return(b||"").replace(/\&\#38;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," ");};apf.isCharacter=function(b){return(b<112||b>122)&&(b==32||b>42||b==8);};apf.randomGenerator={d:new Date(),seed:null,A:48271,M:2147483647,Q:null,R:null,oneOverM:null,generate:function(c,b){if(this.seed==null){this.seed=2345678901+(this.d.getSeconds()*16777215)+(this.d.getMinutes()*65535);}this.Q=this.M/this.A;this.R=this.M%this.A;this.oneOverM=1/this.M;return Math.floor((b-c+1)*this.next()+c);},next:function(){var b=this.seed/this.Q;var c=this.seed%this.Q;var d=this.A*c-this.R*b;if(d>0){this.seed=d;}else{this.seed=d+this.M;}return(this.seed*this.oneOverM);}};apf.getNoCacheUrl=function(b){return b+(b.indexOf("?")==-1?"?":"&")+"nocache="+new Date().getTime();};apf.parseExpression=function(str){if(!apf.parseExpression.regexp.test(str)){return str;}return eval(RegExp.$1);};apf.parseExpression.regexp=/^\{([\s\S]*)\}$/;apf.formatNumber=function(b,d){var c=parseFloat(b);if(!c){return b;}var g=new String(Math.round(c*100)/100).replace(/(\.\d?\d?)$/,function(k){return k.pad(3,"0",apf.PAD_RIGHT);});if(g.indexOf(".")==-1){g+=".00";}return d+g;};apf.jsexec=function(str,win){if(!str){return str;}if(!win){win=self;}if(apf.isO3){eval(str,self);}else{if(apf.hasExecScript){win.execScript(str);}else{var head=win.document.getElementsByTagName("head")[0];if(head){var script=win.document.createElement("script");script.setAttribute("type","text/javascript");script.text=str;head.appendChild(script);head.removeChild(script);}else{eval(str,win);}}}return str;};apf.K=function(){};apf.isNumber=function(b){return parseFloat(b)==b;};apf.isArray=function(b){return Object.prototype.toString.call(b)==="[object Array]";};apf.isTrue=function(b){return(b===true||b==="true"||b==="on"||typeof b=="number"&&b>0||b==="1");};apf.isFalse=function(b){return(b===false||b==="false"||b==="off"||b===0||b==="0");};apf.isNot=function(b){return(!b&&typeof b!="string"&&b!==0||(typeof b=="number"&&!isFinite(b)));};apf.removePathContext=function(c,b){if(!b){return"";}if(b.indexOf(c)>-1){return b.substr(c.length);}return b;};apf.cancelBubble=function(c,d,b){if(c.stopPropagation){c.stopPropagation();}else{c.cancelBubble=true;}if(!b){if(d&&d.$ext&&d.$ext["on"+(c.type||c.name)]){d.$ext["on"+(c.type||c.name)](c);}apf.window.$mousedown(c);}};apf.destroyHtmlNode=function(b){if(!b){return;}if(!apf.isIE||b.ownerDocument!=document){if(b.parentNode){b.parentNode.removeChild(b);}return;}var c=document.getElementById("IELeakGarbageBin");if(!c){c=document.createElement("DIV");c.id="IELeakGarbageBin";c.style.display="none";document.body.appendChild(c);}c.appendChild(b);c.innerHTML="";};apf.getRules=function(c){var d={};for(var b=c.firstChild;b;b=b.nextSibling){if(b.nodeType!=1){continue;}else{if(!d[b[apf.TAGNAME]]){d[b[apf.TAGNAME]]=[];}d[b[apf.TAGNAME]].push(b);}}return d;};apf.isCoord=function(b){return b||b===0;};apf.getCoord=function(c,b){return c||c===0?c:b;};apf.getBox=function(g,d){if(!d){d=0;}if(g==null||(!parseInt(g)&&parseInt(g)!=0)){return[0,0,0,0];}var b=String(g).splitSafe(" ");for(var c=0;c<b.length;c++){b[c]=parseInt(b[c])||0;}switch(b.length){case 1:b[1]=b[0];b[2]=b[0];b[3]=b[0];break;case 2:b[2]=b[0];b[3]=b[1];break;case 3:b[3]=b[1];break;}return b;};apf.getNode=function(d,b){var g=0;if(d!=null){for(var c=0;c<d.childNodes.length;c++){if(d.childNodes[c].nodeType==1){if(g==b[0]){d=d.childNodes[c];if(b.length>1){b.shift();d=this.getNode(d,b);}return d;}g++;}}}return null;};apf.getFirstElement=function(b){return b.firstChild.nodeType==1?b.firstChild:b.firstChild.nextSibling;};apf.getLastElement=function(b){return b.lastChild.nodeType==1?b.lastChild:b.lastChild.previousSibling;};apf.selectTextHtml=function(c){if(!apf.hasMsRangeObject){return;}var b=document.selection.createRange();try{b.moveToElementText(c);}catch(d){}b.select();};apf.visibilitymanager=function(){var d={};var c=this;var b=false;this.check=function(m,o,r){if(m.$ext.offsetHeight||m.$ext.offsetWidth){return true;}if(m.$visibleCheck){if(m.$visibleCheck[o]){return;}}else{m.$visibleCheck={};}function n(t){var s=m;while(s){s.removeEventListener("prop.visible",k);s.removeEventListener("DOMNodeRemoved",g);s.removeEventListener("DOMNodeRemovedFromDocument",g);if(t){s.addEventListener("DOMNodeInserted",q);}s=s.parentNode||s.$parentNode;}delete m.$visibleCheck[o];}function k(s){if(!m.$ext.offsetHeight&&!m.$ext.offsetWidth){return;}r.call(m);n();}function g(s){if(s.currentTarget!=this){return;}n(s.name=="DOMNodeRemoved");}function q(){var s=m;while(s){s.addEventListener("prop.visible",k);s.addEventListener("DOMNodeRemoved",g);s.addEventListener("DOMNodeRemovedFromDocument",g);s.removeEventListener("DOMNodeInserted",q);s=s.parentNode||s.$parentNode;}m.$visibleCheck[o]=true;}q();return false;};this.permanent=function(n,k,m){var o=n.$ext.offsetHeight&&n.$ext.offsetWidth;function g(s){var r=n.$ext.offsetHeight&&n.$ext.offsetWidth;if(r==o){return;}if(r){k();}else{m();}o=r;}var q=n;while(q){q.addEventListener("prop.visible",g);q=q.parentNode||q.$parentNode;}return o;};};apf.isChildOf=function(b,g,c){if(!b||!g){return false;}if(g.nodeType==2){g=g.ownerElement||g.selectSingleNode("..");}if(c&&b==g){return true;}var d=g.parentNode;while(d){if(d==b){return true;}d=d.parentNode;}return false;};apf.escapeXML=function(b){return((b||"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;"));};apf.isOnlyChild=function(m,c){if(!m||!m.parentNode||c&&c.indexOf(m.nodeType)==-1){return false;}var g,b,k,d=m.parentNode.childNodes;for(g=0,b=d.length;g<b;g++){k=d[g];if(k.nodeType==1&&k!=m){return false;}if(k.nodeType==3&&!k.nodeValue.trim()){return false;}}return true;};apf.getChildNumber=function(k,n){if(!k){return -1;}var m=k.parentNode,d=0;if(!m){return 0;}if(!n){n=m.childNodes;}if(n.indexOf){var b=n.indexOf(k);return b==-1?n.length:b;}for(var g=0,c=n.length;g<c;g++){if(n[g]==k){return d;}d++;}return d;};apf.mergeXml=function(u,o,y){if(typeof o!="object"){o=getElementById(o);}if(y&&y.clearContents){var d,k,n,b=o.selectNodes("descendant::node()[@"+apf.xmldb.xmlListenTag+"]");for(n=b.length-1;n>=0;n--){var x=b[n].getAttribute(apf.xmldb.xmlListenTag).split(";");for(k=x.length-1;k>=0;k--){d=apf.all[x[k]];if(!d){continue;}if(d.dataParent&&d.dataParent.xpath){d.dataParent.parent.signalXmlUpdate[d.$uniqueId]=true;}else{if(d.$model){d.$model.$waitForXml(d);}}}}b=o.childNodes;for(n=b.length-1;n>=0;n--){o.removeChild(b[n]);}}if(y&&y.start){var c,r,b,t,n,g,m=y.marker;if(!m){}if(m.getAttribute("start")-y.start==0){m.setAttribute("start",y.start+y.length);c=parseInt(m.getAttribute("reserved"));m.setAttribute("reserved",c+y.length);r=m;}else{if(y.start+y.length==m.getAttribute("end")){m.setAttribute("end",y.start+y.length);r=m.nextSibling;c=parseInt(m.getAttribute("reserved"))+parseInt(m.getAttribute("end"))-y.length;}else{var w=m.parentNode.insertBefore(m.cloneNode(true),m);w.setAttribute("end",y.start-1);m.setAttribute("start",y.start+y.length);c=parseInt(m.getAttribute("reserved"));m.setAttribute("reserved",c+y.length);r=m;}}b=u.childNodes;if(o.ownerDocument.importNode){t=o.ownerDocument;for(n=0,g=b.length;n<g;n++){o.insertBefore(t.importNode(b[n],true),r).setAttribute(apf.xmldb.xmlIdTag,y.documentId+"|"+(c+n));}}else{for(n=b.length-1;n>=0;n--){o.insertBefore(b[0],r).setAttribute(apf.xmldb.xmlIdTag,y.documentId+"|"+(c+n));}}}else{r=y&&y.beforeNode?y.beforeNode:apf.getNode(o,[0]);b=u.childNodes;if(o.ownerDocument.importNode){t=o.ownerDocument;for(n=0,g=b.length;n<g;n++){o.insertBefore(t.importNode(b[n],true),r);}}else{for(n=b.length-1;n>=0;n--){o.insertBefore(b[0],r);}}}if(y&&y.copyAttributes){var q=u.attributes;for(n=0;n<q.length;n++){if(q[n].nodeName!=apf.xmldb.xmlIdTag){o.setAttribute(q[n].nodeName,q[n].nodeValue);}}}return o;};apf.setNodeValue=function(m,k,o,g){if(!m){return;}var n,b,d;if(g){n=g.undoObj;b=g.xpath;d=g.newNodes;n.extra.oldValue=g.forceNew?"":apf.queryValue(m,b);n.xmlNode=m;if(b){m=apf.createNodeFromXpath(m,b,d,g.forceNew);}n.extra.appliedNode=m;}if(m.nodeType==1){if(!m.firstChild){m.appendChild(m.ownerDocument.createTextNode(""));}m.firstChild.nodeValue=apf.isNot(k)?"":k;if(o){apf.xmldb.applyChanges("text",m,n);}}else{if(apf.isO3&&m.nodeType==2){k=k.replace(/&/g,"&amp;");}var c=m.nodeValue;m.nodeValue=apf.isNot(k)?"":k;if(n){n.name=m.nodeName;}if(m.$triggerUpdate){m.$triggerUpdate(null,c);}if(o){apf.xmldb.applyChanges(m.nodeType==2?"attribute":"text",m.parentNode||m.ownerElement||m.selectSingleNode(".."),n);}}};apf.setQueryValue=function(d,b,k,c){var g=apf.createNodeFromXpath(d,b);if(!g){return null;}apf.setNodeValue(g,k,!c);return g;};apf.removeQueryNode=function(d,b,c){var g=apf.queryNode(d,b);if(!g){return false;}if(c){g.parentNode.removeChild(g);}else{apf.xmldb.removeNode(g);}return g;};apf.queryValue=function(c,b){if(!c){return"";}if(c.nodeType==2){return c.nodeValue;}if(b){c=c.selectSingleNode(b);if(!c){return"";}}return c.nodeType==1?(!c.firstChild?"":c.firstChild.nodeValue):c.nodeValue;};apf.queryValues=function(k,c){var d=[];if(!k){return d;}var b=k.selectNodes(c);if(!b.length){return d;}for(var g=0;g<b.length;g++){var m=b[g];if(m.nodeType==1){m=m.firstChild;}d.push(m.nodeValue||"");}return d;};apf.queryNodes=function(b,c){if(b&&(apf.hasXPathHtmlSupport&&b.selectSingleNode||!b.style)){return b.selectNodes(c);}return apf.XPath.selectNodes(c,b);};apf.queryNode=function(b,c){if(b&&(apf.hasXPathHtmlSupport&&b.selectSingleNode||!b.style)){return b.selectSingleNode(c);}var d=apf.queryNodes(b?b:null,c+(apf.isIE?"":"[1]"));return d.length>0?d[0]:null;};apf.getInheritedAttribute=function(g,d,k){var c,b;if(g.nodeType!=1){g=g.parentNode;}while(g&&(g.nodeType!=1||!(c=d&&((b=g.getAttribute(d))||typeof b=="string")||k&&k(g)))){g=g.parentNode;}if(b==""){return"";}return !c&&d&&apf.config?apf.config[d]:c;};apf.createNodeFromXpath=function(k,x,m,o){var u,t="",y=x.replace(/('.*?')|(".*?")|\|/g,function(A,C,B){if(C||B){return C||B;}return"-%-|-%-";}).split("-%-|-%-")[0].split(/\/(?!\/)/);if(!o&&(u=k.selectSingleNode(x))){return u;}var n=y.length-1;if(o){if(y[n].trim().match(/^\@(.*)$|^text\(\)$/)){n--;}}if(!y[0]){k=k.ownerDocument.documentElement;y.shift();y.shift();n--;n--;}for(var b,q=false,d=0;d<n;d++){if(!q&&k.selectSingleNode(t+(d!=0?"/":"")+y[d])){t+=(d!=0?"/":"")+y[d];continue;}var c=y[d].match(/(\w+)\[@([\w-]+)=(\w+)\]/);if(c){y[d]=c[1];}q=true;b=k.selectSingleNode(t||".").appendChild(k.ownerDocument.createElement(y[d]));if(c){b.setAttribute(c[2],c[3]);t+=(t?"/":"")+c[0];}else{t+=(t?"/":"")+y[d];}if(m){m.push(b);}}if(!t){t=".";}if(m){m.foundpath=t;}var s,g=y[n],r=k.nodeType==9?k:k.ownerDocument;do{if(g.match(/^\@(.*)$/)){(s||k.selectSingleNode(t)).setAttributeNode(s=r.createAttribute(RegExp.$1));}else{if(g.trim()=="text()"){s=(s||k.selectSingleNode(t)).appendChild(r.createTextNode(""));}else{var w=g.match(/(\w+)\[@([\w-]+)=(\w+)\]/);if(w){g=w[1];}s=(s||k.selectSingleNode(t)).appendChild(r.createElement(g));if(w){s.setAttribute(w[2],w[3]);}}}if(m){m.push(s);}t+=(t?"/":"")+y[n];}while((g=y[++n]));return s;};apf.convertMethods={json:function(b){return JSON.stringify(apf.xml2json(b));},cgivars:function(q,t){if(!t){t="";}var u,c,k,n,d,s=[],b=q.childNodes,m={},o=0,g=b.length;for(;o<g;++o){if(b[o].nodeType!=1){continue;}c=b[o].tagName;if(m[c]){continue;}k=q.selectNodes(c);if(k.length>1){m[c]=true;for(n=0,d=k.length;n<d;n++){u=this.cgivars(k[n],t+c+"["+n+"]");if(u){s.push(u);}}}else{u=this.cgivars(b[o],t+c);if(u){s.push(u);}}}var r=q.attributes;for(o=0,g=r.length;o<g;o++){if(r[o].nodeValue){if(t){s.push(t+"["+r[o].nodeName+"]="+escape(r[o].nodeValue));}else{s.push(r[o].nodeName+"="+escape(r[o].nodeValue));}}}if(s.length){return s.join("&");}u=apf.queryValue(q,"text()");if(t&&u){return t+"="+escape(u);}return"";},cgiobjects:function(g,c,o,q){if(!c){c="";}var w,B,t,A,y,x,u,n,r,s=g.childNodes,m=[],b={},d="";for(y=0;y<s.length;y++){w=s[y];if(w.nodeType==1){B=w.tagName;r=w.parentNode.selectNodes(B).length==1?true:false;if(typeof b[B]=="undefined"){b[B]=0;}d=c+(o?"[":"")+B+(o?"]":"")+(r?"":"["+b[B]+"]");u=w.attributes;n=w.attributes.length;if(n>0){for(x=0;x<n;x++){if(!(A=u[x]).nodeValue){continue;}m.push(d+"[_"+A.nodeName+"]="+escape(A.nodeValue.trim()));}}t=this.cgiobjects(w,d,true);if(t.dataType!==1){m.push(t);}else{if(w.firstChild&&w.firstChild.nodeValue.trim()){m.push(d+(n>0?"[_]=":"=")+escape(w.firstChild.nodeValue.trim()));}else{if(n==0){if(q){m.push(d);}}}}b[B]++;}else{if(w.nodeType==3&&o){var k=w.nodeValue;if(k&&k.trim()!==""){m.push(c+"="+escape(k));}}}}if(!o&&g.getAttribute("id")){m.push("id="+escape(g.getAttribute("id")));}if(m.length){return m.join("&");}return m;}};apf.convertXml=function(b,c){return apf.convertMethods[c](b);};apf.getTextNode=function(b){for(var d=0,c=b.childNodes.length;d<c;++d){if(b.childNodes[d].nodeType==3||b.childNodes[d].nodeType==4){return b.childNodes[d];}}return false;};apf.getBoundValue=function(c,g,d){if(!g&&!c.xmlRoot){return"";}var b=c.$getDataNode("value",c.xmlRoot);return b?apf.queryValue(b):"";};apf.getArrayFromNodelist=function(g){for(var c=[],d=0,b=g.length;d<b;++d){c.push(g[d]);}return c;};apf.serializeChildren=function(g){var m,k=[],c=g.childNodes,d=0,b=c.length;for(;d<b;++d){k[d]=(m=c[d]).nodeType==1?m.xml||m.serialize():(m.nodeType==8?"":m.nodeValue);}return k.join("");};apf.getXmlString=function(c){var b=apf.xmldb.cleanNode(c.cloneNode(true));return b.xml||b.serialize();};apf.getXml=function(d,b,c){return apf.getXmlDom(d,b,c).documentElement;};apf.formatXml=function(k){k=k.trim();var c=k.split("\n"),g=0,d=0,b=c.length;for(;d<b;++d){c[d]=c[d].trim();}c=c.join("\n").replace(/\>\n/g,">").replace(/\>/g,">\n").replace(/\n\</g,"<").replace(/\</g,"\n<").split("\n");c.removeIndex(0);c.removeIndex(c.length);for(d=0,b=c.length;d<b;d++){c[d]="    ".repeat((c[d].match(/^\s*\<\//)?(g==0)?0:--g:(c[d].match(/^\s*\<[^\?][^>]+[^\/]\>/)?g++:g)))+c[d];}if(!k){return"";}return c.join("\n");};apf.xmlToXpath=function(q,r,g){if(!q){return"";}if(g===true&&q.nodeType==1&&q.getAttribute(apf.xmldb.xmlIdTag)){return"//node()[@"+apf.xmldb.xmlIdTag+"='"+q.getAttribute(apf.xmldb.xmlIdTag)+"']";}if(apf!=this&&this.lookup&&this.select){var m,c=this.lookup[q.tagName];if(c){m=q.selectSingleNode(c).nodeValue;return"//"+q.tagName+"["+c+"='"+m+"']";}for(var n=0,k=this.select.length;n<k;n++){if(q.selectSingleNode(this.select[n][0])){m=q.selectSingleNode(this.select[n][1]).nodeValue;return"//"+this.select[n][0]+"["+this.select[n][1]+"='"+m+"']";}}}if(q==r){return".";}if(q.nodeType!=2&&!q.parentNode&&!q.ownerElement){return false;}var o=[],d=q;if(d.nodeType==2){o.push("@"+d.nodeName);d=d.ownerElement||q.selectSingleNode("..");}var b;while(d&&d.nodeType==1){if(d==r){break;}o.unshift((d.nodeType==1?d.tagName:"text()")+"["+(g&&(b=d.nodeType==1&&d.getAttribute(apf.xmldb.xmlIdTag))?"@"+apf.xmldb.xmlIdTag+"='"+b+"'":(apf.getChildNumber(d,d.parentNode.selectNodes(d.nodeType==1?d.tagName:"text()"))+1))+"]");d=d.parentNode;}return(o[0]=="/"||r&&r.nodeType==1?"":"/")+o.join("/");};apf.xpathToXml=function(b,c){if(!c){return false;}return c.selectSingleNode(b);};apf.n=function(c,b){return new apf.xmlset(c,b,true);};apf.b=function(c,b){return new apf.xmlset(c,b);};apf.b.$queue=[];apf.b.$state=0;apf.xmlset=function(c,b,d,g){if(typeof(c)=="string"){c=apf.getXml(c);}this.$xml=c;if(c){this.$nodes=c.dataType==apf.ARRAY?c:(b?c.selectNodes(b):[c]);}this.$xpath=b||".";this.$local=d;this.$previous=g;};(function(){this.add=function(){};this.begin=function(){apf.b.$state=1;return this;};this.commit=function(c,g,d){if(apf.b.$queue.length){if(g){var b=this;g.addEventListener("rdbsend",function(k){if(!d||k.uri==d){b.rdbstack=k.message;g.removeEventListener("rdbsend",arguments.callee);}});}c.execute({action:"multicall",args:apf.b.$queue});if(g){g.$processQueue(g);}}apf.b.$queue=[];apf.b.$state=0;return this;};this.rollback=function(){apf.b.$queue=[];apf.b.$state=0;return this;};this.getRDBMessage=function(){return this.rdbstack||[];};this.before=function(d){d=typeof d=="function"?d(c):d;for(var g,c=0,b=this.$nodes.length;c<b;c++){g=this.$nodes[c];if(this.$local){g.parentNode.insertBefore(d,g);}else{apf.xmldb.appendChild(g.parentNode,d,g);}}return this;};this.after=function(d){d=typeof d=="function"?d(c):d;for(var g,c=0,b=this.$nodes.length;c<b;c++){g=this.$nodes[c];if(this.$local){g.parentNode.insertBefore(d,g.nextSibling);}else{apf.xmldb.appendChild(g.parentNode,d,g.nextSibling);}}return this;};this.andSelf=function(){};this.append=function(d){for(var g,k,c=0,b=this.$nodes.length;c<b;c++){g=this.$nodes[c];k=typeof d=="function"?d(c,g):d;if(apf.b.$state){apf.b.$queue.push({action:"appendChild",args:[g,k]});}else{if(this.$local){g.appendChild(k);}else{apf.xmldb.appendChild(g,k);}}}return this;};this.appendTo=function(d){for(var c=0,b=this.$nodes.length;c<b;c++){d.appendChild(this.$nodes[c]);}return this;};this.prepend=function(g){for(var d,c=0,b=this.$nodes.length;c<b;c++){d=this.$nodes[c];d.insertBefore(typeof el=="function"?el(c,d):el,d.firstChild);}return this;};this.prependTo=function(d){for(var c=0,b=this.$nodes.length;c<b;c++){target.insertBefore(this.$nodes[c],target.firstChild);}return this;};this.attr=function(d,g){if(g===undefined){return this.$nodes&&this.$nodes[0]&&this.$nodes[0].getAttribute(d)||"";}else{for(var c=0,b=this.$nodes.length;c<b;c++){if(apf.b.$state){apf.b.$queue.push({action:"setAttribute",args:[this.$nodes[c],d,g]});}else{if(this.$local){this.$nodes[c].setAttribute(d,g);}else{apf.xmldb.setAttribute(this.$nodes[c],d,g);}}}}return this;};this.removeAttr=function(d){for(var c=0,b=this.$nodes.length;c<b;c++){if(apf.b.$state){apf.b.$queue.push({action:"removeAttribute",args:[this.$nodes[c],d]});}else{if(this.$local){this.$nodes[c].removeAttribute(d);}else{apf.xmldb.removeAttribute(this.$nodes[c],d);}}}return this;};this.xml=function(){var d=[];for(var c=0,b=this.$nodes.length;c<b;c++){d.push(this.$nodes[c].xml);}return d.join("\n");};this.get=this.index=function(b){if(b==undefined){return apf.getChildNumber(this.$nodes[0],this.$nodes[0].parentNode.getElementsByTagName("*"));}};this.eq=function(b){return b<0?this.$nodes[this.$nodes.length-b]:this.$nodes[b];};this.size=this.length=function(){return this.$nodes.length;};this.load=function(b){};this.next=function(b){if(!b){b="node()[local-name()]";}return new apf.xmlset(this.$xml,"((following-sibling::"+(this.$xpath=="."?"node()":this.$xpath)+")[1])[self::"+b.split("|").join("|self::")+"]",this.$local,this);};this.nextAll=function(b){if(!b){b="node()[local-name()]";}return new apf.xmlset(this.$xml,"(following-sibling::"+(this.$xpath=="."?"node()":this.$xpath)+")[self::"+b.split("|").join("|self::")+"]",this.$local,this);};this.nextUntil=function(){};this.prev=function(b){if(!b){b="node()[local-name()]";}return new apf.xmlset(this.$xml,"((preceding-sibling::"+(this.$xpath=="."?"node()":this.$xpath)+")[1])[self::"+b.split("|").join("|self::")+"]",this.$local,this);};this.prevAll=function(b){if(!b){b="node()[local-name()]";}return new apf.xmlset(this.$xml,"(preceding-sibling::"+(this.$xpath=="."?"node()":this.$xpath)+")[self::"+b.split("|").join("|self::")+"]",this.$local,this);};this.not=function(){};this.parent=function(b){return new apf.xmlset(this.$xml.parentNode,this.$local,this);};this.parents=function(b){};this.pushStack=function(){};this.replaceAll=function(){};this.replaceWith=function(d){for(var g,k,c=0,b=this.$nodes.length;c<b;c++){g=this.$nodes[c];k=typeof d=="function"?d(c,g):d;if(apf.b.$state){apf.b.$queue.push({action:"replaceNode",args:[k,g]});}else{if(this.$local){g.parentNode.replaceChild(k,g);}else{apf.xmldb.replaceNode(k,g);}}}return this;};this.siblings=function(b){};this.text=function(){};this.toArray=function(){var b=[];for(var d=0,c=this.$nodes.length;d<c;d++){b.push(this.$nodes[d]);}return b;};this.detach=function(b){var d=[];for(var k,g=0,c=this.$nodes.length;g<c;g++){k=this.$nodes[g];if(!k.selectSingleNode("self::node()["+b+"]")){continue;}if(apf.b.$state){apf.b.$queue.push({action:"removeNode",args:[k]});}else{if(this.$local){k.parentNode.removeChild(k);}else{apf.xmldb.removeNode(k);}}d.push(k);}return new apf.xmlset(d,"",this.$local,this);};this.remove=function(b){for(var d,g=this.$nodes,c=g.length-1;c>=0;c--){d=g[c];if(b&&!d.selectSingleNode("self::node()["+b+"]")){continue;}if(apf.b.$state){apf.b.$queue.push({action:"removeNode",args:[d]});}else{if(this.$local){d.parentNode.removeChild(d);}else{apf.xmldb.removeNode(d);}}}return this;};this.children=function(k){var b=[];for(var d,c,o=0,g=this.$nodes.length;o<g;o++){var q=(d=this.$nodes[o]).selectNodes(k);for(var m=0,n=q.length;m<n;m++){b.push(q[m]);}}return new apf.xmlset(b,null,this.$local,this);};this.children2=function(b){return new apf.xmlset(this.$xml,"("+this.$xpath+")/node()[self::"+b.split("|").join("|self::")+"]",this.$local,this);};this.has=this.find=function(b){return new apf.xmlset(this.$xml,"("+this.$xpath+")//"+b.split("|").join("|self::"),this.$local,this);};this.query=function(b){return new apf.xmlset(this.$xml,"("+this.$xpath+")/"+b.split("|").join("|("+this.$xpath+")/"),this.$local,this);};this.filter=function(g){var d=[];for(var c=0,b=this.$nodes.length;c<b;c++){if(this.$nodes[c].selectSingleNode("self::node()["+g+"]")){d.push(this.$nodes[c]);}}return new apf.xmlset(d,null,this.$local,this);};this.end=function(){return this.$previous||this;};this.is=function(b){return this.filter(b)?true:false;};this.contents=function(){return this.children("node()");};this.has=function(){};this.val=function(b){if(b!==undefined){apf.setQueryValue(this.$xml,this.$xpath,b);return this;}else{return apf.queryValue(this.$xml,this.$xpath);}};this.vals=function(){return apf.queryValues(this.$xml,this.$xpath);};this.node=function(){return apf.queryNode(this.$xml,this.$xpath);};this.nodes=function(){return apf.queryNodes(this.$xml,this.$xpath);};this.clone=function(c){if(this.$nodes.length==1){return new apf.xmlset(this.$nodes[0].cloneNode(true),"",this.$local,this);}var d=[];for(var g=0,b=this.$nodes.length;g<b;g++){d.push(this.$nodes[g].cloneNode(c==undefined?true:c));}return new apf.xmlset(d,"",this.$local,this);};this.context=function(){return this.$xml;};this.data=function(d){for(var c=0,b=this.$nodes.length;c<b;c++){apf.setQueryValue(this.$nodes[c],".",d);}return this;};this.each=function(d){for(var c=0,b=this.$nodes.length;c<b;c++){d.call(this.$nodes[c],c);}return this;};this.eachrev=function(c){for(var b=this.$nodes.length-1;b>=0;b--){c.call(this.$nodes[b],b);}return this;};this.map=function(g){var c=[];for(var d=0,b=this.$nodes.length;d<b;d++){c.push(g(this.$nodes[d]));}return new apf.xmlset(c,"",this.$local,this);};this.empty=function(){this.children().detach();return this;};this.first=function(){return new apf.xmlset(this.$xml,"("+this.$xpath+")[1]",this.$local,this);};this.last=function(){return new apf.xmlset(this.$xml,"("+this.$xpath+")[last()]",this.$local,this);};}).call(apf.xmlset.prototype);apf.xmlDiff=function(H,F){var N=true,ac={},w=[],b=[],al=[],B=H.ownerDocument.$domParser.preserveWhiteSpace,E=1,A=2,n=3,y=4,S={},C={},M={},P={},c={},ah={include:{}},G,Q,ad,k,u,Z,ab,Y,ae,af,am,R,L,g,m,I,an=[],T;(function x(ap,q,ar){var at,t,av,aq,aw,au,ao;q+="/"+ap.tagName;if(aq=(t=ap.childNodes).length){for(at=0;at<aq;at++){if((au=t[at]).nodeType==1){x(t[at],q,ar);t[at].$childNumber=at;}else{ao=q+"/"+au.nodeType,(ar[ao]||(ar[ao]=[])).push(au),au.$isValid=false;au.$childNumber=at;}}}if(aq=(av=ap.attributes).length){for(at=0;at<aq;at++){ao=q+"/@"+(aw=av[at]).nodeName,(ar[ao]||(ar[ao]=[])).push(aw),aw.$isValid=false;}}(ar[q]||(ar[q]=[])).push(ap);ap.$isValid=false;if(ap.$amlList){delete ap.$amlList;}})(H,"",ac);ah.include[H.parentNode.$uniqueId]=H;(function s(aq,aF,ap,q,aJ,aB){var aU,av,aw,aM,aQ,t,aL,aC,aE,aG,aS,aO,aA,ay,aR,at,aI,aN,ao,az,au,aD,aK=0,ax=[],aT={length:0},aP=aJ.include;aF+="/"+aq.tagName;if(!(ay=ap[aF])){(S[aF]||(S[aF]=[])).push({arr:null,node:aq,curNode:aJ});return false;}else{t=(aI={}).include={};for(aL=0,aG=ay.length;aL<aG;aL++){if((aQ=ay[aL])){t[aQ.$uniqueId]=aQ;}}t.length=aG;}if(aG=(aC=aq.childNodes).length){for(aL=0;aL<aG;aL++){if((aO=aC[aL]).nodeType==1){s(aO,aF,ap,q,aI,aL);}else{if((aR=ap[aA=aF+"/"+aO.nodeType])){for(aU=0,av=null,aw=aO.nodeValue,aH=0,aM=aR.length;aH<aM;aH++){if((at=aR[aH])&&at.nodeValue==aw){if(!av){av={node:aO,index:aH,arr:aR,curNode:aI,pcur:[at.parentNode.$uniqueId],found:[aH],childNumber:aL};}else{av.found.push(aH),av.pcur.push(at.parentNode.$uniqueId);}aU++;}}if(aU){aN=av.pcur,ao=aN.length;for(aH=0;aH<ao;aH++){if(aI[aN[aH]]){aI[aN[aH]]+=(1/aU);}else{aI[aN[aH]]=(1/aU);}}(P[aA]||(P[aA]=[])).push(av);continue;}(S[aA]||(S[aA]=[])).push({arr:aR,node:aO,curNode:aI});continue;}(S[aA]||(S[aA]=[])).push({isNew:true,arr:null,node:aO,curNode:aI});}}}if(aG=(aE=aq.attributes).length){for(aL=0;aL<aG;aL++){pattr=aF+"/@"+(aS=aE[aL]).nodeName;if(aR=ap[pattr]){for(aU=0,av=null,aw=aS.nodeValue,aH=0,aM=aR.length;aH<aM;aH++){if((at=aR[aH])&&at.nodeValue==aw){if(!av){av={node:aS,index:aH,arr:aR,curNode:aI,pcur:[at.ownerElement.$uniqueId],found:[aH]};}else{av.found.push(aH),av.pcur.push(at.ownerElement.$uniqueId);}aU++;}}if(aU){aN=av.pcur,ao=aN.length;for(aH=0;aH<ao;aH++){if(aI[aN[aH]]){aI[aN[aH]]+=(1/aU);}else{aI[aN[aH]]=(1/aU);}}(c[pattr]||(c[pattr]=[])).push(av);continue;}(C[pattr]||(C[pattr]=[])).push({arr:aR,node:aS,curNode:aI});continue;}(C[pattr]||(C[pattr]=[])).push({isNew:true,arr:null,node:aS,curNode:aI});}}for(az in aI){if(aI[az]>aK){aK=aI[az];au=1;}else{if(aI[az]==aK){au++;}}}if(!aK){au=ay.length;for(aL=au;aL>=0;aL--){if(!ay[aL]){continue;}q=(aD=ay[aL]).parentNode;if(aD.$isValid||!t[aD.$uniqueId]||!aP[q.$uniqueId]){delete t[aD.$uniqueId],au--;continue;}if(!aT[q.$uniqueId]){aT[q.$uniqueId]=q,aT.length++;}ax.push(aD);}}else{for(az in aI){if(aI[az]!=aK){continue;}q=(aD=apf.all[az]).parentNode;if(aD.$isValid||!t[aD.$uniqueId]||!aP[q.$uniqueId]){delete t[aD.$uniqueId];au--;continue;}if(!aT[q.$uniqueId]){aT[q.$uniqueId]=q,aT.length++;}ax.push(aD);}}if(ax.length){aJ.include=aT;}for(av=null,aL=0,aG=ax.length;aL<aG;aL++){q=(aQ=ax[aL]).parentNode;if(aJ[q.$uniqueId]){aJ[q.$uniqueId]+=1/au;}else{aJ[q.$uniqueId]=1/au;}if(au>1){if(!av){av={node:aq,arr:ay,curNode:aI,curParentNode:aJ,found:ax,childNumber:aB};(M[aF]||(M[aF]=[])).push(av);}if(au>(aQ.$matchedNodes||0)){aQ.$matchedNodes=au;}}else{aQ.$isValid=true;for(var aH=ay.length-1;aH>=0;aH--){if(ay[aH]==aQ){delete ay[aH];break;}}}}if(!ax.length){var ax=[];for(var ar in aI.include){if(ar=="length"){continue;}ax.push(aI.include[ar]);}(M[aF]||(M[aF]=[])).push({arr:ay,node:aq,curParentNode:aJ,curNode:aI,found:ax,childNumber:aB});}aI.curNode=ax[0],aI.parent=aJ,aI.curPath=aF;})(F,"",ac,H,ah);function V(t,q){if(t.$childNumber!=q.childNumber){al.push([t,q.childNumber]);}}function O(aA){var ay=M[aA];if(!ay){return;}var aB,aC,aq,ax,aD,au,av,aw,t,at,az;for(av=0,at=ay.length;av<at;av++){aw=(aB=ay[av]).found,t=100000;for(ax=au=0,aq=aw.length;au<aq;au++){if((aC=aw[au]).$isValid){continue;}aD=aC.$matchedNodes;if(aD<t){t=aD,ax=1;}else{if(aD==t){ax++;}}}if(ax==1){for(au=0,aq=aw.length;au<aq;au++){if(!(aC=aw[au]).$isValid&&aC.$matchedNodes==t){aC.$isValid=true,aB.curNode.curNode=aC;V(aC,aB);break;}}}else{if(ax){var ap=aB.curParentNode.include;if(ap.length==1){az=aB.curParentNode.curNode;for(au=0,aq=aw.length;au<aq;au++){if(!(aC=aw[au]).$isValid&&aC.$matchedNodes==t&&aC.parentNode==az){aC.$isValid=true,aB.curNode.curNode=aC;V(aC,aB);break;}}continue;}O(aB.curParentNode.curPath);az=aB.curParentNode.curNode;for(au=0,aq=aw.length;au<aq;au++){if(!(aC=aw[au]).$isValid&&aC.$matchedNodes==t&&aC.parentNode==az){aC.$isValid=true,aB.curNode.curNode=aC;V(aC,aB);break;}}}else{var ao=ac[aA],q=false;for(var ar=0;ar<ao.length;ar++){if(ao[ar]&&!ao[ar].$isValid){ao[ar].$isValid=true;aB.curNode.curNode=ao[ar];V(ao[ar],aB);q=true;break;}}if(!q){aB.curNode.isAdding=true;if(!aB.curParentNode.isAdding){(S[aA]||(S[aA]=[])).push({isNew:true,arr:null,node:aB.node,curNode:aB.curParentNode});}}}}}delete M[aA];}for(Z in M){O(Z);}for(Z in P){G=P[Z],ad=G.length,Q=G[0].arr;var X=[];for(af=0;af<ad;af++){Y=G[af],g=Y.found;if((ab=Y.curNode)&&(ab=ab.curNode)){if(Q[Y.index]&&ab==Q[Y.index].parentNode){V(Q[Y.index],Y);delete Q[Y.index];}else{for(u=false,ae=0;ae<g.length;ae++){if(Q[g[ae]]&&Q[g[ae]].parentNode==ab){V(Q[g[ae]],Y);delete Q[g[ae]],u=true;break;}}if(!u&&!Y.curNode.isAdding){(S[Z]||(S[Z]=[])).push(Y);}}}else{if(!Y.curNode.isAdding){(S[Z]||(S[Z]=[])).push(Y);}}}}for(Z in c){G=c[Z],ad=G.length,Q=G[0].arr;for(af=0;af<ad;af++){Y=G[af],g=Y.found;if((ab=Y.curNode)&&(ab=ab.curNode)){if(Q[Y.index]&&ab==Q[Y.index].ownerElement){delete Q[Y.index];}else{for(u=false,ae=0;ae<g.length;ae++){if(Q[g[ae]]&&Q[g[ae]].ownerElement==ab){delete Q[g[ae]],u=true;break;}}if(!u&&!Y.curNode.isAdding){(C[Z]||(C[Z]=[])).push(Y);}}}else{if(!Y.curNode.isAdding){(C[Z]||(C[Z]=[])).push(Y);}}}}for(Z in C){G=C[Z],ad=G.length,Q=G[0].arr||an,k=Q.length;for(af=0;af<ad;af++){am=G[af];if((ab=Y.curNode)&&ab.isAdding){continue;}if((ab=am.curNode)&&(ab=ab.curNode)){if(am.node.nodeName=="id"){ab.setAttribute("id",am.node.nodeValue);}else{w.push([y,ab,am.node]);}for(ae=0;ae<k;ae++){if(Q[ae]&&Q[ae].ownerElement==ab){delete Q[ae];break;}}}else{}}}for(Z in S){G=S[Z],ad=G.length,Q=G[0].arr||an,k=Q.length;for(af=0;af<ad;af++){Y=G[af];if((ab=Y.curNode)&&ab.isAdding){continue;}if(ab=ab.curNode){b.push(m=[E,ab,Y.node]);for(ae=0;ae<k;ae++){if(Q[ae]&&Q[ae].parentNode==ab){if(Y.node.nodeType!=1){m[0]=A;m[1]=Q[ae];}else{b.length--;}delete Q[ae];break;}}}else{}}}for(I in ac){R=ac[I];for(af=0,ad=R.length;af<ad;af++){L=R[af];if(L&&!L.$isValid&&(L.parentNode||L.ownerElement).$isValid){w.push([n,L]);}}}var o=new Date().getTime();var aa={},r=H.ownerDocument;for(af=0,ad=b.length;af<ad;af++){switch((R=b[af])[0]){case A:R[1].$setValue(R[2].nodeValue);if(R[1].nodeType!=2){var aj=apf.getChildNumber(R[1]),ai=apf.getChildNumber(R[2]);if(aj!=ai){R[1].parentNode.insertBefore(R[1],R[1].parentNode.childNodes[ai]);}}break;case E:if(!R[1].canHaveChildren){R[1].$aml=R[2].parentNode;if(R[1].$redraw){R[1].$redraw();}continue;}if(R[1].render!="runtime"){var J=R[1].parentNode;while(J&&J.nodeType==1&&!J.getAttribute("render")){J=J.parentNode;}if(J&&J.render){if(J.$amlList){J.$amlList.push(R);}else{J.$amlList=[R];J.addEventListener("beforerender",function(ar){var t=this.$amlList;this.$amlList=null;for(var aq,ap=0,q=t.length;ap<q;ap++){aq=t[ap];var ao=apf.getChildNumber(T=aq[2]);aq[1].insertBefore(r.importNode(T,true),aq[1].childNodes[ao]);}this.$rendered=true;this.removeEventListener("beforerender",arguments.callee);return false;});J.$rendered=false;}}else{(R[1].$amlList||(R[1].$amlList=[]))[apf.getChildNumber(R[2])]=R;aa[R[1].$uniqueId]=R[1];}}else{R[1].$aml=R[2].parentNode;R[1].$rendered=false;}break;}}var K,D;for(var W in aa){K=aa[W].$amlList;for(var R,af=0;af<K.length;af++){R=K[af];if(!R){continue;}D=r.importNode(R[2],true);if(D){R[1].insertBefore(D,R[1].childNodes[af]);}}}for(af=0,ad=w.length;af<ad;af++){switch((R=w[af])[0]){case n:if((T=R[1]).destroy){T.destroy(true,true);}else{if(T.parentNode){T.parentNode.removeChild(T);}else{T.ownerElement.removeAttributeNode(T);}}break;case y:R[1].setAttribute((R=R[2]).nodeName,R.nodeValue);break;}}for(var T,ak,d,ag,U,af=0;af<al.length;af++){T=al[af][0];ag=T.$childNumber;U=al[af][1];ak=T.parentNode;d=ak.childNodes[U+(ag<U?1:0)];if(T.nextSibling!=d&&T!=d){ak.insertBefore(T,d);}}apf.queue.empty();};apf.zmanager=function(){var b={"default":{level:10},plane:{level:1000000},popup:{level:2000000},notifier:{level:3000000},drag:{level:4000000},print:{level:10000000}};this.set=function(d,c,g){c.style.zIndex=b[d].level++;if(g){if(g.$storedZ==undefined){g.$storedZ=g.style.zIndex;}g.style.zIndex=b[d].level++;}};this.clear=function(c,d){if(d.$storedZ==c.style.zIndex+1){d.style.zIndex=d.$storedZ;d.$storedZ=undefined;}};};apf.config=new apf.Class().$init();apf.extend(apf.config,{disableRightClick:false,allowSelect:false,allowBlur:true,autoDisableActions:true,autoDisable:false,disableF5:true,autoHideLoading:true,disableSpace:true,defaultPage:"home",disableBackspace:true,undokeys:false,outline:false,dragOutline:false,resizeOutline:false,autoDisableNavKeys:true,disableTabbing:false,resourcePath:null,initdelay:true,liveText:false,skinset:"default",name:apf.isO3?"o3App":self.window&&window.location.href.replace(/[^0-9A-Za-z_]/g,"_"),tags:{},defaults:{},baseurl:"",model:"@default","empty-message":"No items","loading-message":"Loading...","offline-message":"You are currently offline.",setDefaults:function(){if(apf.isParsingPartial){this.disableRightClick=false;this.allowSelect=true;this.autoDisableActions=true;this.autoDisable=false;this.disableF5=false;this.autoHideLoading=true;this.disableSpace=false;this.disableBackspace=false;this.undokeys=false;this.disableTabbing=true;this.allowBlur=true;}},getDefault:function(c,k){var g=this.defaults[c];if(!g){return;}for(var b=g.length-1;b>=0;b--){if(g[b][0]==k){return g[b][1];}}},$handlePropSet:function(b,c){this[b.replace(/-(\w)/g,function(d,g){return g.toUpperCase();})]=this[b]=c;(this.$propHandlers&&this.$propHandlers[b]||apf.GuiElement.propHandlers[b]||apf.K).call(this,c);},$inheritProperties:{},$propHandlers:{baseurl:function(b){this.baseurl=apf.parseExpression(b);},language:function(b){},"resource-path":function(b){this.resourcePath=apf.parseExpression(b||"").replace(/resources\/?|\/$/g,"");},skinset:function(b){if(this.$amlLoaded){apf.skins.changeSkinset(b);}},outline:function(b){this.dragOutline=this.resizeOutline=this.outline=apf.isTrue(b);},"drag-outline":function(b){this.dragOutline=b?apf.isTrue(b):false;},"resize-outline":function(b){this.resizeOutline=b?!apf.isFalse(b):false;},debug:function(b){apf.debug=b;}}});apf.offline={onLine:true};apf.saveData=apf.getData=function(c,u){if(!c){return false;}var w,o=c.charAt(0),t=u.callback;var n=function(y,x,m){var A=u.callback;if(x!=apf.SUCCESS){return A(y,x,m||{});}return A(y,x,m||{});};if(!u){u={};}var k=u.fParsed||(c.indexOf("{")>-1||c.indexOf("[")>-1?apf.lm.compile(c,{withopt:true,precall:u.precall,alwayscb:true,simplexpath:true}):{str:c,type:2});if(u.precall&&!u._pc){u.asyncs=k.asyncs;u._pc=1;}if(k.type==3){if(k.xpaths[0]){var r=k.xpaths[0],s=k.xpaths[1];if(r=="#"||s=="#"){var g=(apf.lm.compile(c,{xpathmode:5}))();if(typeof g!="string"){r=g.model&&g.model.$isModel&&g.model;if(r){s=g.xpath;}else{if(g.model){r=apf.xmldb.findModel(g.model);s=apf.xmlToXpath(g.model,r.data)+(g.xpath?"/"+g.xpath:"");}else{return;}}}else{r=null;}}else{r=apf.nameserver.get("model",r);}return n(r.data.selectSingleNode(s),apf.SUCCESS,{});}else{return n(u.xmlNode.data.selectSingleNode(k.xpaths[1]),apf.SUCCESS,{});}}if(o=="<"){if(k.type==2){w=k.str;}else{return k(u.xmlNode,n,u);}}else{if((o=="["||o=="{")){return k(u.xmlNode,n,u);}else{if(k.type==1||k.type==3){var q=t;t=u.callback=function(A,y,m){if(u._pc===true){return;}if(y!=apf.SUCCESS){return q.apply(this,arguments);}var x=A.split(" "),B="get";if(x.length>1&&x[0].length<10){B=x.shift();x=x.join(" ");}else{x=A;}t=u.callback=q;apf.oHttp.exec(B,[x],n,u);};k(u.xmlNode,n,u);}else{if(u._pc===true){return;}var d=c.split(" "),b="get";if(d.length>1&&d[0].length<10){b=d.shift();d=d.join(" ");}else{d=c;}apf.oHttp.exec(b,[d.replace(/\\/g,"")],n,u);}}}if(w){if(t){n(w,apf.SUCCESS,{});}else{return w;}}};apf.setModel=function(b,g){if(!b){return;}var d=b.indexOf("{")>-1||b.indexOf("[")>-1?apf.lm.compile(b,{alwayscb:true}):{type:2,str:b};if(b=="@default"||d.type==2){var c=apf.nameserver.get("model",b);if(c){return c.register(g);}else{if(b=="@default"){return;}}if(b.indexOf(".")==-1&&b.indexOf("/")==-1){return;}}if(d.type==3){if(d.models){if(d.xpaths.length==2&&d.xpaths[0]!="#"&&d.xpaths[1]!="#"){apf.nameserver.get("model",d.xpaths[0]).register(g,d.xpaths[1]);return;}}}if(g.clear){g.clear("loading");}apf.getData(b,{parsed:d,xmlNode:g&&g.xmlRoot,callback:function(o,n,k){if(n!=apf.SUCCESS){throw new Error(apf.formatErrorString(0,null,"Loading new data","Could not load data into model.                 \nMessage: "+k.message+"                \nInstruction: '"+b+"'"));}if(!o){return g.clear&&g.clear();}if(typeof o=="string"){if(o.charAt(0)=="<"){o=apf.getXml(o);}else{if(o.indexOf("http://")==0){return apf.setModel(o,g);}else{throw new Error("Invalid data from server");}}}if(o.nodeFunc){o.register(g);return;}var m=apf.xmldb.findModel(o);if(m){m.register(g,apf.xmlToXpath(o,m.data));}else{new apf.model().register(g).load(o);}}});};apf.date=(function(){return{masks:{"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},i18n:{beginWeekday:1,dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNumbers:{Sun:0,Mon:1,Tue:2,Wed:3,Thu:4,Fri:5,Sat:6,Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}},span:function(k){if(k<0){return;}var g=parseInt(k),d=Math.floor(g/60),b=Math.floor(d/60),c=parseInt(Math.floor(b/24));this.seconds=g%60;this.minutes=d%60;this.hours=b%24;this.days=c;},dateToDays:function(b,d,c){var k=c+"";var g=parseInt(k.substr(0,2));c=parseInt(k.substr(2,2),10);if(d>2){d-=3;}else{d+=9;if(c){c--;}else{c=99;g--;}}return(Math.floor((146097*g)/4)+Math.floor((1461*c)/4)+Math.floor((153*d+2)/5)+b+1721119);},daysToDate:function(k){k-=1721119;var g=Math.floor((4*k-1)/146097);k=Math.floor(4*k-1-146097*g);var b=Math.floor(k/4);var c=Math.floor((4*b+3)/1461);b=Math.floor(4*b+3-1461*c);b=Math.floor((b+4)/4);var d=Math.floor((5*b-3)/153);b=Math.floor(5*b-3-153*d);b=Math.floor((b+5)/5);if(d<10){d+=3;}else{d-=9;if(c++==99){c=0;g++;}}return{day:b+"",month:d+"",year:(g+"").pad(2,"0")+(c+"").pad(2,"0")};},nextDay:function(b,g,d){var c=new Date();return this.daysToDate(this.dateToDays(b||c.getDate(),g||c.getMonth(),d||c.getFullYear())+1);},prevDay:function(b,g,d){var c=new Date();return this.daysToDate(this.dateToDays(b||c.getDate(),g||c.getMonth(),d||c.getFullYear())-1);},isLeapYear:function(b){if(typeof b!="number"){return false;}if(b<1582){return(b%4==0);}else{return((b%4==0)&&(b%100!=0))||(b%400==0);}},julianDate:function(b,k,g){var d=new Date();if(!k){k=d.getMonth();}var m=[0,31,59,90,120,151,181,212,243,273,304,334],c=(m[k-1]+b||d.getDate());if(k>2&&this.isLeapYear(g||d.getFullYear())){c++;}return c;},compare:function(g,d){var c=this.dateToDays(g.getUTCDate(),g.getUTCMonth(),g.getUTCYear()),b=this.dateToDays(d.getUTCDate(),d.getUTCMonth(),d.getUTCYear());if(c<b){return -1;}if(c>b){return 1;}if(g.getUTCHour()<d.getUTCHour()){return -1;}if(g.getUTCHour()>d.getUTCHour()){return 1;}if(g.getUTCMinutes()<d.getUTCMinutes()){return -1;}if(g.getUTCMinutes()>d.getUTCMinutes()){return 1;}if(g.getUTCSeconds()<d.getUTCSeconds()){return -1;}if(g.getUTCSeconds()>d.getUTCSeconds()){return 1;}return 0;},gregorianToISO:function(r,n,q){var m=[0,31,59,90,120,151,181,212,243,273,304,334],b=this.isLeapYear(q),t=this.isLeapYear(q-1),d=r+m[n-1];if(b&&n>2){d++;}var o=(q-1)%100,g=1+parseInt(((((((q-1)-o)/100)%4)*5)+(o+parseInt(o/4)))%7),k=1+parseInt(((d+(g-1))-1)%7),c,s;if(d<=(8-g)&&g>4){c=q-1;s=(g==5||(g==6&&t))?53:52;}else{c=q;}if(c==q){if(((b?366:365)-d)<(4-k)){c++;s=1;}}if(c==q){s=parseInt((d+(7-k)+(g-1))/7);if(g>4){s--;}}if(s<10){s="0"+s;}return c+"-"+s+"-"+k;},weekOfYear:function(b,g,d){var c=new Date();return parseInt(this.gregorianToISO(b||c.getDate(),g||c.getMonth(),d||c.getFullYear()).split("-")[1]);},quarterOfYear:function(c){var b=new Date();return parseInt((c||b.getMonth()-1)/3+1);},daysInMonth:function(d,c){var b=new Date();if(!c){c=b.getFullYear();}if(!d){d=b.getMonth();}if(c==1582&&d==10){return 21;}if(d==2){return this.isLeapYear(c)?29:28;}else{if(d==4||d==6||d==9||d==11){return 30;}else{return 31;}}},dayOfWeek:function(b,g,d){var c=new Date();if(!d){d=c.getFullYear();}if(!g){g=c.getMonth();}if(!b){b=c.getDate();}return new Date(d,g,b).getDay();},beginOfWeek:function(g,o,m,n){var k=new Date();if(!m){m=k.getFullYear();}if(!o){o=k.getMonth();}if(!g){g=k.getDate();}var b=this.dayOfWeek(g,o,m);var c=(7-this.i18n.beginWeekday+b)%7;var q=this.dateToDays(g,o,m)-c;return n?q:this.daysToDate(q);},weeksInMonth:function(n,k){var c=new Date();if(!k){k=c.getFullYear();}if(!n){n=c.getMonth();}var g=this.dayOfWeek(1,n,k),b=this.i18n.beginWeekday,d,m;if(b==1&&g==0){d=7-g+b;m=1;}else{if(b==0&&g==6){d=7-g+b;m=1;}else{d=b-g;m=0;}}d%=7;return Math.ceil((this.daysInMonth(n,k)-d)/7)+m;},getCalendarWeek:function(d,n,m){var g=new Date(),c=[];var b=this.beginOfWeek(d||g.getDate(),n||g.getMonth(),m||g.getFullYear(),true);for(var k=0;k<=6;k++){c[k]=this.daysToDate(b);b++;}return c;},getCalendarMonth:function(o,g){var d=new Date(),k=[];if(!g){g=d.getFullYear();}if(!o){o=d.getMonth();}var b=(this.i18n.beginWeekday==1)?(this.dayOfWeek(1,o,g)==0)?this.dateToDays(1,o,g)-6:this.dateToDays(1,o,g)-this.dayOfWeek(1,o,g)+1:(this.dateToDays(1,o,g)-this.dayOfWeek(1,o,g));var c=this.weeksInMonth(o,g);for(var m=0;m<c;m++){k[m]=[];for(var n=0;n<=6;n++){k[m][n]=this.daysToDate(b);b++;}}return k;},getCalendarYear:function(c){if(!c){c=new Date().getFullYear();}var b=[];for(var d=0;d<=11;d++){b[d]=this.getCalendarMonth(d+1,c);}return b;}};})();apf.date.dateFormat=(function(){var b=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,c=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,g=/[^-+\dA-Z]/g,d=function(m,k){m=String(m);k=k||2;while(m.length<k){m="0"+m;}return m;};return function(t,I,C){var q=apf.date;if(arguments.length==1&&(typeof t=="string"||t instanceof String)&&!/\d/.test(t)){I=t;t=undefined;}t=t?new Date(t):new Date();if(isNaN(t)){return"NaN";}I=String(q.masks[I]||I||q.masks["default"]);if(I.slice(0,4)=="UTC:"){I=I.slice(4);C=true;}var F=C?"getUTC":"get",x=t[F+"Date"](),k=t[F+"Day"](),u=t[F+"Month"](),B=t[F+"FullYear"](),E=t[F+"Hours"](),w=t[F+"Minutes"](),G=t[F+"Seconds"](),A=t[F+"Milliseconds"](),n=C?0:t.getTimezoneOffset(),r={d:x,dd:d(x),ddd:q.i18n.dayNames[k],dddd:q.i18n.dayNames[k+7],m:u+1,mm:d(u+1),mmm:q.i18n.monthNames[u],mmmm:q.i18n.monthNames[u+12],yy:String(B).slice(2),yyyy:B,h:E%12||12,hh:d(E%12||12),H:E,HH:d(E),M:w,MM:d(w),s:G,ss:d(G),l:d(A,3),L:d(A>99?Math.round(A/10):A),t:E<12?"a":"p",tt:E<12?"am":"pm",T:E<12?"A":"P",TT:E<12?"AM":"PM",Z:C?"UTC":(String(t).match(c)||[""]).pop().replace(g,""),o:(n>0?"-":"+")+d(Math.floor(Math.abs(n)/60)*100+Math.abs(n)%60,4),S:["th","st","nd","rd"][x%10>3?0:(x%100-x%10!=10)*x%10]};return I.replace(b,function(m){return m in r?r[m]:m.slice(1,m.length-1);});};})();apf.date.getDateTime=function(q,w){var c=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,n=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC:)(?:[-+]\d{4})?)\b/g,k=0,u=new Date().getFullYear(),b=1,r=1,g=12,o=0,A=0,x=apf.date.i18n;if(!w){throw new Error(apf.formatErrorString(0,null,"date-format","Date format is null"));}w=w.replace(n,"");var t=w.replace(c,function(C,B,y){var d=q.substring(y+k,y+k+C.length);switch(C){case"d":case"m":case"h":case"H":case"M":case"s":if(!/[\/, :\-](d|m|h|H|M|s)$|^(d|m|h|H|M|s)[\/, :\-]|[\/, :\-](d|m|h|H|M|s)[\/, :\-]/.test(w)){throw new Error(apf.formatErrorString(0,null,"date-format","Dates without leading zero needs separators"));}var s=parseInt(q.substring(y+k,y+k+2));if(s.toString().length==2){k++;}return C=="d"?r=s:(C=="m"?b=s:(C=="M"?o=s:(C=="s"?A=s:g=s)));case"dd":return r=d;case"dddd":k+=x.dayNames[x.dayNumbers[d.substring(0,3)]+7].length-4;break;case"mm":return b=d;case"mmm":return b=x.monthNumbers[d]+1;case"mmmm":var m=x.monthNumbers[d.substring(0,3)];k+=x.monthNames[m+12].length-4;return b=m+1;case"yy":return u=parseInt(d)<70?"20"+d:d;case"yyyy":return u=d;case"hh":return g=d;case"HH":return g=d;case"MM":return o=d;case"ss":return A=d;case"T":case"Z":k-=2;break;}});return new Date(u,b-1,r,g,o,A);};Date.prototype.format=function(b,c){return apf.date.dateFormat(this,b,c);};Date.prototype.copy=function(){return new Date(this.getTime());};Date.prototype.inDaylightTime=function(){var d=0,c=new Date(this.getFullYear(),0,1,0,0,0,0),n=new Date(this.getFullYear(),6,1,0,0,0,0),o=c.toUTCString(),q=new Date(o.slice(0,o.lastIndexOf(" ")-1));o=n.toUTCString();var m=new Date(o.slice(0,o.lastIndexOf(" ")-1));var k=(c-q)/(1000*60*60),g=(n-m)/(1000*60*60);if(k===g){d=0;}else{var b=k-g;if(b>=0){k=g;}d=1;}return d;};Date.prototype.addSeconds=function(b){b=parseInt(b);if(b<0){return this.subtractSeconds(Math.abs(b));}return this.addSpan(new apf.date.span(b));};Date.prototype.addSpan=function(b){if(!(b instanceof apf.date.span)){return this;}var g;this.setSeconds(this.getSeconds()+b.seconds);if(this.getSeconds()>=60){this.setMinutes(this.getMinutes()+1);this.setSeconds(this.getSeconds()-60);}this.setMinutes(this.getMinutes()+b.minutes);if(this.getMinutes()>=60){this.setHours(this.getHours()+1);if(this.getHours()>=24){g=apf.date.nextDay(this.getDate(),this.getMonth(),this.getFullYear());this.setFullYear(parseInt(g.year),parseInt(g.month),parseInt(g.day));this.setHours(this.getHours()-24);}this.setMinutes(this.getMinutes()-60);}this.setHours(this.getHours()+b.hours);if(this.getHours()>=24){g=apf.date.nextDay(this.getDate(),this.getMonth(),this.getFullYear());this.setFullYear(parseInt(g.year),parseInt(g.month),parseInt(g.day));this.setHours(this.getHours()-24);}g=apf.date.dateToDays(this.getDate(),this.getMonth(),this.getFullYear());g+=b.days;var c=apf.date.daysToDate(g);this.setFullYear(parseInt(c.year),parseInt(c.month),parseInt(c.day));return this;};Date.prototype.subtractSeconds=function(b){b=parseInt(b);if(b<0){return this.addSeconds(Math.abs(b));}return this.subtractSpan(new apf.date.span(b));};Date.prototype.subtractSpan=function(b){if(!(b instanceof apf.date.span)){return this;}var g;this.setSeconds(this.getSeconds()-b.seconds);if(this.getSeconds()<0){this.setMinutes(this.getMinutes()-1);this.setSeconds(this.getSeconds()+60);}this.setMinutes(this.getMinutes()-b.minutes);if(this.getMinutes()<0){this.setHours(this.getHours()-1);if(this.getHours()<0){g=apf.date.prevDay(this.getDate(),this.getMonth(),this.getFullYear());this.setFullYear(parseInt(g.year),parseInt(g.month),parseInt(g.day));this.setHours(this.getHours()+24);}this.setMinutes(this.getMinutes()+60);}this.setHours(this.getHours()-b.hours);if(this.getHours()<0){g=apf.date.prevDay(this.getDate(),this.getMonth(),this.getFullYear());this.setFullYear(parseInt(g.year),parseInt(g.month),parseInt(g.day));this.setHours(this.getHours()+24);}g=apf.date.dateToDays(this.getDate(),this.getMonth(),this.getFullYear());g-=b.days;var c=apf.date.daysToDate(g);this.setFullYear(parseInt(c.year),parseInt(c.month),parseInt(c.day));return this;};Date.prototype.before=function(b){return(apf.date.compare(this,b)==-1);};Date.prototype.after=function(b){return(apf.date.compare(this,b)==1);};Date.prototype.equals=function(b){return(apf.date.compare(this,b)===0);};Date.prototype.isFuture=function(){return this.after(new Date());};Date.prototype.isPast=function(){return this.before(new Date());};Date.prototype.isLeapYear=function(){return apf.date.isLeapYear(this.getFullYear());};Date.prototype.getJulianDate=function(){return apf.date.julianDate(this.getDate(),this.getMonth(),this.getFullYear());};Date.prototype.getWeekOfYear=function(){return apf.date.weekOfYear(this.getDate(),this.getMonth(),this.getFullYear());};Date.prototype.getQuarterOfYear=function(){return apf.date.quarterOfYear(this.getMonth());};Date.prototype.getDaysInMonth=function(){return apf.date.daysInMonth(this.getMonth(),this.getFullYear());};Date.prototype.getWeeksInMonth=function(){return apf.date.weeksInMonth(this.getMonth(),this.getFullYear());};Date.prototype.getNextDay=Date.prototype.getNextWeekday=function(){var b=apf.date.nextDay(this.getDate(),this.getMonth(),this.getFullYear());return this.copy().setFullYear(b.year,b.month,b.day);};Date.prototype.getPrevDay=Date.prototype.getPrevWeekday=function(){var b=apf.date.prevDay(this.getDate(),this.getMonth(),this.getFullYear());return this.copy().setFullYear(b.year,b.month,b.day);};Date.prototype.getCalendarWeek=function(){return apf.date.getCalendarWeek(this.getDate(),this.getMonth(),this.getFullYear());};Date.prototype.getCalendarMonth=function(){return apf.date.getCalendarMonth(this.getMonth(),this.getFullYear());};Date.prototype.getCalendarYear=function(){return apf.date.getCalendarYear(this.getFullYear());};Date.prototype.fromISO8601=function(g){var c=g.match(/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/),b=null;if(c){c.shift();if(c[1]){c[1]--;}if(c[6]){c[6]*=1000;}b=new Date(c[0]||1970,c[1]||0,c[2]||1,c[3]||0,c[4]||0,c[5]||0,c[6]||0);if(c[0]<100){b.setFullYear(c[0]||1970);}var k=0,d=c[7]&&c[7].charAt(0);if(d!="Z"){k=((c[8]||0)*60)+(Number(c[9])||0);if(d!="-"){k*=-1;}}if(d){k-=b.getTimezoneOffset();}if(k){b.setTime(b.getTime()+k*60000);}}else{return new Date(g);}return b;};Date.prototype.getUTCTime=function(){return Date.UTC(this.getUTCFullYear(),this.getUTCMonth(),this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds(),this.getUTCMilliseconds());};Date.prototype.toISO8601=function(){var b=function(d,g){var k="";while(k.length<g-1&&d<Math.pow(10,g-k.length-1)){k+="0";}return k+d.toString();};var c=this.getTimezoneOffset();return b(this.getFullYear(),4)+"-"+b(this.getMonth()+1,2)+"-"+b(this.getDate(),2)+"T"+b(this.getHours(),2)+":"+b(this.getMinutes(),2)+":"+b(this.getUTCSeconds(),2)+(c>0?"-":"+")+b(Math.floor(Math.abs(c)/60),2)+":"+b(Math.abs(c)%60,2);};apf.htmlCleaner=(function(){var g=null,c=null,d={table:1,TABLE:1},b={br:1,img:1,input:1,hr:1};return{prepare:function(q,n){if(!g){g=[/<(\/?)strong>|<strong( [^>]+)>/gi,/<(\/?)em>|<em( [^>]+)>/gi,/&apos;/g,/(<(\/?)(span|strong|em|u|i|b|a|strike|sup|sub|font|img)(?:\s+[\s\S]*?)?>)|(<br[\s\S]*?>)|(<(\/?)([\w\-]+)(?:\s+[\s\S]*?)?>)|([^<>]*)/gi,/(<a[^>]*href=)([^\s^>]+)*([^>]*>)/gi,/<p><\/p>/gi,/<a( )([^>]+)\/>|<a\/>/gi];}if(apf.isGecko){q=q.replace(g[0],"<$1b$2>").replace(g[1],"<$1i$2>");}else{if(apf.isIE){q=q.replace(g[2],"&#39;").replace(g[4],"$1$2 _apf_href=$2$3");var t=[],u=false,k=[],o=[],r=[],m=false;q.replace(g[3],function(y,E,G,I,H,B,s,C,D){if(E){var x=k.push(E);I=I.toLowerCase();if(!b[I]){if(G){if(!o[o.length-1]||o[o.length-1][0]!=I){k.length--;}else{o.length--;}}else{o.push([I,x]);}}u=true;}else{if(D){k.push(D);u=true;}else{if(H){if(u){if(o.length){k.push(H);}else{t.push("<p>",k.join(""),"</p>");k=[];}if(!o.length){u=false;}}else{if((r.length||m)&&H.indexOf("_apf_marker")>-1){}else{t.push("<p>&nbsp;</p>");}}}else{if(B){if(s){if(r[r.length-1]!=C.toLowerCase()){return;}else{r.length--;}if(k.length){t.push(k.join(""));k=[];}m=2;}else{var A=k.length&&k.join("").trim();var F=A?k:t;if(!d[C]){if(F[F.length-1]=="<p>&nbsp;</p>"){F[F.length-1]="";}else{if(A&&!r.length){F.push("<p></p>");}}}if(k.length){if(!A||r.length){t.push(k.join(""));k=[];}else{t.push("<p>",k.join(""),"</p>");k=[];}}r.push(C.toLowerCase());}t.push(B);u=false;}}}}m=m==2?1:false;});var w;if((w=k.join("")).trim()){t.push(n?w:"<p>"+w+"</p>");}q=t.join("");}}q=(apf.xmlentities?apf.xmlentities(q):q).replace(g[6],"<a$1$2></a>");return q;},parse:function(o,m,q){if(!c){c=[/<br[^>]*><\/li>/gi,/<br[^>]*_apf_placeholder="1"\/?>/gi,/<(a|span|div|h1|h2|h3|h4|h5|h6|pre|address)>[\s\n\r\t]*<\/(a|span|div|h1|h2|h3|h4|h5|h6|pre|address)>/gi,/<(tr|td)>[\s\n\r\t]*<\/(tr|td)>/gi,/[\s]*_apf_href="?[^\s^>]+"?/gi,/(".*?"|'.*?')|(\w)=([^'"\s>]+)/gi,/<((?:br|input|hr|img)(?:[^>]*[^\/]|))>/ig,/<p>&nbsp;$/mig,/(<br[^>]*?>(?:[\r\n\s]|&nbsp;)*<br[^>]*?>)|(<(\/?)(span|strong|em|u|i|b|a|br|strike|sup|sub|font|img)(?:\s+.*?)?>)|(<(\/?)([\w\-]+)(?:\s+.*?)?>)|([^<>]*)/gi,/<\/p>/gi,/<p>/gi,/<\s*\/?\s*(?:\w+:\s*)?[\w-]*[\s>\/]/g];}if(apf.isIE){o=o.replace(c[7],"<p></p>").replace(c[9],"<br />").replace(c[10],"");}else{if(o=="<br>"){o="";}}o=(!m&&apf.xmlentities?apf.xmlentities(o):o).replace(c[0],"</li>").replace(c[1],"").replace(c[2],"").replace(c[3],"<$1>&nbsp;</$2>").replace(c[4],"").replace(c[6],"<$1 />").replace(c[11],function(u){return u.toLowerCase();});if(apf.isIE&&!q){var t=[],n=true,s=[],r=[],k=[];o.replace(c[8],function(x,F,C,E,H,y,u,A,B){if(C){if(apf.isIE){C=C.replace(c[5],function(K,L,J,I){return L||J+'="'+I+'"';});}var w=s.push(C);if(!b[H]){if(E){if(!r[r.length-1]||r[r.length-1][0]!=H){s.length--;}else{r.length--;}}else{r.push([H,w]);}}n=true;}else{if(B){s.push(B);n=true;}else{if(F){if(n){if(r.length){s.push(F);}else{t.push("<p>",s.join("").trim()||"&nbsp;","</p>");s=[];n=false;}}else{t.push("<p>&nbsp;</p>");}}else{if(y){if(u){if(k[k.length-1]!=A){return;}else{k.length--;}if(s.length){t.push(s.join(""));s=[];}}else{if(apf.isIE){y=y.replace(c[5],function(K,L,J,I){return L||J+'="'+I+'"';});}var D=s.length?s:t;if(D[D.length-1]=="<p>&nbsp;</p>"){D.length--;}if(s.length){var G;if(k.length||(G=s.join("").trim()).replace(/<.*?>/g,"").trim()==""){t.push(G||s.join(""));s=[];}else{t.push("<p>",(G||s.join("").trim()||"&nbsp;").replace(/<br \/>[\s\r\n]*$/,""),"</p>");s=[];}}k.push(A);}t.push(y);n=false;}}}}});if(s.length){t.push("<p>"+s.join("").replace(/<br \/>[\s\r\n]*$/,"")+"</p>");}o=t.join("");}else{o=o.replace(/<br[^>]*_apf_marker="1"[^>]*>/gi,"<br />");}return o;}};})();apf.layout={compile:function(d){var c=this.layouts[d.getAttribute("id")];if(!c){return false;}var b=c.root.copy();c.layout.compile(b);c.layout.reset();},removeAll:function(c){c.children.length=null;var b=this.getHtmlId(c.pHtml);if(!this.rules[b]){delete this.qlist[b];}},timer:null,qlist:{},dlist:[],$hasQueue:false,queue:function(d,g,c,b){if(!b){this.$hasQueue=true;b=this.qlist;}var k;if(!(k=this.getHtmlId(d))){k=apf.setUniqueHtmlId(d);}if(b[k]){if(g){b[k][2].push(g);}if(c){b[k][1]=c;}return;}b[k]=[d,c,[g]];if(!this.timer){this.timer=apf.setZeroTimeout(function(){apf.layout.processQueue();});}},processQueue:function(){var d,n,b,m,k;for(d=0;d<this.dlist.length;d++){if(this.dlist[d].hidden){this.dlist[d].hide();}else{this.dlist[d].show();}}do{var g={};var c=this.qlist;this.qlist={};this.$hasQueue=false;for(n in c){m=c[n];if(m[1]){apf.layout.compileAlignment(m[1]);}k=m[2];for(d=0,b=k.length;d<b;d++){if(k[d]){if(k[d].$amlDestroyed){continue;}k[d].$updateLayout();}}apf.layout.activateRules(m[0]);}}while(this.$hasQueue);if(apf.hasSingleRszEvent){apf.layout.forceResize();}this.dlist=[];clearTimeout(this.timer);this.timer=null;},rules:{},onresize:{},getHtmlId:function(b){return b.getAttribute?b.getAttribute("id"):1;},setRules:function(d,k,g,c){if(!this.getHtmlId(d)){apf.setUniqueHtmlId(d);}if(!this.rules[this.getHtmlId(d)]){this.rules[this.getHtmlId(d)]={};}var b=this.rules[this.getHtmlId(d)][k];if(!c&&b){this.rules[this.getHtmlId(d)][k]=g+"\n"+b;}else{this.rules[this.getHtmlId(d)][k]=g;}},getRules:function(b,c){return c?this.rules[this.getHtmlId(b)][c]:this.rules[this.getHtmlId(b)];},removeRule:function(g,n){var c=this.getHtmlId(g);if(!this.rules[c]){return;}var d=this.rules[c][n]||false;delete this.rules[c][n];var m;for(m in this.rules[c]){}if(!m){delete this.rules[c];}if(apf.hasSingleRszEvent){if(this.onresize[c]){this.onresize[c]=null;}else{var k=g.parentNode;while(k&&k.nodeType==1&&!this.onresize[k.getAttribute("id")]){k=k.parentNode;}if(k&&k.nodeType==1){var b=this.onresize[k.getAttribute("id")];if(b.children){delete b.children[c];}}}}return d;},activateRules:function(k,q){if(!k){var b,m;for(b in this.rules){m=document.getElementById(b);if(!m||m.onresize){continue;}this.activateRules(m);}if(apf.hasSingleRszEvent&&window.onresize){window.onresize();}return;}var n,g,r,u,t=[];if(!apf.hasSingleRszEvent){u=this.rules[this.getHtmlId(k)];if(!u){k.onresize=null;return false;}for(g in u){if(typeof u[g]!="string"){continue;}t.push(u[g]);}n=apf.needsCssPx?new Function(t.join("\n")):new Function(t.join("\n").replace(/ \+ 'px'|try\{\}catch\(e\)\{\}\n/g,""));k.onresize=n;if(!q){n();}}else{var d=this.getHtmlId(k);u=this.rules[d];if(!u){return false;}for(g in u){if(typeof u[g]!="string"){continue;}t.push(u[g]);}var c=k.parentNode;while(c&&c.nodeType==1&&!this.onresize[c.getAttribute("id")]){c=c.parentNode;}var o=new Function(t.join("\n"));if(this.onresize[d]){o.children=this.onresize[d].children;}if(c&&c.nodeType==1){var s=this.onresize[c.getAttribute("id")];this.onresize[d]=(s.children||(s.children={}))[d]=o;}else{this.onresize[d]=o;}if(!q){o();}if(!window.onresize){var n=function(y){try{var B=[];for(var w in y){if(y[w]){B.unshift(y[w]);}}for(var x=0;x<B.length;x++){B[x]();if(B[x].children){n(B[x].children);}}}catch(A){}};window.onresize=function(){n(apf.layout.onresize);};}}},forceResize:function(k){if(apf.hasSingleRszEvent){return window.onresize&&window.onresize();}var c=k.onresize;if(c){c();}var g=k.getElementsByTagName("*");for(var d=0,b=g.length;d<b;d++){if(g[d]&&g[d].onresize){g[d].onresize();}}},paused:{},pause:function(c,d){if(apf.hasSingleRszEvent){var b=this.getHtmlId(c);this.paused[b]=this.onresize[b]||true;if(d){this.onresize[b]=d;this.onresize[b].children=this.paused[b].children;d();}else{delete this.onresize[b];}}else{this.paused[this.getHtmlId(c)]=c.onresize||true;if(d){c.onresize=d;d();}else{c.onresize=null;}}},play:function(c){if(!this.paused[this.getHtmlId(c)]){return;}if(apf.hasSingleRszEvent){var b=this.getHtmlId(c);var d=this.paused[b];if(typeof d=="function"){this.onresize[b]=d;}else{delete this.onresize[b];}if(window.onresize){window.onresize();}this.paused[this.getHtmlId(c)]=null;}else{var d=this.paused[this.getHtmlId(c)];if(typeof d=="function"){c.onresize=d;d();}else{c.onresize=null;}this.paused[this.getHtmlId(c)]=null;}}};apf.getWindowWidth=function(){return apf.isIE?document.documentElement.offsetWidth-apf.windowHorBorder:window.innerWidth;};apf.getWindowHeight=function(){return apf.isIE?document.documentElement.offsetHeight-apf.windowVerBorder:window.innerHeight;};apf.setZeroTimeout=apf.isIE||apf.isO3||apf.isAIR?setTimeout:(function(){var c=[];var b="zero-timeout-message";function d(k){c.push(k);window.postMessage(b,"*");}function g(m){if(!m){m=event;}if(m.source==window&&m.data==b){apf.stopPropagation(m);if(c.length>0){var k=c.shift();k();}}}apf.addListener(window,"message",g,true);return d;})();apf.queue={q:{},timer:null,add:function(c,b){this.q[c]=b;if(!this.timer){this.timer=apf.setZeroTimeout(function(){apf.queue.empty();});}},remove:function(b){delete this.q[b];},empty:function(d){clearTimeout(this.timer);this.timer=null;if(apf.layout&&apf.layout.$hasQueue){apf.layout.processQueue();}if(apf.xmldb&&apf.xmldb.$hasQueue){apf.xmldb.notifyQueued();}var c=this.q;this.q={};for(var d in c){var b=c[d];if(b){delete c[d];b();}}}};apf.resize=function(){this.scales={scalex:false,scaley:false,scaleratio:false,dwidth:0,dheight:0,snap:false,gridW:48,gridH:48};this.htmlElement;var b=[];this.init=function(){b=[new apf.resize.square("top","left",this),new apf.resize.square("top","middle",this),new apf.resize.square("top","right",this),new apf.resize.square("middle","left",this),new apf.resize.square("middle","right",this),new apf.resize.square("bottom","left",this),new apf.resize.square("bottom","middle",this),new apf.resize.square("bottom","right",this)];};this.grab=function(c,d){this.htmlElement=c;this.scales=d;if(!b.length){this.init();}this.show();};this.hide=function(){for(var d=0,c=b.length;d<c;d++){b[d].visible=false;b[d].repaint();}};this.show=function(){var n=this.scales.scalex;var m=this.scales.scaley;var k=this.scales.scaleratio;for(var d=0,c=b.length,g;d<c;d++){g=b[d];g.visible=n&&m?true:(m&&!n?(g.posX=="middle"?true:false):(n&&!m?(g.posY=="middle"?true:false):(k?((g.posY=="top"||g.posY=="bottom")&&g.posX!=="middle"?true:false):false)));g.repaint();}};this.destroy=function(){for(var c=0;c<b.length;c++){b[c].destroy();}};};apf.resize.square=function(g,k,c){this.visible=true;this.posX=k;this.posY=g;var d=0;var b=this;this.htmlElement=c.htmlElement.parentNode.appendChild(document.createElement("div"));apf.setStyleClass(this.htmlElement,"square");this.repaint=function(){if(this.visible){var o=c.htmlElement;this.htmlElement.style.display="block";var u=parseInt(o.style.width)+apf.getDiff(o)[0];var q=parseInt(o.style.height)+apf.getDiff(o)[1];var x=parseInt(o.style.top);var m=parseInt(o.style.left);var w=this.htmlElement.offsetWidth;var r=this.htmlElement.offsetHeight;var y=g=="top"?x-d-r:g=="middle"?x+q/2-r/2:x+q+d;var n=k=="left"?m-d-w:k=="middle"?m+u/2-w/2:m+u+d;var s=(g=="middle"?"w-resize":(k=="middle"?"n-resize":(g+k=="topleft"||g+k=="bottomright")?"nw-resize":"ne-resize"));this.htmlElement.style.top=(y-1)+"px";this.htmlElement.style.left=(n-1)+"px";this.htmlElement.style.cursor=s;}else{var w=this.htmlElement.offsetWidth;this.htmlElement.style.display="none";}};this.destroy=function(){apf.destroyHtmlNode(this.htmlElement);};this.htmlElement.onmouseover=function(m){apf.setStyleClass(b.htmlElement,"squareHover");};this.htmlElement.onmouseout=function(m){apf.setStyleClass(b.htmlElement,"",["squareHover"]);};this.htmlElement.onmousedown=function(T){T=(T||event);var u=c.htmlElement,I=T.clientX,F=T.clientY,K=u.parentNode.offsetTop,S=u.parentNode.offsetLeft,B=c.scales.dwidth,R=c.scales.dheight,J=c.scales.snap,m=c.scales.gridH,P=c.scales.gridW,N=apf.flow.isBlock(u),G=N.other.ratio,s=b.posX,q=b.posY,L,H,E,o,A,y,n,D,M=parseInt(u.style.left),C=parseInt(u.style.top),x=parseInt(u.style.width),O=parseInt(u.style.height),Q=false;c.onresizedone(x,O,C,M);if(T.preventDefault){T.preventDefault();}document.onmousemove=function(w){w=(w||event);A=w.clientX-I;y=w.clientY-F;var r=w.shiftKey,t=G;if(r){if(s=="right"&&q=="bottom"){L=x+A;H=L/t;o=M;E=C;}else{if(s=="right"&&q=="top"){L=x+A;H=L/t;o=M;E=C-A/t;}else{if(s=="left"&&q=="bottom"){L=x-A;H=L/t;o=M+A;E=C;}else{if(s=="left"&&q=="top"){L=x-A;H=L/t;o=M+A;E=C+A/t;}}}}if(L>=B&&H>=R){L=n=Math.max(B,L);H=D=Math.max(R,H);}else{L=n;H=D;return false;}}else{L=s=="right"?x+A:(s=="left"?x-A:x);H=q=="bottom"?O+y:(q=="top"?O-y:O);o=s=="right"?M:(s=="left"?Math.min(M+x-B,M+A):M);E=q=="bottom"?C:(q=="top"?Math.min(C+O-R,C+y):C);L=Math.max(B,L);H=Math.max(R,H);}if(J){o=Math.floor(o/P)*P;E=Math.floor(E/m)*m;L=Math.ceil(L/P)*P;H=Math.ceil(H/m)*m;}if(c.onresize){c.onresize(u,E,o,L,H);}c.show();Q=true;};document.onmouseup=function(r){document.onmousemove=null;if(c.onresizedone&&Q){c.onresizedone(L,H,E,o);N.other.ratio=L/H;Q=false;}};};};apf.skins={skins:{},css:[],events:["onmousemove","onmousedown","onmouseup","onmouseout","onclick","ondragcopy","ondragstart","ondblclick"],Init:function(r,n,s){var d=(n?n.getAttribute("id"):null)||r.getAttribute("id");var g=(n?n.getAttribute("src").match(/\//)||s:"")?(s||n.getAttribute("src")).replace(/\/[^\/]*$/,"")+"/":"";var k=null,o=null;k=r.getAttribute("media-path");if(k!==null){k=apf.getAbsolutePath(g||apf.hostPath,k);}else{if(n){k=n.getAttribute("media-path");if(k!==null){k=apf.getAbsolutePath(apf.hostPath,k);}else{k=apf.getAbsolutePath(g||apf.hostPath,"images/");}}}o=r.getAttribute("icon-path");if(o!==null){o=apf.getAbsolutePath(g||apf.hostPath,o);}else{if(n){o=n.getAttribute("icon-path");if(o!==null){o=apf.getAbsolutePath(apf.hostPath,o);}else{o=apf.getAbsolutePath(g||apf.hostPath,"icons/");}}}if(!d){d="default";}if(r.getAttribute("id")){document.body.className+=" "+r.getAttribute("id");}var q=d.split("|");d=q[0];if(!this.skins[d]||d=="default"){this.skins[d]={base:g,name:d,iconPath:o,mediaPath:k,templates:{},originals:{},xml:r};if(q.length>1){for(var m=0;m<q.length;m++){this.skins[q[m]]=this.skins[d];}}}if(!this.skins["default"]&&this.$first==n){this.skins["default"]=this.skins[d];}var c=r.childNodes;for(var m=c.length-1;m>=0;m--){if(c[m].nodeType!=1){continue;}this.skins[d].templates[c[m].getAttribute("name")]=c[m];if(c[m].ownerDocument){this.importSkinDef(c[m],g,d);}}this.purgeCss(k,o);if(this.queue[d]){for(var b in this.queue[d]){this.queue[d][b]();}}},loadStylesheet:function(filename,title){var o;with(o=document.getElementsByTagName("head")[0].appendChild(document.createElement("LINK"))){rel="stylesheet";type="text/css";href=filename;title=title;}return o;},importSkinDef:function(xmlNode,basepath,name){var i,l,nodes=$xmlns(xmlNode,"style",apf.ns.aml),tnode,node;for(i=0,l=nodes.length;i<l;i++){node=nodes[i];if(node.getAttribute("src")){this.loadStylesheet(apf.getAbsolutePath(basepath,node.getAttribute("src")));}else{var test=true;if(node.getAttribute("condition")){try{test=eval(node.getAttribute("condition"));}catch(e){test=false;}}if(test){tnode=node.firstChild;while(tnode){this.css.push(tnode.nodeValue);tnode=tnode.nextSibling;}}}}nodes=$xmlns(xmlNode,"alias",apf.ns.apf);var t=this.skins[name].templates;for(i=0;i<nodes.length;i++){if(!nodes[i].firstChild){continue;}t[nodes[i].firstChild.nodeValue.toLowerCase()]=xmlNode;}},loadedCss:"",purgeCss:function(b,d){if(!this.css.length){return;}var c=this.css.join("\n").replace(/images\//g,b).replace(/icons\//g,d);apf.importCssString(c);this.css=[];},loadCssInWindow:function(b,o,d,m){this.css=[];var c=b.split(":");var n=this.skins[c[0]];var g=n.templates[c[1]];this.importSkinDef(g,n.base,n.name);var k=this.css.join("\n").replace(/images\//g,d).replace(/icons\//g,m);apf.importCssString(k);this.css=[];},setSkinPaths:function(b,d){b=b.split(":");var c=b[0];var g=b[1];d.iconPath=this.skins[c].iconPath;d.mediaPath=this.skins[c].mediaPath;},getTemplate:function(d,c){d=d.split(":");var k=d[0];var n=d[1];if(!this.skins[k]){if(c){return false;}return false;}if(!this.skins[k].templates[n]){return false;}var o=this.skins[k].templates[n];var b=this.skins[k].originals[n];if(!b){b=this.skins[k].originals[n]={};var g=$xmlns(o,"presentation",apf.ns.aml)[0].childNodes;for(var m=0;m<g.length;m++){if(g[m].nodeType!=1){continue;}b[g[m].baseName||g[m][apf.TAGNAME]]=g[m];}}return b;},getCssString:function(b){return apf.queryValue($xmlns(this.skins[b.split(":")[0]].xml,"style",apf.ns.aml)[0],"text()");},changeSkinset:function(c){var b=apf.document.documentElement;while(b){if(b&&b.nodeFunc==apf.NODE_VISIBLE&&b.hasFeature(apf.__PRESENTATION__)&&!b.skinset){b.$propHandlers.skinset.call(b,c);b.skinset=null;}if(b.firstChild||b.nextSibling){b=b.firstChild||b.nextSibling;}else{do{b=b.parentNode;}while(b&&!b.nextSibling);if(b){b=b.nextSibling;}}}},queue:{},waitForSkin:function(b,d,c){if(this.skins[b]){return;}(this.queue[b]||(this.queue[b]={}))[d]=c;return true;},setIcon:function(c,d,b){if(!d){c.style.backgroundImage="";return;}if(c.tagName.toLowerCase()=="img"){c.setAttribute("src",d?(b||"")+d:"");return;}c.style.backgroundImage="url("+(b||"")+d+")";}};apf.Sort=function(c){var d={};this.parseXml=function(o,m){if(m){d={};}d.order=o.order;d.getValue=o.csort||o.$compile("sort");d.getNodes=self[o["nodes-method"]];d.ascending=(d.order||"").indexOf("desc")==-1;d.order=null;if(o["data-type"]){d.method=g[o["data-type"]];}else{if(o["sort-method"]){d.method=self[o["sort-method"]];}else{d.method=g.alpha;}}var q=o["date-format"];if(q){d.sort_dateFmtStr=q;d.method=g.date;var k=q.match(/(D+|Y+|M+|h+|m+|s+)/g);if(k){for(var r={},n=0;n<k.length;n++){r[k[n].substr(0,1)]=n+1;}d.dateFormat=new RegExp(q.replace(/([^\sDYMhms])/g,"\\$1").replace(/YYYY/,"(\\d\\d\\d\\d)").replace(/(DD|YY|MM|hh|mm|ss)/g,"(\\d\\d)"));d.dateReplace="$"+r.M+"/$"+r.D+"/$"+r.Y;if(r.h){d.dateReplace+=" $"+r.h+":$"+r.m+":$"+r.s;}}}};this.set=function(o,m){if(m){d={};}apf.extend(d,o);if(d.ascending==undefined){d.ascending=o.order?o.order.indexOf("desc")==-1:true;}d.order=null;if(o.type){d.method=g[o.type];}else{if(o.method){d.method=self[o.method];}else{if(!d.method){d.method=g.alpha;}}}if(o.format){d.sort_dateFmtStr=o.format;var k=str.match(/(D+|Y+|M+|h+|m+|s+)/g);if(k){for(var q={},n=0;n<k.length;n++){q[k[n].substr(0,1)]=n+1;}d.dateFormat=new RegExp(str.replace(/([^\sDYMhms])/g,"\\$1").replace(/YYYY/,"(\\d\\d\\d\\d)").replace(/(DD|YY|MM|hh|mm|ss)/g,"(\\d\\d)"));d.dateReplace="$"+q.M+"/$"+q.D+"/$"+q.Y;if(q.h){d.dateReplace+=" $"+q.h+":$"+q.m+":$"+q.s;}}}if(!d.getValue){d.getValue=function(r){return apf.queryValue(r,d.xpath);};}};this.get=function(){return apf.extend({},d);};this.findSortSibling=function(o,n){var k=getNodes?getNodes(o,n):this.getTraverseNodes(o);for(var m=0;m<k.length;m++){if(!compare(n,k[m],true,sortSettings)){return k[m];}}return null;};var b=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000"];var g={alpha:function(k){return k.toString().toLowerCase();},number:function(k){return(k.length<b.length?b[b.length-k.length]:"")+k;},date:function(m,k){var n=d.dateFormat;var q=d.dateReplace;var r=d.sort_dateFmtStr;var o;if(!n){o=new Date(m);}else{if(r=="*"){o=apf.date.getDateTime(m);}else{o=(new Date(m.replace(n,q))).getTime();}}m=""+o.getTime();if(m=="NaN"){m="0";}return(m.length<b.length?b[b.length-m.length]:"")+m;}};this.apply=function(m,u,o,k,s){var w=[],r=m.length;while(r--){var x=d.getValue(m[r]);if(m){w[w.length]={toString:function(){return this.v;},xmlNode:m[r],v:(d.method||g.alpha)(x||"",u,m[r])};}}w.sort();var q=s?Math.min(w.length,k+s):w.length;if(!k){k=0;}if(o){if(d.ascending){for(r=k;r<q;r++){f(r,q,w[r].xmlNode,w[r].v);}}else{for(r=q-1;r>=k;r--){f(q-r-1,q,w[r].xmlNode,w[r].v);}}}else{var t=[];if(d.ascending){for(r=k;r<q;r++){t[t.length]=w[r].xmlNode;}}else{for(r=q-1;r>=k;r--){t[t.length]=w[r].xmlNode;}}return t;}};if(c){this.parseXml(c);}};apf.tween=(function(C){var M={left:function(Q,P){Q.style.left=P+s;},right:function(Q,P){Q.style.left="";Q.style.right=P+s;},top:function(Q,P){Q.style.top=P+s;},bottom:function(Q,P){Q.style.top="";Q.style.bottom=P+s;},width:function(R,Q,P){R.style.width=Q+s;},height:function(R,Q,P){R.style.height=Q+s;},scrollTop:function(R,Q,P){R.scrollTop=Q;},scrollLeft:function(R,Q,P){R.scrollLeft=Q;},"height-rsz":function(R,Q,P){R.style.height=Q+s;if(C.hasSingleResizeEvent){window.onresize();}},mwidth:function(Q,P,S){var R=C.getDiff(Q);Q.style.width=P+s;Q.style.marginLeft=-1*(P/2+(parseInt(C.getStyle(Q,"borderLeftWidth"))||R[0]/2)+(S.margin||0))+s;},mheight:function(Q,P,S){var R=C.getDiff(Q);Q.style.height=P+s;Q.style.marginTop=(-1*P/2-(parseInt(C.getStyle(Q,"borderTopWidth"))||R[1]/2)+(S.margin||0))+s;},scrollwidth:function(Q,P){Q.style.width=P+s;Q.scrollLeft=Q.scrollWidth;},scrollheight_old:function(Q,P){try{Q.style.height=P+s;Q.scrollTop=Q.scrollHeight;}catch(R){alert(P);}},scrollheight:function(R,Q,T){var S=C.getHeightDiff(R),P=T.$int||R;R.style.height=Math.max((Q+(T.diff||0)),0)+s;P.scrollTop=P.scrollHeight-P.offsetHeight-S+(T.diff||0)-(C.isGecko?16:0);},scrolltop:function(Q,P){Q.style.height=P+s;Q.style.top=(-1*P-2)+s;Q.scrollTop=0;},clipright:function(R,Q,P){R.style.clip="rect(auto, auto, auto, "+Q+"px)";R.style.marginLeft=(-1*Q)+s;},fade:function(Q,P){if(!C.supportOpacity&&C.hasStyleFilters){Q.style.filter=P==1?"":"alpha(opacity="+parseInt(P*100)+")";}else{Q.style.opacity=P;}},bgcolor:function(Q,P){Q.style.backgroundColor=P;},textcolor:function(Q,P){Q.style.color=P;},htmlcss:function(Q,P,R){if(C.hasStyleFilters&&R.type=="filter"){Q.style.filter=P==1?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+P+")";}else{Q.style[R.type]=P+(R.needsPx?s:"");}},transformscale:function(Q,P,R){Q.style[R.type]=r+parseFloat(P)+n;},transformrotate:function(Q,P,R){Q.style[R.type]=J+parseFloat(P)+I;},transformvalscale:function(P){return r+parseFloat(P)+n;},transformvalrotate:function(P){return J+parseFloat(P)+I;}};var t="id",s="px",w="number",A="transformval",q="transform",B="scale",r="scale(",J="rotate(",n=")",I="deg)",N=["linear","ease-in","ease-out","ease","ease-in-out","cubic-bezier"],u={left:"left",right:"right",top:"top",bottom:"bottom",width:"width",height:"height",scrollTop:false,scrollLeft:false,mwidth:false,mheight:false,scrollwidth:false,scrollheight:false,fade:"opacity",opacity:"opacity",bgcolor:"background-color",textcolor:"color",transform:"transform"},O=Math.pow,K=Math.round,G={},E=null,g=function(P,R){var Q=P.getAttribute(t);if(!Q){C.setUniqueHtmlId(P);Q=P.getAttribute(t);}if(!G[Q]){G[Q]=[];}G[Q].push(R);if(G[Q].length==1){R(0);}},H=function(Q){var P=G[Q.getAttribute(t)];if(!P){return;}P.shift();if(P.length){P[0](0);}},d=function(R,P){var Q=G[R.getAttribute(t)];if(!Q){return;}if(P&&E&&E.control){E.control.stop=true;}Q.length=0;},m=function(Q){var R=Q.getAttribute(t);if(!R){C.setUniqueHtmlId(Q);R=Q.getAttribute(t);}for(var P in G){if(P==R){G[P]=[];}}},o=function(U,V,R,Q){var T=0,P=Q-1,S=[V];if(typeof U==w){if(!U){U=C.tween.linear;}else{if(U==1){U=C.tween.easeInCubic;}else{if(U==2){U=C.tween.easeOutCubic;}}}}for(T=0;T<P;++T){S.push(U(T/Q,V,R-V));}S.push(R);return S;},k=function(V,P,U,W){var Q,R,X=C.color.colorshex,Z=parseInt((X[P]||P).slice(1),16),Y=parseInt((X[U]||U).slice(1),16),T=0,S=[];for(;T<W;T++){R=T/(W-1),Q=1-R;S[S.length]="#"+("000000"+((K((Z&255)*Q+(Y&255)*R)&255)|(K((Z&65280)*Q+(Y&65280)*R)&65280)|(K((Z&16711680)*Q+(Y&16711680)*R)&16711680)).toString(16)).slice(-6);}return S;},L=function(P,Q){Q=C.extend({steps:10,interval:5,anim:C.tween.linear,control:{}},Q);Q.steps=Math.ceil(Q.steps*C.animSteps);Q.interval=Math.ceil(Q.interval*C.animInterval);if(P.nodeFunc>100){Q.$int=P.$int;P=P.$ext;}try{if("fixed|absolute|relative".indexOf(C.getStyle(P,"position"))==-1){P.style.position="relative";}}catch(T){}var X=(C.supportCSSAnim&&C.supportCSSTransition&&u[Q.type]),S=(Q.type==q);Q.method=X?Q.type:S?M[q+(Q.subType||B)]:M[Q.type]?M[Q.type]:(Q.needsPx=y[Q.type]||false)?M.htmlcss:M.htmlcss;if(X){var U=u[Q.type];if(U===false){return C.tween;}Q.type=U||Q.type;if(S){if(!Q.subType){Q.subType=B;}Q.type=C.supportCSSAnim;}var R=(S)?M[A+(Q.subType||B)]:null;P.style[Q.type]=S?R(Q.from):Q.from+(y[Q.type]?s:"");$setTimeout(function(){P.style[Q.type]=S?R(Q.to):Q.to+(y[Q.type]?s:"");P.offsetTop;P.style[C.cssPrefix+"Transition"]=Q.type+" "+((Q.steps*Q.interval)/1000)+"s "+N[Q.anim||0];var Y=function(){if(Q.onfinish){Q.onfinish(P,Q.userdata);}P.style[C.cssPrefix+"Transition"]="";P.removeEventListener(C.cssAnimEvent,Y);};P.addEventListener(C.cssAnimEvent,Y);});return C.tween;}if(Q.control){Q.control.state=C.tween.RUNNING;Q.control.stop=function(){Q.control.state=C.tween.STOPPING;d(P);if(Q.onstop){Q.onstop(P,Q.userdata);}};}var W=Q.color?k(Q.anim,Q.from,Q.to,Q.steps):o(Q.anim,parseFloat(Q.from),parseFloat(Q.to),Q.steps),V=function(Y){if(Q.control&&Q.control.state){Q.control.state=C.tween.STOPPED;return;}E=Q;if(Q.onbeforeeach&&Q.onbeforeeach(P,Q.userdata)===false){return;}try{Q.method(P,W[Y],Q);}catch(Z){}if(Q.oneach){Q.oneach(P,Q.userdata);}if(Y<Q.steps){return $setTimeout(function(){V(Y+1);},Q.interval);}E=null;if(Q.control){Q.control.state=C.tween.STOPPED;}if(Q.onfinish){Q.onfinish(P,Q.userdata);}H(P);};if(Q.type.indexOf("scroll")>-1){m(P);}g(P,V);return C.tween;},F=function(S,ai){ai=C.extend({steps:10,interval:5,anim:C.tween.linear,control:{}},ai);ai.steps=Math.ceil(ai.steps*C.animSteps);ai.interval=Math.ceil(ai.interval*C.animInterval);if(S.nodeFunc>100){ai.$int=S.$int;S=S.$ext;}var ah,V,Z=C.supportCSSAnim&&C.supportCSSTransition,X=false,P=((ai.steps*ai.interval)/1000),Q=N[ai.anim||0],ag=[],ab=[],af=0,ac=ai.tweens.length;for(;af<ac;af++){var aj=ai.tweens[af];if(aj.oHtml&&aj.oHtml.nodeFunc>100){aj.$int=aj.oHtml.$int;aj.oHtml=aj.oHtml.$ext;}ah=(Z&&u[aj.type]);V=(aj.type==q);if(V){if(!aj.subType){aj.subType=B;}aj.type=C.supportCSSAnim;}aj.method=ah?aj.type:V?M[q+(aj.subType)]:M[aj.type]?M[aj.type]:(aj.needsPx=y[aj.type]||false)?M.htmlcss:M.htmlcss;if(ah){var R=V?aj.type:u[aj.type];aj.type=R||aj.type;var Y=M[A+(aj.subType)];S.style[aj.type]=V?Y(aj.from):aj.from+(y[aj.type]?s:"");ab.push([aj.type,V?Y(aj.to):aj.to+(y[aj.type]?s:"")]);ag.push(aj.type+" "+P+"s "+Q+" 0");X=true;}else{ag.push(aj.color?k(ai.anim,aj.from,aj.to,ai.steps):o(ai.anim,parseFloat(aj.from),parseFloat(aj.to),ai.steps));}}if(X){S.style[C.cssPrefix+"Transition"]=ag.join(",");S.offsetTop;var U=0,T=function(){U++;if(U==ab.length){if(ai.onfinish){ai.onfinish(S,ai.userdata);}S.style[C.cssPrefix+"Transition"]="";S.removeEventListener(C.cssAnimEvent,T);}};S.addEventListener(C.cssAnimEvent,T,false);for(var ad=0,ae=ab.length;ad<ae;ad++){S.style[ab[ad][0]]=ab[ad][1];}return C.tween;}if(ai.control){ai.control.state=C.tween.RUNNING;ai.control.stop=function(){ai.control.state=C.tween.STOPPING;d(S);if(ai.onstop){ai.onstop(S,ai.userdata);}};}var aa=ai.tweens,W=function(al){if(ai.control&&ai.control.state){ai.control.state=C.tween.STOPPED;return;}E=ai;try{for(var ak=0;ak<ag.length;ak++){aa[ak].method(aa[ak].oHtml||S,ag[ak][al],aa[ak]);}}catch(am){}if(ai.oneach){ai.oneach(S,ai.userdata);}if(al<ai.steps){return $setTimeout(function(){W(al+1);},ai.interval);}E=null;if(ai.control){ai.control.state=C.tween.STOPPED;}if(ai.onfinish){ai.onfinish(S,ai.userdata);}H(S);};g(S,W);return C.tween;},x=function(T,Q,af,ag){(af=af||{}).tweens=[];if(T.nodeFunc>100){T=T.$ext;}if(ag){C.setStyleClass(T,"",[Q]);}var ab=function(ah,aj){if(ah){C.setStyleClass(T,"",[Q]);}else{C.setStyleClass(T,Q);}for(var ai=0;ai<af.tweens.length;ai++){if(af.tweens[ai].type=="filter"){continue;}T.style[af.tweens[ai].type]="";}if(aj){aj.apply(this,arguments);}};var P=af.onfinish,S=af.onstop;af.onfinish=function(){ab(ag,P);};af.onstop=function(){ab(!ag,S);};var X,U,Y,aa,ae,ad,W,ac,Z={};for(ac=0;ac<document.styleSheets.length;ac++){W=document.styleSheets[ac][C.styleSheetRules];for(aa=W.length-1;aa>=0;aa--){var V=W[aa];if(!V.style||!V.selectorText.match("."+Q+"$")){continue;}for(ad in V.style){if(!V.style[ad]||c.indexOf("|"+ad+"|")==-1){continue;}if(ad=="filter"){if(!V.style[ad].match(/opacity\=([\d\.]+)/)){continue;}U=RegExp.$1;X=(C.getStyleRecur(T,ad)||"").match(/opacity\=([\d\.]+)/);Y=X?RegExp.$1:100;ae=false;if(U==Y){if(ag){Y=100;}else{U=100;}}}else{U=ag&&T.style[ad]||V.style[ad];if(ag){T.style[ad]="";}Y=C.getStyleRecur(T,ad);ae=ad.match(/color/i)?true:false;}Z[ad]={type:ad,from:(ae?String:parseFloat)(ag?U:Y),to:(ae?String:parseFloat)(ag?Y:U),color:ae,needsPx:y[ad.toLowerCase()]||false};}}}for(var R in Z){af.tweens.push(Z[R]);}if(ag){C.setStyleClass(T,Q);}return F(T,af);},b=function(Q,P,R){x(Q,P,R,true);},y={left:true,top:true,bottom:true,right:true,width:true,height:true,fontSize:true,lineHeight:true,textIndent:true,marginLeft:true,marginTop:true,marginRight:true,marginBottom:true},c="|backgroundColor|backgroundPosition|color|width|filter|height|left|top|bottom|right|fontSize|letterSpacing|lineHeight|textIndent|opacity|paddingLeft|paddingTop|paddingRight|paddingBottom|borderLeftWidth|borderTopWidth|borderRightWidth|borderBottomWidth|borderLeftColor|borderTopColor|borderRightColor|borderBottomColor|marginLeft|marginTop|marginRight|marginBottom|transform|",D="|scale|rotate|";return{single:L,multi:F,css:x,cssRemove:b,clearQueue:d,addModule:function(P,Q,R){if(typeof P!="string"||typeof Q!="function"||(M[P]&&!R)){return this;}M[P]=Q;return this;},NORMAL:0,EASEIN:1,EASEOUT:2,RUNNING:0,STOPPING:1,STOPPED:2,calcColorSteps:k,linear:function(Q,R,P){return P*Q+R;},easeInQuad:function(Q,R,P){return P*O(Q,2)+R;},easeOutQuad:function(Q,R,P){return -P*Q*(Q-2)+R;},easeInOutQuad:function(Q,R,P){if((Q/=0.5)<1){return P/2*Q*Q+R;}return -P/2*((--Q)*(Q-2)-1)+R;},easeInCubic:function(Q,R,P){return P*O(Q,3)+R;},easeOutCubic:function(Q,R,P){return P*(O(Q-1,3)+1)+R;},easeInOutCubic:function(Q,R,P){if((Q/=0.5)<1){return P/2*O(Q,3)+R;}return P/2*(O(Q-2,3)+2)+R;},easeInQuart:function(Q,R,P){return P*O(Q,4)+R;},easeOutQuart:function(Q,R,P){return -P*(O(Q-1,4)-1)+R;},easeInOutQuart:function(Q,R,P){if((Q/=0.5)<1){return P/2*O(Q,4)+R;}return -P/2*(O(Q-2,4)-2)+R;},easeInQuint:function(Q,R,P){return P*O(Q,5)+R;},easeOutQuint:function(Q,R,P){return P*(O(Q-1,5)+1)+R;},easeInOutQuint:function(Q,R,P){if((Q/=0.5)<1){return P/2*O(Q,5)+R;}return P/2*(O(Q-2,5)+2)+R;},easeInSine:function(Q,R,P){return -P*Math.cos(Q*(Math.PI/2))+P+R;},easeOutSine:function(Q,R,P){return P*Math.sin(Q*(Math.PI/2))+R;},easeInOutSine:function(Q,R,P){return -P/2*(Math.cos(Math.PI*Q)-1)+R;},easeInExpo:function(Q,R,P){return(Q==0)?R:P*O(2,10*(Q-1))+R;},easeOutExpo:function(Q,R,P){return(Q==1)?R+P:P*(-O(2,-10*Q)+1)+R;},easeInOutExpo:function(Q,R,P){if(Q==0){return R;}if(Q==1){return R+P;}if((Q/=0.5)<1){return P/2*O(2,10*(Q-1))+R;}return P/2*(-O(2,-10*--Q)+2)+R;},easeInCirc:function(Q,R,P){return -P*(Math.sqrt(1-Q*Q)-1)+R;},easeOutCirc:function(Q,R,P){return P*Math.sqrt(1-(Q-=1)*Q)+R;},easeInOutCirc:function(Q,R,P){if((Q/=0.5)<1){return -P/2*(Math.sqrt(1-Q*Q)-1)+R;}return P/2*(Math.sqrt(1-(Q-=2)*Q)+1)+R;},easeInElastic:function(R,U,Q){var S=1.70158,T=0.3,P=Q;if(R==0){return U;}if(R==1){return U+Q;}if(!P||P<Math.abs(Q)){P=Q;S=T/4;}else{S=T/(2*Math.PI)*Math.asin(Q/P);}return -(P*O(2,10*(R-=1))*Math.sin((R*1-S)*(2*Math.PI)/T))+U;},easeOutElastic:function(R,U,Q){var S=1.70158,T=0.3,P=Q;if(R==0){return U;}if(R==1){return U+Q;}if(P<Math.abs(Q)){P=Q;S=T/4;}else{S=T/(2*Math.PI)*Math.asin(Q/P);}return P*O(2,-10*R)*Math.sin((R-S)*(2*Math.PI)/T)+Q+U;},easeInOutElastic:function(R,U,Q){var S=1.70158,T=0,P=Q;if(R==0){return U;}if((R/2)==2){return U+Q;}if(!T){T=0.3*1.5;}if(P<Math.abs(Q)){P=Q;S=T/4;}else{S=T/(2*Math.PI)*Math.asin(Q/P);}if(R<1){return -0.5*(P*O(2,10*(R-=1))*Math.sin((R-S)*(2*Math.PI)/T))+U;}return P*O(2,-10*(R-=1))*Math.sin((R-S)*(2*Math.PI)/T)*0.5+Q+U;},easeInBack:function(Q,S,P){var R=1.70158;return P*O(Q,2)*((R+1)*Q-R)+S;},easeOutBack:function(Q,S,P){var R=1.70158;return P*((Q-=1)*Q*((R+1)*Q+R)+1)+S;},easeInOutBack:function(Q,S,P){var R=1.70158;if((Q/2)<1){return P/2*(Q*Q*(((R*=(1.525))+1)*Q-R))+S;}return P/2*((Q-=2)*Q*(((R*=(1.525))+1)*Q+R)+2)+S;},easeInBounce:function(Q,R,P){return P-C.tween.easeOutBounce(1-Q,0,P)+R;},easeOutBounce:function(Q,R,P){if(Q<(1/2.75)){return P*(7.5625*Q*Q)+R;}else{if(Q<(2/2.75)){return P*(7.5625*(Q-=(1.5/2.75))*Q+0.75)+R;}else{if(Q<(2.5/2.75)){return P*(7.5625*(Q-=(2.25/2.75))*Q+0.9375)+R;}else{return P*(7.5625*(Q-=(2.625/2.75))*Q+0.984375)+R;}}}},easeInOutBounce:function(Q,R,P){if(Q<1/2){return C.tween.easeInBounce(Q*2,0,P)*0.5+R;}return C.tween.easeOutBounce(Q*2-1,0,P)*0.5+P*0.5+R;}};})(apf);apf.xmldb=new (function(){this.xmlDocTag="a_doc";this.xmlIdTag="a_id";this.xmlListenTag="a_listen";this.htmlIdTag="id";this.disableRDB=false;this.$xmlDocLut=[];this.$nodeCount={};var b=/(?:a_doc|a_id|a_listen|a_loaded)=(?:"|')[^'"]+(?:"|')/g,g=/>[\s\n\r\t]+</g;this.getElementById=function(m,k){if(!k){k=this.$xmlDocLut[m.split("|")[0]];}if(!k){return false;}return k.selectSingleNode("descendant-or-self::node()[@"+this.xmlIdTag+"='"+m+"']");};this.getNode=function(k){if(!k||!k.getAttribute(this.htmlIdTag)){return false;}return this.getElementById(k.getAttribute(this.htmlIdTag).split("|",2).join("|"));};this.getNodeById=function(n,m){var k=n.split("|");k.pop();return this.getElementById(k.join("|"),m);};this.getDocumentById=function(k){return this.$xmlDocLut[k];};this.getDocument=function(k){return this.$xmlDocLut[k.getAttribute(this.xmlIdTag).split("|")[0]];};this.getID=function(k,m){return k.getAttribute(this.xmlIdTag)+"|"+m.$uniqueId;};this.getElement=function(o,q){var k=o.childNodes;for(var m=0,n=0;n<k.length;n++){if(k[n].nodeType!=1){continue;}if(m++==q){return k[n];}}};this.setModel=function(k){apf.nameserver.register("model",k.data.ownerDocument.documentElement.getAttribute(this.xmlDocTag),k);};this.findModel=function(k){return apf.nameserver.get("model",k.ownerDocument.documentElement.getAttribute(this.xmlDocTag));};this.getXmlId=function(k){return k.getAttribute(this.xmlIdTag)||this.nodeConnect(apf.xmldb.getXmlDocId(k),k);};this.getHtmlNode=function(k,m){if(k&&k.nodeType==1&&k.getAttribute(this.xmlIdTag)){return m.$findHtmlNode(k.getAttribute(this.xmlIdTag)+"|"+m.$uniqueId);}return null;};this.findHtmlNode=function(k,m){do{if(k.nodeType==1&&k.getAttribute(this.xmlIdTag)){return m.$findHtmlNode(k.getAttribute(this.xmlIdTag)+"|"+m.$uniqueId);}if(k==m.xmlRoot){return null;}k=k.parentNode;}while(k&&k.nodeType!=9);return null;};this.findXmlNode=function(k){if(!k){return false;}var m;while(k&&k.nodeType==1&&(k.tagName.toLowerCase()!="body"&&!(m=k.getAttribute(this.htmlIdTag))||(m||(m=k.getAttribute(this.htmlIdTag)))&&m.match(/^q/))){if(k.host&&k.host.$ext==k){return k.host.xmlRoot;}k=k.parentNode;}if(!k||k.nodeType!=1){return false;}if(k.tagName.toLowerCase()=="body"){return false;}return this.getNode(k);};this.getXml=apf.getXml;this.nodeConnect=function(n,m,r,s){if(!this.$nodeCount[n]){this.$nodeCount[n]=0;}var q;q=m.getAttribute(this.xmlIdTag)||m.setAttribute(this.xmlIdTag,(q=n+"|"+ ++this.$nodeCount[n]))||q;if(!s){return q;}var k=q+"|"+s.$uniqueId;if(r){r.setAttribute(this.htmlIdTag,k);}return k;};this.$listeners=[null];this.addNodeListener=function(q,t,r){var u,n=String(q.getAttribute(this.xmlListenTag)||"");if(!r){r=String(t.$uniqueId);}if(r.charAt(0)=="p"){var s=r.split("|");u=this.$listeners.push(function(x){var y=apf.all[s[1]];if(y){var w=apf.all[s[3]];if(!w){return;}var o=w.$propBinds[s[1]][s[2]].listen;var A=o?apf.queryNode(w.data,o):q;if(A){y.$execProperty(s[2],A,x[3]);}}})-1;this.$listeners[r]=u;}else{u="e"+r;if(!this.$listeners[u]){this.$listeners[u]=function(o){var w=apf.all[r];if(w){w.$xmlUpdate.apply(w,o);}};}if(q.$regbase){var m={DOMCharacterDataModified:"text",DOMAttrModified:"attribute",DOMNodeInserted:"add",DOMNodeRemoved:"remove"};var k=this.$listeners[u].rFn||(this.$listeners[u].rFn=function(x){var o=x.relatedNode&&x.relatedNode.nodeType!=1?x.relatedNode:x.currentTarget;if(o.nodeName&&o.nodeName.substr(0,2)=="a_"){return;}var w=m[x.name];if(o.nodeType!=1){w=o.nodeType==2?"attribute":"text";o=o.parentNode||o.ownerElement;}apf.xmldb.$listeners[u]([w,o,this,null,o.parentNode]);});q.addEventListener("DOMCharacterDataModified",k);q.addEventListener("DOMAttrModified",k);q.addEventListener("DOMNodeInserted",k);q.addEventListener("DOMNodeRemoved",k);return;}}if(!n||n.indexOf(";"+u+";")==-1){q.setAttribute(this.xmlListenTag,(n?n+u:";"+u)+";");}return q;};this.removeNodeListener=function(r,t,u){var q=r.getAttribute(this.xmlListenTag);var m=(q?q.split(";"):[]);if(u&&u.charAt(0)=="p"){u=this.$listeners[u];delete this.$listeners[u];}else{u="e"+t.$uniqueId;if(r.$regbase){var k=this.$listeners[u].rFn;r.removeEventListener("DOMCharacterDataModified",k);r.removeEventListener("DOMAttrModified",k);r.removeEventListener("DOMNodeInserted",k);r.removeEventListener("DOMNodeRemoved",k);}}for(var s=[],n=0;n<m.length;n++){if(m[n]!=u){s.push(m[n]);}}r.setAttribute(this.xmlListenTag,s.join(";"));return r;};this.setTextNode=apf.setTextNode=function(n,q,m,r,k){var o;if(m){o=n.selectSingleNode(m);if(!o){return;}n=o.nodeType==1?o:null;}if(n.nodeType!=1){o=n;}else{if(n||!o){o=n.selectSingleNode("text()");if(!o){o=n.appendChild(n.ownerDocument.createTextNode(""));}}}if(r&&!r.$filled){r.extra.oldValue=o.nodeValue;r.$filled=true;}if(k){r.extra.range=k;}else{o.nodeValue=q;if(o.$regbase){o.$setValue(q);}}this.applyChanges("text",o.parentNode,r);};this.setAttribute=apf.setAttribute=function(o,n,q,m,r,k){if(r&&!r.$filled){r.name=n;r.$filled=true;}if(k){r.extra.range=k;}else{(m?o.selectSingleNode(m):o).setAttribute(n,q);}this.applyChanges("attribute",o,r);};this.removeAttribute=apf.removeAttribute=function(n,m,k,o){if(o&&!o.$filled){o.name=m;o.$filled=true;}(k?n.selectSingleNode(k):n).removeAttribute(m);this.applyChanges("attribute",n,o);};this.replaceNode=apf.replaceNode=function(n,o,m,q){if(m){o=o.selectSingleNode(m);}if(o.ownerDocument.importNode&&n.ownerDocument!=o.ownerDocument){n=o.ownerDocument.importNode(n,true);}if(q&&!q.$filled){q.$filled=true;q.oldNode=o;q.xmlNode=n;}this.cleanNode(n);var k=o.parentNode;if(!k){return;}k.replaceChild(n,o);this.copyConnections(o,n);this.applyChanges("replacenode",n,q);return n;};this.addChildNode=apf.addChildNode=function(r,q,k,m,s){var o=r.insertBefore(r.ownerDocument.createElement(q),m);for(var n=0;n<k.length;n++){o.setAttribute(k[n][0],k[n][1]);}if(s&&!s.$filled){s.extra.addedNode=o;s.$filled=true;}this.applyChanges("add",o,s);return o;};this.appendChild=apf.appendChild=function(q,o,m,s,k,r){if(q==o.parentNode){return apf.xmldb.moveNode(q,o,m,null,k,r);}if(s&&q.selectSingleNode(o.tagName)){return false;}if(r&&!r.$filled){r.$filled=true;this.cleanNode(o);}else{this.cleanNode(o);}if(q.ownerDocument.importNode&&q.ownerDocument!=o.ownerDocument){o=q.ownerDocument.importNode(o,true);}if(k){var n=[];q=apf.createNodeFromXpath(q,k,n);if(n.length){q.appendChild(o);while(n.length){if(q==n.pop()&&n.length){q=q.parentNode;}}}}else{if(o.parentNode){this.removeNode(o);}}q.insertBefore(o,m);this.applyChanges("add",o,r);return o;};this.moveNode=apf.moveNode=function(o,n,m,k,q){if(!q){q={extra:{}};}q.extra.oldParent=n.parentNode;q.extra.beforeNode=n.nextSibling;q.extra.parent=(k?o.selectSingleNode(k):o);this.applyChanges("move-away",n,q);if(o.ownerDocument.importNode&&o.ownerDocument!=n.ownerDocument){n=o.ownerDocument.importNode(n,true);}q.extra.parent.insertBefore(n,m);this.applyChanges("move",n,q);};this.removeNode=apf.removeNode=function(m,k,o){if(k){m=m.selectSingleNode(k);}if(o&&!o.$filled){o.$filled=true;o.extra.parent=m.parentNode;o.extra.removedNode=m;o.extra.beforeNode=m.nextSibling;}this.applyChanges("remove",m,o);var n=m.parentNode;if(!n){return;}n.removeChild(m);this.applyChanges("redo-remove",m,null,n);};this.removeNodeList=apf.removeNodeList=function(k,q){for(var n=[],m=0;m<k.length;m++){if(q){n.push({pNode:k[m].parentNode,removedNode:k[m],beforeNode:k[m].nextSibling});}this.applyChanges("remove",k[m],q);var o=k[m].parentNode;o.removeChild(k[m]);this.applyChanges("redo-remove",k[m],null,o);}if(q&&!q.$filled){q.$filled=true;q.extra.removeList=n;}};var d={},c;this.$hasQueue=false;this.applyChanges=function(r,B,D,n){if(D&&D.$dontapply){return;}if(D&&!D.xmlNode){D.xmlNode=B;}var k=n,C=(B.nodeType==1?B:B.parentNode);if(!this.delayUpdate&&"|remove|move-away|".indexOf("|"+r+"|")>-1){this.notifyQueued();}var q,A,x,w,t,u,m,o,y,E,s={};while(C&&C.nodeType==1){q=C.getAttribute(this.xmlListenTag);if(q){x=q.split(";");for(w=0;w<x.length;w++){A=x[w];if(!A||s[A]){continue;}s[A]=true;u=d[A];if(!u){d[A]=u=[];}if(!apf.isO3&&"|update|attribute|text|".indexOf("|"+r+"|")>-1){E=false;for(t=0;t<u.length;t++){if(u[t]&&B==u[t][1]&&"|update|attribute|text|".indexOf("|"+u[t][0]+"|")>-1){u[t]=null;E=true;continue;}}u.push([r,B,C,D,k]);y=true;continue;}if(apf.isO3||"|remove|move-away|move|add|".indexOf("|"+r+"|")>-1){if(this.$listeners[A]){this.$listeners[A]([r,B,C,D,k]);}}else{u.push([r,B,C,D,k]);y=true;}}}C=C.parentNode||n;if(C==n){n=null;}}if(D&&!this.delayUpdate){apf.xmldb.notifyQueued();}else{if(y){clearTimeout(c);this.$hasQueue=true;c=apf.setZeroTimeout(function(){apf.xmldb.notifyQueued();});}}};this.notifyQueued=function(){this.$hasQueue=false;var r=d;d={};clearTimeout(c);for(var n in r){if(!n){continue;}var o=r[n];var m=this.$listeners[n];if(!o||!m){continue;}for(var k=0;k<o.length;k++){if(!o[k]){continue;}m(o[k]);}}};this.notifyListeners=function(n){var m=n.getAttribute(apf.xmldb.xmlListenTag);if(m){m=m.split(";");for(var k=0;k<m.length;k++){apf.all[m[k]].$xmlUpdate("synchronize",n,n);}}};this.copyConnections=function(m,k){try{k.setAttribute(this.xmlListenTag,m.getAttribute(this.xmlListenTag));}catch(n){}try{k.setAttribute(this.xmlIdTag,m.getAttribute(this.xmlIdTag));}catch(n){}};this.cleanXml=function(k){if(typeof k!="string"){return k;}return k.replace(b,"").replace(g,"><");};this.cleanNode=function(n){try{var m,k=n.selectNodes("descendant-or-self::node()[@"+this.xmlListenTag+"]");for(m=k.length-1;m>=0;m--){k[m].removeAttribute(this.xmlListenTag);}k=n.selectNodes("descendant-or-self::node()[@"+this.xmlIdTag+"]");for(m=k.length-1;m>=0;m--){k[m].removeAttribute(this.xmlIdTag);}k=n.selectNodes("descendant-or-self::node()[@"+this.xmlDocTag+"]");for(m=k.length-1;m>=0;m--){k[m].removeAttribute(this.xmlDocTag);}k=n.selectNodes("descendant-or-self::node()[@a_loaded]");for(m=k.length-1;m>=0;m--){k[m].removeAttribute("a_loaded");}}catch(o){}return n;};this.copy=this.getCleanCopy=apf.getCleanCopy=function(k){return apf.xmldb.cleanNode(k.cloneNode(true));};this.unbind=function(s){for(var u={},q=0;q<s.apf.all.length;q++){if(s.apf.all[q]&&s.apf.all[q].unloadBindings){u[s.apf.all[q].unloadBindings()]=true;}}for(var m=0;m<this.$xmlDocLut.length;m++){if(!this.$xmlDocLut[m]){continue;}var t=this.$xmlDocLut[m].selectNodes("//self::node()[@"+this.xmlListenTag+"]");if(!t){continue;}for(var q=0;q<t.length;q++){var o=t[q].getAttribute(this.xmlListenTag).split(";");for(var r=[],n=0;n<o.length;n++){if(!u[o[n]]){r.push(o[n]);}}if(r.length!=o.length){t[q].setAttribute(this.xmlListenTag,r.join(";"));}}}};this.getXmlDocId=function(n,k){var o=n.ownerDocument.documentElement;if(!apf.isChildOf(o,n)){o=n;}var m=(o||n).getAttribute(this.xmlDocTag)||this.$xmlDocLut.indexOf(o||n.ownerDocument||n);if(k&&apf.nameserver.get("model",m)!=k){m=null;o=n;}if(!m||m==-1){m=this.$xmlDocLut.push(o||n.ownerDocument||n)-1;if(o){o.setAttribute(this.xmlDocTag,String(m));}}if(k){apf.nameserver.register("model",m,k);}return m;};});apf.http=function(){this.queue=[null];this.callbacks={};this.cache={};this.timeout=this.timeout||10000;this.autoroute=this.autoroute||false;this["route-server"]=this["route-server"]||null;if(!this.$uniqueId){this.$uniqueId=apf.all.push(this)-1;}this.toString=this.toString||function(){return"[Ajax.org Teleport Component : (HTTP)]";};this.getXml=function(url,callback,options){if(!options){options={};}options.useXML=true;options.callback=callback;return this.get(url,options);};this.getJSON=function(url,callback,options){if(!options){options={};}options.callback=callback;options.useJSON=true;return this.get(url,options);};this.get=this.$get=function(url,options){if(!options){options={};}var _self=this;var id=options.id;var async=options.async=(options.async||typeof options.async=="undefined"||apf.isOpera||false);if(apf.isWebkit){url=apf.html_entity_decode(url);}var data=options.data||"";if(apf.isNot(id)){var http=apf.getHttpReq();id=this.queue.push({http:http,url:url,callback:options.callback,retries:0,options:options})-1;}else{var http=this.queue[id].http;http.abort();}if(async){http.onreadystatechange=function(){if(!_self.queue[id]||http.readyState!=4){return;}if(async&&arguments.callee.caller){setTimeout(function(){_self.receive(id);});}else{_self.receive(id);}};}var autoroute=this.autoroute&&apf.isOpera?true:(options.autoroute||this.shouldAutoroute),httpUrl=autoroute?this["route-server"]:url;var headers=[];function setRequestHeader(name,value){http.setRequestHeader(name,value);}var errorFound=false;try{if(options.nocache){httpUrl=apf.getNoCacheUrl(httpUrl);}if(apf.config.queryAppend){httpUrl+=(httpUrl.indexOf("?")==-1?"?":"&")+apf.config.queryAppend;}if(apf.hasHtml5XDomain&&httpUrl.match(/^http:\/\//)&&!new apf.url(httpUrl).isSameLocation()){throw new Error(apf.formatErrorString(0,this,"Communication error","Url: "+httpUrl+"\nReason: Same origin policy in effect"));}http.open(this.method||options.method||"GET",httpUrl,async);if(options.username){setRequestHeader("Authorization","Basic "+apf.crypto.Base64.encode(options.username+":"+options.password));}setRequestHeader("X-Requested-With","XMLHttpRequest");if(!options.headers||!options.headers["Content-type"]){setRequestHeader("Content-type",options.contentType||this.contentType||(this.useXML||options.useXML?"text/xml":"text/plain"));}if(autoroute){setRequestHeader("X-Route-Request",url);setRequestHeader("X-Proxy-Request",url);setRequestHeader("X-Compress-Response","gzip");}}catch(e){errorFound=e.message;}if(errorFound){var useOtherXH=false;if(!useOtherXH&&this.autoroute&&!autoroute){this.shouldAutoroute=true;options.autoroute=true;return this.get(url,options);}if(!useOtherXH){var noClear=options.callback?options.callback(null,apf.ERROR,{userdata:options.userdata,http:http,url:url,tpModule:this,id:id,message:"Permission denied accessing remote resource: "+url+"\nMessage: "+errorFound}):false;if(!noClear){this.clearQueueItem(id);}return;}}if(this.$headerHook){this.$headerHook(http);}if(options.headers){for(var name in options.headers){setRequestHeader(name,options.headers[name]);}}function handleError(){var msg=self.navigator&&self.navigator.onLine?"File or Resource not available "+url:"Browser is currently working offline";var state=self.navigator&&navigator.onLine?apf.ERROR:apf.TIMEOUT;var noClear=options.callback?options.callback(null,state,{userdata:options.userdata,http:http,url:url,tpModule:_self,id:id,message:msg}):false;if(!noClear){_self.clearQueueItem(id);}}function send(isLocal){var hasError;if(apf.isIE&&isLocal){var oldWinOnerror=window.onerror;window.onerror=function(){if(arguments.caller.callee==send){window.onerror=oldWinOnerror;return true;}else{window.onerror=oldWinOnerror;if(oldWinOnerror){return oldWinOnerror.apply(window,arguments);}}};http.send(data);window.onerror=oldWinOnerror;}else{try{http.send(data);}catch(e){hasError=true;}}if(hasError){handleError();return;}}if(!async){send.call(this);return this.receive(id);}else{if(apf.loadsLocalFilesSync&&location.protocol=="file:"&&url.indexOf("http://")==-1){$setTimeout(function(){send.call(_self,true);});}else{send.call(_self);}return id;}};if(!this.exec){this.exec=function(method,args,callback,options){if(!options){options={};}var url=args[0],query="";if(!options.method){options.method=method.toUpperCase();}if(!options.callback){options.callback=callback;}this.contentType="application/x-www-form-urlencoded";this.$get(apf.getAbsolutePath(apf.config.baseurl,url),options.method=="GET"?options:apf.extend({data:query},options));};}this.receive=function(id){if(!this.queue[id]){return false;}var qItem=this.queue[id],http=qItem.http,callback=qItem.callback;if(self.navigator&&navigator.onLine===false&&(location.protocol!="file:"||qItem.url.indexOf("http://")>-1)){return false;}if(qItem.async){try{if(http.status){}}catch(e){var _self=this;return $setTimeout(function(){_self.receive(id);},10);}}var errorMessage=[],extra={tpModule:this,http:http,status:http.status,url:qItem.url,callback:callback,id:id,retries:qItem.retries||0,userdata:qItem.options.userdata};if(http.status>600){return this.$timeout(id);}extra.data=qItem.options.useJSON?eval("("+http.responseText+")"):http.responseText;if(http.status>=400&&http.status<600||http.status<10&&(http.status!=0||!apf.isIE&&!http.responseText)){errorMessage.push("HTTP error ["+id+"]:"+http.status+"\n"+http.responseText);}if(qItem.options.useXML||this.useXML){if((http.responseText||"").replace(/^[\s\n\r]+|[\s\n\r]+$/g,"")==""){errorMessage.push("Received an empty XML document (0 bytes)");}else{try{var xmlDoc=(http.responseXML&&http.responseXML.documentElement)?apf.xmlParseError(http.responseXML):apf.getXmlDom(http.responseText);if(!apf.supportNamespaces){xmlDoc.setProperty("SelectionLanguage","XPath");}extra.data=xmlDoc.documentElement;}catch(e){errorMessage.push("Received invalid XML\n\n"+e.message);}}}if(errorMessage.length){extra.message=errorMessage.join("\n");if(!callback||!callback(extra.data,apf.ERROR,extra)){this.clearQueueItem(id);}return;}if(!callback||!callback(extra.data,apf.SUCCESS,extra)){this.clearQueueItem(id);}return extra.data;};this.$timeout=function(id){if(!this.queue[id]){return false;}var qItem=this.queue[id],http=qItem.http;try{if(http.status){}}catch(e){var _self=this;return $setTimeout(function(){_self.$timeout(id);},10);}var callback=qItem.callback;http.abort();var extra;var noClear=callback?callback(null,apf.TIMEOUT,extra={userdata:qItem.options.userdata,http:http,url:qItem.url,tpModule:this,id:id,message:"HTTP Call timed out",retries:qItem.retries||0}):false;if(!noClear){this.clearQueueItem(id);}};this.retryTimeout=function(extra,state,amlNode,oError,maxRetries){if(state==apf.TIMEOUT&&extra.retries<(maxRetries||apf.maxHttpRetries)){return extra.tpModule.retry(extra.id);}oError=oError||new Error(apf.formatErrorString(0,this,"Communication "+(state==apf.TIMEOUT?"timeout":"error"),"Url: "+extra.url+"\nInfo: "+extra.message));if((amlNode||apf).dispatchEvent("error",apf.extend({error:oError,state:state,extra:extra,bubbles:true},extra))===false){return 2;}};this.clearQueueItem=function(id){if(!this.queue[id]){return false;}if(apf.releaseHTTP&&!apf.isGecko){apf.releaseHTTP(this.queue[id].http);}this.queue[id]=null;delete this.queue[id];return true;};this.retry=function(id){if(!this.queue[id]){return false;}var qItem=this.queue[id];qItem.retries++;qItem.options.id=id;this.get(qItem.url,qItem.options);return true;};this.cancel=function(id){if(id===null){id=this.queue.length-1;}if(!this.queue[id]){return false;}if(apf.isGecko){this.queue[id].http.abort();}this.clearQueueItem(id);};if(!this.$loadAml&&!this.instantiate&&!this.call){this.$loadAml=function(x){var receive=this["receive"];for(var i=0,l=this.childNodes.length;i<l;i++){if(this.childNodes[i].nodeType!=1){continue;}var url=this.childNodes[i].getAttribute("url"),callback=self[this.childNodes[i].getAttribute("receive")||receive],options={useXML:this.childNodes[i].getAttribute("type")=="XML",async:!apf.isFalse(this.childNodes[i].getAttribute("async"))};this[this.childNodes[i].getAttribute("name")]=function(data,userdata){options.userdata=userdata;options.data=data;return this.get(url,options);};}};this.instantiate=function(x){var url=x.getAttribute("src"),options={async:x.getAttribute("async")!="false",nocache:true};this.getURL=function(data,userdata){options.data=data;options.userdata=userdata;options.callback=this.callbacks.getURL;return this.get(url,options);};var name="http"+Math.round(Math.random()*100000);apf.setReference(name,this);return name+".getURL()";};this.call=function(method,args){this[method].call(this,args);};}};apf.Init.run("http");apf.DOMParser=function(){};apf.DOMParser.prototype=new (function(){this.caseInsensitive=true;this.preserveWhiteSpace=false;this.$shouldWait=0;var c=[/\<\!(DOCTYPE|doctype)[^>]*>/,/&nbsp;/g,/<\s*\/?\s*(?:\w+:\s*)[\w-]*[\s>\/]/g],b="//@*[not(contains(local-name(), '.')) and not(translate(local-name(), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz') = local-name())]";this.parseFromString=function(o,r,k){var n;if(this.caseInsensitive){var q=o.replace(c[0],"").replace(c[2],function(s){return s.toLowerCase();});if(!this.supportNamespaces){q=q.replace(/xmlns\=\"[^"]*\"/g,"");}n=apf.getXmlDom(q,null,this.preserveWhiteSpace||apf.debug).documentElement;var m,d,g=n.selectNodes(b);for(m=0,d=g.length;m<d;m++){(g[m].ownerElement||g[m].selectSingleNode("..")).setAttribute(g[m].nodeName.toLowerCase(),g[m].nodeValue);}}else{n=apf.getXmlDom(o,null,this.preserveWhiteSpace||apf.debug).documentElement;}return this.parseFromXml(n,k);};this.parseFromXml=function(g,k){var H,d,A,y;if(!k){k={};}if(!k.delayedRender&&!k.include){if(k.doc){H=k.doc;d=k.docFrag||H.createDocumentFragment();}else{H=new apf.AmlDocument();H.$aml=g;H.$domParser=this;}if(k.host){H.$parentNode=k.host;}A=this.$createNode(H,g.nodeType,g);(d||H).appendChild(A);if(k.htmlNode){A.$int=k.htmlNode;}}else{A=k.amlNode;H=k.doc;if(k.include){var B=A.childNodes;var u=B.indexOf(k.beforeNode);var s=u?B.splice(u,B.length-u):[];}}this.$parseContext=[A,k];var C,x={},r=[],m=this;(function t(K,n){var L,P,J,O,I=K.childNodes,N=0,M=n.length;for(;N<M;N++){P=m.$createNode(H,(J=n[N]).nodeType,J);if(!P){continue;}I[L=I.length]=P;P.parentNode=K;if(L>0){(P.previousSibling=I[L-1]).nextSibling=P;}if(!P.render&&P.canHaveChildren&&(O=J.childNodes).length){t(P,O);}if(P.$parsePrio){if(P.$parsePrio=="001"){P.dispatchEvent("DOMNodeInsertedIntoDocument");continue;}(x[P.$parsePrio]||(r.push(P.$parsePrio)&&(x[P.$parsePrio]=[]))).push(P);}}K.firstChild=I[0];K.lastChild=I[L];})(A,g.childNodes);if(k.include&&s.length){var o=B.length-1;B.push.apply(B,s);var q=B[o];var w=B[o+1];(w.previousSibling=q).nextSibling=w;A.lastChild=B[B.length-1];}if(k.delay){A.$parseOptions={prios:r,nodelist:x};return(d||H);}r.sort();var G,F,E,D;for(G=0,E=r.length;G<E;G++){C=x[r[G]];for(F=0,D=C.length;F<D;F++){C[F].dispatchEvent("DOMNodeInsertedIntoDocument");}}if(this.$shouldWait){return(d||H);}if(k.timeout){$setTimeout(function(){m.$continueParsing(A,k);});}else{this.$continueParsing(A,k);}return(d||H);};this.$callCount=0;this.$continueParsing=function(g,t){if(this.$shouldWait&&--this.$shouldWait!=0){return false;}if(!t){t={};}this.$callCount++;if(g.$parseOptions){var q=g.$parseOptions.prios,s=g.$parseOptions.nodelist,o,n,m,k,d;delete g.$parseOptions;q.sort();for(o=0,m=q.length;o<m;o++){nodes=s[q[o]];for(n=0,k=nodes.length;n<k;n++){if(!(d=nodes[n]).parentNode||d.$amlLoaded){continue;}nodes[n].dispatchEvent("DOMNodeInsertedIntoDocument");}}}if(!t.ignoreSelf&&!g.$amlLoaded){g.dispatchEvent("DOMNodeInsertedIntoDocument");}(function r(w){var y,A;for(var x=0,u=w.length;x<u;x++){if(!(y=w[x]).$parsePrio&&!y.$amlLoaded){y.dispatchEvent("DOMNodeInsertedIntoDocument");}if(!y.render&&(A=y.childNodes).length){r(A);}}})(g.childNodes);if(!--this.$callCount&&!t.delay){apf.queue.empty();}if(t.callback){t.callback.call(g.ownerDocument);}delete this.$parseContext;};this.$createNode=function(C,s,D,k,B,w){var g;switch(s){case 1:var d,u;if(D){if((k=D.namespaceURI||apf.ns.xhtml)&&!(u=C.$prefixes[k])){C.$prefixes[u=D.prefix||D.scopeName||""]=k;C.$namespaceURIs[k]=u;if(!C.namespaceURI&&!u){C.namespaceURI=k;C.prefix=u;}}B=D.baseName||D.localName||D.tagName.split(":").pop();}else{u=C.$prefixes[k]||"";}var r=apf.namespaces[k].elements;g=new (r[B]||r["@default"])(null,B);g.prefix=u||"";g.namespaceURI=k;g.tagName=u?u+":"+B:B;if(D){if(d=D.getAttribute("id")){g.$propHandlers.id.call(g,g.id=d);}var y=D.attributes,m;for(var A,t=0,q=y.length;t<q;t++){g.attributes.push(new apf.AmlAttr(g,(m=(A=y[t]).nodeName),A.nodeValue));if(m=="render"){g.render=true;}}}break;case 2:g=new apf.AmlAttr();g.name=g.nodeName=B;if(w||(w=D&&D.nodeValue)){g.value=g.nodeValue=w;}if(D){if(D.namespaceURI&&!(g.prefix=C.$namespaceURIs[g.namespaceURI=D.namespaceURI])){C.$prefixes[g.prefix=D.prefix||D.scopeName]=g.namespaceURI;}}else{g.prefix=C.$prefixes[k];}break;case 3:if(D){w=D&&D.nodeValue;}if(!this.preserveWhiteSpace&&!(w||"").trim()){return;}g=new apf.AmlText();g.nodeValue=w||D&&D.nodeValue;break;case 7:var x=B||D&&D.nodeName;g=new apf.aml.processingInstructions[x]();g.target=g.nodeName=x;g.data=g.nodeValue=w||D&&D.nodeValue;break;case 4:g=new apf.AmlCDATASection();g.nodeValue=w||D&&D.nodeValue;break;case 5:g=new apf.AmlNode();g.nodeType=s;break;case 6:g=new apf.AmlNode();g.nodeType=s;break;case 8:g=new apf.AmlComment();g.nodeValue=w||D&&D.nodeValue;break;case 9:g=new apf.AmlDocument();g.$domParser=this;break;case 10:g=new apf.AmlNode();g.nodeType=s;break;case 11:g=new apf.AmlDocumentFragment();break;}g.ownerDocument=C;g.$aml=D;return g;};})();apf.AmlNamespace=function(){this.elements={};this.processingInstructions={};};apf.AmlNamespace.prototype={setElement:function(b,c){return this.elements[b]=c;},setProcessingInstruction:function(c,b){this.processingInstructions[c]=b;}};apf.aml=new apf.AmlNamespace();apf.setNamespace("http://ajax.org/2005/aml",apf.aml);apf.__AMLNODE__=1<<14;apf.AmlNode=function(){this.$init(function(){this.childNodes=[];});};(function(){this.toString=function(){if(this.nodeName){return"["+this.nodeName.uCaseFirst()+" Node]";}return"["+this.localName.uCaseFirst()+" Element Node, <"+(this.prefix?this.prefix+":":"")+this.localName+" "+this.attributes.join(" ")+" /> : "+(this.name||this.$uniqueId||"")+"]";};this.$regbase=this.$regbase|apf.__AMLNODE__;this.NODE_ELEMENT=1;this.NODE_ATTRIBUTE=2;this.NODE_TEXT=3;this.NODE_CDATA_SECTION=4;this.NODE_ENTITY_REFERENCE=5;this.NODE_ENTITY=6;this.NODE_PROCESSING_INSTRUCTION=7;this.NODE_COMMENT=8;this.NODE_DOCUMENT=9;this.NODE_DOCUMENT_TYPE=10;this.NODE_DOCUMENT_FRAGMENT=11;this.NODE_NOTATION=12;this.ownerDocument=null;this.nodeValue="";this.namespaceURI="";this.appendChild=this.insertBefore=function(g,r,d){if(this.nodeType==this.NODE_DOCUMENT){if(this.childNodes.length){throw new Error(apf.formatErrorString(0,this,"Insertbefore DOM operation","Only one top level element is allowed in an AML document."));}else{this.documentElement=g;}}if(this==g){throw new Error(apf.formatErrorString(0,this,"Insertbefore DOM operation","Cannot append node as a child of itself."));}if(g.nodeType==this.NODE_DOCUMENT_FRAGMENT){var b=g.childNodes.slice(0);for(var m=0,k=b.length;m<k;m++){this.insertBefore(b[m],r);}return g;}var c=g.parentNode==this,o=g.$pHtmlNode,t=g.parentNode,n=-1,q=this;if(r){n=this.childNodes.indexOf(r);if(n<0){return false;}}if(!g.ownerDocument){g.ownerDocument=this.ownerDocument||apf.ownerDocument;}if(g.parentNode){g.removeNode(c,d);}g.parentNode=this;if(r){n=this.childNodes.indexOf(r);}if(r){g.nextSibling=r;g.previousSibling=r.previousSibling;r.previousSibling=g;if(g.previousSibling){g.previousSibling.nextSibling=g;}}if(n>=0){this.childNodes=this.childNodes.slice(0,n).concat(g,this.childNodes.slice(n));}else{n=this.childNodes.push(g)-1;g.nextSibling=null;if(n>0){g.previousSibling=this.childNodes[n-1];g.previousSibling.nextSibling=g;}else{g.previousSibling=null;}}this.firstChild=this.childNodes[0];this.lastChild=this.childNodes[this.childNodes.length-1];var u=!g.$amlLoaded;function w(){g.$pHtmlNode=q.canHaveChildren?q.$int:document.body;var x=r;if(!u&&!d&&g.$ext&&!g.$coreHtml){x=r;while(x&&!(x.$altExt||x.$ext)){x=x.nextSibling;}g.$pHtmlNode.insertBefore(g.$altExt||g.$ext,x&&(x.$altExt||x.$ext)||null);}g.dispatchEvent("DOMNodeInserted",{$beforeNode:r,relatedNode:q,$isMoveWithinParent:c,$oldParentHtmlNode:o,$oldParent:t,bubbles:true});if(u&&!d&&r&&g.$ext&&!g.$coreHtml){x=r;while(x&&!(x.$altExt||x.$ext)){x=x.nextSibling;}g.$pHtmlNode.insertBefore(g.$altExt||g.$ext,x&&(x.$altExt||x.$ext)||null);}}var s=this.nodeType==this.NODE_DOCUMENT?this:this.ownerDocument;if(!s||s.$domParser.$shouldWait){return g;}if(this.nodeType==this.NODE_DOCUMENT_FRAGMENT){return;}if(u){(this.ownerDocument||this).$domParser.$continueParsing(g,{delay:true});}w();return g;};this.removeNode=function(c,b){if(!this.parentNode||!this.parentNode.childNodes){return this;}this.parentNode.childNodes.remove(this);if(this.$amlLoaded&&!apf.isDestroying){this.dispatchEvent("DOMNodeRemoved",{relatedNode:this.parentNode,bubbles:true,$doOnlyAdmin:c});if(!b&&!c&&this.$ext&&this.$ext.parentNode){this.$ext.parentNode.removeChild(this.$ext);}}if(this.parentNode.firstChild==this){this.parentNode.firstChild=this.nextSibling;}if(this.parentNode.lastChild==this){this.parentNode.lastChild=this.previousSibling;}if(this.nextSibling){this.nextSibling.previousSibling=this.previousSibling;}if(this.previousSibling){this.previousSibling.nextSibling=this.nextSibling;}this.$pHtmlNode=this.parentNode=this.previousSibling=this.nextSibling=null;return this;};this.removeChild=function(b){b.removeNode();return this;};this.replaceChild=function(){};this.cloneNode=function(b){if(b&&this.nodeType==1){return this.ownerDocument.$domParser.parseFromXml(this,{doc:this.ownerDocument,delay:true}).childNodes[0];}else{return this.ownerDocument.$domParser.$createNode(this.ownerDocument,this.nodeType,this);}};this.canDispatch=function(b,c){};this.compareDocumentPosition=function(b){};this.hasAttributes=function(){return this.attributes&&this.attributes.length;};this.hasChildNodes=function(){return this.childNodes&&this.childNodes.length;};this.isDefaultNamespace=function(b){if(c.nodeType==1){if(!this.prefix){return this.namespaceURI==b;}}var c=this.parentNode||this.ownerElement;return c&&c.isDefaultNamespace(b);};this.lookupNamespaceURI=function(c){if(b.nodeType==1){if(this.namespaceURI&&c==this.prefix){return this.namespaceURI;}}var b=this.parentNode||this.ownerElement;return b&&b.lookupNamespaceURI(c);};this.lookupPrefix=function(b){if(this.nodeType==1){if(b==this.namespaceURI&&this.prefix){return this.prefix;}}var c=this.parentNode||this.ownerElement;return c&&c.lookupPrefix(b);};this.normalize=function(){};this.selectNodes=function(c,b){if(!apf){return;}if(!apf.XPath){apf.runXpath();}return apf.XPath.selectNodes(c,b||(this.nodeType==9?this.documentElement:this));};this.selectSingleNode=function(c,b){if(!apf){return;}if(!apf.XPath){apf.runXpath();}return apf.XPath.selectNodes(c,b||(this.nodeType==9?this.documentElement:this))[0];};}).call(apf.AmlNode.prototype=new apf.Class());apf.AmlElement=function(d,b){var c=this.$init;this.$init=function(k,g,o){this.$supportedProperties=this.$supportedProperties.slice();var r,n,m;n=this.$propHandlers;m=this.$propHandlers={};for(r in n){m[r]=n[r];}n=this.$booleanProperties;m=this.$booleanProperties={};for(r in n){m[r]=n[r];}c.call(this,k,g,o);};this.$init(function(o,m,q){this.$events={};this.$inheritProperties={};this.attributes=new apf.AmlNamedNodeMap(this);this.nodeFunc=m;this.localName=o;if(q){var k,r,n,g;if(q.childNodes){k=q.childNodes;delete q.childNodes;}for(r in q){if(r=="htmlNode"){continue;}this.attributes.push(new apf.AmlAttr(this,r,q[r]));}if(!this.ownerDocument){this.ownerDocument=apf.document;this.prefix="a";this.namespaceURI=apf.ns.aml;this.tagName=o;}if(k){this.childNodes=k;for(n=0,g=k.length;n<g;n++){k[n].nextSibling=k[n+1]||null;k[n].previousSibling=k[n-1]||null;k[n].parentNode=this;}this.firstChild=k[0]||null;this.lastChild=k[k.length-1]||null;}this.$aml=apf.$emptyNode||(apf.$emptyNode=apf.getXml("<empty />"));}});if(b){c.call(this,b,apf.NODE_HIDDEN,d);}};(function(){this.nodeType=this.NODE_ELEMENT;this.canHaveChildren=true;this.$propHandlers={id:function(c){if(this.name==c){return;}if(self[this.name]==this){self[this.name]=null;}if(!self[c]||!self[c].hasFeature){try{self[c]=this;}catch(b){}}apf.nameserver.register(this.localName,c,this);this.name=c;}};this.$booleanProperties={};this.$inheritProperties={};this.$supportedProperties=[];this.getElementsByTagName=function(k,n){k=k.toLowerCase();var m,g,c,d=this.childNodes,b=[];for(g=0,c=d.length;g<c;g++){if((m=d[g]).nodeType!=1){continue;}if(m.tagName==k||k=="*"){b.push(m);}if(!n&&m.nodeType==1){b=b.concat(m.getElementsByTagName(k));}}return b;};this.getElementsByTagNameNS=function(k,g,o){g=g.toLowerCase();var n,m,c,d=this.childNodes,b=[];for(m=0,c=d.length;m<c;m++){if((n=d[m]).nodeType!=1){continue;}if(n.namespaceURI==k&&(n.localName==g||g=="*")){b.push(n);}if(!o&&n.nodeType==1){b=b.concat(n.getElementsByTagNameNS(k,g));}}return b;};this.setAttribute=function(d,k,g){d=d.toLowerCase();var b=this.attributes.getNamedItem(d);if(!b){this.attributes.push(b=new apf.AmlAttr(this,d,k));if(!this.$amlLoaded){return;}if(g){b.$setValue(k);}else{b.dispatchEvent("DOMNodeInsertedIntoDocument",{relatedNode:this});b.dispatchEvent("DOMNodeInserted",{relatedNode:this,bubbles:true});}return;}var c=b.nodeValue;b.$setValue(k);if(g||!this.$amlLoaded){return;}b.$triggerUpdate(null,c);};this.setAttributeNode=function(b){this.attributes.setNamedItem(b);};this.setAttributeNS=function(c,b,d){return this.setAttribute(b,d);};this.hasAttribute=function(b){return this.getAttributeNode(b)?true:false;};this.hasAttributeNS=function(c,b){return this.hasAttribute(b);};this.removeAttribute=function(b){this.attributes.removeNamedItem(b);return this;};this.removeAttributeNS=function(c,b){return this.removeAttribute(b);};this.removeAttributeNode=function(b){this.attributes.removeNamedItem(b.name);};this.getAttribute=function(c,b){var d=this.attributes.getNamedItem(c);return d?(b?d.inheritedValue||d.nodeValue:d.nodeValue):null;};this.getAttributeNode=function(b){return this.attributes.getNamedItem(b);};this.getBoundingClientRect=function(){return new apf.AmlTextRectangle(this);};this.querySelector=function(){};this.querySelectorAll=function(){};this.scrollIntoView=function(){};this.replaceMarkup=function(b,c){if(!c){c={};}if(!c.$intAML){c.$intAML=this.$aml;}if(!c.$int){c.$int=this.$int;}c.clear=true;for(var d=this.childNodes.length-1;d>=0;d--){var g=this.childNodes[d];if(g.destroy){g.destroy(true);}if(g.$ext!=this.$int){apf.destroyHtmlNode(g.$ext);}}this.childNodes.length=0;this.$int.innerHTML="<div class='loading'>loading...</div>";this.insertMarkup(b,c);};this.insertMarkup=function(d,g){var c=this;var b=new apf.XiInclude();if(d.trim().charAt(0)=="<"){d=apf.getXml(d);}b.setAttribute("href",d);if(g&&g.clear){b.setAttribute("clear",true);}b.options=g;b.callback=g&&g.callback||function(){c.dispatchEvent("afteramlinserted",{src:d});};this.appendChild(b);};this.serialize=function(c){if(c||!this.firstChild){return"<"+(this.prefix?this.prefix+":"+this.localName+" xmlns:"+this.prefix+'="'+this.namespaceURI+'"':this.localName)+(this.attributes&&this.attributes.length?" ":"")+(this.attributes&&this.attributes.join(" ")||"")+"/>";}else{var d=["<"+(this.prefix?this.prefix+":"+this.localName+" xmlns:"+this.prefix+'="'+this.namespaceURI+'"':this.localName)+(this.attributes&&this.attributes.length?" ":"")+(this.attributes&&this.attributes.join(" ")||"")+">"];for(var b=this.firstChild;b;b=b.nextSibling){d.push(b.serialize());}return d.join("")+"</"+(this.prefix?this.prefix+":"+this.localName:this.localName)+">";}};this.$setInheritedAttribute=function(g){var d,b=this,c=false;d=b.getAttribute(g);if(!d){b=b.parentNode;while(b&&b.nodeType==1&&!(d=b.getAttribute(g,true))){b=b.parentNode;}c=true;}if(!d&&apf.config&&g){d=apf.config[g];}if(d){this.$clearDynamicProperty(g);if(c){this.$inheritProperties[g]=2;}if(typeof d=="string"&&(d.indexOf("{")>-1||d.indexOf("[")>-1)){this.$setDynamicProperty(g,d);}else{this.setProperty(g,d,false,false,2);}}return d;};this.addEventListener("DOMNodeInserted",function(g){if(g.currentTarget!=this||g.$isMoveWithinParent||!g.$oldParent){return;}var d,m;var b=apf.config.$inheritProperties;for(var k in b){d=apf.getInheritedAttribute(g.$oldParent,k);m=apf.getInheritedAttribute(this.parentNode,k);if(d!=m){(function c(q){var r,o,s,u;for(r=0,o=q.length;r<o;r++){s=q[r];if(s.nodeType!=1&&s.nodeType!=7){continue;}u=s.$inheritProperties[k];if(b[k]==1&&!u){c(s.childNodes);}else{if(!(u<0)){if(u==3){var t=s[k];s[k]=null;}s.setProperty(k,u!=3?m:t,false,false,u);}}}})([this]);}}});this.$handlePropSet=function(g,d,c){if(d&&this.$booleanProperties[g]){d=apf.isTrue(d);}this[g]=d;var b;return(b=this.$propHandlers&&this.$propHandlers[g]||this.nodeFunc==apf.NODE_VISIBLE&&apf.GuiElement&&apf.GuiElement.propHandlers[g]||null)&&b.call(this,d,g,c);};this.addEventListener("DOMNodeInsertedIntoDocument",function(n){var s,k,b,o=this.attributes;var g=apf.nameserver.getAll("defaults_"+this.localName);if(g.length){for(var c=0,m=g.length;c<m;c++){var r=g[c].attributes,q;for(k=0,b=r.length;k<b;k++){s=o.getNamedItem((q=r[k]).nodeName);if(s){if(s.value){continue;}s.$setValue(q.nodeValue);this.$inheritProperties[q.nodeName]=2;}else{this.attributes.push(new apf.AmlAttr(this,q.nodeName,q.nodeValue));this.$inheritProperties[q.nodeName]=2;}}}}for(k=0,b=o.length;k<b;k++){o[k].dispatchEvent("DOMNodeInsertedIntoDocument");}this.$amlLoaded=true;},true);}).call(apf.AmlElement.prototype=new apf.AmlNode());apf.AmlCharacterData=function(){this.data="";this.length=0;this.$init(true);this.appendData=function(b){this.dispatchEvent("DOMCharacterDataModified",{value:b});};this.deleteData=function(c,b){this.dispatchEvent("DOMCharacterDataModified",{offset:c,count:b});};this.insertData=function(c,b){this.dispatchEvent("DOMCharacterDataModified",{offset:c,count:b});};this.replaceData=function(d,b,c){this.dispatchEvent("DOMCharacterDataModified",{offset:d,count:b,value:c});};this.substringData=function(c,b){};};apf.AmlCharacterData.prototype=new apf.AmlNode();apf.AmlText=function(b){this.$init(b);};(function(){this.nodeType=this.NODE_TEXT;this.nodeName="#text";this.serialize=function(){return apf.xmlentities(this.nodeValue).replace(/</g,"&lt;").replace(/>/g,"&gt;");};this.$setValue=function(b){this.dispatchEvent("DOMCharacterDataModified",{bubbles:true,prevValue:this.nodeValue,newValue:this.nodeValue=b});if(this.$amlLoaded&&this.$ext){this.$ext.nodeValue=b;}};this.addEventListener("DOMNodeInsertedIntoDocument",function(c){var d;if(!(d=this.parentNode.$int)||this.parentNode.hasFeature(apf.__CHILDVALUE__)){return;}this.$amlLoaded=true;var b=this.nodeValue;if(apf.config.liveText&&!this.parentNode.hasFeature(apf.__CHILDVALUE__)&&(b.indexOf("{")>-1||b.indexOf("[")>-1)){this.$supportedProperties=[];this.$propHandlers={};this.$booleanProperties={};this.$inheritProperties={};this.$propHandlers.calcdata=apf.LiveMarkupPi.prototype.$propHandlers.calcdata;this.$setInheritedAttribute=apf.AmlElement.prototype.$setInheritedAttribute;this.implement(apf.StandardBinding);d.appendChild(this.$ext=document.createElement("span"));this.$setDynamicProperty("calcdata",this.nodeValue);return;}if(apf.hasTextNodeWhiteSpaceBug){var b=b.replace(/[\t\n\r ]+/g," ");if(b&&b!=" "){this.$ext=d.appendChild(d.ownerDocument.createTextNode(b));}}else{this.$ext=d.appendChild(d.ownerDocument.createTextNode(b));}},true);}).call(apf.AmlText.prototype=new apf.AmlCharacterData());apf.AmlAttr=function(d,b,c){this.$init();if(d){this.ownerElement=d;this.ownerDocument=d.ownerDocument;}this.nodeName=this.name=b;this.nodeValue=this.value=c;};(function(){this.nodeType=this.NODE_ATTRIBUTE;this.MODIFICATION=1;this.ADDITION=2;this.REMOVAL=3;this.serialize=this.toString=function(){return this.name+'="'+apf.xmlentities(String(this.value)).replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"';};this.$setValue=function(b){this.nodeValue=this.value=b;this.specified=true;this.ownerElement.dispatchEvent("DOMAttrModified",{relatedNode:this,attrChange:this.MODIFICATION,attrName:this.name,newValue:b,prevValue:this.$lastValue||"",bubbles:true});this.$lastValue=b;};this.$triggerUpdate=function(k,c){var b=this.name,g=this.value||this.nodeValue,d=this.ownerElement;if(b=="id"&&!this.specified&&d.id){this.specified=true;return;}if(b.substr(0,2)=="on"){if(d.$events[b]){d.removeEventListener(b.replace(/^on/,""),d.$events[b]);}if(g){d.addEventListener(b,(d.$events[b]=(typeof g=="string"?apf.lm.compile(g,{event:true,parsecode:true}):g)));}return;}if(this.specified){d.$clearDynamicProperty(b);}if(typeof g=="string"&&(d.$attrExcludePropBind[b]||(g.indexOf("{")>-1||g.indexOf("[")>-1))){d.$setDynamicProperty(b,g);}else{d.setProperty(b,g);}if(this.specified){d.dispatchEvent("DOMAttrModified",{relatedNode:this,attrChange:this.MODIFICATION,attrName:b,newValue:g,prevValue:this.$lastValue||"",bubbles:true});}else{this.specified=true;}this.$lastValue=g;};this.addEventListener("DOMNodeInsertedIntoDocument",this.$triggerUpdate);}).call(apf.AmlAttr.prototype=new apf.AmlNode());apf.AmlCDATASection=function(b){this.nodeType=this.NODE_CDATA_SECTION;this.nodeName="#cdata-section";this.$init(b);};apf.AmlCDATASection.prototype=new apf.AmlText(true);apf.AmlCDATASection.prototype.serialize=function(){return"<![CDATA["+this.nodeValue+"]]>";};apf.AmlComment=function(b){this.nodeType=this.NODE_COMMENT;this.nodeName="#comment";this.$init(b);};(function(){this.serialize=function(){return"<!--"+this.nodeValue+"-->";};this.$setValue=function(b){this.dispatchEvent("DOMCharacterDataModified",{bubbles:true,newValue:b,prevValue:this.nodeValue});};}).call(apf.AmlComment.prototype=new apf.AmlCharacterData());apf.AmlConfiguration=function(b){this.parameterNames=[];this.$init(b);};(function(){this.setParameter=this.setProperty;this.getParameter=this.getProperty;this.canSetParameter=function(b,c){return this.parameterNames.indexOf(b)>-1;};}).call(apf.AmlConfiguration.prototype=new apf.Class());apf.AmlDocument=function(){this.$prefixes={};this.$namespaceURIs={};this.domConfig=new apf.AmlConfiguration();this.$init();};(function(){this.nodeType=this.NODE_DOCUMENT;this.nodeFunc=apf.NODE_HIDDEN;this.nodeName="#document";this.$amlLoaded=true;this.activeElement=null;this.doctype=null;this.domConfig=null;this.implementation=null;this.characterSet=apf.characterSet;this.documentElement=null;this.getElementById=function(b){return self[b];};this.getElementsByTagName=function(c){var d,b=(d=this.documentElement).getElementsByTagName(c);if(c=="*"||d.tagName==c){b.unshift(d);}return b;};this.getElementsByTagNameNS=function(d,c){var g,b=(g=this.documentElement).getElementsByTagNameNS(d,c);if(c=="*"||g.tagName==c&&g.namespaceURI==d){b.unshift(g);}return b;};this.createElement=function(b){return this.$domParser.$createNode(this,this.NODE_ELEMENT,null,this.namespaceURI,b);};this.createElementNS=function(b,c){return this.$domParser.$createNode(this,this.NODE_ELEMENT,null,b,c);};this.importNode=function(c,b){if(b&&c.nodeType==1){return this.$domParser.parseFromXml(c,{doc:this,delay:true}).childNodes[0];}else{return this.$domParser.$createNode(this,c.nodeType,c);}};this.createAttribute=function(b){return this.$domParser.$createNode(this,this.NODE_ATTRIBUTE,null,this.nameSpaceURI,b);};this.createAttributeNS=function(b,c){return this.$domParser.$createNode(this,this.NODE_ATTRIBUTE,null,b,c);};this.createEvent=function(){return new apf.AmlEvent();};this.createComment=function(b){return this.$domParser.$createNode(this,this.NODE_COMMENT,null,null,null,b);};this.createProcessingInstruction=function(c,b){return this.$domParser.$createNode(this,this.NODE_PROCESSING_INSTRUCTION,null,null,c,b);};this.createCDATASection=function(b){return this.$domParser.$createNode(this,this.NODE_CDATA_SECTION,null,null,null,b);};this.createTextNode=function(b){return this.$domParser.$createNode(this,this.NODE_TEXT,null,null,null,b);};this.createDocumentFragment=function(){return this.$domParser.$createNode(this,this.NODE_DOCUMENT_FRAGMENT);};this.querySelector=function(){};this.querySelectorAll=function(){};this.evaluate=function(k,g,d,m,c){var b=apf.XPath.selectNodes(k,g||this.documentElement);return{snapshotLength:b.length,snapshotItem:function(n){return b[n];}};};this.createNSResolver=function(b){return{};};this.hasFocus=function(){};}).call(apf.AmlDocument.prototype=new apf.AmlNode());apf.AmlDocumentFragment=function(b){this.$init(b);};apf.AmlDocumentFragment.prototype=new apf.AmlNode();apf.AmlDocumentFragment.prototype.nodeName="#document-fragment";apf.AmlDocumentFragment.prototype.nodeType=apf.AmlDocumentFragment.prototype.NODE_DOCUMENT_FRAGMENT;apf.AmlEvent=function(b,c){this.name=b;var d;for(d in c){this[d]=c[d];}};apf.AmlEvent.prototype={bubbles:false,cancelBubble:false,preventDefault:function(){this.returnValue=false;},stopPropagation:function(){this.cancelBubble=true;},stop:function(){this.returnValue=false;this.cancelBubble=true;}};apf.AmlNamedNodeMap=function(b){this.$host=b;};(function(){this.getNamedItem=function(b){for(var c=0;c<this.length;c++){if(this[c].name==b){return this[c];}}return false;};this.setNamedItem=function(g){var b=g.name;for(var d,c=this.length-1;c>=0;c--){if(this[c].name==b){this[c].ownerElement=null;this.splice(c,1);break;}}this.push(g);g.ownerElement=this.$host;g.ownerDocument=this.$host.ownerDocument;g.$triggerUpdate();};this.removeNamedItem=function(c){for(var g,d=this.length-1;d>=0;d--){if(this[d].name==c){g=this[d];this.splice(d,1);break;}}if(!g){return false;}var b=g.nodeValue;g.nodeValue=g.value="";g.$triggerUpdate(null,b);g.ownerElement=null;g.nodeValue=g.value=b;return g;};this.item=function(b){return this[b];};this.length=0;this.splice=function(g,d){for(var c=g,b=this.length-d;c<b;c++){this[c]=this[c+1];}delete this[c];this.length-=d;};this.push=function(b){this[this.length++]=b;return this.length;};this.join=function(k){var b=[];for(var m,d,g=0,c=this.length;g<c;g++){if((m=(d=this[g]).ownerElement)&&m.$inheritProperties[d.nodeName]!=2){b.push(this[g]);}}return b.join(k);};}).call(apf.AmlNamedNodeMap.prototype={});apf.AmlProcessingInstruction=function(b){this.$init(b);};(function(){this.nodeType=this.NODE_PROCESSING_INSTRUCTION;this.data=null;this.target=null;this.serialize=function(){return"<?"+this.target+"\n"+apf.xmlentities(this.nodeValue)+"\n?>";};this.reload=function(){this.$handlePropSet("data",this.data);};this.$attrExcludePropBind=apf.extend({calcdata:0},this.$attrExcludePropBind);this.getAttribute=function(){};this.$setInheritedAttribute=apf.AmlElement.prototype.$setInheritedAttribute;this.$supportedProperties=[];this.$propHandlers={};this.$booleanProperties={};this.$inheritProperties={};this.$setValue=function(b){this.setProperty("data",b);};this.$handlePropSet=function(d,c,b){this[d]=c;if(d=="data"){this.$clearDynamicProperty("calcdata");this.$setDynamicProperty("calcdata",c);}else{if(d=="target"){}else{if(this.$propHandlers[d]){this.$propHandlers[d].call(this,c,d);}}}};this.addEventListener("DOMNodeInsertedIntoDocument",function(b){var c=b.pHtmlNode;if(!c&&(this.parentNode.$bindingRule||!(c=this.parentNode.$int))){return;}c.appendChild(this.$ext=document.createElement("span"));this.$ext.host=this;this.$setDynamicProperty("calcdata",this.data);},true);this.$destroy=function(){this.$clearDynamicProperty("calcdata");this.$propHandlers.calcdata.call(this,"");};}).call(apf.AmlProcessingInstruction.prototype=new apf.AmlNode());apf.AmlSelection=function(d){this.$init();this.$ownerDocument=d;var c=this;var b=false;this.$monitorRange=function(){apf.queue.add("selrange"+this.$uniqueId,function(){var k=c.$ranges[0];c.anchorNode=k.startContainer;c.anchorOffset=k.startOffset;k=c.$ranges[c.rangeCount-1];c.focusNode=k.endContainer;c.focusOffset=k.endOffset;b=false;});b=true;};var g=false;this.$update=function(){if(!g){apf.queue.add("selupdate"+this.$uniqueId,function(){c.dispatchEvent("update");g=false;});g=true;}};};(function(){this.anchorNode=null;this.anchorOffset=0;this.focusNode=null;this.focusOffset=null;this.rangeCount=0;this.$ranges=[];this.toString=function(){return"[apf.AmlSelection]";};this.isCollapsed=function(){return !this.rangeCount||this.rangeCount==1&&this.$ranges[0].collapsed;};this.collapse=function(b,m,k){for(var g=0,c=this.$ranges.length;g<c;g++){(d=this.$ranges[g]).removeEventListener("update",this.$monitorRange);d.detach();}var d;this.$ranges=[d=new apf.AmlRange(this.ownerDocument)];d.addEventListener("update",this.$monitorRange);d.setStart(b,m);d.setEnd(b,m);this.rangeCount=1;this.focusNode=this.anchorNode=b;this.anchorOffset=this.focusOffset=m;if(!k){this.dispatchEvent("update");}};this.collapseToStart=function(){var b=this.$ranges[0];this.collapse(b.startContainer,b.startOffset);};this.collapseToEnd=function(){var b=this.$ranges[this.rangeCount-1];this.collapse(b.endContainer,b.endOffset);};this.selectAllChildren=function(b){this.collapse(b,0,true);var c=this.$ranges[0];c.selectNodeContents(parseNode);this.focusNode=this.anchorNode=b;this.anchorOffset=0;this.focusOffset=c.endOffset;this.$update();};this.deleteFromDocument=function(){for(var d=0,b=this.$ranges.length;d<b;d++){this.$ranges[d].deleteContents();}var c=this.$ranges[0];this.anchorNode=c.startContainer;this.anchorOffset=c.startOffset;c=this.$ranges[this.rangeCount-1];this.focusNode=c.endContainer;this.focusOffset=c.endOffset;this.$update();};this.getRangeAt=function(b){return this.$ranges[b];};this.addRange=function(b){this.rangeCount=this.$ranges.push(b);this.focusNode=b.endContainer;this.focusOffset=b.endOffset;b.addEventListener("update",this.$monitorRange);this.$update();return b;};this.removeRange=function(b){this.$ranges.remove(b);this.rangeCount=this.$ranges.length;b.removeEventListener("update",this.$monitorRange);var b=this.$ranges[0];this.anchorNode=b.startContainer;this.anchorOffset=b.startOffset;b=this.$ranges[this.rangeCount-1];this.focusNode=b.endContainer;this.focusOffset=b.endOffset;this.$update();};this.removeAllRanges=function(){for(var c,d=0,b=this.$ranges.length;d<b;d++){(c=this.$ranges[d]).removeEventListener("update",this.$monitorRange);c.detach();}this.$ranges=[];this.rangeCount=0;this.anchorNode=null;this.anchorOffset=0;this.focusNode=null;this.focusOffset=0;this.$update();};this.$getNodeList=function(){var b=[];for(var d,c=0;c<this.rangeCount;c++){b.push((d=this.$ranges[c]).startContainer.childNodes[d.startOffset]);}return b;};this.$selectList=function(c){this.removeAllRanges();for(var b=0;b<c.length;b++){this.addRange(new apf.AmlRange(this)).selectNode(c[b]);}};this.$getFirstNode=function(){var b;return(b=this.$ranges[0]).startContainer.childNodes[b.startOffset];};}).call(apf.AmlSelection.prototype=new apf.Class());apf.AmlTextRectangle=function(d){var b=this;function c(){var g=b.getAbsolutePosition(b.$ext);b.setProperty("left",g[0]);b.setProperty("top",g[1]);b.setProperty("right",document.documentElement.offsetWidth-g[0]);b.setProperty("bottom",document.documentElement.offsetWidth-g[1]);}d.addEventListener("prop.width",c);d.addEventListener("prop.height",c);d.addEventListener("prop.left",c);d.addEventListener("prop.top",c);c.call(d);};apf.AmlTextRectangle.prototype=new apf.Class();apf.xhtml=new apf.AmlNamespace();apf.setNamespace("http://www.w3.org/1999/xhtml",apf.xhtml);apf.XhtmlElement=function(d,c){this.$init(c||true,apf.NODE_VISIBLE,d);this.$xoe=this.addEventListener;this.addEventListener=this.$xae;this.removeEventListener=this.$xre;var b=this;this.$de=function(g){b.dispatchEvent(g.type,null,g);};};(function(){var b={contextmenu:1,keydown:1,keypress:1,keyup:1,DOMNodeInserted:2,DOMNodeInsertedIntoDocument:2,DOMNodeRemoved:2,DOMNodeRemovedFromDocument:2};this.$xae=function(d,c){this.$xoe.apply(this,arguments);if(b[d]>(this.editable?0:1)||d.substr(0,5)=="prop."){return;}if(this.$ext){if(d.substr(0,2)=="on"){d=d.substr(2);}apf.addListener(this.$ext,d,this.$de);}};this.$xre=function(d,c){apf.AmlElement.prototype.removeEventListener.apply(this,arguments);if(this.$ext){apf.removeListener(this.$ext,d,this.$de);}};this.$handlePropSet=function(d,m,k,c){if(this.$booleanProperties[d]){m=apf.isTrue(m);}this[d]=m;var g=this.$propHandlers&&this.$propHandlers[d]||apf.GuiElement.propHandlers[d];if(g){g.call(this,m,null,d);}else{if(this.$int&&(k||this.$amlLoaded)){this.$int.setAttribute(apf.isIE&&apf.isIE<8&&d=="class"?"className":d,m);}}};this.addEventListener("DOMNodeInsertedIntoDocument",function(d){var k;if(!(k=this.$pHtmlNode=this.parentNode.$int)){return;}var g,c=this.$aml;if(c){if(c.serialize){g=c.serialize();}else{c=c.cloneNode(false);g=c.xml||c.nodeValue;}g=g.replace(/ on\w+="[^"]*"| on\w+='[^']*'/g,"");this.$ext=this.$int=apf.insertHtmlNode(null,k,null,apf.html_entity_decode(g));}else{this.$ext=this.$int=k.appendChild(document.createElement(this.localName));}if(this.localName!="a"){this.$ext.host=this;}this.style=this.$ext.style;},true);this.addEventListener("DOMNodeInsertedIntoDocument",function(c){this.$amlLoaded=true;if(this.$setLayout){this.$setLayout();}});}).call(apf.XhtmlElement.prototype=new apf.AmlElement());apf.Init.addConditional(function(){if(apf.isO3){return;}var b=apf.XhtmlElement.prototype;b.implement(apf.Anchoring);b.$drawn=true;b.$setLayout=apf.GuiElement.prototype.$setLayout;b.addEventListener("DOMNodeInserted",function(c){if(c.currentTarget==this&&"vbox|hbox|table".indexOf(this.parentNode.localName)==-1){this.$setLayout();}});},null,["interactive"]);apf.xhtml.setElement("@default",apf.XhtmlElement);apf.XhtmlBodyElement=function(c,b){this.$init(b||"body",apf.NODE_VISIBLE,c);};(function(){this.addEventListener("DOMNodeInsertedIntoDocument",function(b){if(!this.ownerDocument.body){this.ownerDocument.body=this;}this.$ext=this.$int=document.body;},true);}).call(apf.XhtmlBodyElement.prototype=new apf.AmlElement());apf.Init.addConditional(function(){if(apf.isO3){return;}var b=apf.XhtmlBodyElement.prototype;},null,["interactive"]);apf.xhtml.setElement("body",apf.XhtmlBodyElement);apf.XhtmlHtmlElement=function(c,b){this.$init(b||"html",apf.NODE_VISIBLE,c);this.$ext=document.documentElement;this.$ext.host=this;this.$int=document.body;this.$tabList=[];this.$focussable=apf.KEYBOARD;this.focussable=true;this.visible=true;this.$isWindowContainer=true;this.implement(apf.Focussable);apf.window.$addFocus(this);this.addEventListener("DOMNodeInsertedIntoDocument",function(q){var m,k,s,g,r,d=this.attributes,o=this.ownerDocument;for(m=0,k=d.length;m<k;m++){s=(g=d[m]).nodeName.split(":");if(s[0]=="xmlns"){if(r=s[1]){o.$prefixes[r]=g.nodeValue;o.$namespaceURIs[g.nodeValue]=r;}else{o.namespaceURI=g.nodeValue;}}}if(!o.namespaceURI){o.namespaceURI=apf.ns.xhtml;}});};apf.XhtmlHtmlElement.prototype=new apf.XhtmlElement();apf.xhtml.setElement("html",apf.XhtmlHtmlElement);apf.XhtmlIgnoreElement=function(c,b){this.$init(b,apf.NODE_VISIBLE,c);};apf.XhtmlIgnoreElement.prototype=new apf.AmlElement();apf.xhtml.setElement("script",apf.XhtmlIgnoreElement);apf.xhtml.setElement("noscript",apf.XhtmlIgnoreElement);apf.xhtml.setElement("head",apf.XhtmlIgnoreElement);apf.xhtml.setElement("meta",apf.XhtmlIgnoreElement);apf.XhtmlInputElement=function(c,b){this.$init(b||"input",apf.NODE_VISIBLE,c);};(function(){this.$xae=apf.XhtmlElement.prototype.$xae;this.$xre=apf.XhtmlElement.prototype.$xre;this.$handlePropSet=function(b,d,c){if(b=="type"){return;}return apf.XhtmlElement.prototype.$handlePropSet.call(this,b,d,c);};this.addEventListener("DOMNodeInsertedIntoDocument",function(b){var c;if(!(c=this.parentNode.$int)){return;}if(this.$aml){this.$ext=this.$int=apf.insertHtmlNode(this.$aml.serialize?this.$aml:this.$aml.cloneNode(false),c);}else{this.$ext=this.$int=document.createElement(this.localName);if(this.getAttribute("type")){this.$int.setAttribute("type",this.getAttribute("type"));}c.appendChild(this.$int);}},true);}).call(apf.XhtmlInputElement.prototype=new apf.AmlElement());apf.xhtml.setElement("input",apf.XhtmlInputElement);apf.XhtmlOptionElement=function(c,b){this.$init(b||"option",apf.NODE_VISIBLE,c);};(function(){this.addEventListener("DOMNodeInsertedIntoDocument",function(b){this.$ext=this.$int=this.parentNode.$int.appendChild(this.parentNode.$int.ownerDocument.createElement("option"));if(this.value){this.$int.setAttribute("value",this.value);}},true);}).call(apf.XhtmlOptionElement.prototype=new apf.AmlElement());apf.xhtml.setElement("option",apf.XhtmlOptionElement);apf.XhtmlSkipChildrenElement=function(c,b){this.$init(b,apf.NODE_VISIBLE,c);};(function(){this.canHaveChildren=false;this.$redraw=function(){var b=this;apf.queue.add("redraw"+this.$uniqueId,function(){var d=b.$ext.parentNode;var c=b.$ext.nextSibling;d.removeChild(b.$ext);b.$ext=apf.insertHtmlNode(null,d,c,b.$aml?(b.$aml.serialize?b.$aml.serialize():b.$aml.xml):b.serialize());});};this.addEventListener("DOMNodeInsertedIntoDocument",function(b){var c;if(!(c=this.parentNode.$int)){return;}this.$ext=apf.insertHtmlNode(null,c,null,this.$aml?(this.$aml.serialize?this.$aml.serialize():this.$aml.xml):this.serialize());},true);}).call(apf.XhtmlSkipChildrenElement.prototype=new apf.AmlElement());apf.xhtml.setElement("object",apf.XhtmlSkipChildrenElement);apf.xhtml.setElement("embed",apf.XhtmlSkipChildrenElement);apf.xhtml.setElement("table",apf.XhtmlSkipChildrenElement);apf.xhtml.setElement("pre",apf.XhtmlSkipChildrenElement);apf.xsd=new apf.AmlNamespace();apf.setNamespace("http://www.w3.org/2001/XMLSchema",apf.xsd);apf.xsd.typeHandlers={"http://www.w3.org/2001/XMLSchema":{dateTime:function(c){c=c.replace(/-/g,"/");c.match(/^(\d{2})\/(\d{2})\/(\d{4}) (\d{2}):(\d{2}):(\d{2})$/);if(!RegExp.$3||RegExp.$3.length<4){return false;}var b=new Date(c);if(b.getFullYear()!=parseFloat(RegExp.$3)){return false;}if(b.getMonth()!=parseFloat(RegExp.$2)-1){return false;}if(b.getDate()!=parseFloat(RegExp.$1)){return false;}if(b.getHours()!=parseFloat(RegExp.$4)){return false;}if(b.getMinutes()!=parseFloat(RegExp.$5)){return false;}if(b.getSeconds()!=parseFloat(RegExp.$5)){return false;}return true;},time:function(c){c.match(/^(\d{2}):(\d{2}):(\d{2})$/);var b=new Date("21/06/1980 "+c);if(b.getHours()!=parseFloat(RegExp.$1)){return false;}if(b.getMinutes()!=parseFloat(RegExp.$2)){return false;}if(b.getSeconds()!=parseFloat(RegExp.$3)){return false;}return true;},date:function(c){c=c.replace(/-/g,"/");c.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!RegExp.$3||RegExp.$3.length<4){return false;}var b=new Date(RegExp.$2+"/"+RegExp.$1+"/"+RegExp.$3);if(b.getFullYear()!=parseFloat(RegExp.$3)){return false;}if(b.getMonth()!=parseFloat(RegExp.$2)-1){return false;}if(b.getDate()!=parseFloat(RegExp.$1)){return false;}return true;},gYearMonth:function(c){c=c.replace(/-/g,"/");c.match(/^\/?(\d{4})(?:\d\d)?\/(\d{2})(?:\w|[\+\-]\d{2}:\d{2})?$/);if(!RegExp.$1||RegExp.$1.length<4){return false;}var b=new Date(c);if(b.getFullYear()!=parseFloat(RegExp.$)){return false;}if(b.getMonth()!=parseFloat(RegExp.$2)-1){return false;}return true;},gYear:function(c){c.match(/^\/?(\d{4})(?:\d\d)?(?:\w|[\+\-]\d{2}:\d{2})?$/);if(!RegExp.$1||RegExp.$1.length<4){return false;}var b=new Date(c);if(b.getFullYear()!=parseFloat(RegExp.$1)){return false;}return true;},gMonthDay:function(c){c=c.replace(/-/g,"/");c.match(/^\/\/(\d{2})\/(\d{2})(?:\w|[\+\-]\d{2}:\d{2})?$/);var b=new Date(c);if(b.getMonth()!=parseFloat(RegExp.$1)-1){return false;}if(b.getDate()!=parseFloat(RegExp.$2)){return false;}return true;},gDay:function(c){c=c.replace(/-/g,"/");c.match(/^\/{3}(\d{2})(?:\w|[\+\-]\d{2}:\d{2})?$/);var b=new Date(c);if(b.getDate()!=parseFloat(RegExp.$1)){return false;}return true;},gMonth:function(c){c=c.replace(/-/g,"/");c.match(/^\/{2}(\d{2})(?:\w|[\+\-]\d{2}:\d{2})?$/);var b=new Date(c);if(b.getMonth()!=parseFloat(RegExp.$1)-1){return false;}return true;},string:function(b){return typeof b=="string";},"boolean":function(b){return/^(true|false)$/i.test(b);},base64Binary:function(b){return true;},hexBinary:function(b){return/^(?:0x|x|#)?[A-F0-9]{0,8}$/i.test(b);},"float":function(b){return parseFloat(b)==b;},decimal:function(b){return/^[0-9\.\-,]+$/.test(b);},"double":function(b){return parseFloat(b)==b;},anyURI:function(b){return/^(?:\w+:\/\/)?(?:(?:[\w\-]+\.)+(?:[a-z]+)|(?:(?:1?\d?\d?|2[0-4]9|25[0-5])\.){3}(?:1?\d\d|2[0-4]9|25[0-5]))(?:\:\d+)?(?:\/([^\s\\\%]+|%[\da-f]{2})*)?$/i.test(b);},QName:function(b){return true;},normalizedString:function(b){return true;},token:function(b){return true;},language:function(b){return true;},Name:function(b){return true;},NCName:function(b){return true;},ID:function(b){return true;},IDREF:function(b){return true;},IDREFS:function(b){return true;},NMTOKEN:function(b){return true;},NMTOKENS:function(b){return true;},integer:function(b){return parseInt(b)==b;},nonPositiveInteger:function(b){return parseInt(b)==b&&b<=0;},negativeInteger:function(b){return parseInt(b)==b&&b<0;},"long":function(b){return parseInt(b)==b&&b>=-2147483648&&b<=2147483647;},"int":function(b){return parseInt(b)==b;},"short":function(b){return parseInt(b)==b&&b>=-32768&&b<=32767;},"byte":function(b){return parseInt(b)==b&&b>=-128&&b<=127;},nonNegativeInteger:function(b){return parseInt(b)==b&&b>=0;},unsignedLong:function(b){return parseInt(b)==b&&b>=0&&b<=4294967295;},unsignedInt:function(b){return parseInt(b)==b&&b>=0;},unsignedShort:function(b){return parseInt(b)==b&&b>=0&&b<=65535;},unsignedByte:function(b){return parseInt(b)==b&&b>=0&&b<=255;},positiveInteger:function(b){return parseInt(b)==b&&b>0;}},"http://ajax.org/2005/aml":{url:function(b){return/\b(https?|ftp):\/\/([\-A-Z0-9.]+)(\/[\-A-Z0-9+&@#\/%=~_|!:,.;]*)?(\?[\-A-Z0-9+&@#\/%=~_|!:,.;]*)?/i.test(b.trim());},website:function(b){return/^(?:http:\/\/)?([\w-]+\.)+\w{2,4}$/.test(b.trim());},email:function(b){return/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i.test(b.trim());},creditcard:function(g){g=g.replace(/ /g,"");g=g.pad(21,"0",apf.PAD_LEFT);for(var d=0,c,b=g.length;b>=0;b--){c=g.substr(b,1)*(b%2+1);d+=c>9?c-9:c;}return d%10===0;},expdate:function(c){c=c.replace(/-/g,"/");c=c.split("/");var b=new Date(c[0]+"/01/"+c[1]);if(b.getYear()!=parseFloat(c[1])){return false;}if(b.getMonth()!=parseFloat(c[0])-1){return false;}return true;},wechars:function(b){return/^[0-9A-Za-z\xC0-\xCF\xD1-\xD6\xD8-\xDD\xDF-\xF6\xF8-\xFF -\.',]+$/.test(b);},phonenumber:function(b){return/^[\d\+\- \(\)]+$/.test(b);},faxnumber:function(b){return/^[\d\+\- \(\)]+$/.test(b);},mobile:function(b){return/^[\d\+\- \(\)]+$/.test(b);}}};apf.xsd.custumTypeHandlers={};apf.xsd.matchType=function(m,g){var b=g.split(":"),k=b[0],n=apf.document,d=n.$prefixes[k];g=b[1];if(k=="xsd"){d="http://www.w3.org/2001/XMLSchema";}if(!d){d=n.namespaceURI||apf.ns.xhtml;}var o=this.typeHandlers[d];if(o&&o[g]){return o[g](m);}throw new Error(apf.formatErrorString(0,null,"Validating XSD Type","Could not find type: "+g));return true;};apf.xsd.checkType=function(k,r){var q=typeof r=="object"?apf.queryValue(r):r;if(k.indexOf(":")>-1){var m=k.split(":"),d=m[0],b=m[1],o=apf.document,n=o.$prefixes[d];if(d=="xsd"){n="http://www.w3.org/2001/XMLSchema";}if(!n){n=o.namespaceURI||apf.ns.xhtml;}var g=this.typeHandlers[n];if(g&&g[b]){return g[b](q);}}if(this.custumTypeHandlers[k]){return this.custumTypeHandlers[k](q);}else{}};apf.html5=new apf.AmlNamespace();apf.setNamespace("",apf.html5);apf.HTML5INPUT={email:"textbox",url:"textbox",password:"textbox",datetime:"spinner",date:"calendar",month:"spinner",week:"spinner",time:"spinner",number:"spinner",range:"slider",checkbox:"checkbox",radio:"radiobutton",file:"upload",submit:"submit",image:"submit",reset:"button"};apf.xinclude=new apf.AmlNamespace();apf.setNamespace("http://www.w3.org/2001/XInclude",apf.xinclude);apf.XiInclude=function(c,b){this.$init(b||"include",apf.NODE_HIDDEN,c);};apf.xinclude.setElement("include",apf.XiInclude);apf.aml.setElement("include",apf.XiInclude);(function(){this.$parsePrio="002";this.$propHandlers.href=this.$propHandlers.src=function(g){if(typeof g!="string"){return c.call(this,g);}if(g.trim().charAt(0)=="<"){d.call(this,g.trim());return;}this.$path=g.charAt(0)=="{"?g:apf.getAbsolutePath(apf.hostPath,g);var k=this.ownerDocument.$domParser;if(!this.defer){k.$shouldWait++;this.$parseContext=k.$parseContext||[this.parentNode];}d.call(this,this.$path);};function b(g){if(this.callback){this.callback({xmlNode:g,amlNode:this.parentNode,addedNode:this.previousSibling||this.nextSibling});}if(this.parentNode){this.parentNode.removeChild(this);}}function c(n){var s=this.ownerDocument.$domParser;if(this.clear){this.parentNode.$int.innerHTML="";}if(n){s.parseFromXml(n,{doc:this.ownerDocument,amlNode:this.parentNode,beforeNode:this,include:true});if(!this.defer&&this.$parseContext){var r=(this.$parseContext[1]||(this.$parseContext[1]={})),k=r.callback,g=this;r.callback=function(){b.call(g,n);if(k){k.call(g.ownerDocument);}};if(s.$continueParsing.apply(s,this.$parseContext)===false){var q=(s.$parseContext[1]||(s.$parseContext[1]={})),m=r.callback;q.callback=function(){if(k){k.call(g.ownerDocument);}s.$continueParsing.apply(s,g.$parseContext);};}}else{b.call(this,n);}}else{if(!this.defer){s.$continueParsing.apply(s,this.$parseContext);}b.call(this,n);}}function d(k){var g=this;apf.getData(k,apf.extend(this.options||{},{callback:function(q,o,m){if(o!=apf.SUCCESS){var r=new Error(apf.formatErrorString(1007,g,"Loading Includes","Could not load Include file '"+(k||g.src)+"'\nReason: "+m.message));if(m.tpModule.retryTimeout(m,o,null,r)===true){return true;}apf.console.error(r.message);c.call(g,null);return;}q=q.replace(/\<\!DOCTYPE[^>]*>/,"").replace(/^[\r\n\s]*/,"");if(!apf.supportNamespaces){q=q.replace(/xmlns\=\"[^"]*\"/g,"");}if(q.indexOf("<a:application")==-1){q="<a:application xmlns:a='"+apf.ns.aml+"'>"+q+"</a:application>";}var n=apf.getXml(q,null,true);if(!n){throw new Error(apf.formatErrorString(0,null,"Loading include","Could not parse include file. Maybe the file does not exist?",n));}n.setAttribute("filename",m.url);c.call(g,n);},async:true,ignoreOffline:true}));}}).call(apf.XiInclude.prototype=new apf.AmlElement());apf.__LIVEEDIT__=1<<23;apf.__ANCHORING__=1<<13;apf.Anchoring=function(){this.$regbase=this.$regbase|apf.__ANCHORING__;this.$anchors=[];var m=1;var d=2;this.$updateQueue=0;this.$inited=this.$parsed=this.$anchoringEnabled=false;this.$hordiff=this.$verdiff=0;this.$rule_v=this.$rule_h=this.$rule_header="";var g=apf.layout;this.$supportedProperties.push("anchors");var c={right:function(s,t){if(!this.$anchoringEnabled&&!this.$setLayout("anchoring")){return;}if(!s&&s!==0){this.$ext.style[t]="";}if(!this.$updateQueue){g.queue(this.$pHtmlNode,this);}this.$updateQueue=this.$updateQueue|d;},bottom:function(s,t){if(!this.$anchoringEnabled&&!this.$setLayout("anchoring")){return;}if(!s&&s!==0){this.$ext.style[t]="";}if(!this.$updateQueue){g.queue(this.$pHtmlNode,this);}this.$updateQueue=this.$updateQueue|m;}};c.left=c.width=c.right;c.top=c.height=c.bottom;this.$propHandlers.anchors=function(s){this.$anchors=s?s.splitSafe("(?:, *| )"):[];if(!this.$anchoringEnabled&&!this.$setLayout("anchoring")){return;}if(!this.$updateQueue&&apf.loaded){g.queue(this.$pHtmlNode,this);}this.$updateQueue=this.$updateQueue|d|m;};this.$disableAnchoring=function(s){if(!this.$inited||!this.$anchoringEnabled||!this.$pHtmlNode){return;}g.removeRule(this.$pHtmlNode,this.$uniqueId+"_anchors");if(g.queue){g.queue(this.$pHtmlNode);}for(var t in c){delete this.$propHandlers[t];}this.removeEventListener("DOMNodeRemoved",n);this.removeEventListener("DOMNodeInserted",b);if(this.$ext){this.$ext.style.left=this.$ext.style.right=this.$ext.style.top=this.$ext.style.bottom=this.$ext.style.width=this.$ext.style.height=this.$ext.style.position="";}this.removeEventListener("prop.visible",k);this.$inited=false;this.$anchoringEnabled=false;};this.$enableAnchoring=function(){if(this.$inited){return;}apf.extend(this.$propHandlers,c);this.addEventListener("DOMNodeRemoved",n);this.addEventListener("DOMNodeInserted",b);this.addEventListener("prop.visible",k);this.$updateQueue=0|((this.left||this.width||this.right||this.anchors)&&d)|((this.top||this.height||this.bottom||this.anchors)&&m);if(this.$updateQueue){g.queue(this.$pHtmlNode,this);}this.$inited=true;this.$anchoringEnabled=true;};function k(s){if(!(this.$rule_header||this.$rule_v||this.$rule_h)){return;}if(s.value){if(this.$rule_v||this.$rule_h){var t=this.$rule_header+"\n"+this.$rule_v+"\n"+this.$rule_h;g.setRules(this.$pHtmlNode,this.$uniqueId+"_anchors",t);g.queue(this.$pHtmlNode,this);}g.processQueue();}else{g.removeRule(this.$pHtmlNode,this.$uniqueId+"_anchors");g.queue(this.$pHtmlNode);}}function n(s){if(s&&(s.$doOnlyAdmin||s.currentTarget!=this)){return;}if(g.queue&&this.$pHtmlNode){g.removeRule(this.$pHtmlNode,this.$uniqueId+"_anchors");g.queue(this.$pHtmlNode);}}function b(s){if(!this.$amlLoaded||s.currentTarget!=this){return;}if(!s.$isMoveWithinParent&&this.$parsed){this.$moveAnchoringRules(s.$oldParentHtmlNode);}}this.$moveAnchoringRules=function(s,t){var u=s&&g.removeRule(s,this.$uniqueId+"_anchors");if(u){g.queue(s);}if(!this.$rule_v&&!this.$rule_h&&!this.$rule_header){return;}this.$rule_header=r.call(this);u=this.$rule_header+"\n"+this.$rule_v+"\n"+this.$rule_h;g.setRules(this.$pHtmlNode,this.$uniqueId+"_anchors",u);g.queue(this.$pHtmlNode,this);};this.$hasAnchorRules=function(){return this.$rule_v||this.$rule_h?true:false;};function r(){if(!this.$pHtmlDoc){return"";}return"try{            var oHtml = "+(apf.hasHtmlIdsInJs?this.$ext.getAttribute("id"):"document.getElementById('"+this.$ext.getAttribute("id")+"')")+";                        var pWidth = "+(this.$pHtmlNode==this.$pHtmlDoc.body?"apf.getWindowWidth()":"apf.getHtmlInnerWidth(oHtml.parentNode)")+";                        var pHeight = "+(this.$pHtmlNode==this.$pHtmlDoc.body?"apf.getWindowHeight()":"apf.getHtmlInnerHeight(oHtml.parentNode)")+";            }catch(e){            }";}function o(t,s){return String(t).replace(apf.percentageMatch,"(("+s+" * $1)/100)");}this.$recalcAnchoring=function(s){this.$updateQueue=this.$updateQueue|d|m;this.$updateLayout();g.queue(this.$pHtmlNode,this);if(!s){g.processQueue();}};function q(){if(this.$updateQueue){this.$updateLayout();apf.layout.activateRules(this.$ext.parentNode);}}this.$updateLayout=function(){if(!this.$anchoringEnabled){return;}if(!apf.window.vManager.check(this,"anchoring",q)){return;}if(!this.$parsed){if(!this.$ext.getAttribute("id")){apf.setUniqueHtmlId(this.$ext);}this.$rule_header=r.call(this);this.$parsed=true;}if(!this.$updateQueue){if(this.visible&&this.$ext.style.display=="none"){this.$ext.style.display="";}return;}if(this.draggable=="relative"){if("absolute|fixed|relative".indexOf(apf.getStyle(this.$ext,"position"))==-1){this.$ext.style.position="absolute";}}else{if(this.left||this.left===0||this.top||this.top===0||this.right||this.right===0||this.bottom||this.bottom===0||this.$anchors.length){if("absolute|fixed".indexOf(apf.getStyle(this.$ext,"position"))==-1){this.$ext.style.position="absolute";}}else{if(!this.center){if("absolute|fixed|relative".indexOf(apf.getStyle(this.$ext,"position"))==-1){this.$ext.style.position="relative";}if(!this.width){this.$ext.style.width="";}if(!this.height){this.$ext.style.height="";}}}}var E;if(this.$updateQueue&d){E=[];this.$hordiff=apf.getWidthDiff(this.$ext);var x=this.$anchors[3]||this.left,C=this.$anchors[1]||this.right,u=this.width,B=x||x===0,G=C||C===0,y=u||u===0;if(C&&typeof C=="string"){C=o(C,"pWidth");}if(B){if(parseInt(x)!=x){x=o(x,"pWidth");E.push("oHtml.style.left = ("+x+") + 'px'");}else{this.$ext.style.left=x+"px";}}if((apf.hasStyleAnchors||!B)&&G){if(parseInt(C)!=C){C=o(C,"pWidth");E.push("oHtml.style.right = ("+C+") + 'px'");}else{this.$ext.style.right=C+"px";}}if(B&&G){if(!apf.hasStyleAnchors){E.push("oHtml.style.width = (pWidth - ("+C+") - ("+x+") - "+this.$hordiff+") + 'px'");}else{this.$ext.style.width="";}}else{if(y&&typeof this.maxwidth=="number"&&typeof this.minwidth=="number"){if(parseInt(u)!=u){u=o(u,"pWidth");E.push("oHtml.style.width = Math.max("+(this.minwidth-this.$hordiff)+", Math.min("+(this.maxwidth-this.$hordiff)+", "+u+" - "+this.$hordiff+")) + 'px'");}else{this.$ext.style.width=((u>this.minwidth?(u<this.maxwidth?u:this.maxwidth):this.minwidth)-this.$hordiff)+"px";}}}this.$rule_h=(E.length?"try{"+E.join(";}catch(e){};try{")+";}catch(e){};":"");}if(this.$updateQueue&m){E=[];this.$verdiff=apf.getHeightDiff(this.$ext);var A=this.$anchors[0]||this.top,s=this.$anchors[2]||this.bottom,D=this.height,w=A||A===0,t=s||s===0,F=D||D===0;if(s&&typeof s=="string"){s=o(s,"pHeight");}if(w){if(parseInt(A)!=A){A=o(A,"pHeight");E.push("oHtml.style.top = ("+A+") + 'px'");}else{this.$ext.style.top=A+"px";}}if((apf.hasStyleAnchors||!w)&&t){if(parseInt(s)!=s){E.push("oHtml.style.bottom = ("+s+") + 'px'");}else{this.$ext.style.bottom=s+"px";}}if(w&&t){if(!apf.hasStyleAnchors){E.push("oHtml.style.height = (pHeight - ("+s+") - ("+A+") - "+this.$verdiff+") + 'px'");}else{this.$ext.style.height="";}}else{if(F&&typeof this.minheight=="number"){if(parseInt(D)!=D){D=o(D,"pHeight");E.push("oHtml.style.height = Math.max("+(this.minheight-this.$verdiff)+", Math.min("+(this.maxheight-this.$verdiff)+", "+D+" - "+this.$verdiff+")) + 'px'");}else{this.$ext.style.height=Math.max(0,(D>this.minheight?(D<this.maxheight?D:this.maxheight):this.minheight)-this.$verdiff)+"px";}}}this.$rule_v=(E.length?"try{"+E.join(";}catch(e){};try{")+";}catch(e){};":"");}if(this.$rule_v||this.$rule_h){g.setRules(this.$pHtmlNode,this.$uniqueId+"_anchors",this.$rule_header+"\n"+this.$rule_v+"\n"+this.$rule_h,true);}else{g.removeRule(this.$pHtmlNode,this.$uniqueId+"_anchors");}this.$updateQueue=0;if(this.$box&&!apf.hasFlexibleBox){apf.layout.forceResize(this.$ext);}};this.addEventListener("DOMNodeInsertedIntoDocument",function(s){});this.addEventListener("DOMNodeRemovedFromDocument",function(s){this.$disableAnchoring();});};apf.__CONTENTEDITABLE__=1<<24;apf.__GUIELEMENT__=1<<15;apf.__VALIDATION__=1<<6;apf.GuiElement=function(){this.$init(true);};(function(){this.$regbase=this.$regbase|apf.__GUIELEMENT__;this.$focussable=apf.KEYBOARD_MOUSE;this.visible=2;this.$booleanProperties["disable-keyboard"]=true;this.$booleanProperties.visible=true;this.$booleanProperties.focussable=true;this.$supportedProperties.push("draggable","resizable");this.$supportedProperties.push("focussable","zindex","disabled","tabindex","disable-keyboard","contextmenu","visible","autosize","loadaml","actiontracker","alias","width","left","top","height","tooltip");this.$setLayout=function(c,d){if(!this.$drawn||!this.$pHtmlNode){return false;}if(this.parentNode){if(this.parentNode.localName=="table"){if(this.$disableCurrentLayout){this.$disableCurrentLayout();}this.parentNode.register(this,d);this.$disableCurrentLayout=null;return c=="table";}else{if("vbox|hbox".indexOf(this.parentNode.localName)>-1){if(this.$disableCurrentLayout){this.$disableCurrentLayout();}this.parentNode.register(this,d);this.$disableCurrentLayout=null;return c==this.parentNode.localName;}}}if(!this.$anchoringEnabled){if(this.$disableCurrentLayout){this.$disableCurrentLayout();}this.$enableAnchoring();this.$disableCurrentLayout=this.$disableAnchoring;}return c=="anchoring";};this.addEventListener("DOMNodeInserted",function(c){if(c.currentTarget==this&&"vbox|hbox|table".indexOf(this.parentNode.localName)==-1){this.$setLayout();}});this.implement(apf.Anchoring);this.setWidth=function(c){this.setProperty("width",c,false,true);return this;};this.setHeight=function(c){this.setProperty("height",c,false,true);return this;};this.setLeft=function(c){this.setProperty("left",c,false,true);return this;};this.setTop=function(c){this.setProperty("top",c,false,true);return this;};if(!this.show){this.show=function(){this.setProperty("visible",true,false,true);return this;};}if(!this.hide){this.hide=function(){this.setProperty("visible",false,false,true);return this;};}this.getWidth=function(){return(this.$ext||{}).offsetWidth;};this.getHeight=function(){return(this.$ext||{}).offsetHeight;};this.getLeft=function(){return(this.$ext||{}).offsetLeft;};this.getTop=function(){return(this.$ext||{}).offsetTop;};this.enable=function(){this.setProperty("disabled",false,false,true);return this;};this.disable=function(){this.setProperty("disabled",true,false,true);return this;};this.sendToBack=function(){this.setProperty("zindex",0,false,true);return this;};this.bringToFront=function(){this.setProperty("zindex",apf.all.length+1,false,true);return this;};this.sendBackwards=function(){this.setProperty("zindex",this.zindex-1,false,true);return this;};this.bringForward=function(){this.setProperty("zindex",this.zindex+1,false,true);return this;};this.hasFocus=function(){};this.addEventListener("DOMNodeInsertedIntoDocument",function(d){var c=this.$aml;if(this.parentNode){if(this.localName=="item"&&this.parentNode.hasFeature(apf.__MULTISELECT__)){this.$pHtmlNode=this.parentNode.$container;}else{this.$pHtmlNode=this.parentNode.$int;}}if(!this.$pHtmlNode){return;}this.$pHtmlDoc=this.$pHtmlNode.ownerDocument||document;if(this.$initSkin){this.$initSkin(c);}if(this.$draw){this.$draw();}if(d.id){this.$ext.setAttribute("id",d.id);}if(typeof this.visible=="undefined"){this.visible=true;}if(this.$focussable&&typeof this.focussable=="undefined"){apf.GuiElement.propHandlers.focussable.call(this);}this.$drawn=true;},true);var b=function(g){if(!this.$pHtmlNode){return;}this.$setLayout();if(this.$ext){var c=(this.hasFeature(apf.__PRESENTATION__))||false;var d=this.$isLeechingSkin?this.localName:"main";if(this.minwidth==undefined){this.minwidth=apf.getCoord(c&&parseInt(this.$getOption(d,"minwidth")),0);}if(this.minheight==undefined){this.minheight=apf.getCoord(c&&parseInt(this.$getOption(d,"minheight")),0);}if(this.maxwidth==undefined){this.maxwidth=apf.getCoord(c&&parseInt(this.$getOption(d,"maxwidth")),10000);}if(this.maxheight==undefined){this.maxheight=apf.getCoord(c&&parseInt(this.$getOption(d,"maxheight")),10000);}}if(this.$loadAml){this.$loadAml(this.$aml);}};this.addEventListener("DOMNodeInsertedIntoDocument",b);this.addEventListener("$skinchange",b);var b;this.addEventListener("$event.resize",b=function(d){apf.layout.setRules(this.$ext,"resize","var o = apf.all["+this.$uniqueId+"];            if (o) o.dispatchEvent('resize');",true);apf.layout.queue(this.$ext);this.removeEventListener("$event.resize",b);});this.addEventListener("contextmenu",function(q){if(!this.contextmenus){return;}if(this.hasFeature(apf.__DATABINDING__)){var c;var t=this.hasFeature(apf.__MULTISELECT__)?this.selected:this.xmlRoot;var o,n,k,d,g,r,s,u;for(o=0,n=this.contextmenus.length;o<n;o++){d=(typeof(s=this.contextmenus[o])=="string");u=null;if(!d&&s.match&&t){u=(s.cmatch||(s.cmatch=apf.lm.compile(s.match,{xpathmode:3,injectself:true})))(t);}if(d||t&&u||!s.match){r=d?s:s.menu;if(!self[r]){return;}self[r].display(q.x,q.y,null,this,t);q.returnValue=false;q.cancelBubble=true;break;}}}else{r=typeof this.contextmenus[0]=="string"?this.contextmenus[0]:this.contextmenus[0].getAttribute("menu");if(!self[r]){return;}self[r].display(q.x,q.y,null,this);q.returnValue=false;q.cancelBubble=true;}});}).call(apf.GuiElement.prototype=new apf.AmlElement());apf.GuiElement.propHandlers={focussable:function(b){this.focussable=typeof b=="undefined"||b;if(!this.hasFeature(apf.__FOCUSSABLE__)){this.implement(apf.Focussable);}if(this.focussable){apf.window.$addFocus(this,this.tabindex);}else{apf.window.$removeFocus(this);}},zindex:function(b){this.$ext.style.zIndex=b;},visible:function(b){if(apf.isFalse(b)||typeof b=="undefined"){if(this.$ext){this.$ext.style.display="none";}if(apf.document.activeElement==this||this.canHaveChildren&&apf.isChildOf(this,apf.document.activeElement,false)){if(apf.config.allowBlur&&this.hasFeature(apf.__FOCUSSABLE__)){this.blur();}else{apf.window.moveNext();}}this.visible=false;}else{if(this.$ext){this.$ext.style.display="";if(!this.$ext.offsetHeight){this.$ext.style.display=this.$display||"block";}}if(apf.layout&&this.$int){apf.layout.forceResize(this.$int);}this.visible=true;}},disabled:function(m){if(!this.$drawn){var b=this;apf.queue.add("disable"+this.$uniqueId,function(n){b.disabled=m;apf.GuiElement.propHandlers.disabled.call(b,m);});return;}else{apf.queue.remove("disable"+this.$uniqueId);}if(this.canHaveChildren){if(m!=-1){m=this.disabled=apf.isTrue(m);}var d=this.childNodes;for(var k,g=0,c=d.length;g<c;g++){k=d[g];if(k.nodeFunc==apf.NODE_VISIBLE){if(m&&k.disabled!=-1){k.$disabled=k.disabled||false;}k.setProperty("disabled",m?-1:false);}}if(this.$isWindowContainer){return;}}if(m==-1||m==false){}else{if(typeof this.$disabled=="boolean"){if(m===null){m=this.$disabled;this.$disabled=null;}else{this.$disabled=m||false;return;}}}if(apf.isTrue(m)||m==-1){this.disabled=false;if(apf.document.activeElement==this){apf.window.moveNext(true);if(apf.document.activeElement==this){this.$blur();}}if(this.hasFeature(apf.__PRESENTATION__)){this.$setStyleClass(this.$ext,this.$baseCSSname+"Disabled");}if(this.$disable){this.$disable();}this.disabled=m;}else{if(this.hasFeature(apf.__DATABINDING__)&&apf.config.autoDisable&&!(!this.$bindings||this.xmlRoot)){return false;}this.disabled=false;if(apf.document.activeElement==this){this.$focus();}if(this.hasFeature(apf.__PRESENTATION__)){this.$setStyleClass(this.$ext,null,[this.$baseCSSname+"Disabled"]);}if(this.$enable){this.$enable();}}},enabled:function(b){this.setProperty("disabled",!b);},"disable-keyboard":function(b){this.disableKeyboard=apf.isTrue(b);},tooltip:function(b){this.$ext.setAttribute("title",b+(this.hotkey?" ("+this.hotkey+")":""));},contextmenu:function(b){this.contextmenus=[b];},actiontracker:function(b){if(!b){this.$at=null;}else{if(b.localName=="actiontracker"){this.$at=b;}else{this.$at=typeof b=="string"&&self[b]?apf.nameserver.get("actiontracker",b)||self[b].getActionTracker():apf.setReference(b,apf.nameserver.register("actiontracker",b,new apf.actiontracker()));if(!this.$at.name){this.$at.name=b;}}}},aml:function(b){this.replaceMarkup(b);}};apf.__PRESENTATION__=1<<9;apf.Presentation=function(){this.$init(true);};(function(){this.$regbase=this.$regbase|apf.__PRESENTATION__;this.$supportedProperties.push("skin");this.$propHandlers.skinset=this.$propHandlers.skin=function(g){if(!this.$amlLoaded){return;}if(!this.$skinTimer){var d=this;clearTimeout(this.$skinTimer);this.$skinTimer=$setTimeout(function(){b.call(d,d.skin);delete d.$skinTimer;});}};this.$propHandlers.style=function(d){if(!this.styleAttrIsObj&&this.$amlLoaded){this.$ext.setAttribute("style",d);}};this.$propHandlers.border=function(d){if(!d){this.$ext.style.borderWidth="";}else{this.$ext.style.borderWidth=apf.getBox(d).join("px ")+"px";}};this.$propHandlers.margin=function(d){if(!d){this.$ext.style.margin="";}else{this.$ext.style.margin=apf.getBox(d).join("px ")+"px";}};this.$propHandlers["class"]=function(d){this.$setStyleClass(this.$ext,d,this.$lastClassValue?[this.$lastClassValue]:null);this.$lastClassValue=d;};this.$forceSkinChange=function(g,d){b.call(this,g,d);};function b(y,E){clearTimeout(this.$skinTimer);if(this.selectable){var s=this.getSelection();}var m=this.$ext,D=this.$int,d=this.$ext.parentNode,u=m.nextSibling,o=this.$ext.getAttribute("id"),g=this.$int&&this.$int.getAttribute("id"),q=this.$baseCSSname;if(m.parentNode){m.parentNode.removeChild(m);}if(this.$destroy){this.$destroy(true);}this.skin=y;this.$loadSkin(E?E+":"+y:null);if(this.$draw){this.$draw(true);}if(o){this.$ext.setAttribute("id",o);}if(u||d!=this.$ext.parentNode){d.insertBefore(this.$ext,u);}var A,x,r=[],C=(m.className||"").splitSafe("\\s+");for(A=0;A<C.length;A++){if(C[A]&&C[A].indexOf(q)!=0){r.push(C[A].replace(q,this.$baseCSSname));}}apf.setStyleClass(this.$ext,r.join(" "));var k,B=apf.skins.events;for(A=0,x=B.length;A<x;A++){k=B[A];if(typeof m[k]=="function"&&!this.$ext[k]){this.$ext[k]=m[k];}}this.$ext.style.left=m.style.left;this.$ext.style.top=m.style.top;this.$ext.style.width=m.style.width;this.$ext.style.height=m.style.height;this.$ext.style.right=m.style.right;this.$ext.style.bottom=m.style.bottom;this.$ext.style.zIndex=m.style.zIndex;this.$ext.style.position=m.style.position;this.$ext.style.display=m.style.display;if(g){this.$int.setAttribute("id",g);}if(this.$int&&this.$int!=D){var w,n=this.$int,t=D.childNodes;for(var A=t.length-1;A>=0;A--){if((w=t[A]).host){w.host.$pHtmlNode=n;if(w.host.$isLeechingSkin){c.call(w.host);}}n.insertBefore(w,n.firstChild);}}if(this.hasFeature(apf.__DRAGDROP__)){if(document.elementFromPointAdd){document.elementFromPointRemove(m);document.elementFromPointAdd(this.$ext);}}if(this.disabled){this.$disable();}if(this.$focussable&&apf.document.activeElement==this){this.$focus();}this.dispatchEvent("$skinchange",{ext:m,"int":D});if(this.hasFeature(apf.__DATABINDING__)&&this.xmlRoot){this.reload();}else{if(this.value){this.$propHandlers.value.call(this,this.value);}}if(this.hasFeature(apf.__MULTISELECT__)){if(this.selectable){this.selectList(s,true);}}if(!apf.hasSingleRszEvent){apf.layout.activateRules(this.$ext);if(this.$int){apf.layout.activateRules(this.$int);}}if(this.draggable&&this.$propHandlers.draggable){this.$propHandlers.draggable.call(this,this.draggable);}if(this.resizable&&this.$propHandlers.resizable){this.$propHandlers.resizable.call(this,this.resizable);}apf.layout.forceResize(this.$ext);}this.$setStyleClass=apf.setStyleClass;function c(o){if(!this.$amlLoaded||o&&(o.$isMoveWithinParent||o.currentTarget!=this||!o.$oldParent)){return;}this.$setInheritedAttribute(this,"skinset");if(this.attributes.getNamedItem("skin")){return;}var d,k=this.parentNode,g;if((d=this.$canLeechSkin.dataType==apf.STRING?this.$canLeechSkin:this.localName)&&k.$originalNodes&&(g=k.$originalNodes[d])&&g.getAttribute("inherit")){var m=g.getAttribute("link");this.$isLeechingSkin=true;if(m){this.$forceSkinChange(m);}else{var n=k.skinName.split(":");this.$forceSkinChange(n[1],n[0]);}}else{if(this.$isLeechingSkin){delete this.kin;this.$forceSkinChange();}}}this.$initSkin=function(d){if(this.$canLeechSkin){this.addEventListener("DOMNodeInserted",c);}if(!this.skin){this.skin=this.getAttribute("skin");}var g,m=this.parentNode,k;if(this.$canLeechSkin&&!this.skin&&(g=this.$canLeechSkin.dataType==apf.STRING?this.$canLeechSkin:this.localName)&&m.$originalNodes&&(k=m.$originalNodes[g])&&k.getAttribute("inherit")){var n=k.getAttribute("link");this.$isLeechingSkin=true;if(n){this.skin=n;this.$loadSkin();}else{this.$loadSkin(m.skinName);}}else{if(!this.skinset){this.skinset=this.getAttribute("skinset");}this.$loadSkin(null,this.$canLeechSkin);}};this.$loadSkin=function(k,g){this.baseSkin=k||(this.skinset||this.$setInheritedAttribute("skinset"))+":"+(this.skin||this.localName);clearTimeout(this.$skinTimer);if(this.skinName){this.$blur();this.$baseCSSname=null;}this.skinName=this.baseSkin;this.$pNodes={};this.$originalNodes=apf.skins.getTemplate(this.skinName,true);if(!this.$originalNodes){var m=this.skin;if(m){var d=this.skinName.split(":")[0];this.baseName=this.skinName="default:"+m;this.$originalNodes=apf.skins.getTemplate(this.skinName);if(!this.$originalNodes&&d!="default"){this.baseName=this.skinName=d+":"+this.localName;this.$originalNodes=apf.skins.getTemplate(this.skinName,true);}}if(!this.$originalNodes){this.baseName=this.skinName="default:"+this.localName;this.$originalNodes=apf.skins.getTemplate(this.skinName);}if(!this.$originalNodes){if(g){return(this.baseName=this.skinName=this.originalNode=null);}throw new Error(apf.formatErrorString(1077,this,"Presentation","Could not load skin: "+this.baseSkin));}}if(this.$originalNodes){apf.skins.setSkinPaths(this.skinName,this);}};this.$getNewContext=function(g,d){this.$pNodes[g]=this.$originalNodes[g].cloneNode(true);};this.$hasLayoutNode=function(d){return this.$originalNodes[d]?true:false;};this.$getLayoutNode=function(d,m,k){var g=this.$pNodes[d]||this.$originalNodes[d];if(!g){return false;}if(!m){return k||apf.getFirstElement(g);}var n=g.getAttribute(m);if(!n){return null;}return(k?apf.queryNode(k,n):apf.getFirstElement(g).selectSingleNode(n));};this.$getOption=function(g,m){g=g.toLowerCase();var k=this.$pNodes[g]||this.$originalNodes[g];if(!m||!k){return k;}var d=k.selectSingleNode("@"+m);return d?d.nodeValue:"";};this.$getExternal=function(d,g,m,n){if(!g){g=this.$pHtmlNode;}if(!d){d="main";}d=d.toLowerCase();this.$getNewContext(d);var o=this.$getLayoutNode(d);var k;if(k=(n||this).getAttributeNode("style")){o.setAttribute("style",k.nodeValue);}if(m){m.call(this,o);}o=apf.insertHtmlNode(o,g);o.host=this;if(k=(n||this).getAttributeNode("bgimage")){o.style.backgroundImage="url("+apf.getAbsolutePath(this.mediaPath,k.nodeValue)+")";}if(!this.$baseCSSname){this.$baseCSSname=o.className.trim().split(" ")[0];}return o;};this.$focus=function(){if(!this.$ext){return;}this.$setStyleClass(this.oFocus||this.$ext,this.$baseCSSname+"Focus");};this.$blur=function(){if(this.renaming){this.stopRename(null,true);}if(!this.$ext){return;}this.$setStyleClass(this.oFocus||this.$ext,"",[this.$baseCSSname+"Focus"]);};this.$fixScrollBug=function(){if(this.$int!=this.$ext){this.oFocus=this.$int;}else{this.oFocus=this.$int=this.$ext.appendChild(document.createElement("div"));this.$int.style.height="100%";this.$int.className="focusbug";}};}).call(apf.Presentation.prototype=new apf.GuiElement());apf.config.$inheritProperties.skinset=1;apf.__VALIDATION__=1<<6;apf.validator={macro:{datatype:"apf.xsd.matchType(value, '",datatype_:"')",pattern:"value.match(",pattern_:")",custom:"(",custom_:")",min:"parseInt(value) >= ",max:"parseInt(value) <= ",maxlength:"value.toString().length <= ",minlength:"value.toString().length >= ",notnull:"value.toString().length > 0",checkequal:"!(temp = ",checkequal_:").isValid() || temp.getValue() == value"},compile:function(c){var b=this.macro,d=["var temp, valid = true;             if (!validityState)                 validityState = new apf.validator.validityState(); "];if(c.required){d.push("if (checkRequired && (!value || value.toString().trim().length == 0)) {                validityState.$reset();                validityState.valueMissing = true;                valid = false;            }");}d.push("validityState.$reset();            if (value) {");for(prop in c){if(!b[prop]){continue;}d.push("if (!(",b[prop],c[prop],b[prop+"_"]||"",")){                validityState.$set('",prop,"');                valid = false;            }");}d.push("};validityState.valid = valid; return validityState;");return new Function("value","checkRequired","validityState",d.join(""));}};apf.validator.validityState=function(){this.valueMissing=false,this.typeMismatch=false,this.patternMismatch=false,this.tooLong=false,this.rangeUnderflow=false,this.rangeOverflow=false,this.stepMismatch=false,this.customError=false,this.valid=true,this.$reset=function(){for(var b in this){if(b.substr(0,1)=="$"){continue;}this[b]=false;}this.valid=true;},this.$set=function(b){switch(b){case"min":this.rangeUnderflow=true;break;case"max":this.rangeOverflow=true;break;case"minlength":this.tooShort=true;break;case"maxlength":this.tooLong=true;break;case"pattern":this.patternMismatch=true;break;case"datatype":this.typeMismatch=true;break;case"notnull":this.typeMismatch=true;break;case"checkequal":this.typeMismatch=true;break;}};};apf.Validation=function(){this.$regbase=this.$regbase|apf.__VALIDATION__;this.isValid=function(c){if(!this.$vOptions){return true;}(this.$vOptions.isValid||(this.$vOptions.isValid=apf.validator.compile(this.$vOptions))).call(this,typeof this.getValue=="function"?this.getValue(null,true):null,c,this.validityState||(this.validityState=new apf.validator.validityState()));var b=this.validityState.valid;if(!b){this.dispatchEvent("invalid",this.validityState);}return b;};this.setCustomValidity=function(b){};this.showMe=function(){var b=this.parentNode;while(b){if(b.show){b.show();}b=b.parentNode;}};this.checkValidity=this.validate=function(b,d,c){if(c||!this.isValid(!b)&&!d){this.setError();return false;}else{this.clearError();return true;}};this.setError=function(c){if(!this.$validgroup){this.$propHandlers.validgroup.call(this,"vg"+this.parentNode.$uniqueId);}var b=this.$validgroup.getErrorBox(this);if(!this.$validgroup.allowMultipleErrors){this.$validgroup.hideAllErrors();}b.setMessage(this.invalidmsg||c);apf.setStyleClass(this.$ext,this.$baseCSSname+"Error");this.showMe();b.display(this);if(this.hasFeature(apf.__MULTISELECT__)&&this.validityState.$errorXml){this.select(this.validityState.$errorXml);}if(apf.document.activeElement&&apf.document.activeElement!=this){this.focus(null,{mouse:true});}};this.clearError=function(c){if(this.$setStyleClass){this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Error"]);}if(this.$validgroup){var b=this.$validgroup.getErrorBox(null,true);if(!b||b.host!=this){return;}b.hide();}};this.addEventListener("DOMNodeRemovedFromDocument",function(b){if(this.$validgroup){this.$validgroup.unregister(this);}});this.addEventListener("DOMNodeInsertedIntoDocument",function(b){if(!this.validgroup){this.$setInheritedAttribute("validgroup");}});this.$attrExcludePropBind=apf.extend({pattern:1,validtest:3},this.$attrExcludePropBind);this.$booleanProperties.required=true;this.$supportedProperties.push("validgroup","required","datatype","pattern","min","max","maxlength","minlength","validtest","notnull","checkequal","invalidmsg","requiredmsg");this.$fValidate=function(){if(this.liveedit){return;}if(!this.$validgroup){this.validate(true);}else{var b=this.$validgroup.getErrorBox(this);if(!b.visible||b.host!=this){this.validate(true);}}};this.addEventListener("blur",this.$fValidate);this.$propHandlers.validgroup=function(c){if(c){var b;if(typeof c!="string"){this.$validgroup=c.name;b=c;}else{b=apf.nameserver.get("validgroup",c);}this.$validgroup=b||new apf.ValidationGroup(c);this.$validgroup.register(this);}else{this.$validgroup.unregister(this);this.$validgroup=null;}};this.$propHandlers.pattern=function(b,c){if(b.substr(0,1)!="/"){b="/"+b+"/";}(this.$vOptions||(this.$vOptions={}))[c]=b;delete this.$vOptions.isValid;};this.$propHandlers.datatype=this.$propHandlers.required=this.$propHandlers.custom=this.$propHandlers.min=this.$propHandlers.max=this.$propHandlers.maxlength=this.$propHandlers.minlength=this.$propHandlers.notnull=this.$propHandlers.checkequal=function(b,c){(this.$vOptions||(this.$vOptions={}))[c]=b;delete this.$vOptions.isValid;};this.$propHandlers.validtest=function(d){var b=this,c={};this.removeValidationCache=function(){c={};};this.$checkRemoteValidation=function(){var g=this.getValue();if(typeof c[g]=="boolean"){return c[g];}if(c[g]==-1){return true;}c[g]=-1;apf.getData(this.validtest.toString(),{xmlNode:this.xmlRoot,value:this.getValue(),callback:function(o,n,k){if(n!=apf.SUCCESS){if(n==apf.TIMEOUT&&k.retries<apf.maxHttpRetries){return k.tpModule.retry(k.id);}else{var m=new Error(apf.formatErrorString(0,b,"Validating entry at remote source","Communication error: \n\n"+k.message));if(b.dispatchEvent("error",apf.extend({error:m,state:status},k))!==false){throw m;}return;}}c[g]=apf.isTrue(o);if(!c[g]){if(!b.hasFocus()){b.setError();}}else{b.clearError();}}});return true;};(this.$vOptions||(this.$vOptions={})).custom="apf.lookup("+this.$uniqueId+").$checkRemoteValidation()";delete this.$vOptions.isValid;};};apf.GuiElement.propHandlers.datatype=apf.GuiElement.propHandlers.required=apf.GuiElement.propHandlers.pattern=apf.GuiElement.propHandlers.min=apf.GuiElement.propHandlers.max=apf.GuiElement.propHandlers.maxlength=apf.GuiElement.propHandlers.minlength=apf.GuiElement.propHandlers.notnull=apf.GuiElement.propHandlers.checkequal=apf.GuiElement.propHandlers.validtest=function(b,c){this.implement(apf.Validation);this.$propHandlers[c].call(this,b,c);};apf.ValidationGroup=function(b){this.$init();this.childNodes=[];if(b){apf.setReference(b,this);}this.name=b||"validgroup"+this.$uniqueId;apf.nameserver.register("validgroup",this.name,this);};(function(){this.validateVisibleOnly=false;this.allowMultipleErrors=false;this.register=function(o){if(o.hasFeature(apf.__VALIDATION__)){this.childNodes.push(o);}};this.unregister=function(o){this.childNodes.remove(o);};this.toString=function(){return"[APF Validation Group]";};var errbox;this.getErrorBox=function(o,no_create){if(this.allowMultipleErrors||!errbox&&!no_create){errbox=new apf.errorbox();errbox.$pHtmlNode=o.$ext.parentNode;errbox.skinset=apf.getInheritedAttribute(o.parentNode,"skinset");errbox.dispatchEvent("DOMNodeInsertedIntoDocument");}return errbox;};this.hideAllErrors=function(){if(errbox&&errbox.host){errbox.host.clearError();}};function checkValidChildren(oParent,ignoreReq,nosetError){var found;for(var v,i=0;i<oParent.childNodes.length;i++){var oEl=oParent.childNodes[i];if(!oEl){continue;}if(!oEl.disabled&&(!this.validateVisibleOnly&&oEl.visible||!oEl.$ext||oEl.$ext.offsetHeight)&&(oEl.hasFeature(apf.__VALIDATION__)&&oEl.isValid&&!oEl.isValid(!ignoreReq))){if(!nosetError){if(!found){oEl.validate(true,null,true);found=true;if(!this.allowMultipleErrors){return true;}}else{if(oEl.errBox&&oEl.errBox.host==oEl){oEl.errBox.hide();}}}else{if(!this.allowMultipleErrors){return true;}}}if(oEl.canHaveChildren&&oEl.childNodes.length){found=checkValidChildren.call(this,oEl,ignoreReq,nosetError)||found;if(found&&!this.allowMultipleErrors){return true;}}}return found;}this.checkValidity=this.validate=this.isValid=function(ignoreReq,nosetError,page){var found=checkValidChildren.call(this,page||this,ignoreReq,nosetError);if(page){if(page.validation&&!eval(page.validation)){alert(page.invalidmsg);found=true;}}return !found;};}).call(apf.ValidationGroup.prototype=new apf.Class());apf.config.$inheritProperties.validgroup=1;apf.__DATABINDING__=1<<1;apf.DataBinding=function(){this.$init(true);this.$loadqueue=this.$dbTimer=null;this.$regbase=this.$regbase|apf.__DATABINDING__;this.$mainBind="value";this.$bindings=this.$cbindings=this.$attrBindings=false;this.$attrExcludePropBind=apf.extend({model:1,each:1},this.$attrExcludePropBind);this.setQueryValue=function(k,o,m){var n=apf.createNodeFromXpath(this[m||"xmlRoot"],k);if(!n){return null;}apf.setNodeValue(n,o,true);return n;};this.queryValue=function(k,m){return apf.queryValue(this[m||"xmlRoot"],k);};this.queryValues=function(k,m){return apf.queryValues(this[m||"xmlRoot"],k);};this.queryNode=function(k,m){var o=this[m||"xmlRoot"];return o?o.selectSingleNode(k):null;};this.queryNodes=function(k,m){var o=this[m||"xmlRoot"];return o?o.selectNodes(k):[];};this.$checkLoadQueue=function(){if(this.$loadqueue){if(!this.caching){this.xmlRoot=null;}var k=this.load(this.$loadqueue[0],{cacheId:this.$loadqueue[1]});if(!k||k.dataType!=apf.ARRAY||k!=this.$loadqueue){this.$loadqueue=null;}}else{return false;}};this.$execProperty=function(s,n,r){var m=this.$attrBindings[s];if(this.nodeType==7){if(n!=this.xmlRoot){this.xmlRoot=n;}}try{if(m.cvalue.asyncs){var k=this;return m.cvalue.call(this,n,function(t){k.setProperty(s,t,true);});}else{var o=m.cvalue.call(this,n);}}catch(q){apf.console.warn("[400] Could not execute binding for property "+s+"\n\n"+q.message);return;}this.setProperty(s,r&&r.extra.range||o,true);};this.$applyBindRule=function(m,n,k,r,q){var o=this.$attrBindings[m]&&this.$attrBindings[m].cvalue||this.$cbindings[m];return o?o.call(this,n,r):k||"";};this.addEventListener("$clear",function(){var k;if(!this.$amlBindQueue||!(k=this.$amlBindQueue.caption)){return;}for(var n in k){var m=k[n];if(m.destroy){m.parentNode=m.$focusParent=m.$model=m.xmlRoot=null;m.destroy();}delete k[n];}});var d;this.addEventListener("afterload",d=function(){var k;if(!this.$amlBindQueue||!(k=this.$amlBindQueue.caption||this.$amlBindQueue.column)){return;}var r,q=this.ownerDocument;for(var o,n=0,m=k.length;n<m;n++){if(!k[n]){continue;}r=document.getElementById("placeholder_"+this.$uniqueId+"_"+n);o=q.createProcessingInstruction("lm",this.$cbindings.caption||this.$cbindings.column);o.$model=this.$model;o.xmlRoot=k[n];o.$noInitModel=true;o.$focusParent=this;o.parentNode=this;o.dispatchEvent("DOMNodeInsertedIntoDocument",{pHtmlNode:r});k[o.xmlRoot.getAttribute(apf.xmldb.xmlIdTag)]=o;delete k[n];}k.length=0;});this.addEventListener("xmlupdate",function(n){if(n.xmlNode!=n.traverseNode){return;}if("insert|add|synchronize|move".indexOf(n.action)>-1){d.call(this,n);}else{if("remove|move-away".indexOf(n.action)>-1){var k;if(!this.$amlBindQueue||!(k=this.$amlBindQueue.caption)){return;}var m=k[n.xmlNode.getAttribute(apf.xmldb.xmlIdTag)];m.parentNode=m.$focusParent=m.$model=m.xmlRoot=null;m.destroy();}}});this.$hasBindRule=function(k){return this.$attrBindings[k]||this.$bindings&&this.$bindings[k];};this.$getBindRule=function(k,m){return this.$attrBindings[k]||this.$bindings&&this.$bindings.getRule(k,m);};var c={drag:1,drop:1,dragcopy:1};this.$getDataNode=function(n,o,t,m,k){var r,s=this.$attrBindings[n];if(s){if(s.cvalue.type!=3){return false;}var q=s.cvalue2||s.compile("value",{xpathmode:k?4:3,parsecode:1,injectself:c[n]});if(q&&(r=q(o,t))){if(m){m.push(s);}return r;}return false;}return this.$bindings&&this.$bindings.getDataNode(n,o,t,m,k);};this.setModel=function(k){this.setAttribute("model",k,false,true);};this.getModel=function(k){if(k&&!this.$model){return this.dataParent?this.dataParent.parent.getModel(true):null;}return this.$model;};this.reload=this.reload||function(){this.load(this.xmlRoot,{cacheId:this.cacheId,force:true});};this.load=function(m,k){if(k){var q=k.cacheId,o=k.force,r=k.noClearMsg;}if(q&&q==this.cacheId&&!o){return;}if(apf.popup.isShowing(this.$uniqueId)){apf.popup.forceHide();}if(m){if(typeof m=="string"){if(m.charAt(0)=="<"){m=apf.getXmlDom(m).documentElement;}else{return apf.model.prototype.$loadFrom.call(this,m,k);}}else{if(m.nodeType==9){m=m.documentElement;}else{if(m.nodeType==3||m.nodeType==4){m=m.parentNode;}else{if(m.nodeType==2){m=m.ownerElement||m.parentNode||m.selectSingleNode("..");}}}}}if(this.$preventDataLoad||!this.$canLoadData&&((!this.$bindings&&(!this.$canLoadDataAttr||!this.each))||!this.$amlLoaded)&&(!this.hasFeature(apf.__MULTISELECT__)||!this.each)||this.$canLoadData&&!this.$canLoadData()){if(!this.caching||!this.hasFeature(apf.__CACHE__)){this.xmlRoot=m;this.setProperty("root",this.xmlRoot);}return this.$loadqueue=[m,q];}if(this.dataParent&&this.dataParent.xpath){this.dataParent.parent.signalXmlUpdate[this.$uniqueId]=!m;}if(!m&&(!q||!this.$isCached||!this.$isCached(q))){this.clear(r);if(apf.config.autoDisable&&this.$createModel===false){this.setProperty("disabled",true);}return;}if(!this.caching&&!o&&m&&!this.$loadqueue&&m==this.xmlRoot){return;}var n=this.disabled;this.disabled=false;if(this.dispatchEvent("beforeload",{xmlNode:m})===false){return false;}this.clear(true,true);this.cacheId=q;if(this.dispatchEvent("$load",{forceNoCache:o,xmlNode:m})===false){return;}this.documentId=apf.xmldb.getXmlDocId(m);this.xmlRoot=m;this.setProperty("root",this.xmlRoot);this.$load(m);this.$loadSubData(m);if(this.$createModel===false){this.disabled=true;this.setProperty("disabled",false);}else{this.disabled=n;}this.dispatchEvent("afterload",{xmlNode:m});};this.$loadSubData=function(k){if(this.$hasLoadStatus(k)&&!this.$hasLoadStatus(k,"potential")){return;}var o=this.$getBindRule("load",k);if(o&&(!o[1]||o[1](k))){this.$setLoadStatus(k,"loading");if(this.$setClearMessage){this.$setClearMessage(this["loading-message"],"loading");}var n=this.getModel(true);var m=this;if(n.$insertFrom(o.getAttribute("get"),{xmlNode:k,insertPoint:k,amlNode:this,callback:function(){m.setProperty(m.hasFeature(apf.__MULTISELECT__)?"selected":"root",k);}})===false){this.clear(true);if(apf.config.autoDisable){this.setProperty("disabled",true);}}}};this.clear=function(n,q,m){if(!this.$container){return;}if(this.clearSelection){this.clearSelection(true);}var o=this.$container.offsetHeight;if(this.dispatchEvent("$clear")!==false){this.$container.innerHTML="";}if(typeof n=="string"){var k=n;n=false;if(!this[k+"-message"]){this.$setInheritedAttribute(k+"-message");}}this.$lastClearType=k||null;if(!n&&this.$setClearMessage){this.$setClearMessage(k?this[k+"-message"]:this["empty-message"],k||"empty",o);}else{if(this.$removeClearMessage){this.$removeClearMessage();}}if(!m){this.documentId=this.xmlRoot=this.cacheId=null;}if(!n){if(this.hasFeature(apf.__MULTISELECT__)){this.setProperty("length",0);}}};this.clearMessage=function(k){this.customMsg=k;this.clear("custom");};this.$setLoadStatus=function(q,t,n){var u=this.loadgroup||"default";var r=new RegExp("\\|(\\w+)\\:"+u+":(\\d+)\\|");var o=q.getAttribute("a_loaded")||"";var k;if(!n&&(k=o.match(r))&&k[1]!="potential"&&k[2]!=this.$uniqueId){return;}var s=o.replace(r,"");if(!n){s+="|"+t+":"+u+":"+this.$uniqueId+"|";}q.setAttribute("a_loaded",s);};this.$removeLoadStatus=function(k){this.$setLoadStatus(k,null,true);};this.$hasLoadStatus=function(k,o,r){var n=k.getAttribute("a_loaded");if(!n){return false;}var q=this.loadgroup||"default";var m=new RegExp("\\|"+(o||"\\w+")+":"+q+":"+(r?this.$uniqueId:"\\d+")+"\\|");return n.match(m)?true:false;};this.insert=function(n,k){if(typeof n=="string"){if(n.charAt(0)=="<"){n=apf.getXmlDom(n).documentElement;}else{if(!k.insertPoint){k.insertPoint=this.xmlRoot;}return apf.model.prototype.$insertFrom.call(this,n,k);}}var o=k.insertPoint||this.xmlRoot;if(this.dispatchEvent("beforeinsert",{xmlParentNode:o})===false){return false;}if(typeof k.copyAttributes=="undefined"){k.copyAttributes=true;}var m=apf.mergeXml(n,o,k);apf.xmldb.applyChanges("insert",o);if(this.selectable&&this.autoselect){if(this.xmlNode==m){this.$selectDefault(this.xmlNode);}}else{if(this.xmlNode==m){this.setProperty("root",this.xmlNode);}}if(this.$hasLoadStatus(o,"loading")){this.$setLoadStatus(o,"loaded");}this.dispatchEvent("afterinsert");};this.$booleanProperties["render-root"]=true;this.$supportedProperties.push("empty-message","loading-message","offline-message","render-root","smartbinding","bindings","actions");this.$propHandlers["render-root"]=function(k){this.renderRoot=k;};this.$propHandlers["empty-message"]=function(k){this["empty-message"]=k;if(this.$updateClearMessage){this.$updateClearMessage(this["empty-message"],"empty");}};this.$propHandlers["loading-message"]=function(k){this["loading-message"]=k;if(this.$updateClearMessage){this.$updateClearMessage(this["loading-message"],"loading");}};this.$propHandlers["offline-message"]=function(k){this["offline-message"]=k;if(this.$updateClearMessage){this.$updateClearMessage(this["offline-message"],"offline");}};this.$propHandlers.smartbinding=this.$propHandlers.actions=this.$propHandlers.bindings=function(m,n){var k="$"+n+"Element";if(this[k]){this[k].unregister(this);}if(!m){return;}apf.nameserver.get(n,m).register(this);if(n!="actions"&&this.$checkLoadQueue()===false&&this.$amlLoaded){1+1;}};var g={caption:1,icon:1,select:1,css:1,sort:1,drop:2,drag:2,dragcopy:2,eachvalue:1};this.$addAttrBind=function(k,o,u){if(o.models){if(this.hasFeature(apf.__MULTISELECT__)){}}var q,s,x,r,y=o.xpaths,t={};for(q=0;q<y.length;q+=2){if(!t[(x=y[q])]){t[x]=1;}else{t[x]++;}}if(!this.$propsUsingMainModel){this.$propsUsingMainModel={};}var w=(this.$attrBindings||(this.$attrBindings={}))[k]={cvalue:o,value:u,compile:apf.BindingRule.prototype.$compile,models:[]};delete this.$propsUsingMainModel[k];for(s,q=0;q<y.length;q+=2){x=y[q];if(t[x]==-1){continue;}s=y[q+1];if(x=="#"||s=="#"){var n=(w.cvalue3||(w.cvalue3=apf.lm.compile(w.value,{xpathmode:5})))(this.xmlRoot);if(typeof n!="string"){r=n.model&&n.model.$isModel&&n.model;if(r){s=n.xpath;}else{if(n.model){r=typeof n.model=="string"?apf.xmldb.findModel(n.model):n.model;s=apf.xmlToXpath(n.model,r.data)+(n.xpath?"/"+n.xpath:"");}else{this.addEventListener("prop."+k,function(C){var B=(w.cvalue3||(w.cvalue3=apf.lm.compile(w.value,{xpathmode:5})))(this.xmlRoot);if(B.model){this.removeEventListener("prop."+k,arguments.callee);var A=this;setTimeout(function(){A.$clearDynamicProperty(k);A.$setDynamicProperty(k,u);},10);}});continue;}}}else{r=null;}}else{r=null;}if(!r){if(x){r=apf.nameserver.get("model",x)||apf.setReference(x,apf.nameserver.register("model",x,new apf.model()));}else{if(!this.$model&&!this.$initingModel){b.call(this);}r=this.$model;if(!this.hasFeature(apf.__MULTISELECT__)&&g[k]!=2||!g[k]){this.$propsUsingMainModel[k]={xpath:s,optimize:t[x]==1};}}}if(r&&(!this.hasFeature(apf.__MULTISELECT__)&&g[k]!=2||!g[k])){r.$bindXmlProperty(this,k,s,t[x]==1);w.models.push(r);}t[x]=-1;}w.xpath=s;this.$canLoadDataAttr=g[k]==1;this.$checkLoadQueue();};this.$removeAttrBind=function(o){var m=this.$attrBindings[o];if(!m){return;}delete this.$attrBindings[o];delete this.$propsUsingMainModel[o];var n=m.models;if(n.length){for(var k=0;k<n.length;k++){n[k].$unbindXmlProperty(this,o);}}else{if(this.$model){this.$model.$unbindXmlProperty(this,o);}}};this.$initingModel;function b(){this.$initingModel=true;this.$setInheritedAttribute("model");}this.addEventListener("DOMNodeInsertedIntoDocument",function(k){if(!this.model&&this.$setClearMessage&&!this.value){this.$setClearMessage(this["empty-message"],"empty");}this.$amlLoaded=true;this.$checkLoadQueue();});this.$propHandlers.model=function(s){if(!s&&!this.$modelParsed){if(this.$model){this.clear();this.$model.unregister(this);this.$model=null;this.lastModelId="";}else{if(this.dataParent){this.dataParent.parent=null;}}return;}this.$initingModel=true;var m;if((m=this.$modelParsed)&&m.type!=2){var u,r=m.props;if(this.dataParent){this.dataParent=null;}for(var k in r){this.dataParent={parent:self[k.split(".")[0]],xpath:null,model:this.$modelParsed.instruction};u=true;break;}if(u){if(this.dataParent&&!this.dataParent.signalXmlUpdate){this.dataParent.signalXmlUpdate={};}}this.$modelParsed=null;}var n;if(typeof s=="object"){if(s.dataType==apf.ARRAY){n=apf.nameserver.get("model",s[0]);n.register(this,s[1]);return;}else{if(s.$isModel){n=s;s=this.model=n.name;if(!s){n.setProperty("id",s=this.model="model"+n.$uniqueId);}}else{if(this.dataParent){this.model=this.dataParent.model;}n=apf.xmldb.findModel(s);if(!n){return;}var o=apf.xmlToXpath(s,null,true)||".";n.register(this,o);return;}}}else{if(s.indexOf("[::")>-1){var n,t=this;do{t=t.parentNode;n=t.getAttribute("model");}while(t.parentNode&&t.parentNode.nodeType==1&&(!n||n==s));if(n&&typeof n=="object"){n=n.id;}this.$inheritProperties.model=3;if(n){s=s.replace(/\[\:\:/g,"["+n+"::");}else{apf.console.warn("No found model on any of the parents for this element while trying to overload model: "+s);return;}}}clearTimeout(this.$dbTimer);if(!this.$amlLoaded&&this.nodeType==1){var q=this;this.$dbTimer=$setTimeout(function(){if(!q.$amlDestroyed){apf.setModel(s,q);}});}else{apf.setModel(s,this);}};this.$propHandlers.viewport=function(k){if(k!="virtual"){return;}this.implement(apf.VirtualViewport);};};apf.DataBinding.prototype=new apf[apf.Presentation?"Presentation":"AmlElement"]();apf.config.$inheritProperties.model=1;apf.config.$inheritProperties["empty-message"]=1;apf.config.$inheritProperties["loading-message"]=1;apf.config.$inheritProperties["offline-message"]=1;apf.config.$inheritProperties.noloading=1;apf.Init.run("databinding");apf.MultiselectBinding=function(){if(!this.setQueryValue){this.implement(apf.DataBinding);}this.$regbase=this.$regbase|apf.__MULTISELECT__;this.$init(function(){this.$selectTimer={};});};(function(){this.length=0;this.$attrExcludePropBind=apf.extend({caption:2,icon:2,eachvalue:2,select:2,css:2,sort:2,drag:2,drop:2,dragcopy:2,selected:3,each:1,selection:3,"selection-unique":3,"selection-constructor":3},this.$attrExcludePropBind);this.resort=function(k,d,g){if(!this.$sort){this.$sort=new apf.Sort();}this.$sort.set(k,d);if(this.clearAllCache){this.clearAllCache();}if(g){return;}var c=this;(function m(q,t){if(!q){return;}var r=c.$sort.apply(apf.getArrayFromNodelist(q.selectNodes(c.each)));for(var o=0;o<r.length;o++){if(c.$isTreeArch||c.$withContainer){var s=apf.xmldb.findHtmlNode(r[o],c);var n=c.$findContainer(s);t.appendChild(s);if(!apf.isChildOf(s,n,true)){t.appendChild(n);}m(r[o],n);}else{t.appendChild(apf.xmldb.findHtmlNode(r[o],c));}}})(this.xmlRoot,this.$container);return k;};this.toggleSortOrder=function(){return this.resort({ascending:!this.$sort.get().ascending}).ascending;};this.getSortSettings=function(){return this.$sort.get();};this.getTraverseNodes=function(d){if(this.$sort){var c=apf.getArrayFromNodelist((d||this.xmlRoot).selectNodes(this.each));return this.$sort.apply(c);}return(d||this.xmlRoot).selectNodes(this.each);};this.getFirstTraverseNode=function(d){if(this.$sort){var c=(d||this.xmlRoot).selectNodes(this.each);return this.$sort.apply(c)[0];}return(d||this.xmlRoot).selectSingleNode(this.each);};this.getLastTraverseNode=function(d){var c=this.getTraverseNodes(d||this.xmlRoot);return c[c.length-1];};this.isTraverseNode=function(g){var c=this.getTraverseNodes(this.getTraverseParent(g)||this.xmlRoot);for(var d=0;d<c.length;d++){if(c[d]==g){return true;}}return false;};this.getNextTraverseSelected=function(k,c,n){if(!k){k=this.selected;}if(!n){n=1;}var g=0;var d=this.getTraverseNodes(this.getTraverseParent(k)||this.xmlRoot);while(d[g]&&d[g]!=k){g++;}var m=(c==null)?d[g+n]||d[g-n]:(c?d[g+n]:d[g-n]);return m||n&&(g<n||(g+1)>Math.floor(d.length/n)*n)?m:(c?d[d.length-1]:d[0]);};this.getNextTraverse=function(k,c,m){if(!m){m=1;}if(!k){k=this.selected;}var g=0;var d=this.getTraverseNodes(this.getTraverseParent(k)||this.xmlRoot);while(d[g]&&d[g]!=k){g++;}return d[g+(c?-1*m:m)];};this.getTraverseParent=function(d){if(!d.parentNode||d==this.xmlRoot){return false;}if(d.$regbase){return d.parentNode;}var c,g=d.getAttribute(apf.xmldb.xmlIdTag);if(!g){d.setAttribute(apf.xmldb.xmlIdTag,"temp");g="temp";}c=d.selectSingleNode("ancestor::node()[(("+this.each+")/@"+apf.xmldb.xmlIdTag+")='"+g+"']");if(g=="temp"){d.removeAttribute(apf.xmldb.xmlIdTag);}return c;};if(!this.$findHtmlNode){this.$findHtmlNode=function(c){return this.$pHtmlDoc.getElementById(c);};}this.$setClearMessage=function(n,g,m){if(this.more&&this.$addMoreItem){this.$addMoreItem();}if(!this.$empty){if(!this.$hasLayoutNode("empty")){return;}this.$getNewContext("empty");var d=this.$getLayoutNode("empty");if(!d){return;}this.$empty=apf.insertHtmlNode(d,this.$container);}else{this.$container.appendChild(this.$empty);}var k=this.$getLayoutNode("empty","caption",this.$empty);if(k){apf.setNodeValue(k,n||"");}this.$empty.setAttribute("id","empty"+this.$uniqueId);apf.setStyleClass(this.$empty,g,["loading","empty","offline"]);var c=apf.getStyle(this.$ext,"height");this.$empty.style.height=(m&&(!c||c=="auto")&&g!="empty")?(Math.max(10,(m-apf.getHeightDiff(this.$empty)-apf.getHeightDiff(this.$ext)))+"px"):"";};this.$updateClearMessage=function(g,c){if(!this.$empty||this.$empty.parentNode!=this.$container||this.$empty.className.indexOf(c)==-1){return;}var d=this.$getLayoutNode("empty","caption",this.$empty);if(d){apf.setNodeValue(d,g||"");}};this.$removeClearMessage=function(){if(!this.$empty){this.$empty=document.getElementById("empty"+this.$uniqueId);}if(this.$empty&&this.$empty.parentNode){this.$empty.parentNode.removeChild(this.$empty);}};this.$load=function(c){apf.xmldb.addNodeListener(c,this);var k=this.getTraverseNodes(c).length;if(!this.renderRoot&&!k){return this.clear(null,null,true);}var d=this.$addNodes(c,null,null,this.renderRoot);this.$fill(d);if(this.selectable){if(this.autoselect){if(!this.selected){if(this.renderRoot){this.select(c,null,null,null,true);}else{if(d.length){this.$selectDefault(c);}}}}else{this.clearSelection(true);var g=this.renderRoot?this.xmlRoot:this.getFirstTraverseNode();if(g){this.setCaret(g);}if(this.selected){this.setProperty("selected",null);}if(this.choosen){this.setProperty("choosen",null);}}}if(this.focussable){apf.document.activeElement==this?this.$focus():this.$blur();}if(k!=this.length){this.setProperty("length",k);}};var b={insert:127,replacenode:127,attribute:255,add:251,remove:46,"redo-remove":79,synchronize:127,"move-away":233,move:77};this.$xmlUpdate=function(F,k,s,y,C){if(!this.xmlRoot){return;}var w,n,d,t,J=k;if(!s){s=this.xmlRoot;}if(F=="redo-remove"){C.appendChild(k);var I=this.isTraverseNode(k);C.removeChild(k);if(!I){k=C;}}do{if(F=="add"&&this.isTraverseNode(k)&&J==k){break;}if(k.getAttribute(apf.xmldb.xmlIdTag)){t=this.$findHtmlNode(k.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);if(k==s&&!this.renderRoot){if(k==this.xmlRoot&&F!="insert"&&F!="replacenode"){this.dispatchEvent("xmlupdate",{action:F,xmlNode:k,UndoObj:y});return;}break;}if(t&&b[F]&2&&!this.isTraverseNode(k)){F="remove";}else{if(!t&&b[F]&4&&this.isTraverseNode(k)){F="add";break;}else{if(t&&(J!=k||k==this.xmlRoot)){if(b[F]&1){F="update";}else{if(F=="remove"){return;}}}}}if(t||F=="move"){break;}}else{if(b[F]&8&&this.isTraverseNode(k)){F="add";break;}}if(k==s){if(b[F]&128){return;}break;}k=k.parentNode;}while(k&&k.nodeType!=9);if(this.hasFeature(apf.__VIRTUALVIEWPORT__)){if(!this.$isInViewport(k)){return;}}var g=k;if(k&&k.nodeType==9){k=J;}if(F=="replacenode"){if(y?y.args[1]==this.xmlRoot:!this.xmlRoot.parentNode){return this.load(y?y.xmlNode:s,{force:true});}var D=this.getTraverseNodes();for(var G=0,E=D.length;G<E;G++){if(apf.isChildOf(J,D[G])){return this.load(this.xmlRoot,{force:true});}}}if(y&&k&&!y.xmlNode){y.xmlNode=k;}if(F=="move"&&g==J){var x=apf.isChildOf(this.xmlRoot,k.parentNode,true);var r=apf.isChildOf(this.xmlRoot,y.extra.parent,true);if(x&&r){this.$moveNode(k,t,y.extra.oldParent);}else{if(x){F="add";}else{if(r){F="remove";}}}}else{if(F=="move-away"){var A=apf.isChildOf(this.xmlRoot,y.extra.parent,true);if(!A){F="remove";}}}if(this.$removeClearMessage&&this.$setClearMessage){if(this.getFirstTraverseNode()){this.$removeClearMessage();}else{this.$setClearMessage(this["empty-message"],"empty");}}if(F=="insert"&&(this.$isTreeArch||k==this.xmlRoot)){if(!k){return;}if(this.$hasLoadStatus(k)&&this.$removeLoading){this.$removeLoading(t);}if(this.$container.firstChild&&!apf.xmldb.getNode(this.$container.firstChild)){this.$container.innerHTML="";if(!this.renderRoot){n=this.getTraverseNodes().length;if(!n){this.clear();}}}w=this.$addNodes(k,null,true,false,null,null,"insert");this.$fillParentHtml=(this.$getParentNode?this.$getParentNode(t):t);this.$fillParent=k;this.$fill(w);if(this.selectable&&(n===0||!this.xmlRoot.selectSingleNode(this.each))){return;}}else{if(F=="add"){var H;d=this.getTraverseParent(k);if(d==this.xmlRoot){H=this.$container;}if(!H&&this.$isTreeArch){H=this.$findHtmlNode(d.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);}if(!H&&this.getCacheItem){H=this.getCacheItem(d.getAttribute(apf.xmldb.xmlIdTag)||(d.getAttribute(apf.xmldb.xmlDocTag)?"doc"+d.getAttribute(apf.xmldb.xmlDocTag):false));}if(H||this.$isTreeArch&&d==this.xmlRoot){H=(this.$findContainer&&H?this.$findContainer(H):H)||this.$container;w=this.$addNodes(k,H,true,true,apf.xmldb.getHtmlNode(this.getNextTraverse(k),this));if(H){this.$fill(w);}}}else{if(F=="remove"){if(t){this.$deInitNode(k,t);}else{if(J==this.xmlRoot){return this.load(null,{noClearMsg:!this.dataParent||!this.dataParent.autoselect});}}}else{if(t){if(this.$sort){this.$moveNode(k,t);}this.$updateNode(k,t);if(F=="replacenode"&&this.hasFeature(apf.__MULTISELECT__)&&this.selected&&k.getAttribute(apf.xmldb.xmlIdTag)==this.selected.getAttribute(apf.xmldb.xmlIdTag)){this.selected=k;}}else{if(F=="redo-remove"){var c=this.xmlRoot;while(c&&c.nodeType!=9){c=c.parentNode;}if(!c){var m=this.getModel(true);return m.$waitForXml(this);}}}}}}d=k?k.parentNode:C;if(this.$isTreeArch&&!this.$preventRecursiveUpdate&&d&&d.nodeType==1){do{t=this.$findHtmlNode(d.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);if(t){this.$updateNode(d,t);}}while((d=this.getTraverseParent(d))&&d.nodeType==1);}if(b[F]&32&&this.selectable&&J==k&&(F!="insert"||k==this.xmlRoot)){clearTimeout(this.$selectTimer.timer);if(F=="remove"&&apf.isChildOf(k,this.selected,true)||k==this.$selectTimer.nextNode){this.$selectTimer.nextNode=this.getDefaultNext(k,this.$isTreeArch);}var q=this;this.$selectTimer.timer=$setTimeout(function(){q.$checkSelection(q.$selectTimer.nextNode);q.$selectTimer.nextNode=null;});}if(b[F]&64){if(!n){n=this.xmlRoot.selectNodes(this.each).length;}if(n!=this.length){this.setProperty("length",n);}}if(this.signalXmlUpdate&&b[F]&16){var u;for(u in this.signalXmlUpdate){if(parseInt(u)!=u){continue;}var B=apf.lookup(u);if(!this.selected){continue;}k=this.selected.selectSingleNode(B.dataParent.xpath);if(!k){continue;}B.load(k);}}this.dispatchEvent("xmlupdate",{action:F,xmlNode:J,traverseNode:k,result:w,UndoObj:y});};this.$addNodes=function(A,y,k,g,r,o,m){var x,d;g=(g&&(this.renderRoot&&A==this.xmlRoot||this.isTraverseNode(A)));var c=g?[A]:this.getTraverseNodes(A);var w,t;if(this.$isTreeArch&&this.caching&&(t=this.cache[(w=A.getAttribute(apf.xmldb.xmlIdTag))])){if(this.$subTreeCacheContext||this.$needsDepth){this.clearCacheItem(w);}else{this.$subTreeCacheContext={oHtml:t,container:y,parentNode:null,beforeNode:null};var x;while(t.childNodes.length){(y||this.$container).appendChild(x=t.childNodes[0]);}return c;}}if(this.$isTreeArch&&o===null&&m=="insert"){o=0,loopNode=A;while(loopNode&&loopNode!=this.xmlRoot){o++;loopNode=this.getTraverseParent(loopNode);}}for(var n=0;n<c.length;n++){if(c[n].nodeType!=1){continue;}if(k){x=this.$findHtmlNode(c[n].getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);}if(!x){var s=apf.xmldb.nodeConnect(this.documentId,c[n],null,this);var u=g?r:(d?d.nextSibling:null),q=this.$add(c[n],s,g?A.parentNode:A,u?y||this.$container:y,u,(!u&&n==c.length-1),o,c[n+1],m);if(q===false){break;}}if(k){d=x;}}return c;};this.$handleBindingRule=function(g,k){if(!g){this[k]=null;}if(k=="each"){g=g.charAt(0)=="["&&g.charAt(g.length-1)=="]"?g.replace(/^\[|\]$/g,""):g;if(g.indexOf("::")>-1){var d=g.split("::");if(!apf.xPathAxis[d[0]]){this.setProperty("model",d[0]);this.each=d[1];}else{this.each=g;}}else{this.each=g;}if(this.each==this.$lastEach){return;}this.$lastEach=g;if(!this.$model&&!this.$initingModel){this.$initingModel=true;this.$setInheritedAttribute("model");return;}if(this.$checkLoadQueue()!==false){return;}}if(this.xmlRoot&&!this.$bindRuleTimer&&this.$amlLoaded){var c=this;apf.queue.add("reload"+this.$uniqueId,function(){c.reload();});}};this.$select=function(c){if(this.renaming){this.stopRename(null,true);}if(!c||!c.style){return;}return this.$setStyleClass(c,"selected");};this.$deselect=function(c){if(this.renaming){this.stopRename(null,true);if(this.ctrlselect){return false;}}if(!c){return;}return this.$setStyleClass(c,"",["selected","indicate"]);};this.$indicate=function(c){if(this.renaming){this.stopRename(null,true);}if(!c){return;}return this.$setStyleClass(c,"indicate");};this.$deindicate=function(c){if(this.renaming){this.stopRename(null,true);}if(!c){return;}return this.$setStyleClass(c,"",["indicate"]);};this.$propHandlers.each=this.$propHandlers.caption=this.$propHandlers.eachvalue=this.$propHandlers.icon=this.$propHandlers.tooltip=this.$handleBindingRule;this.$propHandlers.sort=function(c){if(c){this.$sort=new apf.Sort();this.$sort.set({getValue:apf.lm.compile(c)});}else{this.$sort=null;}};}).call(apf.MultiselectBinding.prototype=new apf.DataBinding());apf.StandardBinding=function(){this.$init(true);if(apf.Validation){this.implement(apf.Validation);}if(!this.setQueryValue){this.implement(apf.DataBinding);}if(!this.defaultValue){this.defaultValue="";}this.$load=function(d){apf.xmldb.addNodeListener(d,this);var c,m,n,k,o,g;if(c=this.$bindings){for(n in c){m=n.toLowerCase();if(this.$supportedProperties.indexOf(m)>-1){o=(k=c[m]).length==1?k[0]:this.$getBindRule(m,d);g=o.value||o.match;this.$clearDynamicProperty(m);if(g.indexOf("{")>-1||g.indexOf("[")>-1){this.$setDynamicProperty(m,g);}else{if(this.setProperty){this.setProperty(m,g,true);}}}}}if(this.errBox&&this.isValid&&this.isValid()){this.clearError();}};this.$xmlUpdate=function(k,w,c,q){if(k=="redo-remove"){var d=false,m=this.getModel(true);if(m){var o=m.getXpathByAmlNode(this);if(o){w=m.data.selectSingleNode(o);if(w!=this.xmlRoot){d=true;}}}if(d||this.xmlRoot==w){return m.$waitForXml(this);}}if(q&&!q.xmlNode){q.xmlNode=this.xmlRoot;}var s,g,r,t,n,u;if(s=this.$bindings){for(r in s){g=r.toLowerCase();if(this.$supportedProperties.indexOf(g)>-1){n=(t=s[g]).length==1?t[0]:this.$getBindRule(g,w);u=n.value||n.match;this.$clearDynamicProperty(g);if(u.indexOf("{")>-1||u.indexOf("[")>-1){this.$setDynamicProperty(g,u);}else{if(this.setProperty){this.setProperty(g,u);}}}}}if(this.errBox&&this.isValid&&this.isValid()){this.clearError();}this.dispatchEvent("xmlupdate",{action:k,xmlNode:w,UndoObj:q});};this.addEventListener("$clear",function(c,b){if(this.$propHandlers&&this.$propHandlers.value){this.value=-99999;this.$propHandlers.value.call(this,"");}});};apf.StandardBinding.prototype=new apf.DataBinding();apf.Init.run("standardbinding");apf.__MULTISELECT__=1<<8;apf.MultiSelect=function(){this.$init(function(){this.$valueList=[];this.$selectedList=[];});};(function(){this.$regbase=this.$regbase|apf.__MULTISELECT__;this.sellength=0;this.selected=null;this.$selected=null;this.caret=null;this.$caret=null;this.useindicator=true;this.remove=function(c){if(!c){c=this.$valueList;}if(c.nodeType){c=[c];}if(!c||!c.length){return;}var g=[];for(var d=0;d<c.length;d++){g.push({action:"removeNode",args:[c[d]]});}if(this.$actions.removegroup){return this.$executeAction("multicall",g,"removegroup",c[0]);}else{return this.$executeAction("multicall",g,"remove",c[0],null,null,c.length>1?c:null);}};this.add=function(q,r,o,c){var n;if(this.$actions){if(q&&q.nodeType){n=this.$actions.getRule("add",q);}else{if(typeof q=="string"){if(q.trim().charAt(0)=="<"){q=apf.getXml(q);n=this.$actions.getRule("add",q);}else{var t=this.$actions.add;for(var k=0,g=t.length;k<g;k++){if(t[k].getAttribute("type")==q){q=null;n=t[k];break;}}}}}if(!n){n=(this.$actions.add||{})[0];}}else{n=null;}var m=this.$isTreeArch?this.selected||this.xmlRoot:this.xmlRoot,d=this,s=function(x,y,u){if(y!=apf.SUCCESS){var A;A=new Error(apf.formatErrorString(1032,d,"Loading xml data","Could not add data for control "+d.name+"["+d.tagName+"] \nUrl: "+u.url+"\nInfo: "+u.message+"\n\n"+q));if(u.tpModule.retryTimeout(u,y,d,A)===true){return true;}throw A;}if(typeof x!="object"){x=apf.getXmlDom(x).documentElement;}if(x.getAttribute(apf.xmldb.xmlIdTag)){x.setAttribute(apf.xmldb.xmlIdTag,"");}var w=d.$actions&&d.$actions.getRule("add",d.$isTreeArch?d.selected:d.xmlRoot);if(!r){if(w&&w.parent){r=(w.cparent||w.compile("parent",{xpathmode:2,injectself:true}))(d.$isTreeArch?d.selected||d.xmlRoot:d.xmlRoot);}else{r=d.$isTreeArch?d.selected||d.xmlRoot:d.xmlRoot;}}if(!r){r=d.xmlRoot;}if(apf.isWebkit&&r.ownerDocument!=x.ownerDocument){x=r.ownerDocument.importNode(x,true);}if(d.$executeAction("appendChild",[r,x,o],"add",x)!==false&&d.autoselect){d.select(x);}if(c){c.call(d,x);}return x;};if(q){return s(q,apf.SUCCESS);}else{if(n.get){return apf.getData(n.get,{xmlNode:m,callback:s});}else{}}return addXmlNode;};if(!this.setValue){this.setValue=function(d,c){noEvent=c;this.setProperty("value",d,false,true);noEvent=false;};}this.findXmlNodeByValue=function(k){var d=this.getTraverseNodes(),c=this.$attrBindings.eachvalue&&"eachvalue"||this.$bindings.value&&"value"||this.$hasBindRule("caption")&&"caption";if(!c){return false;}for(var g=0;g<d.length;g++){if(this.$applyBindRule(c,d[g])==k){return d[g];}}};if(!this.getValue){this.getValue=function(d,c){return this.value;};}this.reselect=function(){if(this.selected){this.select(this.selected,null,this.ctrlselect,null,true);}};this.select=function(w,d,t,m,g,o,x){if(!this.selectable||x&&this.disabled){return;}if(parseInt(m)==m){if(m==2){m=true;x=true;}else{m=false;x=true;}}if(this.$skipSelect){this.$skipSelect=false;return;}if(this.ctrlselect&&!t){d=true;}if(!this.multiselect){d=t=false;}if(!this.xmlRoot){if(!this.$buffered){var q;this.addEventListener("afterload",q=function(){this.select.apply(this,this.$buffered);this.removeEventListener("afterload",q);delete this.$buffered;});}this.$buffered=Array.prototype.slice.call(arguments);return;}var u;if(!w){return false;}if(typeof w!="object"){var s=w;w=null;if(typeof w=="string"){w=apf.xmldb.getNodeById(s);}if(!w){w=this.findXmlNodeByValue(s);if(!w){this.clearSelection(o);return;}}}if(!(typeof(w.style||"")=="object")){u=this.$findHtmlNode(w.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);}else{var c=(u=w).getAttribute(apf.xmldb.htmlIdTag);while(!c&&u.parentNode){c=(u=u.parentNode).getAttribute(apf.xmldb.htmlIdTag);}w=apf.xmldb.getNodeById(c);}if(!t&&!d&&!g&&!this.reselectable&&this.$valueList.length<=1&&this.$valueList.indexOf(w)>-1){return;}if(this.dispatchEvent("beforeselect",{selected:w,htmlNode:u,ctrlKey:d,shiftKey:t,force:g,captureOnly:o})===false){return false;}var k=this.caret;this.caret=w;if(t){var n=this.$calcSelectRange(this.$valueList[0]||k,w);if(this.$caret){this.$deindicate(this.$caret);}this.selectList(n);this.$selected=this.$caret=this.$indicate(u);}else{if(d){if(this.$valueList.contains(w)){if(this.selected==w){this.$deselect(this.$findHtmlNode(this.selected.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId));this.$deindicate(this.$caret);if(this.$valueList.length&&!m){this.selected=this.$valueList[0];}}else{this.$deselect(u,w);}if(!m){this.$selectedList.remove(u);this.$valueList.remove(w);}if(u!=this.$caret){this.$deindicate(this.$caret);}this.$selected=this.$caret=this.$indicate(u);}else{if(this.$caret){this.$deindicate(this.$caret);}this.$caret=this.$indicate(u,w);this.$selected=this.$select(u,w);this.selected=w;if(!m){this.$selectedList.push(u);this.$valueList.push(w);}}}else{if(m&&u&&this.$selectedList.contains(u)){return;}else{if(this.$selected){this.$deselect(this.$selected);}if(this.$caret){this.$deindicate(this.$caret);}if(this.selected){this.clearSelection(true);}this.$caret=this.$indicate(u,w);this.$selected=this.$select(u,w);this.selected=w;this.$selectedList.push(u);this.$valueList.push(w);}}}if(this.delayedselect&&(typeof d=="boolean")){var r=this;$setTimeout(function(){if(r.selected==w){r.dispatchEvent("afterselect",{selection:r.$valueList,selected:w,caret:r.caret,captureOnly:o});}},10);}else{this.dispatchEvent("afterselect",{selection:this.$valueList,selected:w,caret:this.caret,captureOnly:o});}return true;};this.choose=function(c,d){if(!this.selectable||d&&this.disabled){return;}if(this.dispatchEvent("beforechoose",{xmlNode:c})===false){return false;}if(c&&!(typeof(c.style||"")=="object")){this.select(c);}if(this.hasFeature(apf.__DATABINDING__)&&this.dispatchEvent("afterchoose",{xmlNode:this.selected})!==false){this.setProperty("chosen",this.selected);}};this.clearSelection=function(d,k){if(!this.selectable||k&&this.disabled||!this.$valueList.length){return;}if(!d){if(this.dispatchEvent("beforeselect",{selection:[],selected:null,caret:this.caret})===false){return false;}}var g;for(var c=this.$valueList.length-1;c>=0;c--){g=this.$findHtmlNode(this.$valueList[c].getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);this.$deselect(g);}this.$selectedList.length=0;this.$valueList.length=0;this.$selected=this.selected=null;if(this.caret){g=this.$findHtmlNode(this.caret.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);this.$caret=this.$indicate(g);}if(!d){this.dispatchEvent("afterselect",{selection:this.$valueList,selected:null,caret:this.caret});}};this.selectList=function(c,k,m,q){if(!this.selectable||q&&this.disabled){return;}if(this.dispatchEvent("beforeselect",{selection:c,selected:m||c[0],caret:this.caret,captureOnly:k})===false){return false;}this.clearSelection(true);for(var o,g=0;g<c.length;g++){if(!c[g]||c[g].nodeType!=1){continue;}var n,d=c[g];if(typeof d!="object"){d=apf.xmldb.getNodeById(d);}if(!(typeof(d.style||"")=="object")){n=this.$pHtmlDoc.getElementById(d.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);}else{n=d;d=apf.xmldb.getNodeById(n.getAttribute(apf.xmldb.htmlIdTag));}if(!d){continue;}if(n){if(!o&&m==n){o=n;}this.$select(n,d);this.$selectedList.push(n);}this.$valueList.push(d);}this.$selected=o||this.$selectedList[0];this.selected=m||this.$valueList[0];this.dispatchEvent("afterselect",{selection:this.$valueList,selected:this.selected,caret:this.caret,captureOnly:k});};this.setCaret=function(c){if(!c){if(this.$caret){this.$deindicate(this.$caret);}this.caret=this.$caret=null;return;}var d;if(typeof c!="object"){c=apf.xmldb.getNodeById(c);}if(!(typeof(c.style||"")=="object")){d=this.$findHtmlNode(c.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);}else{var g=(d=c).getAttribute(apf.xmldb.htmlIdTag);while(!g&&d.parentNode&&d.parentNode.nodeType==1){g=(d=d.parentNode).getAttribute(apf.xmldb.htmlIdTag);}if(!g){alert(this.$int.outerHTML);}c=apf.xmldb.getNodeById(g);}if(this.$caret){this.$deindicate(this.$caret);}this.$caret=this.$indicate(d);this.setProperty("caret",this.caret=c);};this.$setTempSelected=function(g,k,d,n){clearTimeout(this.timer);if(this.$bindings.selectable){while(g&&!this.$getDataNode("selectable",g)){g=this.getNextTraverseSelected(g,!n);}if(!g){return;}}if(!this.multiselect){k=d=false;}if(k||this.ctrlselect){if(this.$tempsel){this.select(this.$tempsel);this.$tempsel=null;}this.setCaret(g);}else{if(d){if(this.$tempsel){this.$selectTemp();this.$deselect(this.$tempsel);this.$tempsel=null;}this.select(g,null,d);}else{if(!this.bufferselect||this.$valueList.length>1){this.select(g);}else{var m=apf.xmldb.getID(g,this);this.$deselect(this.$tempsel||this.$selected);this.$deindicate(this.$tempsel||this.$caret);this.$tempsel=this.$indicate(document.getElementById(m));this.$select(this.$tempsel);var c=this;this.timer=$setTimeout(function(){c.$selectTemp();},400);}}}};this.$selectTemp=function(){if(!this.$tempsel){return;}clearTimeout(this.timer);this.select(this.$tempsel);this.$tempsel=null;this.timer=null;};this.selectAll=function(d){if(!this.multiselect||!this.selectable||d&&this.disabled||!this.xmlRoot){return;}var c=this.$isTreeArch?this.xmlRoot.selectNodes(".//"+this.each.split("|").join("|.//")):this.xmlRoot.selectNodes(this.each);this.selectList(c);};this.getSelection=function(c){var d,g;if(c){g=this.xmlRoot?this.xmlRoot.ownerDocument.createDocumentFragment():apf.getXmlDom().createDocumentFragment();for(d=0;d<this.$valueList.length;d++){apf.xmldb.cleanNode(g.appendChild(this.$valueList[d].cloneNode(true)));}}else{for(g=[],d=0;d<this.$valueList.length;d++){g.push(this.$valueList[d]);}}return g;};this.$getSelection=function(c){return c?this.$selectedList:this.$valueList;};this.defaultSelectNext=function(d,c){var g=this.getNextTraverseSelected(d);if(g||!c){this.select(g?g:this.getTraverseParent(d));}else{this.clearSelection(true);}};this.selectNext=function(){var c=this.getNextTraverse();if(c){this.select(c);}};this.selectPrevious=function(){var c=this.getNextTraverse(null,-1);if(c){this.select(c);}};this.getDefaultNext=function(d,c){var g=this.getNextTraverseSelected(d);return(g&&g!=d)?g:(c?this.getTraverseParent(d):null);};this.isSelected=function(d){if(!d){return false;}for(var c=0;c<this.$valueList.length;c++){if(this.$valueList[c]==d){return this.$valueList.length;}}return false;};this.$checkSelection=function(d){if(this.$valueList.length>1){for(var c=[],k=0,g=this.$valueList.length;k<g;k++){if(apf.isChildOf(this.xmlRoot,this.$valueList[k])){c.push(this.$valueList[k]);}}if(c.length>1){this.selectList(c);if(this.caret&&!apf.isChildOf(this.xmlRoot,this.caret)){this.setCaret(d||this.selected);}return;}else{if(c.length){d=c[0];}}}if(!d){if(this.selected&&!apf.isChildOf(this.xmlRoot,this.selected)){d=this.getFirstTraverseNode();}else{if(this.selected&&this.caret&&!apf.isChildOf(this.xmlRoot,this.caret)){this.setCaret(this.selected);}else{if(!this.selected){d=this.xmlRoot?this.getFirstTraverseNode():null;}else{return;}}}}if(d){if(this.autoselect){this.select(d);}else{if(!this.multiselect){this.clearSelection();}this.clearSelection();this.setCaret(d);}}else{this.clearSelection();}};this.selectable=true;if(typeof this.ctrlselect=="undefined"){this.ctrlselect=false;}if(typeof this.multiselect=="undefined"){this.multiselect=true;}if(typeof this.autoselect=="undefined"){this.autoselect=true;}if(typeof this.delayedselect=="undefined"){this.delayedselect=true;}if(typeof this.allowdeselect=="undefined"){this.allowdeselect=true;}this.reselectable=false;this.$booleanProperties.selectable=true;this.$booleanProperties.multiselect=true;this.$booleanProperties.autoselect=true;this.$booleanProperties.delayedselect=true;this.$booleanProperties.allowdeselect=true;this.$booleanProperties.reselectable=true;this.$supportedProperties.push("selectable","ctrlselect","multiselect","autoselect","delayedselect","allowdeselect","reselectable","selection","selected","default","value","caret");this.$propHandlers.value=function(d){if(this.$lastValue==d){delete this.$lastValue;return;}if(!this.$attrBindings.eachvalue&&!this.$amlLoaded&&this.getAttribute("eachvalue")){var c=this;return apf.queue.add("value"+this.$uniqueId,function(){c.$propHandlers.value.call(c,d);});}if(d||d===0||this["default"]){this.select(String(d)||this["default"]);}else{this.clearSelection();}};this.$propHandlers["default"]=function(c,d){if(!this.value||!this.$amlLoaded&&!(this.getAttribute("value")||this.getAttribute("selected")||this.getAttribute("selection"))){this.$propHandlers.value.call(this,"");}};this.$propHandlers.caret=function(c,d){if(c){this.setCaret(c);}};this.$propHandlers.selection=this.$propHandlers.selected=function(x,q){if(!x){x=this[q]=null;}if(q=="selected"&&typeof x!="string"){if(x&&x.nodeType!=1){x=x.nodeValue;}else{return;}}if(this.$isSelecting){this.selection=this.$valueList;return false;}var w,o,n,C,B,F,E;if(q=="selection"){if(typeof x=="object"&&x==this.$valueList){var g;if((F=this.$attrBindings[q])&&F.cvalue.models){this.$isSelecting=true;o=this.$attrBindings.eachvalue&&"eachvalue"||this.$bindings.value&&"value"||this.$hasBindRule("caption")&&"caption";if(!o){throw new Error("Missing bind rule set: eachvalue, value or caption");}var k=this.$getDataNode(q,this.xmlRoot);w=x;n=(E=this.$attrBindings["selection-unique"])&&E.cvalue;if(k.length){g=k[0].parentNode;}else{var t,u;if(F.cvalue.xpaths[0]=="#"||F.cvalue.xpaths[1]=="#"){var y=(F.cvalue3||(F.cvalue3=apf.lm.compile(F.value,{xpathmode:5})))(this.xmlRoot);t=y.model&&y.model.$isModel&&y.model;if(t){u=y.xpath;}else{if(y.model){t=apf.xmldb.findModel(y.model);u=apf.xmlToXpath(y.model,t.data)+(y.xpath?"/"+y.xpath:"");}else{}}}else{t=apf.nameserver.get("model",F.cvalue.xpaths[0]);u=F.cvalue.xpaths[1];}if(!t||!t.data){this.$isSelecting=false;return false;}g=t.queryNode(u.replace(/\/[^\/]+$|^[^\/]*$/,"")||".");if(!g){throw new Error("Missing parent node");}}remove_loop:for(C=0;C<k.length;C++){x=n?n(k[C]):this.$applyBindRule(o,k[C]);for(B=0;B<w.length;B++){if(this.$applyBindRule(o,w[B])==x){continue remove_loop;}}apf.xmldb.removeNode(k[C]);}add_loop:for(C=0;C<w.length;C++){x=this.$applyBindRule(o,w[C]);for(B=0;B<k.length;B++){if(n?n(k[B]):this.$applyBindRule(o,k[B])==x){continue add_loop;}}var A=this.$attrBindings["selection-constructor"]&&this.$getDataNode("selection-constructor",w[C])||apf.getCleanCopy(w[C]);apf.xmldb.appendChild(g,A);}this.$isSelecting=false;}return;}this.selection=this.$valueList;}else{this.selected=null;}if(!this.xmlRoot){if(!this.$buffered){var D;this.addEventListener("afterload",D=function(){this.removeEventListener("afterload",D);this.$propHandlers.selected.call(this,x,q);delete this.$buffered;});this.$buffered=true;}this[q]=null;return false;}if(!x||typeof x!="object"){if(this.$attrBindings[q]){w=this.$getDataNode(q,this.xmlRoot);if(w&&(w.length||w.nodeType==1)){this.setProperty("selection",w);return;}if(!w||w.length===0){return;}}if(!x){this.clearSelection();}else{this.select(x);}return false;}else{if(typeof x.length=="number"){w=x;if(!w.length){this.selected=null;if(this.$valueList.length){this.clearSelection();return false;}else{return;}}if(this.isTraverseNode(w[0])&&apf.isChildOf(this.xmlRoot,w[0])){if(!this.multiselect){this.select(w[0]);}else{this.selectList(w);}return false;}if(this.$attrBindings[q]){o=this.$attrBindings.eachvalue&&"eachvalue"||this.$bindings.value&&"value"||this.$hasBindRule("caption")&&"caption";if(!o){throw new Error("Missing bind rule set: eachvalue, value or caption");}var s=!this.each?this.getTraverseNodes():this.xmlRoot.selectNodes("//"+this.each.split("|").join("|//"));n=(F=this.$attrBindings["selection-unique"])&&F.cvalue;var r=[];for(C=0;C<w.length;C++){x=n?n(w[C]):this.$applyBindRule(o,w[C]);for(B=0;B<s.length;B++){if(this.$applyBindRule(o,s[B])==x){r.push(s[B]);}}}this.selectList(r,true);return false;}throw new Error("Show me which case this is");}else{if(this.$valueList.indexOf(x)==-1){this.select(x);}}}};this.$propHandlers.allowdeselect=function(d){if(d){var c=this;this.$container.onmousedown=function(k){if(!k){k=event;}if(k.ctrlKey||k.shiftKey){return;}var g=k.srcElement||k.target;if(c.allowdeselect&&(g==this||g.getAttribute(apf.xmldb.htmlIdTag))){c.clearSelection();}};}else{this.$container.onmousedown=null;}};this.$propHandlers.ctrlselect=function(c){if(c!="enter"){this.ctrlselect=apf.isTrue(c);}};function b(){this.selectAll();}this.$propHandlers.autoselect=function(c){if(c=="all"&&this.multiselect){this.addEventListener("afterload",b);}else{this.removeEventListener("afterload",b);}};this.$propHandlers.multiselect=function(c){if(!c&&this.$valueList.length>1){this.select(this.selected);}};this.addEventListener("beforeselect",function(c){if(this.$bindings.selectable&&!this.$getDataNode("selectable",c.selected)){return false;}},true);this.addEventListener("afterselect",function(k){var g=null;this.setProperty("caret",k.caret);if(this.sellength!=k.selection.length){this.setProperty("sellength",k.selection.length);}delete this.selection;this.setProperty("selection",k.selection);if(!k.selection.length){this.setProperty("selected",k.selected);if(this.value){this.setProperty("value","");}}else{this.$chained=true;if(!k.force&&(!this.dataParent||!this.dataParent.parent.$chained)){var c=this;$setTimeout(function(){if(c.selected==k.selected){c.setProperty("selected",g||k.selected);}delete c.$chained;},10);}else{this.setProperty("selected",g||k.selected);delete this.$chained;}var d=this.$attrBindings.eachvalue&&"eachvalue"||this.$bindings.value&&"value"||this.$hasBindRule("caption")&&"caption";if(d){this.$lastValue=this.$applyBindRule(d,k.selected);if(this.$lastValue!=(d!="value"&&(this.xmlRoot&&this.$applyBindRule("value",this.xmlRoot,null,true))||this.value)){if(d=="eachvalue"||this.xmlRoot!=this){this.change(this.$lastValue);}else{this.setProperty("value",this.$lastValue);}}delete this.$lastValue;}}},true);}).call(apf.MultiSelect.prototype=new apf.MultiselectBinding());apf.__CHILDVALUE__=1<<27;apf.ChildValue=function(){if(!this.$childProperty){this.$childProperty="value";}this.$regbase=this.$regbase|apf.__CHILDVALUE__;var c,b=/^[\s\S]*?>(<\?lm)?([\s\S]*?)(?:\?>)?<[^>]*?>$/;this.addEventListener("DOMCharacterDataModified",c=function(k){if(k&&(k.currentTarget==this||k.currentTarget.nodeType==2&&k.relatedNode==this)||this.$amlDestroyed){return;}if(this.getAttribute(this.$childProperty)){return;}var d=this.serialize().match(b),g=d&&d[2]||"";if(d&&d[1]){g="{"+g+"}";}if(g.indexOf("{")>-1||g.indexOf("[")>-1){this.$setDynamicProperty(this.$childProperty,g);}else{if(this[this.$childProperty]!=g){this.setProperty(this.$childProperty,g);}}});this.addEventListener("DOMAttrModified",c);this.addEventListener("DOMNodeInserted",c);this.addEventListener("DOMNodeRemoved",c);this.addEventListener("$skinchange",function(d){this.$propHandlers[this.$childProperty].call(this,this.caption||"");});this.$init(function(){this.addEventListener("prop."+this.$childProperty,function(d){if(!d.value&&!this.getAttributeNode(this.$childProperty)){c.call(this);}});});this.addEventListener("DOMNodeInsertedIntoDocument",function(k){var n=typeof this[this.$childProperty]=="undefined";if(n&&!this.getElementsByTagNameNS(this.namespaceURI,"*",true).length&&(this.childNodes.length>1||this.firstChild&&(this.firstChild.nodeType==1||this.firstChild.nodeValue.trim().length))){var d=(this.$aml&&this.$aml.xml||this.serialize()).match(b),g=d&&d[2]||"";if(d&&d[1]){g="{"+g+"}";}if(g.indexOf("{")>-1||g.indexOf("[")>-1){this.$setDynamicProperty(this.$childProperty,g);}else{this.setProperty(this.$childProperty,apf.html_entity_decode(g));}}else{if(n){this.$propHandlers[this.$childProperty].call(this,"");}}});};apf.__DATAACTION__=1<<25;apf.DataAction=function(){this.$regbase=this.$regbase|apf.__DATAACTION__;this.getActionTracker=function(g){if(!apf.AmlNode){return apf.window.$at;}var c=this,d=g?null:this.$at;if(!d&&this.dataParent){d=this.dataParent.parent.$at;}while(!d){if(!c.parentNode&&!c.$parentNode){var b;return(b=this.getModel&&this.getModel(true))&&b.$at||apf.window.$at;}d=(c=c.parentNode||c.$parentNode).$at;}return d;};this.$actionsLog={};this.$actions=false;this.$startAction=function(c,g,k){if(this.disabled||this.liveedit&&c!="edit"){return false;}var d=this.$actions&&this.$actions.getRule(c,g);if(!d&&apf.config.autoDisableActions&&this.$actions){return false;}var b=typeof apf.offline!="undefined";if(this.dispatchEvent(c+"start",{xmlContext:g})===false){return false;}this.$actionsLog[c]=g;return true;};this.$stopAction=function(c,d,b){delete this.$actionsLog[c];};this.$executeAction=function(u,n,d,t,o,g,w){var r=this.$actions&&this.$actions.getRule(d,t);if(!r&&this.$actions&&apf.config.autoDisableActions&&"action|change".indexOf(d)==-1){apf.console.warn("Could not execute action '"+d+"'.               No valid action rule was found and auto-disable-actions is enabled");return false;}var s;if(w){s=[];for(var c=w.length-1;c>=0;c--){s.unshift({xmlActionNode:r&&r[4],amlNode:this,selNode:w[c],xmlNode:w[c]});}}var q=new apf.AmlEvent("before"+d.toLowerCase(),{action:u,args:n,xmlActionNode:r,amlNode:this,selNode:g,multiple:s||false});if(!o){if(this.dispatchEvent(q.name,null,q)===false){return false;}delete q.currentTarget;}var b=this.getActionTracker();if(!b){return m;}var m=b.execute(q);q.xmlNode=m.xmlNode;q.undoObj=m;if(!o){q.name="after"+d.toLowerCase();q.cancelBubble=false;delete q.returnValue;delete q.currentTarget;this.dispatchEvent(q.name,null,q);}return m;};this.$executeSingleValue=function(b,r,x,w,o){var q,s,u=this.$getBindRule(r,x);if(!u){return false;}var t;["valuematch","match","value"].each(function(m){if(!u[m]||t){return;}t=u["c"+m];if(!t){t=u.compile(m);}if(t.type!=3){t=null;}});var y,n,g,c=t.xpaths,k=false;if(c[0]=="#"||c[1]=="#"){var d=(u.cvalue3||(u.cvalue3=apf.lm.compile(u.value,{xpathmode:5})))(x);n=d.model&&d.model.$isModel&&d.model;if(n){g=n.queryNode(d.xpath);x=n.data;}else{n=apf.xmldb.findModel(d.model);g=d.model.selectSingleNode(d.xpath);x=d.model;}c[1]=d.xpath;}else{n=c[0]&&apf.nameserver.get("model",c[0])||this.$model,g=n?n.queryNode(c[1]):(x||this.xmlRoot).selectSingleNode(c[1]);if(n&&!x){x=n.data;}}if(g){if(apf.queryValue(g)==w){return;}y=(g.nodeType==1||g.nodeType==3||g.nodeType==4)?"setTextNode":"setAttribute";s=(g.nodeType==1)?[g,w]:(g.nodeType==3||g.nodeType==4?[g.parentNode,w]:[g.ownerElement||g.selectSingleNode(".."),g.nodeName,w]);}else{if(!this.$createModel){return false;}y="setValueByXpath";q=c[1];if(!x){if(!n){n=this.getModel();}if(n){if(!n.data){n.load("<data />");}q=(n.getXpathByAmlNode(this)||".")+(q&&q!="."?"/"+q:"");x=n.data;}else{if(!this.dataParent){return false;}x=this.dataParent.parent.selected||this.dataParent.parent.xmlRoot;if(!x){return false;}q=(this.dataParent.xpath||".")+(q&&q!="."?"/"+q:"");k=true;}}s=[x,w,q];}if(o){return{action:y,args:s};}this.$executeAction(y,s,b,x);if(k){this.load(x.selectSingleNode(q));}};this.change=function(d,c){if(this.errBox&&this.errBox.visible&&this.isValid&&this.isValid()){this.clearError();}if(!this.xmlRoot&&!this.$createModel||!(this.$mainBind=="value"&&this.hasFeature(apf.__MULTISELECT__)?this.$attrBindings.value:this.$hasBindRule(this.$mainBind))){if(!c&&d===this.value||this.dispatchEvent("beforechange",{value:d})===false){return false;}this.setProperty("value",d);return this.dispatchEvent("afterchange",{value:d});}var b=this.$attrBindings.eachvalue&&"eachvalue"||this.$bindings.value&&"value"||this.$hasBindRule("caption")&&"caption";if(d==(b!="value"&&(this.xmlRoot&&this.$applyBindRule("value",this.xmlRoot,null,true))||this.value)){return false;}this.$executeSingleValue("change",this.$mainBind,this.xmlRoot,d);};this.$booleanProperties["render-root"]=true;this.$supportedProperties.push("create-model","actions");this.$propHandlers["create-model"]=function(b){this.$createModel=b;};this.addEventListener("DOMNodeInsertedIntoDocument",function(b){if(typeof this["create-model"]=="undefined"&&!this.$setInheritedAttribute("create-model")){this.$createModel=true;}});};apf.config.$inheritProperties["create-model"]=1;apf.__CACHE__=1<<2;apf.Cache=function(){this.cache={};this.$subTreeCacheContext=null;this.caching=true;this.$regbase=this.$regbase|apf.__CACHE__;this.addEventListener("$load",function(k){if(!this.caching||k.forceNoCache){return;}if(!this.cacheId){this.cacheId=this.$generateCacheId&&this.$generateCacheId(k.xmlNode)||k.xmlNode.getAttribute(apf.xmldb.xmlIdTag)||apf.xmldb.nodeConnect(apf.xmldb.getXmlDocId(k.xmlNode),k.xmlNode);}var g=c.call(this,this.cacheId,k.xmlNode);if(g){if(g==-1||!this.getTraverseNodes){return(k.returnValue=false);}var d=this.getTraverseNodes();if(d.length&&this.autoselect){this.select(d[0],null,null,null,true);}else{if(this.clearSelection){this.clearSelection();}}if(!d.length){this.$removeClearMessage();this.$setClearMessage(this["empty-message"],"empty");}if(d.length!=this.length){this.setProperty("length",d.length);}return false;}});this.addEventListener("$clear",function(){if(!this.caching){return;}if(this.hasFeature(apf.__MULTISELECT__)&&this.$subTreeCacheContext&&this.$subTreeCacheContext.oHtml){if(this.renderRoot){this.$subTreeCacheContext.parentNode.insertBefore(this.$subTreeCacheContext.oHtml,this.$subTreeCacheContext.beforeNode);}else{var d=this.$subTreeCacheContext.container||this.$container;while(d.childNodes.length){this.$subTreeCacheContext.oHtml.appendChild(d.childNodes[0]);}}this.documentId=this.xmlRoot=this.cacheId=this.$subTreeCacheContext=null;}else{if(this.$loadedWhenOffline){this.$loadedWhenOffline=false;}else{var g=this.$getCurrentFragment();if(!g){return;}g.documentId=this.documentId;g.xmlRoot=this.xmlRoot;if(this.cacheId||this.xmlRoot){b.call(this,this.cacheId||this.xmlRoot.getAttribute(apf.xmldb.xmlIdTag)||"doc"+this.xmlRoot.getAttribute(apf.xmldb.xmlDocTag),g);}}}});function c(r,m){if(m&&this.hasFeature(apf.__MULTISELECT__)&&this.$isTreeArch){var d,g=m.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId,n=this.$pHtmlDoc.getElementById(g);if(n){d=r?false:this.$container;}else{for(var q in this.cache){if(this.cache[q]&&this.cache[q].nodeType){n=this.cache[q].getElementById(g);if(n){d=r?q:this.cache[q];break;}}}}if(d&&!this.cache[r]){var o=this.$findHtmlNode(m.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);this.$subTreeCacheContext={oHtml:o,parentNode:o.parentNode,beforeNode:o.nextSibling,cacheItem:d};this.documentId=apf.xmldb.getXmlDocId(m);this.cacheId=r;this.xmlRoot=m;if(this.renderRoot){this.$container.appendChild(o);}else{while(o.childNodes.length){this.$container.appendChild(o.childNodes[0]);}}return true;}}if(!this.cache[r]){return false;}var k=this.cache[r];this.documentId=k.documentId;this.cacheId=r;this.xmlRoot=m;this.setProperty("root",this.xmlRoot);this.clearCacheItem(r);this.$setCurrentFragment(k);return true;}function b(g,d){if(!this.caching){return;}this.cache[g]=d;}this.$findHtmlNode=function(k){var d=this.$pHtmlDoc.getElementById(k);if(d){return d;}for(var g in this.cache){if(this.cache[g]&&this.cache[g].nodeType){d=this.cache[g].getElementById(k);if(d){return d;}}}return null;};this.clearCacheItem=function(g,d){this.cache[g].documentId=this.cache[g].cacheId=this.cache[g].xmlRoot=null;if(d){apf.destroyHtmlNode(this.cache[g]);}this.cache[g]=null;};this.clearAllCache=function(){for(var d in this.cache){if(this.cache[d]){this.clearCacheItem(d,true);}}};this.getCacheItem=function(d){return this.cache[d];};this.$isCached=function(d){return this.cache[d]||this.cacheId==d?true:false;};if(!this.$getCurrentFragment){this.$getCurrentFragment=function(){var d=this.$container.ownerDocument.createDocumentFragment();while(this.$container.childNodes.length){d.appendChild(this.$container.childNodes[0]);}return d;};this.$setCurrentFragment=function(d){this.$container.appendChild(d);if(!apf.window.hasFocus(this)&&this.blur){this.blur();}};}this.$booleanProperties.caching=true;this.$supportedProperties.push("caching");this.addEventListener("DOMNodeRemovedFromDocument",function(d){this.clearAllCache();});};apf.GuiElement.propHandlers.caching=function(b){if(!apf.isTrue(b)){return;}if(!this.hasFeature(apf.__CACHE__)){this.implement(apf.Cache);}};apf.__RENAME__=1<<10;apf.Rename=function(){this.$regbase=this.$regbase|apf.__RENAME__;this.canrename=false;this.$renameSubject=this.renameTimer=this.lastCursor=null;this.$booleanProperties.canrename=true;this.$booleanProperties.autorename=true;this.$supportedProperties.push("canrename","autorename");this.$propHandlers.autorename=function(d){if(d){this.reselectable=true;this.bufferselect=false;this.addEventListener("afterselect",b);this.addEventListener("keydown",c);}else{this.removeEventListener("afterselect",b);this.removeEventListener("keydown",c);}};function b(){var d=this;$setTimeout(function(){if(d.hasFocus()){d.startRename();}},20);}function c(d){if(!this.renaming&&apf.isCharacter(d.keyCode)){this.startRename();}}this.$isContentEditable=function(d){if(this.renaming&&this.autorename){return true;}};this.rename=function(d,g){if(!d){d=this.caret||this.selected;}if(!d){return;}this.$executeSingleValue("rename","caption",d,g);};this.startDelayedRename=function(g,d,k){if(g&&(g.button==2||g.ctrlKey||g.shiftKey)||k&&this.disabled){return;}clearTimeout(this.renameTimer);this.renameTimer=$setTimeout("apf.lookup("+this.$uniqueId+").startRename()",d||400);};this.startRename=function(g,q,s){if(!g&&(this.renaming||!this.canrename||!this.$startAction("rename",this.caret||this.selected,this.stopRename))||s&&this.disabled){return false;}if(!this.hasFocus()){this.focus(null,null,true);}clearTimeout(this.renameTimer);var n=this.$getCaptionElement?this.$getCaptionElement():this.$caret||this.$selected;if(!n){return this.stopRename();}this.renaming=true;this.$renameSubject=this.caret||this.selected;var d=n.offsetWidth;this.lastCursor=n.style.cursor;n.style.cursor="text";n.parentNode.replaceChild(this.$txt,n);n.host=this;if(apf.isTrue(this.$getOption("main","scalerename"))){var o=apf.getWidthDiff(this.$txt);this.$txt.style.width=(d-o-3)+"px";}this.$replacedNode=n;var r=this.$getCaptionXml?this.$getCaptionXml(this.$renameSubject):this.$getDataNode("caption",this.$renameSubject);value=q||!r?"":(r.nodeType!=1?unescape(r.nodeValue):(apf.isOnlyChild(r.firstChild,[3,4])?apf.queryValue(r):this.$applyBindRule("caption",this.$renameSubject)))||"";if(apf.hasContentEditable){if(this.$multiLineRename){this.$txt.innerHTML=apf.htmlCleaner.prepare(value.trim().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br />"));}else{this.$txt.innerHTML=value.replace(/</g,"&lt;")||apf.hasContentEditableContainerBug&&"<br>"||"";}}else{this.$txt.value=value;}this.$txt.unselectable="Off";this.$txt.host=this;var k=this.$txt;var m=function(){try{k.focus();k.select();}catch(t){}};if(apf.isIE){m();}else{setTimeout(m);}};this.stopRename=function(d,k){clearTimeout(this.renameTimer);if(!this.renaming||d&&d!=this.$renameSubject||!this.$replacedNode){return false;}this.renaming=false;if(this.$txt.parentNode&&this.$txt.parentNode.nodeType==1){if(apf.isIE8||apf.isIE7Emulate){this.$txt.blur();}this.$txt.parentNode.replaceChild(this.$replacedNode,this.$txt);}if(this.$replacedNode){this.$replacedNode.style.cursor=this.lastCursor||"";this.$replacedNode.host=null;}if(this.$multiLineRename){var g=apf.html_entity_decode(apf.htmlCleaner.parse(this.$txt.innerHTML,true).replace(/<br \/>/g,"").replace(/<\/?p>/g,""));}else{var g=this.$txt[apf.hasContentEditable?"innerText":"value"].replace(/<.*?nobr>/gi,"").replace(/\n$/,"");}if(!k||(this.$validateRename&&!this.$validateRename(g))){this.dispatchEvent("stoprename");this.$stopAction("rename");}else{if(this.$replacedNode){this.$replacedNode.innerHTML=g.replace(/</g,"&lt;").replace(/\r?\n/g,"<br />");}this.rename(this.$renameSubject,g);}if(!this.renaming){this.$renameSubject=null;this.$replacedNode=null;this.$txt.style.width="";}return true;};this.addEventListener("keydown",function(g){var d=g.keyCode;if(this.renaming){if(d==27||this.$multiLineRename&&g.ctrlKey&&d==13||!this.$multiLineRename&&d==13){this.stopRename(null,d==13&&!this.$autocomplete);g.cancelBubble=true;return false;}else{if(apf.hasContentEditableContainerBug&&d==8&&this.$txt.innerHTML=="<br>"){g.preventDefault();}}return;}if(d==113){if(this.$tempsel){this.$selectTemp();}if(this.caret!=this.selected){if(this.multiselect||this.isSelected(this.caret)){this.selected=this.caret;this.$selected=this.$caret;}else{this.select(this.caret,true);}}this.startRename();return false;}},true);this.addEventListener("DOMNodeRemovedFromDocument",function(d){this.$txt.refCount--;if(!this.$txt.refCount){this.$txt.host=this.$txt.onmouseover=this.$txt.onmousedown=this.$txt.select=this.$txt.onfocus=this.$txt.onblur=null;}this.$txt=null;});this.$init(apf.Rename.initEditableArea);};apf.Rename.initEditableArea=function(){if(!(this.$txt=document.getElementById("txt_rename"))){if(apf.hasContentEditable){this.$txt=document.createElement("DIV");this.$txt.contentEditable=true;if(apf.isIE6){this.$txt.style.width="1px";}}else{this.$txt=document.createElement("input");this.$txt.id="txt_rename";this.$txt.autocomplete=false;}this.$txt.refCount=0;this.$txt.id="txt_rename";apf.importCssString("#txt_rename{white-space:nowrap}");this.$txt.onselectstart=function(c){(c||event).cancelBubble=true;};this.$txt.onmouseover=this.$txt.onmouseout=this.$txt.oncontextmenu=this.$txt.onmouseup=this.$txt.onmousedown=function(c){apf.stopPropagation(c||event);};this.$txt.onkeyup=function(c){if(!this.host.$autocomplete){return;}this.host.$lookup(this[apf.hasContentEditable?"innerHTML":"value"]);};var b;this.$txt.select=function(){if(!apf.hasMsRangeObject){(b||(b=new apf.selection())).selectNode(this);return;}var c=document.selection.createRange();try{c.moveToElementText(this);if(apf.isFalse(this.host.$getOption("main","selectrename"))||typeof this.host.$renameStartCollapse!="undefined"){c.collapse(this.host.$renameStartCollapse);}}catch(d){}c.select();};if(apf.hasFocusBug){this.$txt.onfocus=function(){if(apf.window){apf.window.$focusfix2();}};}this.$txt.onblur=function(){if(apf.hasFocusBug){apf.window.$blurfix();}if(this.host.$autocomplete){return;}this.host.stopRename(null,true);};}this.$txt.refCount++;};apf.__ALIGNMENT__=1<<29;apf.BaseButton=function(){this.$init(true);};(function(){this.implement(apf.ChildValue);this.$refKeyDown=this.$refMouseDown=0;this.$mouseOver=this.$mouseLeft=false;this.$propHandlers.background=function(d){var g=this.$getLayoutNode("main","background",this.$ext);if(!g){return;}if(d){var c=d.split("|");this.$background=c.concat(["vertical",2,16].slice(c.length-1));g.style.backgroundImage="url("+this.mediaPath+c[0]+")";g.style.backgroundRepeat="no-repeat";}else{g.style.backgroundImage="";g.style.backgroundRepeat="";this.$background=null;}};this.addEventListener("keydown",function(c){var b=c.keyCode;switch(b){case 13:if(this.localName!="checkbox"){this.$ext.onmouseup(c.htmlEvent,true);}break;case 32:if(!c.htmlEvent.repeat){this.$refKeyDown++;this.$updateState(c.htmlEvent);}return false;}},true);this.addEventListener("keyup",function(c){var b=c.keyCode;switch(b){case 32:this.$refKeyDown--;if(this.$refKeyDown<0){this.$refKeyDown=0;return false;}if(this.$refKeyDown+this.$refMouseDown==0&&!this.disabled){this.$ext.onmouseup(c,true);}this.$updateState(c);return false;}},true);this.states={Out:1,Over:2,Down:3};this.$updateState=function(c,b){if(c.reset){this.$refKeyDown=0;this.$refMouseDown=0;this.$mouseOver=false;return false;}if(this.$refKeyDown>0||(this.$refMouseDown>0&&this.$mouseOver)||(this.isBoolean&&this.value)){this.$setState("Down",c,b);}else{if(this.$mouseOver){this.$setState("Over",c,b);}else{this.$setState("Out",c,b);}}};this.$setupEvents=function(){if(this.editable){return;}var b=this;this.$ext.onmousedown=function(c){c=c||window.event;if(b.$notfromext&&(c.srcElement||c.target)==this){return;}b.$refMouseDown=1;b.$mouseLeft=false;if(b.disabled){return;}if(!apf.isIE){if(b.value){apf.stopEvent(c);}else{apf.cancelBubble(c);}}b.$updateState(c,"mousedown");};this.$ext.onmouseup=function(d,c){d=d||window.event;if(b.disabled||!c&&(!b.$mouseOver||!b.$refMouseDown)){return;}b.$refMouseDown=0;b.$updateState(d,"mouseup");if(b.disabled||(d&&d.type=="click"&&b.$mouseLeft==true)){return false;}if(b.$refMouseDown+b.$refKeyDown){return false;}if(b.$clickHandler&&b.$clickHandler()){b.$updateState(d||event,"click");}else{b.dispatchEvent("click",{htmlEvent:d});}return false;};this.$ext.onmousemove=function(c){if((!b.$mouseOver||b.$mouseOver==2)){c=c||window.event;if(b.$notfromext&&(c.srcElement||c.target)==this){return;}b.$mouseOver=true;if(!b.disabled){b.$updateState(c,"mouseover");}}};this.$ext.onmouseout=function(d){d=d||window.event;var c=d.explicitOriginalTarget||d.toElement;if(this==c||apf.isChildOf(this,c)){return;}b.$mouseOver=false;b.$refMouseDown=0;b.$mouseLeft=true;if(!b.disabled){b.$updateState(d,"mouseout");}};if(apf.hasClickFastBug){this.$ext.ondblclick=this.$ext.onmouseup;}};this.$doBgSwitch=function(c){if(this.background&&(this.$background[2]>=c||c==4)){if(c==4){c=this.$background[2]+1;}var b=this.$background[1]=="vertical"?"0 -"+(parseInt(this.$background[3])*(c-1))+"px":"-"+(parseInt(this.$background[3])*(c-1))+"px 0";this.$getLayoutNode("main","background",this.$ext).style.backgroundPosition=b;}};this.$focus=function(){if(!this.$ext){return;}this.$setStyleClass(this.$ext,this.$baseCSSname+"Focus");};this.$blur=function(b){if(!this.$ext){return;}this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Focus"]);if(b){this.$updateState({});}};this.addEventListener("prop.disabled",function(b){this.$refKeyDown=this.$refMouseDown=0;});this.$destroy=function(b){if(!b&&this.$ext){this.$ext.onmousedown=this.$ext.onmouseup=this.$ext.onmouseover=this.$ext.onmouseout=this.$ext.onclick=this.$ext.ondblclick=null;}};}).call(apf.BaseButton.prototype=new apf.StandardBinding());apf.BaseList=function(){this.$init(true);this.$dynCssClasses=[];this.listNodes=[];};(function(){this.implement(apf.Cache,apf.DataAction,apf.K);this.$focussable=true;this.$isWindowContainer=-1;this.multiselect=true;this.$propHandlers.fill=function(c){if(c){this.loadFillData(this.getAttribute("fill"));}else{this.clear();}};this.$mode=0;this.$propHandlers.mode=function(c){if("check|radio".indexOf(c)>-1){if(!this.hasFeature(apf.__MULTICHECK__)){this.implement(apf.MultiCheck);}this.addEventListener("afterrename",b);this.multicheck=c=="check";this.$mode=this.multicheck?1:2;}else{this.removeEventListener("afterrename",b);this.$mode=0;}};function b(){}this.$keyHandler=function(r){var A=r.keyCode,d=r.ctrlKey,u=r.shiftKey,t=this.$caret||this.$selected;if(r.returnValue==-1||!t||this.renaming){return;}var x=this.caret||this.selected,g=this.$ext,k,m,s,B,w,q,o;switch(A){case 13:if(this.$tempsel){this.$selectTemp();}if(this.ctrlselect=="enter"){this.select(this.caret,true);}this.choose(this.selected);break;case 32:if(d||!this.isSelected(this.caret)){this.select(this.caret,d);}break;case 109:case 46:if(this.disableremove){return;}if(this.$tempsel){this.$selectTemp();}this.remove();break;case 36:if(this.hasFeature(apf.__VIRTUALVIEWPORT__)){this.viewport.change(0,null,true,true);}this.select(this.getFirstTraverseNode(),false,u);this.$container.scrollTop=0;break;case 35:if(this.hasFeature(apf.__VIRTUALVIEWPORT__)){this.viewport.change(this.viewport.length,null,true,true);}this.select(this.getLastTraverseNode(),false,u);this.$container.scrollTop=this.$container.scrollHeight;break;case 107:if(this.more){this.startMore();}break;case 37:if(!x&&!this.$tempsel){return;}k=this.$tempsel?apf.xmldb.getNode(this.$tempsel):x;m=apf.getBox(apf.getStyle(t,"margin"));s=t.offsetWidth?Math.floor((g.offsetWidth-(w?15:0))/(t.offsetWidth+m[1]+m[3])):1;k=this.getNextTraverseSelected(k,false);if(k){this.$setTempSelected(k,d,u,true);}else{return;}t=apf.xmldb.findHtmlNode(k,this);if(t.offsetTop<g.scrollTop){g.scrollTop=Array.prototype.indexOf.call(this.getTraverseNodes(),k)<s?0:t.offsetTop-m[0];}break;case 38:if(!x&&!this.$tempsel){return;}k=this.$tempsel?apf.xmldb.getNode(this.$tempsel):x;m=apf.getBox(apf.getStyle(t,"margin"));w=g.scrollHeight>g.offsetHeight;s=t.offsetWidth?Math.floor((g.offsetWidth-(w?15:0))/(t.offsetWidth+m[1]+m[3])):1;k=this.getNextTraverseSelected(k,false,s);if(k){this.$setTempSelected(k,d,u,true);}else{return;}t=apf.xmldb.findHtmlNode(k,this);if(t.offsetTop<g.scrollTop){g.scrollTop=Array.prototype.indexOf.call(this.getTraverseNodes(),k)<s?0:t.offsetTop-m[0];}break;case 39:if(!x&&!this.$tempsel){return;}k=this.$tempsel?apf.xmldb.getNode(this.$tempsel):x;m=apf.getBox(apf.getStyle(t,"margin"));k=this.getNextTraverseSelected(k,true);if(k){this.$setTempSelected(k,d,u);}else{return;}t=apf.xmldb.findHtmlNode(k,this);if(t.offsetTop+t.offsetHeight>g.scrollTop+g.offsetHeight){g.scrollTop=t.offsetTop-g.offsetHeight+t.offsetHeight+m[0];}break;case 40:if(!x&&!this.$tempsel){return;}k=this.$tempsel?apf.xmldb.getNode(this.$tempsel):x;m=apf.getBox(apf.getStyle(t,"margin"));w=g.scrollHeight>g.offsetHeight;s=t.offsetWidth?Math.floor((g.offsetWidth-(w?15:0))/(t.offsetWidth+m[1]+m[3])):1;k=this.getNextTraverseSelected(k,true,s);if(k){this.$setTempSelected(k,d,u);}else{return;}t=apf.xmldb.findHtmlNode(k,this);if(t.offsetTop+t.offsetHeight>g.scrollTop+g.offsetHeight){g.scrollTop=t.offsetTop-g.offsetHeight+t.offsetHeight+m[0];}break;case 33:if(!x&&!this.$tempsel){return;}k=this.$tempsel?apf.xmldb.getNode(this.$tempsel):x;m=apf.getBox(apf.getStyle(t,"margin"));o=g.scrollHeight>g.offsetHeight;q=g.scrollWidth>g.offsetWidth;s=Math.floor((g.offsetWidth-(o?15:0))/(t.offsetWidth+m[1]+m[3]));B=Math.floor((g.offsetHeight-(q?15:0))/(t.offsetHeight+m[0]+m[2]));k=this.getNextTraverseSelected(k,false,s*B);if(!k){k=this.getFirstTraverseNode();}if(k){this.$setTempSelected(k,d,u,true);}else{return;}t=apf.xmldb.findHtmlNode(k,this);if(t.offsetTop<g.scrollTop){g.scrollTop=Array.prototype.indexOf.call(this.getTraverseNodes(),k)<s?0:t.offsetTop-m[0];}break;case 34:if(!x&&!this.$tempsel){return;}k=this.$tempsel?apf.xmldb.getNode(this.$tempsel):x;m=apf.getBox(apf.getStyle(t,"margin"));o=g.scrollHeight>g.offsetHeight;q=g.scrollWidth>g.offsetWidth;s=Math.floor((g.offsetWidth-(o?15:0))/(t.offsetWidth+m[1]+m[3]));B=Math.floor((g.offsetHeight-(q?15:0))/(t.offsetHeight+m[0]+m[2]));k=this.getNextTraverseSelected(x,true,s*B);if(!k){k=this.getLastTraverseNode();}if(k){this.$setTempSelected(k,d,u);}else{return;}t=apf.xmldb.findHtmlNode(k,this);if(t.offsetTop+t.offsetHeight>g.scrollTop+g.offsetHeight){g.scrollTop=t.offsetTop-g.offsetHeight+t.offsetHeight+m[0];}break;default:if(A==65&&d){this.selectAll();}else{if(this.$hasBindRule("caption")){if(!this.xmlRoot||this.autorename){return;}if(!this.lookup||new Date().getTime()-this.lookup.date.getTime()>300){this.lookup={str:"",date:new Date()};}this.lookup.str+=String.fromCharCode(A);var c=this.getTraverseNodes();for(var y,n=0;n<c.length;n++){y=this.$applyBindRule("caption",c[n]);if(y&&y.substr(0,this.lookup.str.length).toUpperCase()==this.lookup.str){if(!this.isSelected(c[n])){this.select(c[n]);}if(t){this.$container.scrollTop=t.offsetTop-(this.$container.offsetHeight-t.offsetHeight)/2;}return;}}return;}}break;}this.lookup=null;return false;};this.$deInitNode=function(c,d){if(!d){return;}d.parentNode.removeChild(d);};this.$updateNode=function(g,n,k){var d=this.$getLayoutNode("item","icon",n);if(d){if(d.nodeType==1){d.style.backgroundImage="url("+apf.getAbsolutePath(this.iconPath,this.$applyBindRule("icon",g))+")";}else{d.nodeValue=apf.getAbsolutePath(this.iconPath,this.$applyBindRule("icon",g));}}else{var m=this.$getLayoutNode("item","image",n);if(m){if(m.nodeType==1){m.style.backgroundImage="url("+apf.getAbsolutePath(apf.hostPath,this.$applyBindRule("image",g))+")";}else{m.nodeValue=apf.getAbsolutePath(apf.hostPath,this.$applyBindRule("image",g));}}}var o=this.$getLayoutNode("item","caption",n);if(o){if(o.nodeType==1){if(!this.$cbindings.caption||!this.$cbindings.caption.hasAml){o.innerHTML=this.$applyBindRule("caption",g);}}else{o.nodeValue=this.$applyBindRule("caption",g);}}n.title=this.$applyBindRule("title",g)||"";var c=this.$applyBindRule("css",g);if(c||this.$dynCssClasses.length){this.$setStyleClass(n,c,this.$dynCssClasses);if(c&&!this.$dynCssClasses.contains(c)){this.$dynCssClasses.push(c);}}if(!k&&this.$updateModifier){this.$updateModifier(g,n);}};this.$moveNode=function(k,m){if(!m){return;}var c=m.parentNode;var g=this.getNextTraverse(k);var d=g?apf.xmldb.findHtmlNode(g,this):null;c.insertBefore(m,d);};this.$add=function(x,o,s,A,t){this.$getNewContext("item");var n=this.$getLayoutNode("item"),k=this.$getLayoutNode("item","select"),r=this.$getLayoutNode("item","icon"),d=this.$getLayoutNode("item","image"),u=this.$getLayoutNode("item","caption");n.setAttribute("id",o);k.setAttribute("onmouseover","var o = apf.lookup("+this.$uniqueId+"); o.$setStyleClass(this, 'hover', null, true);");k.setAttribute("onselectstart","return false;");k.setAttribute("style",(k.getAttribute("style")||"")+";user-select:none;-moz-user-select:none;-webkit-user-select:none;");if(this.hasFeature(apf.__RENAME__)||this.hasFeature(apf.__DRAGDROP__)){k.setAttribute("ondblclick","var o = apf.lookup("+this.$uniqueId+"); o.stopRename(); o.choose()");k.setAttribute("onmouseout","var o = apf.lookup("+this.$uniqueId+");            	  o.$setStyleClass(this, '', ['hover'], true);                this.hasPassedDown = false;");k.setAttribute(this.itemSelectEvent||"onmousedown","var o = apf.lookup("+this.$uniqueId+");                 var xmlNode = apf.xmldb.findXmlNode(this);                 var isSelected = o.isSelected(xmlNode);                 this.hasPassedDown = true;                 if (!o.renaming && o.hasFocus() && isSelected == 1)                     this.dorename = true;                 if (!o.hasFeature(apf.__DRAGDROP__) || !isSelected && !event.ctrlKey)                     o.select(this, event.ctrlKey, event.shiftKey, -1)");k.setAttribute("onmouseup","if (!this.hasPassedDown) return;                var o = apf.lookup("+this.$uniqueId+");if (o.hasFeature(apf.__RENAME__) && this.dorename)                    o.startDelayedRename(event, null, true);this.dorename = false;                 var xmlNode = apf.xmldb.findXmlNode(this);                 var isSelected = o.isSelected(xmlNode);                 if (o.hasFeature(apf.__DRAGDROP__))                     o.select(this, event.ctrlKey, event.shiftKey, -1)");}else{k.setAttribute("onmouseout","apf.setStyleClass(this, '', ['hover']);");k.setAttribute("ondblclick","var o = apf.lookup("+this.$uniqueId+"); o.choose(null, true)");k.setAttribute(this.itemSelectEvent||"onmousedown","var o = apf.lookup("+this.$uniqueId+"); o.select(this, event.ctrlKey, event.shiftKey, -1)");}if(this.$mode){var y=this.$getLayoutNode("item","check");if(y){y.setAttribute("onmousedown","var o = apf.lookup("+this.$uniqueId+");                    o.checkToggle(this, true);o.$skipSelect = true;");if(apf.isTrue(this.$applyBindRule("checked",x))){this.$checkedList.push(x);this.$setStyleClass(n,"checked");}else{if(this.isChecked(x)){this.$setStyleClass(n,"checked");}}}else{return false;}}if(r){if(r.nodeType==1){r.setAttribute("style","background-image:url("+apf.getAbsolutePath(this.iconPath,this.$applyBindRule("icon",x))+")");}else{r.nodeValue=apf.getAbsolutePath(this.iconPath,this.$applyBindRule("icon",x));}}else{if(d){if(d.nodeType==1){if((d.tagName||"").toLowerCase()=="img"){d.setAttribute("src",apf.getAbsolutePath(apf.hostPath,this.$applyBindRule("image",x)));}else{d.setAttribute("style","background-image:url("+apf.getAbsolutePath(apf.hostPath,this.$applyBindRule("image",x))+")");}}else{if(apf.isSafariOld){var g=d.ownerElement.parentNode,m=g.appendChild(g.ownerDocument.createElement("img"));m.setAttribute("src",apf.getAbsolutePath(apf.hostPath,this.$applyBindRule("image",x)));}else{d.nodeValue=apf.getAbsolutePath(apf.hostPath,this.$applyBindRule("image",x));}}}}if(u){if(u.nodeType==1&&this.$cbindings.caption&&this.$cbindings.caption.hasAml){var c=(this.$amlBindQueue||(this.$amlBindQueue={}));if(u==n){apf.setNodeValue(u,"");var w=u.appendChild(u.ownerDocument.createElement("span"));if(apf.isIE){w.appendChild(u.ownerDocument.createTextNode(" "));}w.setAttribute("id","placeholder_"+this.$uniqueId+"_"+((c.caption||(c.caption=[])).push(x)-1));}else{u.setAttribute("id","placeholder_"+this.$uniqueId+"_"+((c.caption||(c.caption=[])).push(x)-1));apf.setNodeValue(u,"");}}else{apf.setNodeValue(u,this.$applyBindRule("caption",x));}}n.setAttribute("title",this.$applyBindRule("tooltip",x)||"");var B=this.$applyBindRule("css",x);if(B){this.$setStyleClass(n,B);if(B){this.$dynCssClasses.push(B);}}if(this.$addModifier&&this.$addModifier(x,n,A,t)===false){return;}if(A){apf.insertHtmlNode(n,A,t);}else{this.listNodes.push(n);}};this.addEventListener("$skinchange",function(c){if(this.more){delete this.moreItem;}});this.$fill=function(){if(this.more&&!this.moreItem){this.$getNewContext("item");var d=this.$getLayoutNode("item"),g=this.$getLayoutNode("item","caption"),c=this.$getLayoutNode("item","select");d.setAttribute("class",this.$baseCSSname+"More");c.setAttribute("onmousedown","var o = apf.lookup("+this.$uniqueId+');o.clearSelection();o.$setStyleClass(this, "more_down", null, true);');c.setAttribute("onmouseout","apf.lookup("+this.$uniqueId+').$setStyleClass(this, "", ["more_down"], true);');c.setAttribute("onmouseup","apf.lookup("+this.$uniqueId+").startMore(this, true)");if(g){apf.setNodeValue(g,this.more.match(/caption:(.*)(;|$)/i)[1]);}this.listNodes.push(d);}apf.insertHtmlNodes(this.listNodes,this.$container);this.listNodes.length=0;if(this.more&&!this.moreItem){this.moreItem=this.$container.lastChild;}};this.startMore=function(g,d){if(d&&this.disabled){return;}this.$setStyleClass(g,"",["more_down"]);var c;if(!this.$actions.add){if(this.each&&!this.each.match(/[\/\[]/)){c="<"+this.each+(this.each.match(/^a:/)?" xmlns:a='"+apf.ns.aml+"'":"")+" custom='1' />";}else{c="<item />";}}this.add(c,null,null,function(k){this.select(k,null,null,null,null,true);if(this.morePos=="begin"){this.$container.insertBefore(this.moreItem,this.$container.firstChild);}else{this.$container.appendChild(this.moreItem);}var m=function(){this.getActionTracker().undo(this.autoselect?2:1);this.removeEventListener("stoprename",m);this.removeEventListener("beforerename",o);this.removeEventListener("afterrename",n);};var n=function(){this.removeEventListener("afterrename",n);};var o=function(r){this.removeEventListener("stoprename",m);this.removeEventListener("beforerename",o);var q=this.findXmlNodeByValue(r.args[1]);if(q||!r.args[1]){if(r.args[1]&&this.dispatchEvent("notunique",{value:r.args[1]})===false){this.startRename();this.addEventListener("stoprename",m);this.addEventListener("beforerename",o);}else{this.removeEventListener("afterrename",n);this.getActionTracker().undo();if(!this.isSelected(q)){this.select(q);}}return false;}};this.addEventListener("stoprename",m);this.addEventListener("beforerename",o);this.addEventListener("afterrename",n);this.startDelayedRename({},1);});};this.$calcSelectRange=function(g,c){var m=[],d=this.hasFeature(apf.__VIRTUALVIEWPORT__)?this.xmlRoot.selectNodes(this.each):this.getTraverseNodes(),n,k;for(n=false,k=0;k<d.length;k++){if(d[k]==g){n=true;}if(n){m.push(d[k]);}if(d[k]==c){n=false;}}if(!m.length||n){m=[];for(n=false,k=d.length-1;k>=0;k--){if(d[k]==g){n=true;}if(n){m.push(d[k]);}if(d[k]==c){n=false;}}}return m;};this.$selectDefault=function(c){this.select(this.getTraverseNodes()[0],null,null,null,true);};this.loadFillData=function(s){var r,c,k,n=s.splitSafe(","),q=[];for(var d,g,o=0;o<n.length;o++){if((g=n[o]).match(/^\d+-\d+$/)){d=g.split("-");c=parseInt(d[0]);k=parseInt(d[1]);if(d[0].length==d[1].length){r=Math.max(d[0].length,d[1].length);for(var m=c;m<k+1;m++){q.push("<item>"+(m+"").pad(r,"0")+"</item>");}}else{for(var m=c;m<k+1;m++){q.push("<item>"+m+"</item>");}}}else{q.push("<item>"+g+"</item>");}}this.$initingModel=true;this.each="item";this.$setDynamicProperty("caption","[label/text()|@caption|text()]");this.$setDynamicProperty("eachvalue","[value/text()|@value|text()]");this.$canLoadDataAttr=false;this.load("<data>"+q.join("")+"</data>");};}).call(apf.BaseList.prototype=new apf.MultiSelect());apf.BaseSimple=function(){this.$init(true);};(function(){this.implement(apf.DataAction);this.getValue=function(){return this.value;};}).call(apf.BaseSimple.prototype=new apf.StandardBinding());apf.BaseStateButtons=function(){this.state="normal";this.edit=false;var m={min:["minimized","minimize","restore"],max:["maximized","maximize","restore"],edit:["edit","edit","closeedit"],close:["closed","close","show"]};this.$lastheight=null;this.$lastpos=null;this.$lastState={normal:true};this.$booleanProperties.animate=true;this.$supportedProperties.push("buttons","animate","state");this.close=function(){this.setProperty("state",this.state.split("|").pushUnique("closed").join("|"),false,true);return this;};this.minimize=function(){this.setProperty("state",this.state.split("|").remove("maximized").remove("normal").pushUnique("minimized").join("|"),false,true);return this;};this.maximize=function(){this.setProperty("state",this.state.split("|").remove("minimized").remove("normal").pushUnique("maximized").join("|"),false,true);return this;};this.restore=function(){this.setProperty("state",this.state.split("|").remove("minimized").remove("maximized").pushUnique("normal").join("|"),false,true);return this;};this.edit=function(n){this.setProperty("state",this.state.split("|").pushUnique("edit").join("|"),false,true);return this;};this.closeedit=function(n){this.setProperty("state",this.state.split("|").remove("edit").join("|"),false,true);return this;};this.$toggle=function(n){var o=m[n][0];this[m[n][this.state.indexOf(o)>-1?2:1]]();};this.$propHandlers.refparent=function(n){if(typeof n=="string"){this.$refParent=self[n]&&self[n].$ext||document.getElementById(n);}else{this.$refParent=n;}};this.$propHandlers.maxconf=function(n){this.$maxconf=n.splitSafe(",");};this.$propHandlers.state=function(E,r,q,x,F){var u=this;if(!this.$amlLoaded){apf.queue.add("state"+this.$uniqueId,function(){u.$propHandlers.state.call(u,E,r,q,x,F);});return;}if(E==0){E="normal";}var I,n,L,G,B,D={},C=E.split("|"),H=this.$lastState,A=[];for(I=0;I<C.length;I++){D[C[I]]=true;}D.value=E;if(!D.maximized&&!D.minimized){D.normal=true;}if(!x&&this.dispatchEvent("beforestatechange",{from:H,to:D})===false){this.state=H.value;return false;}if(D.closed==this.visible){this.setProperty("visible",!D.closed,false,true);}if(D.normal!=H.normal||!D.normal&&(D.minimized!=H.minimized||D.maximized!=H.maximized)){if(this.$lastheight){this.$ext.style.height=this.$lastheight;}if(this.$lastpos){apf.plane.hide(this.$uniqueId);if(this.animate&&!F){var y=this.$ext;L=apf.getStyle(y,"position");if(L!="absolute"){G=parseInt(apf.getStyle(y,"left"))||0;B=parseInt(apf.getStyle(y,"top"))||0;}else{G=y.offsetLeft;B=y.offsetTop;}this.animstate=1;apf.tween.multi(y,{steps:15,anim:apf.tween.easeInOutCubic,interval:10,tweens:[{type:"left",from:G,to:this.$lastpos.px[0]},{type:"top",from:B,to:this.$lastpos.px[1]},{type:"width",from:this.$ext.offsetWidth,to:this.$lastpos.px[2]},{type:"height",from:this.$ext.offsetHeight,to:this.$lastpos.px[3]}],oneach:function(){if(apf.hasSingleRszEvent){apf.layout.forceResize(u.$int);}},onfinish:function(){u.$lastpos.parentNode.insertBefore(u.$ext,u.$lastpos.beforeNode);if(u.$placeHolder){u.$placeHolder.parentNode.removeChild(u.$placeHolder);}u.$propHandlers.state.call(u,E,null,null,true,true);}});return;}else{if(!this.animate){apf.plane.hide(this.$uniqueId,true);u.$lastpos.parentNode.insertBefore(u.$ext,u.$lastpos.beforeNode);if(u.$placeHolder){u.$placeHolder.parentNode.removeChild(u.$placeHolder);}}}this.$ext.style.position=this.$lastpos.pos;this.$ext.style.left=this.$lastpos.css[0];this.$ext.style.top=this.$lastpos.css[1];this.$ext.style.width=this.$lastpos.css[2];this.$ext.style.height=this.$lastpos.css[3];n=this.$lastpos.parentNode;n.style.width=this.$lastpos.parent[0];n.style.height=this.$lastpos.parent[1];n.style.overflow=this.$lastpos.parent[2];}if(this.aData&&this.aData.restore){this.aData.restore();}if(apf.layout){apf.layout.play(this.$pHtmlNode);}this.$lastheight=this.$lastpos=null;if(D.normal){A.push("",this.$baseCSSname+"Max",this.$baseCSSname+"Min");}}if(D.minimized!=H.minimized){if(D.minimized){A.unshift(this.$baseCSSname+"Min",this.$baseCSSname+"Max",this.$baseCSSname+"Edit");if(this.aData&&this.aData.minimize){this.aData.minimize(this.collapsedHeight);}if(!this.aData||!this.aData.minimize){this.$lastheight=apf.getStyle(this.$ext,"height");this.$ext.style.height=Math.max(0,this.collapsedHeight-apf.getHeightDiff(this.$ext))+"px";}if(this.hasFocus()){apf.window.moveNext(null,this,true);}}else{A.push(this.$baseCSSname+"Min");$setTimeout(function(){apf.window.$focusLast(u);});}}if(D.maximized!=H.maximized){if(D.maximized){A.unshift(this.$baseCSSname+"Max",this.$baseCSSname+"Min",this.$baseCSSname+"Edit");n=this.$refParent;if(!n){n=(this.$ext.offsetParent==document.body?document.documentElement:this.$ext.parentNode);}this.animstate=0;var K=false,y=this.$ext;var L=apf.getStyle(y,"position");if(L=="absolute"){n.style.overflow="hidden";G=y.offsetLeft;B=y.offsetTop;}else{var w=apf.getAbsolutePosition(y);G=w[0];B=w[1];}this.$lastpos={css:[this.$ext.style.left,this.$ext.style.top,this.$ext.style.width,this.$ext.style.height,this.$ext.style.margin,this.$ext.style.zIndex],px:[G,B,this.$ext.offsetWidth,this.$ext.offsetHeight],parent:[n.style.width,n.style.height,n.style.overflow],pos:y.style.position,parentNode:n,beforeNode:this.$ext.nextSibling};if(this.parentNode.$layout){if(!this.$placeHolder){this.$placeHolder=document.createElement("div");}this.$placeHolder.style.position=this.$lastpos.pos;this.$placeHolder.style.left=this.$lastpos.css[0];this.$placeHolder.style.top=this.$lastpos.css[1];this.$placeHolder.style.width=this.$lastpos.px[2]+"px";this.$placeHolder.style.height=this.$lastpos.px[3]+"px";this.$placeHolder.style.margin=this.$lastpos.css[4];this.$placeHolder.style.zIndex=this.$lastpos.css[5];this.$pHtmlNode.insertBefore(this.$placeHolder,this.$ext);y.style.position="absolute";}document.body.appendChild(y);y.style.left=G+"px";y.style.top=B+"px";function J(){if(u.animstate){return;}var o,s,O,M,t;if(u.maxconf){o=u.$maxconf[0];s=u.$maxconf[1];O=[u.$maxconf[2]=="center"?(apf.getWindowWidth()-o)/2:u.$maxconf[2],u.$maxconf[3]=="center"?(apf.getWindowHeight()-s)/3:u.$maxconf[3]];}else{o=!apf.isIE&&n==document.documentElement?window.innerWidth:n.offsetWidth,s=!apf.isIE&&n==document.documentElement?window.innerHeight:n.offsetHeight;}if(!O){O=n!=y.offsetParent?apf.getAbsolutePosition(n,y.offsetParent):[0,0];}if(L!="absolute"){var N=apf.getDiff(n);o-=N[0]+(!u.$refParent&&apf.isIE8?4:0);s-=N[0]+(!u.$refParent&&apf.isIE8?4:0);}else{if(!u.$refParent&&apf.isIE8){o-=4;s-=4;}}M=u.$refParent?[0,0,0,0]:g;t=apf.getDiff(n);n.style.width=(n.offsetWidth-t[0])+"px";n.style.height=(n.offsetHeight-t[1])+"px";if(!K&&u.$maxconf&&u.$maxconf[4]){apf.plane.show(y,false,null,null,{color:u.$maxconf[4],opacity:u.$maxconf[5],animate:u.animate,protect:u.$uniqueId});}if(u.animate&&!K){u.animstate=1;K=true;apf.tween.multi(y,{steps:15,anim:apf.tween.easeInOutCubic,interval:10,tweens:[{type:"left",from:G,to:O[0]-M[3]},{type:"top",from:B,to:O[1]-M[0]},{type:"width",from:u.$lastpos.px[2],to:(o+M[1]+M[3]-apf.getWidthDiff(u.$ext))},{type:"height",from:u.$lastpos.px[3],to:(s+M[0]+M[2]-apf.getHeightDiff(u.$ext))}],oneach:function(){if(apf.hasSingleRszEvent){apf.layout.forceResize(u.$int);}},onfinish:function(){u.animstate=0;u.dispatchEvent("afterstatechange",{from:H,to:D});if(apf.hasSingleRszEvent){apf.layout.forceResize(u.$int);}}});}else{if(!u.animstate){y.style.left=(O[0]-M[3])+"px";y.style.top=(O[1]-M[0])+"px";var N=apf.getDiff(u.$ext);y.style.width=(o-N[0]+M[1]+M[3])+"px";y.style.height=(s-N[1]+M[0]+M[2])+"px";}}}if(apf.layout){apf.layout.pause(this.$pHtmlNode,J);}}else{A.push(this.$baseCSSname+"Max");}}if(D.edit!=H.edit){if(D.edit){A.unshift(this.$baseCSSname+"Edit",this.$baseCSSname+"Max",this.$baseCSSname+"Min");if(this.btnedit){d.edit.innerHTML="close";}this.dispatchEvent("editstart");}else{if(this.dispatchEvent("editstop")===false){return false;}A.push(this.$baseCSSname+"Edit");if(A.length==1){A.unshift("");}if(this.btnedit){d.edit.innerHTML="edit";}}}if(A.length||D.closed!=H.closed){if(A.length){this.$setStyleClass(this.$ext,A.shift(),A);}if(D.edit){this.dispatchEvent("prop.visible",{value:true});if(u.oSettings){apf.layout.forceResize(u.oSettings);}}if(!D.maximized||!this.animate||H.maximized&&u.animate){u.dispatchEvent("afterstatechange",{from:H,to:D});}this.$lastState=D;if(this.aData&&!D.maximized){this.$purgeAlignment();}if(!this.animate&&apf.hasSingleRszEvent&&apf.layout){apf.layout.forceResize(u.$int);}}};var g,k,c,d={};this.$propHandlers.buttons=function(w){if(!this.$hasLayoutNode("button")){return;}var t=w&&(w=w.replace(/(\|)\||\|$/,"$1")).split("|")||[],n=this.$buttons.childNodes,s=w&&new RegExp("("+w+")"),u={},r=[];for(var q=0;q<n.length;q++){if(n[q].nodeType!=1||n[q].tagName!="DIV"){continue;}if(n[q].getAttribute("button")&&(!w||!n[q].className||!n[q].className.match(s))){n[q].style.display="none";this.$setStyleClass(n[q],"",["min","max","close","edit"]);r.push(n[q]);}else{u[RegExp.$1]=n[q];}}for(q=0;q<t.length;q++){if(!t[q]){continue;}if(u[t[q]]){this.$buttons.insertBefore(u[t[q]],this.$buttons.firstChild);continue;}var o=r.pop();if(!o){this.$getNewContext("button");o=this.$getLayoutNode("button");o.setAttribute("button","button");b.call(this,o);o=apf.insertHtmlNode(o,this.$buttons);}this.$setStyleClass(o,t[q],["min","max","close","edit"]);o.onclick=new Function("apf.lookup("+this.$uniqueId+").$toggle('"+t[q]+"')");o.style.display="block";d[t[q]]=o;this.$buttons.insertBefore(o,this.$buttons.firstChild);}g=apf.getBox(apf.getStyle(this.$ext,"borderWidth"));};function b(n){n.setAttribute("onmousedown","var o = apf.all["+this.$uniqueId+"];             o.$setStyleClass(this, 'down', null, true);             apf.cancelBubble(event, o);              var o = apf.findHost(this).$ext;             if (o.onmousedown) o.onmousedown(event);             apf.cancelBubble(event, o);             apf.window.$mousedown(event);");n.setAttribute("onmouseup","var o = apf.all["+this.$uniqueId+"];             o.$setStyleClass(this, '', ['down'], true);");n.setAttribute("onmouseover","var o = apf.all["+this.$uniqueId+"];             o.$setStyleClass(this, 'hover', null, true);");n.setAttribute("onmouseout","var o = apf.all["+this.$uniqueId+"];             o.$setStyleClass(this, '', ['hover', 'down'], true);");n.setAttribute("ondblclick","apf.stopPropagation(event);");}this.$initButtons=function(s){this.animate=apf.enableAnim;this.collapsedHeight=this.$getOption("Main","collapsed-height");var r=this.$getLayoutNode("main","buttons",s);if(!r||apf.isIphone||!this.getAttribute("buttons")||!this.$hasLayoutNode("button")){return;}var n=(this.getAttribute("buttons")||"").split("|").length;for(var q,o=0;o<n;o++){this.$getNewContext("button");q=r.appendChild(this.$getLayoutNode("button"));q.setAttribute("button","button");b.call(this,q);}};this.addEventListener("DOMNodeRemovedFromDocument",function(o){for(var n in d){d[n].onclick=null;}});};apf.BaseTab=function(){this.$init(true);};(function(){this.isPaged=true;this.$focussable=apf.KEYBOARD;this.length=0;this.isLoading={};this.inited=this.ready=false;this.$scroll=true;this.set=function(o,q,n){if(n||this.src&&!this.$findPage(o,{})){return this.$propHandlers.activepage.call(this,o,null,null,q,n);}if(q&&this.activepage==o){return q(this.getPage(o));}this.$lastCallback=q;this.setProperty("activepage",o);};this.$supportedProperties.push("activepage","activepagenr","length","src","loading","trans-in","trans-out");this.$propHandlers.activepagenr=this.$propHandlers.activepage=function(r,n,o,x,s){if(!this.inited||apf.isNot(r)){return;}if(!x){x=this.$lastCallback;delete this.$lastCallback;}var t,q={};t=this.$findPage(r,q);if(!t){if(this.src){if(this.isLoading[r]){return;}if(this.$findPage("loading",{})){this.$propHandlers.activepage.call(this,"loading");}this.setProperty("loading",true);this.isLoading[r]=true;t=this.ownerDocument.createElementNS(apf.ns.apf,"page");t.setAttribute("id",r);this.appendChild(t);var u=this;t.insertMarkup(this.src,{page:r,callback:function(y){delete u.isLoading[r];if(!y.xmlNode){var A=new Error(apf.formatErrorString(0,null,"Loading new page","Could not load new page: "+u.src));u.setProperty("loading",false);if(this.dispatchEvent("error",apf.extend({error:A,bubbles:true},y))===false){return true;}throw A;}else{u.setProperty("activepage",r);if(x){x(y.amlNode);}u.setProperty("loading",false);}}});return;}return false;}if(t.parentNode!=this){return false;}if(!t.visible||t.disabled){return false;}if(r.tagName){r=q.position;this.activepage=t.name||r;}if(!s){var w={previous:this.activepage,previousId:this.activepagenr,previousPage:this.$activepage,next:r,nextId:q.position,nextPage:t};if(this.dispatchEvent("beforeswitch",w)===false){if(this.hideLoader){this.hideLoader();}return false;}}this.activepagenr=q.position;this.setProperty("activepagenr",q.position);if(this.$activepage){this.$activepage.$deactivate();}t.$activate();if(t["trans-in"]||this.$activepage&&this.$activepage["trans-out"]){this.transition(t,t["trans-in"]||"normal",this.$activepage,this.$activepage&&this.$activepage["trans-out"]||"normal");}this.$activepage=t;if(this.hideLoader){if(t.$rendered!==false){this.hideLoader();}else{t.addEventListener("afterrender",function(){this.parentNode.hideLoader();});}}if(!s){if(t.$rendered!==false){this.dispatchEvent("afterswitch",w);}else{t.addEventListener("afterrender",function(){this.parentNode.dispatchEvent("afterswitch",w);});}}if(typeof x=="function"){x(t);}return true;};this.$propHandlers.buttons=function(n){this.$scale=n.indexOf("scale")>-1;this.$scroll=!this.$scale;if(this.$scale){this.$maxBtnWidth=parseInt(this.$getOption("button","maxwidth"))||150;this.$minBtnWidth=parseInt(this.$getOption("button","minwidth"))||10;this.$setStyleClass(this.$buttons,"scale");this.addEventListener("resize",d);this.minwidth=this.$minBtnWidth*this.getPages().length+10;this.$ext.style.minWidth=Math.max(0,this.minwidth-apf.getWidthDiff(this.$ext))+"px";}else{this.$setStyleClass(this.$buttons,"",["scale"]);this.removeEventListener("resize",d);}};var k;this.$scaleinit=function(n,A,D){var u=this.getPages();var o=u.length;this.minwidth=this.$minBtnWidth*o+10;this.$ext.style.minWidth=Math.max(0,this.minwidth-apf.getWidthDiff(this.$ext))+"px";if(!A){return d.call(this);}if(this.$control&&this.$control.type!="remove"&&this.$control.stop){this.$control.stop();}var B=this;var q={steps:A=="remove"?8:8,control:this.$control={},anim:apf.tween.EASEOUT,interval:10,tweens:[],oHtml:n,onfinish:function(){if(!n){return;}if(A=="add"){n.dispatchEvent("afteropen");}},onstop:function(){if(!n){return;}if(A=="add"){n.dispatchEvent("afteropen");}else{if(A=="remove"){n.dispatchEvent("afterclose");}}}};this.$control.type=A;if(A=="add"){var C=n.$button;C.style.width=this.$minBtnWidth+"px";if(u.length){d.call(this,null,n);this.$buildScaleAnim(q,u,null,true);}}else{if(A=="sync"){this.$buildScaleAnim(q,u);}else{if(A=="remove"){q.onfinish=function(){D();if(B.$waitForMouseOut==2){apf.removeListener(B.$buttons,"mouseout",w);delete B.$waitForMouseOut;B.$scaleinit(null,"sync");}else{if(r){delete B.$waitForMouseOut;}}n.dispatchEvent("afterclose");};q.onstop=function(){apf.setOpacity(s,1);};var s=n.$button;q.tweens.push({oHtml:s,type:"width",from:s.offsetWidth-apf.getWidthDiff(s),to:0});var x=apf.getWidthDiff(s)+this.$btnMargin;if(x){q.tweens.push({oHtml:s,type:"marginLeft",from:0,to:-1*x});}q.tweens.push({oHtml:s,type:"fade",from:1,to:0});var r=u[u.length-1]==n;if(r){this.$buildScaleAnim(q,u,n);}if(this.$activepage==n){var y=n.nextSibling;while(y&&(!y.$first||!y.visible)){y=y.nextSibling;}var t=n.previousSibling;while(t&&(!t.$last||!t.visible)){t=t.previousSibling;}if(y||t){this.set(y||t);}}this.$waitForMouseOut=true;if(!r){if(!w){var B=this;function w(E){var F=apf.getAbsolutePosition(this);if(E.clientX<=F[0]||E.clientY<=F[1]||E.clientX>=F[0]+this.offsetWidth||E.clientY>=F[1]+this.offsetHeight){apf.removeListener(B.$buttons,"mouseout",w);if(B.$control.state==apf.tween.STOPPED){delete B.$waitForMouseOut;B.$scaleinit(null,"sync");}else{if(B.$waitForMouseOut){B.$waitForMouseOut=2;}}}}}apf.addListener(B.$buttons,"mouseout",w);}}}}if(q.tweens.length){apf.tween.multi(this,q);}};this.$buildScaleAnim=function(q,w,x,A){if(x){w=w.slice();w.remove(x);}if(!w.length){return;}var r=this.$buttons.offsetWidth-apf.getWidthDiff(this.$buttons);var o=w.length;var y=Math.min(r/o,this.$maxBtnWidth);var B=Math.round((y%1)*10);for(var n,u,C,t=0;t<o-1;t++){C=Math.max(this.$minBtnWidth,c[t<B?1:0](y));r-=C;u=w[t].$button,n=apf.getWidthDiff(u);q.tweens.push({oHtml:u,type:"width",from:u.offsetWidth-n,to:C-n-this.$btnMargin});}u=w[o-1].$button,n=apf.getWidthDiff(u);q.tweens.push({oHtml:u,type:"width",from:u.offsetWidth-n,to:Math.max(this.$minBtnWidth,Math.min(r,this.$maxBtnWidth))-this.$btnMargin-n});};var c=[Math.floor,Math.ceil];function d(u,t){if(!this.length||this.$waitForMouseOut||this.$control&&this.$control.state==apf.tween.RUNNING){return;}if(this.$btnMargin==undefined){this.$btnMargin=apf.getMargin(this.getPage().$button)[0];}var r=this.getPages();if(t){r.remove(t);}if(!r.length){return;}var o=this.$buttons.offsetWidth-apf.getWidthDiff(this.$buttons)-(t?t.$button.offsetWidth+this.$btnMargin:0);var n=r.length;var w=Math.min(o/n,this.$maxBtnWidth);var x=Math.round((w%1)*10);for(var y,q=0;q<n-1;q++){y=Math.max(this.$minBtnWidth,c[q<x?1:0](w));o-=y;if(!r[q].$button){continue;}r[q].$button.style.width=(y-apf.getWidthDiff(r[q].$button)-this.$btnMargin)+"px";}if(!r[n-1].$button){return;}r[n-1].$button.style.width=(Math.max(this.$minBtnWidth,Math.min(o,this.$maxBtnWidth))-this.$btnMargin-apf.getWidthDiff(r[n-1].$button))+"px";}this.transition=function(q,o,t,s){var n=this;if(!this.$transInfo){this.$int.style.overflow="hidden";this.$transInfo={start:function(){var w=n.$ext;this.size=[w.style.width,w.style.height];var x=apf.getDiff(w);w.style.width=(w.offsetWidth-x[0])+"px";w.style.height=(w.offsetHeight-x[1])+"px";if(this["in"]){var w=this["in"].oHtml.$ext;var x=apf.getDiff(w);w.style.width=(n.$int.offsetWidth-x[0])+"px";w.style.height=(n.$int.offsetHeight-x[1])+"px";w.style.display="block";apf.tween.multi(w,this["in"]);}if(this["out"]){var w=this["out"].oHtml.$ext;var x=apf.getDiff(w);w.style.width=(n.$int.offsetWidth-x[0])+"px";w.style.height=(n.$int.offsetHeight-x[1])+"px";w.style.display="block";apf.tween.multi(w,this["out"]);}},stop:function(){if(this["in"]&&this["in"].control.stop){this["in"].control.stop();}if(this["out"]&&this["out"].control.stop){this["out"].control.stop();}},finish:function(){var w=n.$ext;w.style.width=this.size[0];w.style.height=this.size[1];if(this["in"]){var w=this["in"].oHtml.$ext;w.style.width=this["in"].size[0];w.style.height=this["in"].size[1];w.style.display="";w.style.position="";w.style.zIndex="";w.style.left="";w.style.top="";apf.setOpacity(w,1);delete this["in"];}if(this["out"]){var w=this["out"].oHtml.$ext;w.style.width=this["out"].size[0];w.style.height=this["out"].size[1];w.style.display="";w.style.position="";w.style.zIndex="";w.style.left="";w.style.top="";apf.setOpacity(w,1);delete this["out"];}n.oPages.style.width="";n.oPages.style.height="";}};}this.$transInfo.stop();var u=apf.getDiff(this.oPages);this.oPages.style.width=(this.oPages.offsetWidth-u[0])+"px";this.oPages.style.height=(this.oPages.offsetHeight-u[1])+"px";var r=this.$createAnim(q,o,false,t);if(r!==false&&t){this.$createAnim(t,s,true,q);}setTimeout(function(){n.$transInfo.start();});};this.$cube={left:[-1,"offsetWidth","left","getHtmlInnerWidth"],right:[1,"offsetWidth","left","getHtmlInnerWidth"],top:[-1,"offsetHeight","top","getHtmlInnerHeight"],bottom:[1,"offsetHeight","top","getHtmlInnerHeight"]};this.$createAnim=function(B,F,q,y){var C=this;var o={steps:apf.isIE?15:25,control:{},anim:q?apf.tween.EASEOUT:apf.tween.EASEOUT,interval:10,tweens:[],oHtml:B,size:[B.$ext.style.width,B.$ext.style.height],onfinish:function(){C.$transInfo.finish(q);}};this.$transInfo[q?"out":"in"]=o;var D,E,x=B.$ext;x.style.zIndex=q?10:20;x.style.position="absolute";x.style.left=0;x.style.top=0;x.style.display="block";F=F.split("-");switch(F[0]){case"fade":o.anim=apf.tween.NORMAL;if(q){x.style.zIndex=30;}o.tweens.push(q?{type:"fade",from:1,to:0}:{type:"fade",from:0,to:1});break;case"slide":var n=this.$cube[F[1]];D=0;E=n[0]*x[n[1]];if(!q){x.style[n[2]]=D+"px";}o.tweens.push({type:n[2],from:q?D:E,to:q?E:D});break;case"push":var n=this.$cube[F[1]];var A=y.$ext;if(q){if(this.$transInfo["in"]){this.$transInfo["in"].tweens=[];}}else{this.$createAnim(y,"normal",true);}var t=apf[n[3]](this.$int);var w=n[0]*t;var u=0;var s=0;var r=-1*n[0]*t;if(q){A.style[n[2]]=r+"px";}else{x.style[n[2]]=w+"px";}o.tweens.push({oHtml:x,type:[n[2]],from:q?u:w,to:q?w:u});o.tweens.push({oHtml:A,type:[n[2]],from:q?r:s,to:q?s:r});return false;case"normal":break;default:throw new Error("Unknown animation type:"+F[0]);}};this.getPages=function(){var s=[],o=this.childNodes;for(var q=0,n=o.length;q<n;q++){if("page|case".indexOf(o[q].localName)>-1&&o[q].visible!==false){s.push(o[q]);}}return s;};this.getPage=function(n){if(apf.isNot(n)){return this.$activepage;}else{return this.$findPage(n);}};this.add=function(n,o,q,s,t){var r=this.ownerDocument.createElementNS(apf.ns.aml,"page");if(o){r.setAttribute("id",o);}if(q){r.setAttribute("type",q);}if(n){r.setAttribute("caption",n);}if(t){t(r);}this.insertBefore(r,s);return r;};this.remove=function(n,q){var o=typeof n=="object"?n:this.$findPage(n);if(!o){return false;}var r={page:o};if(typeof q=="object"){r.htmlEvent=q;q=false;}if(!q&&this.dispatchEvent("close",r)===false){return;}if(this.$scale){this.$scaleinit(o,"remove",function(){o.destroy(true,true);});}else{o.destroy(true,true);o.dispatchEvent("afterclose");}return o;};function g(){var o="cache_"+this.$buttons.childNodes.length;if(SCROLLANIM[o]){return SCROLLANIM[o];}var r=0;for(var q=0,n=this.$buttons.childNodes.length;q<n;q++){if(typeof this.$buttons.childNodes[q].offsetWidth!="undefined"){r+=this.$buttons.childNodes[q].offsetWidth;}}return SCROLLANIM[o]=r;}function m(n,q){var o=n&SCROLL_BOTH;if(o){n=SCROLL_LEFT;}var r=this[n&SCROLL_LEFT?"oLeftScroll":"oRightScroll"];if(!(q&SCROLL_DIS)){if(n&SCROLL_LEFT){SCROLL_L_STATE=q;}else{SCROLL_R_STATE=q;}}if(q&SCROLL_OFF){apf.setStyleClass(r,"",["disabled","hover","down"]);}else{if(q&SCROLL_HOVER){apf.setStyleClass(r,"hover",["disabled","down"]);}else{if(q&SCROLL_DOWN){apf.setStyleClass(r,"down",["disabled","hover"]);}else{if(q&SCROLL_DIS){apf.setStyleClass(r,"disabled",["hover","down"]);}}}}if(o){m(SCROLL_RIGHT,q);}}this.setScrollerState=function(q,o){if(!this.ready||!this.$hasButtons||!this.oScroller){return;}if(typeof q=="undefined"){var n=this.oScroller.offsetWidth||parseInt(apf.getStyle(this.oScroller,"width").replace(/(px|em|%)/,""));q=((g.call(this)+n)>this.$ext.offsetWidth);o=SCROLL_BOTH;}if(o&SCROLL_BOTH&&q!==SCROLLANIM.scrollOn){SCROLLANIM.scrollOn=q;if(!q){this.$buttons.style.left=SCROLLANIM.left+"px";this.oScroller.style.display="none";}}else{this.oScroller.style.display="";}this.oScroller.style.display=(o&SCROLL_BOTH&&!q)?"none":"";if(typeof o=="undefined"){o=SCROLL_BOTH;}if(!q){if((o&SCROLL_LEFT)||(o&SCROLL_BOTH)){m.call(this,SCROLL_LEFT,SCROLL_DIS);}if((o&SCROLL_RIGHT)||(o&SCROLL_BOTH)){m.call(this,SCROLL_RIGHT,SCROLL_DIS);}}};this.correctScrollState=function(){if(!this.ready||!this.$hasButtons||!this.oScroller){return;}this.setScrollerState();};function b(o,n){if(SCROLLANIM.size<=0){SCROLLANIM.left=this.$buttons.offsetLeft;SCROLLANIM.size=Math.round(this.firstChild.$button.offsetWidth);}if(o&SCROLL_LEFT){return SCROLLANIM.left;}else{if(o&SCROLL_RIGHT){var q=this.$buttons.childNodes[this.$buttons.childNodes.length-1];return this.$ext.offsetWidth-(q.offsetLeft+q.offsetWidth+(this.oScroller.offsetWidth+4));}}}this.scroll=function(u,r){if(!this.ready||!this.$hasButtons||!this.oScroller){return;}if(!u){u=window.event;}if(typeof u.type=="unknown"){u={type:"click"};}if(bAnimating&&u.type!="dblclick"){return;}bAnimating=true;if(typeof r=="undefined"){r=SCROLL_LEFT;}var o=this.$buttons.offsetLeft,t=u.delta?Math.round(u.delta*36):SCROLLANIM.size,s=b.call(this,r),n=this;if(r&SCROLL_LEFT){m(SCROLL_LEFT,SCROLL_DOWN);m(SCROLL_RIGHT,SCROLL_OFF);if(o===s){this.setScrollerState(false,SCROLL_LEFT);return apf.tween.single(this.$buttons,{steps:SCROLLANIM.steps,interval:20,from:o,to:o+12,type:"left",anim:apf.tween.EASEOUT,onstop:SCROLLANIM.stopHandle,onfinish:function(w){apf.tween.single(w,{steps:SCROLLANIM.steps,interval:SCROLLANIM.interval,from:o+12,to:o,type:"left",anim:apf.tween.EASEIN,onstop:SCROLLANIM.stopHandle,onfinish:function(){bAnimating=false;if(u.name=="mousescroll"){m(SCROLL_LEFT,SCROLL_OFF);}}});}});}var q=o+(u.type=="dblclick"?t*3:t);if(q>s){q=s;}if(q===s){this.setScrollerState(false,SCROLL_LEFT);}this.setScrollerState(true,SCROLL_RIGHT);apf.tween.single(this.$buttons,{steps:SCROLLANIM.steps,interval:SCROLLANIM.interval,control:SCROLLANIM.control,from:o,to:q,type:"left",anim:apf.tween.NORMAL,onstop:SCROLLANIM.stopHandle,onfinish:function(){bAnimating=false;if(u.name=="mousescroll"){m(SCROLL_LEFT,SCROLL_OFF);}if(keepScrolling){n.scroll(u,globalDir);}}});}else{if(r&SCROLL_RIGHT){this.setScrollerState(true);m(SCROLL_RIGHT,SCROLL_DOWN);m(SCROLL_LEFT,SCROLL_OFF);if(o===s){this.setScrollerState(false,SCROLL_RIGHT);return apf.tween.single(this.$buttons,{steps:SCROLLANIM.steps,interval:20,from:o,to:o-24,type:"left",anim:apf.tween.EASEOUT,onstop:SCROLLANIM.stopHandle,onfinish:function(x,w){apf.tween.single(x,{steps:SCROLLANIM.steps,interval:SCROLLANIM.interval,from:o-24,to:o,type:"left",anim:apf.tween.EASEIN,onstop:SCROLLANIM.stopHandle,onfinish:function(){bAnimating=false;if(u.name=="mousescroll"){m(SCROLL_RIGHT,SCROLL_OFF);}}});}});}var q=o-(u.type=="dblclick"?t*3:t);if(q<s){q=s;}apf.tween.single(this.$buttons,{steps:SCROLLANIM.steps,interval:SCROLLANIM.interval,control:SCROLLANIM.control,from:o,to:q,type:"left",anim:apf.tween.NORMAL,onstop:SCROLLANIM.stopHandle,onfinish:function(){bAnimating=false;if(u.name=="mousescroll"){m(SCROLL_RIGHT,SCROLL_OFF);}if(keepScrolling){n.scroll(u,globalDir);}}});}}};this.scrollIntoView=function(s){bAnimating=false;if(!this.ready||!this.$hasButtons||!this.oScroller||!s.$drawn){return;}bAnimating=true;if(this.$buttons.offsetWidth<this.$ext.offsetWidth){return this.setScrollerState(false);}var u=s.$button.offsetLeft,x=s.$button.offsetWidth,t=this.$buttons.offsetLeft;if(SCROLLANIM.size<=0){SCROLLANIM.left=this.$buttons.offsetLeft;var q=this.firstChild;while(!q.$button){q=q.nextSibling;}SCROLLANIM.size=Math.round(q.$button.offsetWidth);}this.$buttons.style.left=t;var n=this.$ext.offsetWidth,o=this.oScroller.offsetWidth+4,w=null,r;if((u+x)>((n-o)-t)){w=(-(u-SCROLLANIM.left)+(n-x-o));r=SCROLL_RIGHT;}else{if((t+u)<SCROLLANIM.left){w=SCROLLANIM.left-u;r=SCROLL_LEFT;}}if(w!==null){this.setScrollerState(true);m(SCROLL_RIGHT,r&SCROLL_RIGHT?SCROLL_DOWN:SCROLL_OFF);m(SCROLL_LEFT,r&SCROLL_LEFT?SCROLL_DOWN:SCROLL_OFF);apf.tween.clearQueue(this.$buttons,true);apf.tween.single(this.$buttons,{steps:SCROLLANIM.steps,interval:SCROLLANIM.interval,from:t,to:w,type:"left",anim:apf.tween.NORMAL,onstop:SCROLLANIM.stopHandle,onfinish:function(){bAnimating=false;m(SCROLL_RIGHT,SCROLL_OFF);m(SCROLL_LEFT,SCROLL_OFF);}});}else{bAnimating=false;}};this.addEventListener("DOMNodeRemoved",function(r){var n=r.currentTarget;if(r.$doOnlyAdmin||r.relatedNode!=this||n.localName!="page"){return;}var o=n.nextSibling;while(o&&(!o.$first||!o.visible)){o=o.nextSibling;}var q=n.previousSibling;while(q&&(!q.$last||!q.visible)){q=q.previousSibling;}if(this.firstChild==n&&o){o&&o.$first();}if(this.lastChild==n&&q){q&&q.$last();}if(this.$activepage==n){if(o||q){this.set(o||q);}else{n.$deactivate();this.$activepage=this.activepage=this.activepagenr=null;this.setProperty("activepage",null);}}else{if(this.$scale){this.$scaleinit();}}this.setProperty("length",this.childNodes.length);});this.addEventListener("DOMNodeInserted",function(s){var n=s.currentTarget;if(n.localName!="page"||s.relatedNode!=this||n.nodeType!=1){return;}if(!s.$beforeNode){var o,t=this.getPages();if(o=t[t.length-1]){o.$last(true);}n.$last();}var r=this.getPage(0);if(!r||s.$beforeNode==r){if(r){r.$first(true);}n.$first();}if(this.$activepage){var q={};this.$findPage(this.$activepage,q);if(this.activepagenr!=q.position){if(parseInt(this.activepage)==this.activepage){this.activepage=q.position;this.setProperty("activepage",q.position);}this.activepagenr=q.position;this.setProperty("activepagenr",q.position);}}else{if(!this.$activepage){this.set(n);}}if(this.$scale&&n.visible){this.$scaleinit(n,"add");}else{n.dispatchEvent("afteropen");}this.setProperty("length",this.childNodes.length);});this.$findPage=function(u,w){var s,o=this.childNodes;if(u.localName){for(var r=0,q=0,n=o.length;q<n;q++){s=o[q];if("page|case".indexOf(s.localName)>-1&&(++r)&&s==u){if(w){w.position=r-1;}return s;}}}else{for(var r=0,q=0,n=o.length;q<n;q++){s=o[q];if("page|case".indexOf(s.localName)>-1&&(r++==u||s.name==u)){if(w){w.position=r-1;}return s;}}}return null;};this.$enable=function(){var o=this.childNodes;for(var q=0,n=o.length;q<n;q++){if(o[q].enable){o[q].enable();}}};this.$disable=function(){var o=this.childNodes;for(var q=0,n=o.length;q<n;q++){if(o[q].disable){o[q].disable();}}};this.addEventListener("keydown",function(q){if(!this.$hasButtons){return;}var o,n=q.keyCode;switch(n){case 9:break;case 13:break;case 32:break;case 37:o=this.getPage().previousSibling;while(o&&(o.nodeType!=1||"page|case".indexOf(o.localName)==-1||!o.visible)){o=o.previousSibling;}if(o){this.setProperty("activepage",o);}break;case 39:o=this.getPage().nextSibling;while(o&&(o.nodeType!=1||"page|case".indexOf(o.localName)==-1||!o.visible)){o=o.nextSibling;}if(o){this.setProperty("activepage",o);}break;default:return;}},true);this.$loadChildren=function(w){var u=false,n=this,s,r,o,t,q;this.inited=true;if(this.$hasButtons){this.$buttons=this.$getLayoutNode("main","buttons",this.$ext);this.$buttons.setAttribute("id",this.$uniqueId+"_buttons");}this.oPages=this.$getLayoutNode("main","pages",this.$ext);if(this.$int){this.$int=this.oPages;u=true;q=this.childNodes;for(s=0;s<q.length;s++){t=q[s];if(t.nodeType!=1){continue;}t.$draw(true);if(t.$skinchange){t.$skinchange();}t.$loadAml();}}else{this.$int=this.oPages;q=this.getPages();if(q.length){q[0].$first();(t=q[q.length-1]).$last();}}if(t){this.activepage=(typeof this.activepage!="undefined"?this.activepage:this.activepagenr)||0;u=this.getPage(this.activepage);if(u.render!="runtime"||u.$rendered){this.$propHandlers.activepage.call(this,this.activepage);}}else{this.isPages=false;}this.setProperty("length",r);this.ready=true;if(!this.activepage&&this.getAttribute("src")){this.src=this.getAttribute("src");this.$propHandlers.activepage.call(this);}};this.$destroy=function(n){if(n||!this.oScroller){return;}};}).call(apf.BaseTab.prototype=new apf.Presentation());apf.BaseTree=function(){this.$init(true);this.$dynCssClasses=[];this.$nodes=[];};(function(){this.implement(apf.Rename,apf.DataAction,apf.Cache,apf.K);this.$isTreeArch=true;this.$focussable=true;this.multiselect=false;this.bufferselect=true;this.startcollapsed=true;this.$animType=apf.tween.NORMAL;this.$animOpenStep=3;this.$animCloseStep=1;this.$animSpeed=10;var b=1<<1,d=1<<2,g=1<<3,n=1<<4;var c=this.$treeState={};this.$treeState[0]="";this.$treeState[b]="min";this.$treeState[b|d]="plus";this.$treeState[g]="last";this.$treeState[g|b]="minlast";this.$treeState[g|b|d]="pluslast";this.$treeState[n]="root";this.$booleanProperties.openadd=true;this.$booleanProperties.startcollapsed=true;this.$booleanProperties.nocollapse=true;this.$booleanProperties.singleopen=true;this.$booleanProperties.prerender=true;this.$booleanProperties.removecontainer=true;this.$supportedProperties.push("openadd","startcollapsed","nocollapse","singleopen","prerender","removecontainer");this.openadd=true;this.startcollapsed=1;this.prerender=true;this.expandAll=function(){if(!this.xmlRoot){return;}var q=this.each.split("|").join("["+this.each.replace(/\|/g," or ")+"]|.//"),o=this;(function(t){var r=t.selectNodes(q);for(var u,s=0;s<r.length;s++){if(u=apf.xmldb.getHtmlNode(r[s],o)){o.slideToggle(u,1,true);}arguments.callee(r[s]);}})(this.xmlRoot);};this.collapseAll=function(){if(!this.xmlRoot){return;}var r=this.xmlRoot.selectNodes(".//"+this.each.split("|").join("["+this.each.replace(/\|/g," or ")+"]|.//"));for(var s,q=r.length-1;q>=0;q--){if(s=apf.xmldb.getHtmlNode(r[q],this)){this.slideToggle(s,2,true);}}};this.expandAndSelect=function(r){if(!this.xmlRoot){return;}var q=this;if((function o(t){var s=q.getTraverseParent(t);if(s==q.xmlRoot){return true;}if(!s||o(s)===false){return false;}q.slideToggle(apf.xmldb.getHtmlNode(s,q),1,true);})(r)!==false){this.select(r);}};this.expandList=function(r,s){r.sort();var q=this.xmlRoot,o=this;apf.asyncForEach(r,function(w,t){var x=w.split("/");var u=q;apf.asyncForEach(x,function(B,A,y){apf.queue.empty();setTimeout(function(){var C=(u||q).selectSingleNode(B);if(C){u=C;o.slideToggle(apf.xmldb.getHtmlNode(C,o),1,true,null,function(){A();});}else{o.slideToggle(apf.xmldb.getHtmlNode(u,o),1,true,null,function(){u=u.selectSingleNode(B);if(!u){A(true);}else{A();}});}},100);},function(y){t();});},function(t){if(s){s();}});};this.selectPath=function(o){};this.slideToggle=function(s,r,q,t,w){if(this.nocollapse||t&&this.disabled){return;}if(!s){s=this.$selected;}if(!s){return w&&w();}var u=s.getAttribute(apf.xmldb.htmlIdTag);while(!u&&s.parentNode){u=(s=s.parentNode).getAttribute(apf.xmldb.htmlIdTag);}var o=this.$getLayoutNode("item","container",s);if(!o){return;}if(apf.getStyle(o,"display")=="block"){if(r==1){if(w){w();}return;}s.className=s.className.replace(/min/,"plus");this.slideClose(o,apf.xmldb.getNode(s),q,w);}else{if(r==2){if(w){w();}return;}s.className=s.className.replace(/plus/,"min");this.slideOpen(o,apf.xmldb.getNode(s),q,w);}};this.isCollapsed=function(o){return(apf.getStyle(this.$getLayoutNode("item","container",apf.xmldb.getHtmlNode(o,this)),"display")=="none");};var k={};this.slideOpen=function(o,w,r,A){if(!w){w=this.selected;}var u=apf.xmldb.getHtmlNode(w,this);if(!o){o=this.$findContainer(u);}if(!o.childNodes.length&&!this.getTraverseNodes(w).length){return A&&A();}if(this.singleopen){var x=this.getTraverseParent(w),q=(x||this.xmlRoot).getAttribute(apf.xmldb.xmlIdTag);if(k[q]&&k[q][1]!=w&&this.getTraverseParent(k[q][1])==x){this.slideToggle(k[q][0],2);}k[q]=[u,w];}if(!this.nocollapse){o.style.display="block";}if(!this.prerender&&this.$hasLoadStatus(w,"potential")&&!o.childNodes.length){this.$extend(w,o,r,A);return;}if(r||o.scrollHeight>1000){if(!this.nocollapse&&o!=this.$container){o.style.height="auto";o.style.overflow="visible";}if(this.$hasLoadStatus(w,"potential")){return this.$extend(w,o,r,A);}this.dispatchEvent("expand",{xmlNode:w});return A&&A();}var t=this;var s=o.style.height;o.style.overflow="visible";if(!apf.isIE7){o.style.height=apf.hasHeightAutoDrawBug?"100%":"auto";}var y=o.scrollHeight;o.style.overflow="hidden";o.style.height=s;apf.tween.single(o,{type:"scrollheight",from:o.offsetHeight,to:y,anim:this.$animType,steps:this.$animOpenStep,interval:this.$animSpeed,onfinish:function(B){if(w&&t.$hasLoadStatus(w,"potential")){$setTimeout(function(){if(B!=this.$container){B.style.height=B.scrollHeight+"px";B.style.overflow="hidden";}t.$extend(w,B,null,A);});if(B!=this.$container){if(!apf.isIE7){B.style.height=apf.hasHeightAutoDrawBug?"100%":"auto";}B.style.overflow="visible";}}else{if(B!=this.$container){B.style.overflow="visible";if(!apf.isIE7){B.style.height=apf.hasHeightAutoDrawBug?"100%":"auto";}}}t.dispatchEvent("expand",{xmlNode:w});}});};this.slideClose=function(q,s,r){if(this.nocollapse){return;}if(!s){s=this.selected;}if(this.singleopen){var u=(this.getTraverseParent(s)||this.xmlRoot).getAttribute(apf.xmldb.xmlIdTag);k[u]=null;}if(!q){var t=apf.xmldb.getHtmlNode(s,this);q=this.$findContainer(t);}if(q!=this.$container){q.style.height=q.offsetHeight;q.style.overflow="hidden";}if(r){if(q!=this.$container){q.style.height=0;}q.style.display="none";this.dispatchEvent("collapse",{xmlNode:s});return;}var o=this;apf.tween.single(q,{type:"scrollheight",from:q.scrollHeight,to:0,anim:this.$animType,steps:this.$animCloseStep,interval:this.$animSpeed,onfinish:function(w,x){w.style.display="none";o.dispatchEvent("collapse",{xmlNode:s});}});};this.$add=function(q,H,o,D,G,B,O,r,J){if(this.$isTreeArch&&this.$needsDepth&&typeof O=="undefined"){var x=o;O=0;while(x!=this.xmlRoot){O++;x=x.parentNode;}}var w=this.$getBindRule("insert",q)?true:false,N=this.getTraverseNodes(q),M=N.length?true:false,I=w||M,E=this.$hasBindRule("collapsed")?(this.$getDataNode("collapsed",q)?true:false):(this.$hasBindRule("expanded")?(this.$getDataNode("expanded",q)?false:true):this.startcollapsed),s=(I?b:0)|(E&&I||w?d:0)|(B?g:0),y=this.$initNode(q,s,H,O),C=this.$getLayoutNode("item","container",y),L;if(!E&&!this.nocollapse){C.setAttribute("style","overflow:visible;height:auto;display:block;");}var t,K=(!this.removecontainer||I);if(!I||w){C.setAttribute("style","display:none;");}if(!this.prerender){L=N.length;}if(I&&!this.prerender&&L>2&&E||w&&(!this.$hasLoadStatus(q)||this.$hasLoadStatus(q,"potential"))){this.$setLoading(q,C);}else{if(!M&&(t=this.$applyBindRule("empty",q))){this.$setEmptyMessage(C,t);}}if((!D||D==this.$container)&&o==this.xmlRoot&&!G||J=="insert"){this.$nodes.push(y);if(!apf.isChildOf(y,C,true)&&K){this.$nodes.push(C);}if(J!="insert"){this.$setStyleClass(y,"root");this.$setStyleClass(C,"root");}}else{if(!D){D=apf.xmldb.getHtmlNode(q.parentNode,this);D=D?this.$getLayoutNode("item","container",D):this.$container;}if(D==this.$container){this.$setStyleClass(y,"root");this.$setStyleClass(C,"root");}var F;if(!G&&(F=this.getNextTraverse(q))){G=apf.xmldb.getHtmlNode(F,this);}if(G&&G.parentNode!=D){G=null;}if(D.style&&this.getTraverseNodes(q.parentNode).length==1){this.$removeEmptyMessage(D);}if(D.style){var u=!apf.isChildOf(y,C,true);y=apf.insertHtmlNode(y,D,G);if(u&&K){var C=apf.insertHtmlNode(C,D,G);}else{var C=this.$getLayoutNode("item","container",y);}}else{D.insertBefore(y,G);if(!apf.isChildOf(y,C,true)&&K){D.insertBefore(C,G);}}if(D.style){if(this.openadd&&D!=this.$container&&D.style.display!="block"){this.slideOpen(D,o,true);}if(!this.$fillParent){this.$fillParent=o;}var F=r==undefined?this.getNextTraverse(q,true):r;var A;if(F&&(A=apf.xmldb.getHtmlNode(F,this))){this.$fixItem(F,A);}}}if((this.prerender||L<3||!E)&&(q.namespaceURI!=apf.ns.apf||q.localName!="item")){this.$addNodes(q,C,false,null,null,(O||0)+1);}return C;};this.$fill=function(){if(this.$useiframe){this.$pHtmlDoc=this.oDoc;}if(this.$nodes.length){apf.insertHtmlNodes(this.$nodes,this.$fillParentHtml||this.$container);this.$nodes.length=0;delete this.$fillParentHtml;}if(this.$fillParent){this.$fixItem(this.$fillParent,apf.xmldb.getHtmlNode(this.$fillParent,this));delete this.$fillParent;}};this.$getParentNode=function(o){return o?this.$getLayoutNode("item","container",o):this.$container;};this.$fixItem=function(y,w,u,x,r){if(!w){return;}if(u){var s;if(s=this.getNextTraverse(y,true)){this.$fixItem(s,this.$findHtmlNode(s.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId),null,true);}if(!this.emptyMessage&&y.parentNode.selectNodes(this.each).length==1){this.$fixItem(y.parentNode,this.$findHtmlNode(y.parentNode.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId),null,false,true);}}else{var o=this.$getLayoutNode("item","container",w),t=false;if(r){t=false;}else{if(this.getTraverseNodes(y).length>0){t=true;}else{if(this.$hasLoadStatus(y,"potential")){t=true;}else{t=false;}}}var q=t&&w.className.indexOf("plus")>-1;isLast=this.getNextTraverse(y,null,x?2:1)?false:true,state=(t?b:0)|(q?d:0)|(isLast?g:0);this.$setStyleClass(this.$getLayoutNode("item","class",w),c[state],["min","plus","last","minlast","pluslast"]);this.$setStyleClass(this.$getLayoutNode("item","container",w),c[state],["min","plus","last","minlast","pluslast"]);if(this.$getLayoutNode("item","openclose",w)){this.$getLayoutNode("item","openclose",w).setAttribute("children",t);}if(o){if(!t){o.style.display="none";}else{if(!q){o.style.display="block";}}}}};this.$deInitNode=function(q,s){var o=this.$getLayoutNode("item","container",s),r=s.parentNode;o.parentNode.removeChild(o);r.removeChild(s);if(this.$withContainer){s.parentNode.removeChild(s.nextSibling);}if(q.parentNode!=this.xmlRoot){this.$fixItem(q,s,true);}var t;if(!r.childNodes.length&&(t=this.$applyBindRule("empty",q))){this.$setEmptyMessage(r,t);}this.$fixItem(q,s,true);};this.$moveNode=function(A,y,t){if(!self.apf.debug&&!y){return;}var r;if(this.$hasLoadStatus(A.parentNode,"potential")){r=this.$getLayoutNode("item","container",y);y.parentNode.removeChild(y);r.parentNode.removeChild(r);this.$extend(A.parentNode);return;}var B=y.parentNode,o=this.getTraverseParent(A),q=apf.xmldb.getHtmlNode(o,this),C=this.getNextTraverse(A),x=C?apf.xmldb.getHtmlNode(C,this):null,u=q?this.$getLayoutNode("item","container",q):this.$container;r=this.$getLayoutNode("item","container",y);if(u!=B&&this.getTraverseNodes(A.parentNode).length==1){this.$removeEmptyMessage(u);}u.insertBefore(y,x);if(r){u.insertBefore(r,x);}var s;if(!this.getTraverseNodes(t).length&&(s=this.$applyBindRule("empty",t))){this.$setEmptyMessage(B,s);}this.$fixItem(A,y);this.$fixItem(o,apf.xmldb.getHtmlNode(o,this));this.$updateNode(t,apf.xmldb.getHtmlNode(t,this));var w;if(w=this.getNextTraverse(A,true)){this.$fixItem(w,apf.xmldb.getHtmlNode(w,this));}};this.$setLoading=function(r,q){this.$setLoadStatus(r,"potential");var o=this.getTraverseNodes(r).length;if(!o||o>20){this.$getNewContext("loading");apf.insertHtmlNode(this.$getLayoutNode("loading"),q);}};this.$removeLoading=function(o){if(!o){return;}this.$getLayoutNode("item","container",o).innerHTML="";};this.$extend=function(r,o,q,u){if(!this.$hasLoadStatus(r,"potential")){return;}var t=this.$getBindRule("insert",r),s=t&&t.match?(t.cmatch||t.compile("match"))(r):r;if(t&&s){this.$setLoadStatus(r,"loading");if(t.get){this.getModel().$insertFrom(t.getAttribute("get"),{xmlNode:s,insertPoint:s,amlNode:this,callback:u});}else{if(this.$applyBindRule("insert",r)){this.insert(data,{insertPoint:s});}}}else{if(!this.prerender){this.$setLoadStatus(r,"loaded");this.$removeLoading(apf.xmldb.getHtmlNode(r,this));m.call(this,{action:"insert",xmlNode:r,result:this.$addNodes(r,o,true),anim:!q});}}};function m(r){if(r.action=="move-away"){this.$fixItem(r.xmlNode,apf.xmldb.findHtmlNode(r.xmlNode,this),true);}if(r.action!="insert"){return;}var q=this.$findHtmlNode(r.xmlNode.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);if(!q){return;}if(r.action=="insert"&&r.result.length>0){if(this.$hasLoadStatus(r.xmlNode,"loaded",true)){var o=this.$getLayoutNode("item","container",q);this.slideOpen(o,r.xmlNode);}else{if(this.$hasLoadStatus(r.xmlNode,"potential",true)){this.$setLoadStatus(r.xmlNode,"loaded");}}}else{this.$fixItem(r.xmlNode,q);}}this.addEventListener("xmlupdate",m);this.addEventListener("beforerename",function(){if(this.$tempsel){clearTimeout(this.timer);this.select(this.$tempsel);this.$tempsel=null;this.timer=null;}});this.addEventListener("keydown",function(H){var J=H.keyCode,t=H.ctrlKey,B=H.shiftKey,G=this.$caret||this.$selected,w,A,s,D,C,I,o,y;if(H.returnValue==-1||!G||this.renaming){return;}var q=this.caret||this.selected,r=this.$container;switch(J){case 13:if(this.$tempsel){this.$selectTemp();}if(this.ctrlselect=="enter"){this.select(this.caret,true);}this.choose(G);break;case 32:if(this.$tempsel){this.$selectTemp();}if(this.$mode&&!t){var E=this.getSelection();if(!E.length||!this.multiselect){this.checkToggle(this.caret,true);}else{this.checkList(E,this.isChecked(this.selected),true,false,true);}}else{if(t||!this.isSelected(this.caret)){this.select(this.caret,true);}}return false;case 46:if(this.$tempsel){this.$selectTemp();}this.remove(this.caret);break;case 36:this.$setTempSelected(this.getFirstTraverseNode(),false,B);r.scrollTop=0;return false;case 35:var u=this.getLastTraverseNode();while(!this.isCollapsed(u)){u=this.getLastTraverseNode(u);}this.$setTempSelected(u,false,B,true);r.scrollTop=r.scrollHeight;return false;case 37:if(this.$tempsel){this.$selectTemp();}if(this.caret.selectSingleNode(this.each)&&!this.isCollapsed(this.caret)){this.slideToggle(this.$caret||this.$selected,2);}else{if((o=this.getTraverseParent(this.caret))&&o!=this.xmlRoot){this.select(o);}}return false;case 107:case 187:case 39:if(this.$tempsel){this.$selectTemp();}if(this.$hasLoadStatus(this.caret,"potential")||this.getFirstTraverseNode(this.caret)){this.slideToggle(this.$caret||this.$selected,1);}break;case 109:case 189:if(this.getFirstTraverseNode(this.caret)){this.slideToggle(this.$caret||this.$selected,2);}break;case 38:if(!q&&!this.$tempsel){return;}D=this.$tempsel?apf.xmldb.getNode(this.$tempsel):q;I=this.getNextTraverse(D,true);if(I){C=this.getTraverseNodes(I);do{y=this.$getLayoutNode("item","container",this.$findHtmlNode(apf.xmldb.getID(I,this)));if(y&&apf.getStyle(y,"display")=="block"&&C.length){I=C[C.length-1];}else{break;}}while(I&&(C=this.getTraverseNodes(I)).length);}else{if(this.getTraverseParent(D)==this.xmlRoot){this.dispatchEvent("selecttop");return;}else{I=this.getTraverseParent(D);}}if(I&&I.nodeType==1){this.$setTempSelected(I,t,B,true);}else{return false;}G=apf.xmldb.getHtmlNode(I,this);A=apf.getAbsolutePosition(G,this.$container)[1]-(G.offsetHeight);if(A<=r.scrollTop){r.scrollTop=A;}return false;case 40:if(!q&&!this.$tempsel){return;}D=this.$tempsel?apf.xmldb.getNode(this.$tempsel):q;I=this.getFirstTraverseNode(D);if(I){y=this.$getLayoutNode("item","container",this.$findHtmlNode(apf.xmldb.getID(D,this)));if(y&&apf.getStyle(y,"display")!="block"){I=null;}}while(!I){o=this.getTraverseParent(D);if(!o){break;}var F=0;C=this.getTraverseNodes(o);while(C[F]&&C[F]!=D){F++;}I=C[F+1];D=o;}if(I&&I.nodeType==1){this.$setTempSelected(I,t,B);}else{return false;}G=apf.xmldb.getHtmlNode(I,this);A=apf.getAbsolutePosition(G,this.$container)[1]+(G.offsetHeight);if(A>r.scrollTop+r.offsetHeight){r.scrollTop=A-r.offsetHeight;}return false;case 33:w=apf.getAbsolutePosition(this.$container);s=document.elementFromPoint(w[0]+this.$container.offsetWidth-2,w[1]+2);I=apf.xmldb.findXmlNode(s);if(I==this.selected){r.scrollTop-=r.offsetHeight-apf.getHeightDiff(r);s=document.elementFromPoint(w[0]+this.$container.offsetWidth-2,w[1]+2);I=apf.xmldb.findXmlNode(s);}this.select(I);G=apf.xmldb.getHtmlNode(I,this);A=apf.getAbsolutePosition(G,this.$container)[1]-(G.offsetHeight);if(A<=r.scrollTop){r.scrollTop=A;}break;case 34:w=apf.getAbsolutePosition(this.$container);s=document.elementFromPoint(w[0]+this.$container.offsetWidth-2,w[1]+this.$ext.offsetHeight-4);I=apf.xmldb.findXmlNode(s);if(I==this.selected){r.scrollTop+=r.offsetHeight-apf.getHeightDiff(r);s=document.elementFromPoint(w[0]+this.$container.offsetWidth-2,w[1]+this.$ext.offsetHeight-4);I=apf.xmldb.findXmlNode(s);}this.select(I);G=apf.xmldb.getHtmlNode(I,this);A=apf.getAbsolutePosition(G,this.$container)[1]+(G.offsetHeight);if(A>r.scrollTop+r.offsetHeight){r.scrollTop=A-r.offsetHeight;}break;default:if(this.celledit){if(!t&&!H.altKey&&(J>46&&J<112||J>123)){this.startRename(null,true);}return;}else{if(J==65&&t){this.selectAll();return false;}else{if(this.caption||(this.bindingRules||{})["caption"]){if(!this.xmlRoot){return;}if(!this.lookup||new Date().getTime()-this.lookup.date.getTime()>300){this.lookup={str:"",date:new Date()};}this.lookup.str+=String.fromCharCode(J);var C=this.getTraverseNodes();for(var x,F=0;F<C.length;F++){x=this.$applyBindRule("caption",C[F]);if(x&&x.substr(0,this.lookup.str.length).toUpperCase()==this.lookup.str){if(!this.isSelected(C[F])){this.select(C[F]);}if(G){this.$container.scrollTop=G.offsetTop-(this.$container.offsetHeight-G.offsetHeight)/2;}return;}}return;}}}break;}},true);this.$getCaptionElement=function(){if(!this.$selected){return false;}var o=this.$getLayoutNode("item","caption",this.$selected);return o.nodeType==1?o:o.parentNode;};this.$calcSelectRange=function(t,q){var w=[],x=false,u=0,y=this.getTraverseParent(t),o=this.getTraverseParent(q),s=this.getTraverseNodes(y);for(;u<s.length;u++){if(s[u]==t){x=true;}if(x){w.push(s[u]);}if(s[u]==q){x=false;}}if(!w.length||x){w=[];for(x=false,u=s.length-1;u>=0;u--){if(s[u]==t){x=true;}if(x){w.push(s[u]);}if(s[u]==q){x=false;}}}return w;};this.$findContainer=function(o){return this.$getLayoutNode("item","container",o);};this.$selectDefault=function(r){if(this.select(this.getFirstTraverseNode(r),null,null,null,true)){return true;}else{var o=this.getTraverseNodes(r);for(var q=0;q<o.length;q++){if(this.$selectDefault(o[q])){return true;}}}};this.$setEmptyMessage=function(s,t){this.$getNewContext("empty");var q=this.$getLayoutNode("empty");if(!q){return;}var r=apf.insertHtmlNode(q,s);r.setAttribute("empty","true");var o=this.$getLayoutNode("empty","caption",r);if(o){apf.setNodeValue(o,t||"");}if(s.style){this.slideOpen(s,null,true);}else{if(this.nocollapse){s.setAttribute("style","display:inline-block;");}else{s.setAttribute("style","overflow:visible;height:auto;display:block;");}}};this.$removeEmptyMessage=function(q){var o=q.firstElementChild||q.firstChild;if(!o){return;}do{if(o.getAttribute&&o.getAttribute("empty")){q.removeChild(o);return;}o=o.nextSibling;}while(o);};this.$drawBase=function(){this.$ext=this.$getExternal();this.$container=this.$getLayoutNode("main","container",this.$ext);this.opencloseaction=this.$getOption("main","openclose");if(apf.hasCssUpdateScrollbarBug&&!this.mode){this.$fixScrollBug();}var o=this;this.$ext.onclick=function(q){o.dispatchEvent("click",{htmlEvent:q||event});};this.$ext.onmousedown=function(q){o.dispatchEvent("mousedown",{htmlEvent:q||event});};this.$ext.onmouseover=function(q){o.dispatchEvent("mouseover",{htmlEvent:q||event});};this.$ext.onmousemove=function(q){o.dispatchEvent("mousemove",{htmlEvent:q||event});};};this.addEventListener("DOMNodeInsertedIntoDocument",function(){if(this.nocollapse){this.startcollapsed=false;}else{if(this.startcollapsed===1){this.startcollapsed=!apf.isFalse(this.$getOption("main","startcollapsed"));}}});this.addEventListener("DOMNodeRemovedFromDocument",function(){this.$ext.onclick=null;apf.destroyHtmlNode(this.oDrag);this.oDrag=null;});}).call(apf.BaseTree.prototype=new apf.MultiSelect());apf.__DELAYEDRENDER__=1<<11;apf.DelayedRender=function(){this.$regbase=this.$regbase|apf.__DELAYEDRENDER__;this.$rendered=false;this.$render=function(c){if(this.$rendered){return;}if(this.dispatchEvent("beforerender")===false){return;}if(this["render-delay"]||c){$setTimeout("apf.lookup("+this.$uniqueId+").$renderparse()",10);}else{this.$renderparse();}};this.$renderparse=function(){if(this.$rendered){return;}this.$ext.style.visibility="hidden";var c=this.ownerDocument.$domParser;c.parseFromXml(this.$aml,{amlNode:this,doc:this.ownerDocument,delayedRender:true});c.$continueParsing(this);this.$rendered=true;this.dispatchEvent("afterrender");this.$ext.style.visibility="";};var b;this.addEventListener("prop.visible",b=function(){if(arguments[0].value){this.$render();this.removeEventListener("prop.visible",b);}});};apf.GuiElement.propHandlers.render=function(b){if(!this.hasFeature(apf.__DELAYEDRENDER__)&&b=="runtime"){this.implement(apf.DelayedRender);if(this.localName!="page"){this.visible=false;this.$ext.style.display="none";}if(typeof this["render-delay"]=="undefined"){this.$setInheritedAttribute("render-delay");}}};apf.config.$inheritProperties["render-delay"]=1;apf.__DRAGDROP__=1<<5;apf.DragDrop=function(){this.$regbase=this.$regbase|apf.__DRAGDROP__;this.$dragInited=false;this.copy=function(m,o,k,g){if(m.nodeType){m=[m];}var d,q=[],n=0,c=m.length;for(;n<c;n++){q.push({action:g?"moveNode":"appendChild",args:[o,g?m[n]:m[n]=m[n].cloneNode(true),k]});}if(this.$actions[(g?"movegroup":"copygroup")]){d=this.$executeAction("multicall",q,(g?"movegroup":"copygroup"),m[0]);}else{d=this.$executeAction("multicall",q,(g?"move":"copy"),m[0],null,null,m.length>1?m:null);}if(d!==false){return m;}return false;};this.move=function(d,g,c){return this.copy(d,g,c,true);};this.isDragAllowed=function(g,n){if(this.disabled||!g||!g.length||!g[0]){return false;}if(this.drag||this.dragcopy){if(n){n.merge(g);}return true;}var o,c=[],m=0,k=g.length;for(;m<k;m++){o=this.$getDataNode("drag",g[m],null,c);if(!o){return false;}if(n){n.push(o);}}return c.length?c:false;};this.isDropAllowed=function(s,o){if(this.disabled||!s||!s.length||!o){return false;}var m,d,n=this.$attrBindings&&this.$attrBindings.drop;if(this.drop&&(!n||n.value=="true")){this.$setDynamicProperty("drop",this.hasFeature(apf.__MULTISELECT__)?"["+this.each+"]":"[node()]");n=true;}if(n){for(var g=0,c=s.length;g<c;g++){m=this.$getDataNode("drop",s[g]);if(!m){break;}}if(g==c&&o&&!apf.isChildOf(m,o,true)){return[o,null];}}var u=this.$bindings.drop;if(!u||!u.length){return false;}var r,t,k=0,q=u.length;for(;k<q;k++){r=this.$bindings.getRuleIndex("drop",k);for(var g=0,c=s.length;g<c;g++){m=r.cvalue?r.cvalue(s[g]):r.cmatch(s[g]);if(!m){break;}}if(g!=c){continue;}t=r.target;if(!t||t=="."){d=o;}else{d=(r.ctarget||r.compile("target"))(o);}if(d&&!apf.isChildOf(m,d,true)){return[d,r];}}return false;};this.$dragDrop=function(y,g,u,w,s,x,c){if(o=="tree-append"&&s){return false;}var o=u&&u.action;if(o){o=(u.caction||u.compile("action"))(g[0]);}else{o=w;}var d={internal:apf.DragServer.dragdata.host==this,ctrlKey:c.ctrlKey,keyCode:c.keyCode},r=u&&u.copy;if(r){r=!apf.isFalse((u.ccopy||u.compile("copy"))(g[0],d));}else{if(typeof this.dragcopy=="boolean"||typeof this.dropcopy=="boolean"){if(this.dropcopy){r=this.dropcopy;}else{if(this.dragcopy){r=c.ctrlKey;}else{var m=this.$attrBindings&&this.$attrBindings.dragcopy;if(m){r=!apf.isFalse((m.cvalue2||m.compile("value",{withopt:true}))(g[0],d));}}}}}if(!r){for(var q=0,k=x.length;q<k;q++){r=typeof x[q]=="object"&&x[q].copy?!apf.isFalse((x[q].ccopy||x[q].compile("copy"))(g[0],d)):c.ctrlKey;if(r){break;}}}var t,A=r?"copy":"move",n=u?u.getAttribute("parent"):null;switch(o){case"list-append":y=(s?y:this.getTraverseParent(y));if(n){if(y.selectSingleNode(n)){y=y.selectSingleNode(n);}else{y.appendChild(y.ownerDocument.createElement(n));y=y.selectSingleNode(n);}}t=this[A](g,y);break;case"insert-before":t=s?this[A](g,y):this[A](g,y.parentNode,y);break;case"tree-append":if(n){if(y.selectSingleNode(n)){y=y.selectSingleNode(n);}else{y.appendChild(y.ownerDocument.createElement(n));y=y.selectSingleNode(n);}}t=this[A](g,y);break;}if(this.selectable&&t){this.selectList(t);this.setCaret(t[0]);this.focus();}return t;};this.enableDragDrop=function(){this.icoAllowed="";this.icoDenied="";this.$ext.dragdrop=false;var c=this;this.$ext[apf.isIphone?"ontouchstart":"onmousedown"]=function(n){if(c.disabled){return;}n=n||window.event;var m,g=n.originalTarget||n.srcElement||n.target,d=c.hasFeature(apf.__MULTISELECT__);if(d&&g==c.$container){return;}c.dragging=0;try{if(!apf.isIphone&&c.allowdeselect&&(g==this||g.getAttribute(apf.xmldb.htmlIdTag)&&c.$getLayoutNode("item","select",this)!=this)){return;}}catch(n){return;}if(c.$findValueNode){m=c.$findValueNode(g);}var k=(m?apf.xmldb.getNode(m):apf.xmldb.findXmlNode(g));if(d&&(!c.selected||!k||k==c.xmlRoot)){return;}if(c.isDragAllowed(d?c.$getSelection():k)){apf.DragServer.start(c,g,n);}};this.$ext[apf.isIphone?"ontouchmove":"onmousemove"]=function(d){if(this.host.dragging!=1||c.disabled){return;}};this.$ext.onmouseup=function(){if(c.disabled){return;}this.host.dragging=0;};this.$ext.ondragcopy=this.$ext.ondragstart=function(){return false;};if(document.elementFromPointAdd){document.elementFromPointAdd(this.$ext);}if(this.$initDragDrop&&!this.$dragInited){this.$initDragDrop();this.$dragInited=2;}else{this.$dragInited=true;}};function b(){this.$dragInited=false;this.$ext.onmousedown=this.$ext.onmousemove=this.$ext.onmouseup=null;if(document.elementFromPointRemove){document.elementFromPointRemove(this.$ext);}}this.implement(this.hasFeature(apf.__MULTISELECT__)?apf.MultiselectDragDrop:apf.StandardDragDrop);this.$supportedProperties.push("drop","drag","dragcopy");this.$propHandlers.dragcopy=this.$propHandlers.dropcopy=this.$propHandlers.drag=this.$propHandlers.drop=function(c,d){this[d]=apf.isTrue(c);if(this.$dragInited&&d=="drag"&&c&&this.$dragInited!=2){this.$initDragDrop();this.$dragInited=2;return;}if(d=="dragcopy"||d=="dropcopy"){return;}if(!c&&!this.drag&&!this.drop&&!this.$bindings&&(this.$attrBindings&&(!this.$attrBindings.drag||!this.$attrBindings.drop))){b.call(this);}else{if(c&&!this.$dragInited){this.enableDragDrop();}}};this.addEventListener("DOMNodeRemovedFromDocument",function(c){b.call(this);if(this.oDrag){apf.destroyHtmlNode(this.oDrag);this.oDrag=null;}});};apf.GuiElement.propHandlers.dragcopy=apf.GuiElement.propHandlers.dropcopy=apf.GuiElement.propHandlers.drop=apf.GuiElement.propHandlers.drag=function(b,c){if(!apf.isFalse(b)){if(!this.hasFeature(apf.__DRAGDROP__)){this.implement(apf.DragDrop);this.enableDragDrop();}this[c]=apf.isTrue(b);}};apf.DragServer={Init:function(){apf.addEventListener("hotkey",function(b){if(apf.window.dragging&&b.keyCode==27){if(document.body.lastHost&&document.body.lastHost.dragOut){document.body.lastHost.dragOut(apf.dragHost);}return apf.DragServer.stopdrag();}});},start:function(n,c,q){if(document.elementFromPointReset){document.elementFromPointReset();}n.dragging=1;var r=window.document;r=(!r.compatMode||r.compatMode=="CSS1Compat")?r.html||r.documentElement:r.body;var w=(apf.isIE?r.scrollLeft:window.pageXOffset),u=(apf.isIE?r.scrollTop:window.pageYOffset),b=n.$ext.offsetParent,s;while(b&&b!=r&&b.tagName!="BODY"){w-=b.scrollLeft;u-=b.scrollTop;b=b.offsetParent;}var m=c,k;while(m&&m.nodeType==1&&!(k=m.getAttribute(apf.xmldb.htmlIdTag))){m=m.parentNode;}if(!k){return;}s=apf.getAbsolutePosition(m);apf.DragServer.coordinates={srcElement:c,doc:r,scrollX:w,scrollY:u,offsetX:q.clientX-s[0],offsetY:q.clientY-s[1],clientX:q.pageX?q.pageX-window.pageXOffset:q.clientX,clientY:q.pageY?q.pageY-window.pageYOffset:q.clientY};var t=n.hasFeature(apf.__MULTISELECT__)?n.getSelection():[n.xmlRoot],o=[],g=n.isDragAllowed(t,o);if(!g){return;}if(n.hasEventListener("dragdata")){o=n.dispatchEvent("dragdata",{data:o});}this.dragdata={rules:g,selection:t,data:o,indicator:n.$showDragIndicator(t,this.coordinates),host:n};if(n.dispatchEvent("dragstart",this.dragdata)===false){return false;}n.dragging=2;apf.dragMode=true;document.onmousemove=this.onmousemove;document.onmouseup=this.onmouseup;},stop:function(b,c){if(this.last){this.dragout();}this.dragdata.host.dragging=0;this.dragdata.host.$hideDragIndicator(c);apf.dragMode=false;document.onmousemove=document.onmouseup=null;this.dragdata=null;},dragover:function(m,d,k){k=k||window.event;var g;if(m.$findValueNode){g=m.$findValueNode(d);}if(this.lastFel&&this.lastFel==g||!this.lastFel&&this.last==m){return;}var n=(g?apf.xmldb.getNode(g):apf.xmldb.findXmlNode(d)),b=m.isDropAllowed&&m.xmlRoot?m.isDropAllowed(this.dragdata.data,n||m.xmlRoot):apf.isTrue(apf.getInheritedAttribute(m,"",function(o){if(o.drop){m=o;if(m==apf.DragServer.last){return false;}return true;}}));if(this.last&&this.last!=m){this.dragout(this.last,k);}this.last=m;this.lastFel=g;if(!b){return;}if(m.dispatchEvent("dragover",this.dragdata)===false){b=false;}var c=k.originalTarget||k.srcElement||k.target;if(m&&m.$dragover){m.$dragover(d,this.dragdata,b);}},dragout:function(c,b){this.lastFel=null;if(c){this.dragdata.htmlEvent=b;c.dispatchEvent("dragout",this.dragdata);}if(this.last&&this.last.$dragout){this.last.$dragout(null,this.dragdata);}this.last=null;},dragdrop:function(b,c,u,r){var q,t,k=(b.$findValueNode?apf.xmldb.getNode(b.$findValueNode(c)):apf.xmldb.findXmlNode(c)),d=(b.isDropAllowed&&b.xmlRoot)?b.isDropAllowed(this.dragdata.data,k||b.xmlRoot):false;if(this.dragdata.indicator){t=this.dragdata.indicator.style.top;this.dragdata.indicator.style.top="10000px";}if(!d){d=apf.isTrue(apf.getInheritedAttribute(b,"",function(m){if(m.drop){b=m;return true;}}));}if(d){if(b.dispatchEvent("dragdrop",apf.extend({candrop:d,htmlEvent:r,top:t},this.dragdata))===false){d=false;}else{if(!b.xmlRoot){var g=b.getModel?b.getModel(true):apf.nameserver.get("model",b.model);if(g){g.load(this.dragdata.data[0]);}return true;}else{var n=d[1]&&d[1].action||(b.$isTreeArch?"tree-append":"list-append");if(n=="list-append"&&(!b.$isTreeArch&&b==this.dragdata.host)){d=false;}}}}if(this.dragdata.indicator){this.dragdata.indicator.style.top=t;}if(!d){this.dragout(b,r);return false;}if(b.$dragDrop){var s=b.$dragDrop(d[0],this.dragdata.data,d[1],n,q||d[0]==b.xmlRoot,this.dragdata.rules,r);this.dragdata.resultNode=s;}if(b.$dragdrop){b.$dragdrop(c,apf.extend({htmlEvent:r,xmlNode:s},this.dragdata),d);}this.last=null;this.lastFel=null;return true;},onmousemove:function(m){if(!apf.DragServer.dragdata){return;}m=m||window.event;var d=apf.DragServer.dragdata,n={clientX:m.pageX?m.pageX-window.pageXOffset:m.clientX,clientY:m.pageY?m.pageY-window.pageYOffset:m.clientY};if(!d.started&&Math.abs(apf.DragServer.coordinates.clientX-n.clientX)<6&&Math.abs(apf.DragServer.coordinates.clientY-n.clientY)<6){return;}if(!d.started){if(d.host.$dragstart){d.host.$dragstart(null,d);}d.started=true;}var b=d.indicator.style.top;d.indicator.style.display="block";if(d.indicator){d.indicator.style.top="10000px";}apf.DragServer.dragdata.x=m.pageX?m.pageX-(!apf.isIE?window.pageXOffset:0):n.clientX;apf.DragServer.dragdata.y=m.pageY?m.pageY-(!apf.isIE?window.pageYOffset:0):n.clientY;var g=document.elementFromPoint(apf.DragServer.dragdata.x,apf.DragServer.dragdata.y);if(!g){g=document.elementFromPoint(apf.DragServer.dragdata.x,apf.DragServer.dragdata.y);}d.indicator.style.top=b;d.host.$moveDragIndicator(n);var k=apf.findHost(g);if(k){apf.DragServer.dragover(k,g,m);}else{if(apf.DragServer.last){apf.DragServer.dragout(apf.DragServer.last,m);}}apf.DragServer.lastTime=new Date().getTime();},onmouseup:function(m){m=m||window.event;var o={clientX:m.pageX?m.pageX-window.pageXOffset:m.clientX,clientY:m.pageY?m.pageY-window.pageYOffset:m.clientY};if(!apf.DragServer.dragdata.started&&Math.abs(apf.DragServer.coordinates.clientX-o.clientX)<6&&Math.abs(apf.DragServer.coordinates.clientY-o.clientY)<6){apf.DragServer.stop(true);return;}var d=apf.DragServer.dragdata.indicator,b=d.style.top;if(d){d.style.top="10000px";}apf.DragServer.dragdata.x=m.pageX?m.pageX-(!apf.isIE?window.pageXOffset:0):o.clientX;apf.DragServer.dragdata.y=m.pageY?m.pageY-(!apf.isIE?window.pageYOffset:0):o.clientY;var g=document.elementFromPoint(apf.DragServer.dragdata.x,apf.DragServer.dragdata.y);if(!g){g=document.elementFromPoint(apf.DragServer.dragdata.x,apf.DragServer.dragdata.y);}d.style.top=b;var k=apf.findHost(g);if(apf.DragServer.host&&k!=apf.DragServer.host){apf.DragServer.dragout(apf.DragServer.host,m);}var n=apf.DragServer.dragdrop(k,g,apf.DragServer.dragdata.host,m);apf.DragServer.stop(true,n);}};apf.MultiselectDragDrop=function(){this.diffX=this.diffY=0;this.multiple=false;this.lastDragNode=null;this.lastel=null;this.$showDragIndicator=function(k,o){this.multiple=k.length>1;if(this.multiple){this.diffX=o.scrollX;this.diffY=o.scrollY;}else{this.diffX=-1*o.offsetX;this.diffY=-1*o.offsetY;}var g=this.oDrag.className.split(" ")[0];this.$setStyleClass(this.oDrag,(this.multiple?g+"_multiple":"")+(this["class"]?" "+this["class"]:""),[g+"_multiple"]);if(this.multiple){document.body.appendChild(this.oDrag);return this.oDrag;}else{if(this.localName=="datagrid"){if(this.lastDragNode){apf.destroyHtmlNode(this.lastDragNode);}k=this.$selected||this.$caret;var n=k.cloneNode(true);n.removeAttribute("onmousedown");n.onmousedown=null;n.removeAttribute("onmouseup");n.onmouseup=null;n.removeAttribute("onmouseout");n.onmouseout=null;n.removeAttribute("ondblclick");n.ondblclick=null;document.body.appendChild(n);n.style.position="absolute";n.style.width=k.offsetWidth+"px";n.style.display="none";n.removeAttribute("id");this.$setStyleClass(n,"draggrid");var b=k.childNodes;var m=n.childNodes;for(var c=b.length-1;c>=0;c--){if(m[c].nodeType==1){m[c].style.width=apf.getStyle(b[c],"width");}}return(this.lastDragNode=n);}else{var k=this.$selected||this.$caret,d=apf.getStyle(this.oDrag,"width");if(!d||d=="auto"){this.oDrag.style.width=(k.offsetWidth-apf.getWidthDiff(this.oDrag))+"px";}this.$updateNode(this.selected,this.oDrag);}}apf.window.zManager.set("drag",this.oDrag);return this.oDrag;};this.$hideDragIndicator=function(d){var c=this.lastDragNode||this.oDrag,b=this;if(!this.multiple&&!d&&c.style.display=="block"){if(!this.$selected&&!this.$caret){return;}var g=apf.getAbsolutePosition(this.$selected||this.$caret);apf.tween.multi(c,{anim:apf.tween.easeInOutCubic,steps:apf.isIE?15:20,interval:15,tweens:[{type:"left",from:c.offsetLeft,to:g[0]},{type:"top",from:c.offsetTop,to:g[1]}],onfinish:function(){if(b.lastDragNode){apf.destroyHtmlNode(b.lastDragNode);b.lastDragNode=null;}else{b.oDrag.style.display="none";}}});}else{if(this.lastDragNode){apf.destroyHtmlNode(this.lastDragNode);this.lastDragNode=null;}else{this.oDrag.style.display="none";}}};this.$moveDragIndicator=function(c){var b=this.lastDragNode||this.oDrag;b.style.left=(c.clientX+this.diffX)+"px";b.style.top=(c.clientY+this.diffY+(this.multiple?15:0))+"px";};this.addEventListener("$skinchange",function(){this.$initDragDrop();});this.$initDragDrop=function(){if(!this.$hasLayoutNode("dragindicator")){return;}this.oDrag=apf.insertHtmlNode(this.$getLayoutNode("dragindicator"),document.body);apf.window.zManager.set("drag",this.oDrag);this.oDrag.style.position="absolute";this.oDrag.style.cursor="default";this.oDrag.style.display="none";};this.$findValueNode=function(b){if(!b){return null;}while(b&&b.nodeType==1&&!b.getAttribute(apf.xmldb.htmlIdTag)){if(this.$isTreeArch&&b.previousSibling&&b.previousSibling.nodeType==1){b=b.previousSibling;}else{b=b.parentNode;}}return(b&&b.nodeType==1&&b.getAttribute(apf.xmldb.htmlIdTag))?b:null;};this.$dragout=function(k,c,b){if(this.lastel){this.$setStyleClass(this.lastel,"",["dragDenied","dragInsert","dragAppend","selected","indicate"]);}var m=this.$getSelection(true);for(var g=0,d=m.length;g<d;g++){this.$setStyleClass(m[g],"selected",["dragDenied","dragInsert","dragAppend","indicate"]);}this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Drop"]);this.lastel=null;};if(!this.$dragdrop){this.$dragdrop=this.$dragout;}this.$dragover=function(k,c,b){this.$setStyleClass(this.$ext,this.$baseCSSname+"Drop");var o=this.$getSelection(true);for(var g=0,d=o.length;g<d;g++){this.$setStyleClass(o[g],"",["dragDenied","dragInsert","dragAppend","selected","indicate"]);}if(this.lastel){this.$setStyleClass(this.lastel,"",["dragDenied","dragInsert","dragAppend","selected","indicate"]);}var n=b[1]&&b[1].action;this.lastel=this.$findValueNode(k);if(this.$isTreeArch&&n=="list-append"){var m=apf.xmldb.findHtmlNode(this.getTraverseParent(apf.xmldb.getNode(this.lastel)),this);this.lastel=m?this.$getLayoutNode("item","container",m):this.$container;this.$setStyleClass(this.lastel,"dragInsert");}else{this.$setStyleClass(this.lastel,b?(n=="insert-before"?"dragInsert":"dragAppend"):"dragDenied");}};};apf.StandardDragDrop=function(){this.$showDragIndicator=function(d,g){var b=g.offsetX+22,k=g.offsetY;this.oDrag.startX=b;this.oDrag.startY=k;document.body.appendChild(this.oDrag);var c=this.$getLayoutNode("main","caption",this.oDrag);if(c.nodeType!=1){c=c.parentNode;}c.innerHTML=this.$applyBindRule("caption",this.xmlRoot)||"";return this.oDrag;};this.$hideDragIndicator=function(){this.oDrag.style.display="none";};this.$moveDragIndicator=function(b){this.oDrag.style.left=(b.clientX-this.oDrag.startX+document.documentElement.scrollLeft)+"px";this.oDrag.style.top=(b.clientY-this.oDrag.startY+document.documentElement.scrollTop)+"px";};this.$initDragDrop=function(){if(!this.getAttribute("drag")){return;}this.oDrag=document.body.appendChild(this.$ext.cloneNode(true));apf.window.zManager.set("drag",this.oDrag);this.oDrag.style.position="absolute";this.oDrag.style.cursor="default";this.oDrag.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=50)";this.oDrag.style.MozOpacity=0.5;this.oDrag.style.opacity=0.5;this.oDrag.style.display="none";};};apf.DragServer.Init();apf.__FOCUSSABLE__=1<<26;apf.Focussable=function(){this.$regbase=this.$regbase|apf.__FOCUSSABLE__;if(this.disabled==undefined){this.disabled=false;}this.setTabIndex=function(b){apf.window.$removeFocus(this);apf.window.$addFocus(this,b);return this;};this.focus=function(b,d,c){if(!b){if(this.$isWindowContainer>-1){apf.window.$focusLast(this,d,true);}else{apf.window.$focus(this,d);if(!c&&apf.hasFocusBug){apf.window.$focusfix();}}return this;}if(this.$focus&&!this.editable&&(!d||!d.mouse||this.$focussable==apf.KEYBOARD_MOUSE)){this.$focus(d);}this.dispatchEvent("focus",apf.extend({bubbles:true},d));return this;};this.blur=function(b,c){if((c&&!apf.isChildOf(c.fromElement,c.toElement))&&apf.popup.isShowing(this.$uniqueId)){apf.popup.forceHide();}if(this.$blur){this.$blur(c);}if(!b){apf.window.$blur(this);}this.dispatchEvent("blur",apf.extend({bubbles:!c||!c.cancelBubble},c));return this;};this.hasFocus=function(){return apf.document.activeElement==this||this.$isWindowContainer&&(apf.document.activeElement||{}).$focusParent==this;};};apf.__INTERACTIVE__=1<<21;apf.Interactive=function(){var s,q,ab,Z,d,M=null,aa,S,V,ai,G,T,ak,x,O,ad,g,af,c,A,m,F,R,Q,ac,u=this,ae,Y,X,K,U,y,k,B;this.$regbase=this.$regbase|apf.__INTERACTIVE__;this.$dragStart=function(t,r){var b=t||event;if(!r&&b.button==2){return;}o.apply(b.srcElement||this,arguments);};this.$propHandlers.draggable=function(b){if(apf.isFalse(b)){this.draggable=b=false;}else{if(apf.isTrue(b)){this.draggable=b=true;}}var r=this.editable?this.$ext:this.oDrag||this.$ext;if(b){apf.addListener(r,"mousedown",this.$dragStart);}else{apf.removeListener(r,"mousedown",this.$dragStart);}if(r.interactive&1){return;}r.interactive=(r.interactive||0)+1;};this.$propHandlers.resizable=function(b){if(apf.isFalse(b)){this.resizable=b=false;}else{if(apf.isTrue(b)){this.resizable=b=true;}}this.$ext.style.cursor="";var r=this.oResize||this.$ext;if(r.interactive&2){return;}if(!u.editable){apf.addListener(r,"mousedown",function(){L.apply(r,arguments);});apf.addListener(r,"mousemove",function(){E.apply(r,arguments);});}r.interactive=(r.interactive||0)+2;m=this.$getOption&&parseInt(this.$getOption("Main","resize-border"))||3;F=this.$getOption&&parseInt(this.$getOption("Main","resize-corner"))||12;R=apf.getBox(apf.getStyle(this.$ext,"borderWidth"));};this.$cancelInteractive=function(){document.onmouseup(null,true);};function o(w,t){if(!w){w=event;}if(!t&&(!u.draggable||apf.dragMode)){return;}U=u.dragOutline==true||apf.config.dragOutline;if(u.dispatchEvent("beforedragstart",{htmlEvent:w})===false){return;}apf.dragMode=true;if(t){u.dispatchEvent("beforedrag");K=true;}else{K=false;}apf.popup.forceHide();ae="absolute|fixed".indexOf(apf.getStyle(u.$ext,"position"))>-1;if(!ae){u.$ext.style.position=ae?"absolute":"relative";}if(u.editable){ae=true;}if(ae&&!u.aData){apf.plane.show(U?N:u.$ext,w.reappend);}var r=(t||N.self)&&U?N:u.$ext;var al=ae?apf.getAbsolutePosition(r,r.offsetParent,true):[parseInt(apf.getStyle(r,"left"))||0,parseInt(apf.getStyle(r,"top"))||0];B=[r.style.left,r.style.top,r.style.right,r.style.bottom,r.style.width,r.style.height];s=al[0]-(Y=w.clientX);q=al[1]-(X=w.clientY);if(!(t||N.self)){if(ae&&U){N.className="drag";var b=apf.getDiff(N);u.$ext.offsetParent.appendChild(N);N.style.left=al[0]+"px";N.style.top=al[1]+"px";N.style.width=(u.$ext.offsetWidth-b[0])+"px";N.style.height=(u.$ext.offsetHeight-b[1])+"px";if(u.editable){N.style.display="block";}}else{if(u.$ext.style.right){u.$ext.style.left=al[0]+"px";u.$ext.style.right="";}if(u.$ext.style.bottom){u.$ext.style.top=al[1]+"px";u.$ext.style.bottom="";}}}document.onmousemove=n;document.onmouseup=function(ap,an){document.onmousemove=document.onmouseup=null;if(ae&&!u.aData){apf.plane.hide();}var ao=U?N:u.$ext;if(K&&!u.$multidrag){if(an){var am=u.$ext;am.style.left=B[0];am.style.top=B[1];am.style.right=B[2];am.style.bottom=B[3];am.style.width=B[4];am.style.height=B[5];if(u.dispatchEvent){u.dispatchEvent("dragcancel");}}else{if(u.setProperty){W();}else{if(U){u.$ext.style.left=aa+"px";u.$ext.style.top=S+"px";}}}}aa=S=O=ad=null;if(!ae){u.$ext.style.position="relative";}if(u.showdragging){apf.setStyleClass(u.$ext,"",["dragging"]);}if(ae&&U&&!N.self){N.style.display="none";}apf.dragMode=false;if(!an&&u.dispatchEvent&&K){u.dispatchEvent("afterdrag",{htmlNode:ao});}};if(t){document.onmousemove(w);}return false;}function n(w){if(!w){w=event;}if(!K&&u.showdragging){apf.setStyleClass(u.$ext,"dragging");}var r=w.clientX-Y,b=w.clientY-X,am;if(!K&&(am=r*r>b*b?r:b)*am<2){return;}else{if(!K){if(U&&N.style.display!="block"){N.style.display="block";}if(u.dispatchEvent&&u.dispatchEvent("beforedrag")===false){document.onmouseup();return;}}}var t=U?N:u.$ext;t.style.left=(aa=w.clientX+s)+"px";t.style.top=(S=w.clientY+q)+"px";if(u.realtime){var al=u.$stick={};u.$showDrag(aa,S,t,w,al);if(typeof al.l!="undefined"){aa=al.l,t.style.left=aa+"px";}if(typeof al.t!="undefined"){S=al.t,t.style.top=S+"px";}}K=true;}this.$resizeStart=L;function L(w,aq){if(!w){w=event;}if(!u.resizable||String(u.height).indexOf("%")>-1&&u.parentNode.localName=="vbox"||String(u.width).indexOf("%")>-1&&u.parentNode.localName=="hbox"){return;}y=!(u.resizeOutline==false||!apf.config.resizeOutline);var b=u.$ext;if(!y){var ap=apf.getDiff(b);ac=ap[0];Q=ap[1];}d=apf.getAbsolutePosition(b);d.push(b.offsetWidth);d.push(b.offsetHeight);k=apf.getAbsolutePosition(b,b.offsetParent,true);B=[b.style.left,b.style.top,b.style.right,b.style.bottom,b.style.width,b.style.height];var al=0,an=0,ao=(Y=w.clientX)-d[0]+al+document.documentElement.scrollLeft,am=(X=w.clientY)-d[1]+an+document.documentElement.scrollTop,t;if(aq&&aq.resizeType){ae="absolute|fixed".indexOf(apf.getStyle(b,"position"))>-1;t=aq.resizeType;}else{t=P.call(b,ao,am);}ab=ao;Z=am;if(!t){return;}if(u.dispatchEvent&&u.dispatchEvent("beforeresize",{type:t,setType:function(ar){t=ar;}})===false){return;}apf.popup.forceHide();apf.dragMode=true;K=false;g=t.indexOf("w")>-1;af=t.indexOf("n")>-1;c=t.indexOf("e")>-1;A=t.indexOf("s")>-1;if(!u.minwidth){u.minwidth=0;}if(!u.minheight){u.minheight=0;}if(!u.maxwidth){u.maxwidth=10000;}if(!u.maxheight){u.maxheight=10000;}if(ae){G=k[0]+d[2];T=k[1]+d[3];ak=k[0]+d[2];x=k[1]+d[3];}if(ae){apf.plane.show(y?N:b);}if(y){N.className="resize";var r=apf.getDiff(N);ac=r[0];Q=r[1];N.style.left=d[0]+"px";N.style.top=d[1]+"px";N.style.width=(b.offsetWidth-ac)+"px";N.style.height=(b.offsetHeight-Q)+"px";N.style.display="block";}else{if(b.style.right){b.style.left=k[0]+"px";}if(b.style.bottom){b.style.top=k[1]+"px";}}if(!aq||!aq.nocursor){if(M===null){M=document.body.style.cursor;}document.body.style.cursor=t+"-resize";}document.onmousemove=C;document.onmouseup=function(av,at){document.onmousemove=document.onmouseup=null;if(ae){apf.plane.hide();}clearTimeout(J);if(y){var au=apf.getDiff(u.$ext);ac=au[0];Q=au[1];}if(at){var ar=u.$ext;ar.style.left=B[0];ar.style.top=B[1];ar.style.right=B[2];ar.style.bottom=B[3];ar.style.width=B[4];ar.style.height=B[5];if(u.dispatchEvent){u.dispatchEvent("resizecancel");}}else{ah(av||event,true);}if(u.setProperty){W();}document.body.style.cursor=M||"";M=null;if(y){N.style.display="none";}apf.dragMode=false;if(!at&&u.dispatchEvent){u.dispatchEvent("afterresize",{l:aa,t:S,w:O+ac,h:ad+Q});}aa=S=O=ad=null;};return false;}function W(al,an,t,at,ao,am,ar,b){if(typeof al=="undefined"){al=aa,an=S,t=O,at=ad,am=Q,ao=ac;}else{ae=true;}var aq=u.left||u.left===0;var au=u.right||u.right===0;var r=u.bottom||u.bottom===0;var w=u.top||u.top===0;if(ae){var ap=N.style.display=="block"?N:u.$ext;if(au&&!(ar||ar===0)){ar=apf.getHtmlRight(ap);}if(r&&!(b||b===0)){b=apf.getHtmlBottom(ap);}if(au){u.setProperty("right",ar,0,u.editable);if(!u.left){ap.style.left="";}}if(r){u.setProperty("bottom",b,0,u.editable);if(!u.top){ap.style.top="";}}if((al||al===0)&&(!au||aq)){u.setProperty("left",al,0,u.editable);}if((an||an===0)&&(!r||w)){u.setProperty("top",an,0,u.editable);}}if(ao!=undefined&&t&&(!aq||!au)){u.setProperty("width",t+ao,0,u.editable);}if(am!=undefined&&at&&(!w||!r)){u.setProperty("height",at+am,0,u.editable);}}this.$updateProperties=W;var ag=Math.min,D=Math.max,aj,J;function C(b){if(!b){b=event;}clearTimeout(J);if(aj&&new Date().getTime()-aj<(y?6:apf.mouseEventBuffer)){var r={clientX:b.clientX,clientY:b.clientY};J=setTimeout(function(){ah(r);},10);return;}aj=new Date().getTime();ah(b);}function ah(al,w){var t=y&&!w?N:u.$ext;var r=document.documentElement.scrollLeft,b=document.documentElement.scrollTop;if(g){if(ae){t.style.left=(aa=D((ak-u.maxwidth),ag((G-u.minwidth),k[0]+al.clientX-Y+r)))+"px";}t.style.width=(O=ag(u.maxwidth-ac,D(ac,u.minwidth,d[2]-(al.clientX-Y)+r)-ac))+"px";}if(af){if(ae){t.style.top=(S=D((x-u.maxheight),ag((T-u.minheight),k[1]+al.clientY-X+b)))+"px";}t.style.height=(ad=ag(u.maxheight-Q,D(Q,u.minheight,d[3]-(al.clientY-X)+b)-Q))+"px";}if(c){t.style.width=(O=ag(u.maxwidth-ac,D(ac,u.minwidth,al.clientX-d[0]+(d[2]-ab)+r)-ac))+"px";}if(A){t.style.height=(ad=ag(u.maxheight-Q,D(Q,u.minheight,al.clientY-d[1]+(d[3]-Z)+b)-Q))+"px";}if(u.parentNode&&u.parentNode.localName=="table"){W();apf.layout.processQueue();}if(u.realtime){var am=u.$stick={};u.$showResize(aa||apf.getHtmlLeft(t),S||apf.getHtmlTop(t),O&&O+ac||t.offsetWidth,ad&&ad+Q||t.offsetHeight,al,am,g,af,c,A);if(ae&&g&&typeof am.l!="undefined"){t.style.left=(aa=D((ak-u.maxwidth),ag((G-u.minwidth),am.l)))+"px";}if(ae&&af&&typeof am.t!="undefined"){t.style.top=(S=D((x-u.maxheight),ag((T-u.minheight),am.t)))+"px";}if(typeof am.w!="undefined"){t.style.width=(O=ag(u.maxwidth-ac,D(ac,u.minwidth,am.w)-ac))+"px";}if(typeof am.h!="undefined"){t.style.height=(ad=ag(u.maxheight-Q,D(Q,u.minheight,am.h)-Q))+"px";}}if(apf.hasSingleRszEvent){apf.layout.forceResize(u.$int);}}function P(b,w){var t="",r="";ae="absolute|fixed".indexOf(apf.getStyle(u.$ext,"position"))>-1;if(u.resizable==true||u.resizable=="vertical"){if(w<m+R[0]){t=ae?"n":"";}else{if(w>this.offsetHeight-m){t="s";}else{if(w>this.offsetHeight-F){r="s";}}}}if(u.resizable==true||u.resizable=="horizontal"){if(b<(t?F:m)+R[0]){t+=r+(ae?"w":"");}else{if(b>this.offsetWidth-(t||r?F:m)){t+=r+"e";}}}return t;}var H;function E(w){if(!w){w=event;}if(!u.resizable||u.editable||document.onmousemove){return;}var an=apf.getAbsolutePosition(u.$ext),t=0,r=0,b=w.clientX-an[0]+t+document.documentElement.scrollLeft,am=w.clientY-an[1]+r+document.documentElement.scrollTop;if(!H){H=apf.getStyle(this,"cursor");}var al=P.call(u.$ext,b,am);this.style.cursor=al?al+"-resize":H||"default";}var N;function I(r){var b=this.$pHtmlDoc||document;N=b.getElementById("apf_outline");if(!N){N=b.body.appendChild(b.createElement("div"));N.refCount=0;N.setAttribute("id","apf_outline");N.style.position="absolute";N.style.display="none";apf.window.zManager.set("drag",N);N.host=false;}N.refCount++;}if(this.addEventListener&&this.hasFeature(apf.__AMLNODE__)&&!this.$amlLoaded){if(document.body){I.call(this);}else{this.addEventListener("DOMNodeInsertedIntoDocument",I);}}else{this.$pHtmlDoc=document;I.call(this);}this.$setOutline=function(b){N=b;};};apf.GuiElement.propHandlers.resizable=function(b){this.implement(apf.Interactive);this.$propHandlers.resizable.apply(this,arguments);};apf.GuiElement.propHandlers.draggable=function(b){this.implement(apf.Interactive);this.$propHandlers.draggable.apply(this,arguments);};apf.Init.run("interactive");apf.__MEDIA__=1<<20;apf.__MULTICHECK__=1<<22;apf.MultiCheck=function(){this.$regbase=this.$regbase|apf.__MULTICHECK__;this.multicheck=true;this.checklength=0;this.$checkedList=[];this.check=function(g,m){if(m&&this.disabled||this.$checkedList.indexOf(g)>-1){return;}if(m&&this.$executeSingleValue("check","checked",g,"true")!==false){return;}if(this.dispatchEvent("beforecheck",{xmlNode:g})===false){return false;}if(!this.multicheck&&this.$checkedList.length){this.clearChecked(true);}this.$checkedList.push(g);if(this.$isTreeArch){var b=g.selectNodes(".//"+this.each.split("|").join("|.//"));this.checkList(b,null,true,true);var k,d=this.getTraverseParent(g);while(d&&d!=this.xmlRoot){b=this.getTraverseNodes(d);k=true;for(var c=0;c<b.length;c++){if(this.$checkedList.indexOf(b[c])==-1){k=false;break;}}apf.setStyleClass(apf.xmldb.getHtmlNode(d,this),k?"checked":"partial",["partial","checked"]);if(k){this.$checkedList.push(d);}d=this.getTraverseParent(d);}}this.$setStyleClass(apf.xmldb.getHtmlNode(g,this),"checked",["partial"]);this.dispatchEvent("aftercheck",{list:this.$checkedList,xmlNode:g});};this.uncheck=function(b,c){if(c&&this.disabled||this.$checkedList.indexOf(b)==-1){return;}if(c&&this.$executeSingleValue("check","checked",b,"false")!==false){return;}if(this.$isTreeArch){return this.checkList([b],true,true);}if(this.dispatchEvent("beforeuncheck",{xmlNode:b})===false){return false;}this.$checkedList.remove(b);this.$setStyleClass(apf.xmldb.getHtmlNode(b,this),"",["checked","partial"]);this.dispatchEvent("afteruncheck",{list:this.$checkedList,xmlNode:b});};this.checkToggle=function(b,d){if(d&&this.disabled){return;}if(b.style){var c=b,g=c.getAttribute(apf.xmldb.htmlIdTag);while(!g&&c.parentNode){g=(c=c.parentNode).getAttribute(apf.xmldb.htmlIdTag);}b=apf.xmldb.getNode(c);}if(this.$checkedList.indexOf(b)>-1){this.uncheck(b,d);}else{this.check(b,d);}};this.checkList=function(b,d,r,k,s){if(!b.indexOf){b=apf.getArrayFromNodelist(b);}if(s){if(this.disabled){return;}var q=[];for(var o,g=0;g<b.length;g++){o=this.$executeSingleValue("check","checked",b[g],d?"false":"true",true);if(o===false){break;}q.push(o);}if(q.length){return this.$executeAction("multicall",q,"checked",b[0],null,null,b.length>1?b:null);}}if(s&&this.disabled){return;}if(!k&&this.dispatchEvent("beforecheck",{list:b})===false){return false;}if(!d&&!r){this.clearChecked(true);}if(!this.multicheck){b=[b[0]];}var g;if(d){for(g=b.length-1;g>=0;g--){this.$checkedList.remove(b[g]);this.$setStyleClass(apf.xmldb.getHtmlNode(b[g],this),"",["checked"]);}}else{for(g=b.length-1;g>=0;g--){this.$checkedList.push(b[g]);this.$setStyleClass(apf.xmldb.getHtmlNode(b[g],this),"checked");}}if(!k&&this.$isTreeArch){var n=this;function m(D,c){var t=n.getTraverseNodes(D);if(!t.length){if(c){if(d){n.$checkedList.remove(D);n.$setStyleClass(apf.xmldb.getHtmlNode(D,n),"",["checked"]);return 0;}else{if(n.$checkedList.indexOf(D)==-1){n.$checkedList.push(D);n.$setStyleClass(apf.xmldb.getHtmlNode(D,n),"checked");}return 1;}}return n.$checkedList.indexOf(D)>-1?1:0;}var w=n.$checkedList.indexOf(D)!=-1,u=c||b.indexOf(D)>-1&&(d?!w:w),C=true,B=true,A=false,x;for(var y=t.length-1;y>=0;y--){x=m(t[y],u);if(x){B=false;if(!A&&x==2){A=true;}}else{C=false;}if(!C&&!B){A=true;}}if(D==n.xmlRoot){return;}if(C){if(!w){n.$checkedList.push(D);apf.setStyleClass(apf.xmldb.getHtmlNode(D,n),"checked",["partial"]);}}else{if(w){n.$checkedList.remove(D);}apf.setStyleClass(apf.xmldb.getHtmlNode(D,n),A?"partial":"",["partial","checked"]);}return C?1:(B?0:2);}m(this.xmlRoot);}if(!k){this.dispatchEvent("aftercheck",{list:b});}};this.clearChecked=function(c){if(!c&&this.dispatchEvent("beforeuncheck",{xmlNode:this.$checkedList})===false){return false;}for(var b=this.$checkedList.length-1;b>=0;b--){this.$setStyleClass(apf.xmldb.getHtmlNode(this.$checkedList[b],this),"",["checked"]);}this.$checkedList.length=0;if(!c){this.dispatchEvent("afteruncheck",{list:this.$checkedList});}};this.isChecked=function(b){return this.$checkedList.indexOf(b)>-1;};this.getChecked=function(b){var c,d;if(b){d=this.xmlRoot?this.xmlRoot.ownerDocument.createDocumentFragment():apf.getXmlDom().createDocumentFragment();for(c=0;c<this.$checkedList.length;c++){apf.xmldb.cleanNode(d.appendChild(this.$checkedList[c].cloneNode(true)));}}else{for(d=[],c=0;c<this.$checkedList.length;c++){d.push(this.$checkedList[c]);}}return d;};this.checkAll=function(c){if(!this.multicheck||c&&this.disabled||!this.xmlRoot){return;}var b=this.$isTreeArch?this.xmlRoot.selectNodes(".//"+this.each.split("|").join("|.//")):this.getTraverseNodes();this.checkList(b);};this.addEventListener("beforeload",function(){if(!this.$hasBindRule("checked")){this.clearChecked(true);}});this.addEventListener("afterload",function(){if(!this.$hasBindRule("checked")&&this.$checkedList.length){this.checkList(this.$checkedList,false,true,false);}});this.addEventListener("xmlupdate",function(d){if(d.action=="synchronize"||d.action=="update"){var c=apf.isTrue(this.$applyBindRule("checked",d.xmlNode));var b=this.isChecked(d.xmlNode);if(c!=b){if(c){this.check(d.xmlNode);}else{this.uncheck(d.xmlNode);}}}});this.addEventListener("aftercheck",function(){if(this.checklength!=this.$checkedList.length){this.setProperty("checklength",this.$checkedList.length);}});this.addEventListener("afteruncheck",function(){if(this.checklength!=this.$checkedList.length){this.setProperty("checklength",this.$checkedList.length);}});};apf.Teleport=function(){this.$init(true);};apf.__TELEPORT__=1<<28;(function(){this.$parsePrio="002";this.$regbase=this.$regbase|apf.__TELEPORT__;this.$booleanProperties.autoroute=true;this.$supportedProperties.push("url","timeout","protocol","route-server","autoroute");this.$propHandlers.url=function(c){var b=new apf.url(c);if(!b.protocol){return apf.console.error(apf.formatErrorString(0,this,"Communication (Teleport) initialization error","Invalid server url provided: '"+c+"'"));}this.$host=b.host;this.$rootPath=b.path;this.$server=c.replace(new RegExp(this.$rootPath+"$"),"");};this.$propHandlers.timeout=function(b){this.timeout=parseInt(b)||10000;};this.$propHandlers.protocol=function(c){var b=c.toLowerCase();if(!apf[b]){throw new Error(apf.formatErrorString(1025,null,"Teleport baseclass","Could not find Ajax.org Teleport RPC Component '"+b+"'",this));}this.implement(apf[b]);};this.toString=function(){return"[Ajax.org Teleport Component : "+(this.name||"")+" ("+this.type+")]";};this.addEventListener("DOMNodeInsertedIntoDocument",function(){var b;if(this.type&&this.type=="socket"){if(!apf.socket){b="Socket";}else{this.implement(apf.socket);}}else{if(!apf.http){b="HTTP";}else{this.implement(apf.http);}}if(b){throw new Error(apf.formatErrorString(1024,null,"Teleport baseclass","Could not find Ajax.org Teleport "+b+" Component",this.$aml));}if(this.id){apf.$asyncObjects[this.id]=1;}});}).call(apf.Teleport.prototype=new apf.AmlElement());apf.Init.run("teleport");apf.__TRANSACTION__=1<<3;apf.Transaction=function(){this.$regbase=this.$regbase|apf.__TRANSACTION__;this.$addParent=this.$transactionNode=this.$transactionSubject=this.$originalNode=this.$inTransaction=this.$lastAction=null;this.$supportedProperties.push("autoshow");this.$booleanProperties.autoshow=true;this.commit=function(d){if(!this.$inTransaction){return false;}if(!this.$validgroup&&this.validgroup){this.$validgroup=self[this.validgroup];}if(this.$validgroup&&!this.$validgroup.isValid()){return false;}var c=true;if(!this.$at.undolength){if(d){return false;}this.$at.purge();this.$inTransaction=false;this.load(this.$originalNode);this.$helperModel.reset();c=false;}else{this.$at.reset();this.$inTransaction=false;this.$transactionNode.removeAttribute(apf.xmldb.xmlListenTag);if(this.$lastAction=="add"){if(this.$transactionSubject.$executeAction("appendChild",[this.$addParent,this.$transactionNode],"add",this.$transactionNode)&&this.$transactionSubject.hasFeature(apf.__MULTISELECT__)){this.$transactionSubject.select(this.$transactionNode);}this.$transactionSubject=null;}else{var b=this.$at;this.$at=this.dataParent?this.dataParent.parent.getActionTracker():null;this.$transactionSubject.$executeAction("replaceNode",[this.$originalNode,this.$transactionNode],"update",this.$transactionNode);this.$at=b;}}this.$transactionNode=null;this.$addParent=null;this.$originalNode=null;if(this.autoshow){if(this.autoshow==-1){this.autoshow=true;}else{this.hide();}}return c;};this.rollback=function(b){if(!this.$inTransaction){return;}if(this.$at){if(this.rpcMode=="realtime"){this.$at.undo(-1);}this.$at.reset();}this.$transactionNode=null;this.$addParent=null;if(!b){this.load(this.$originalNode);}this.$helperModel.reset();this.$stopAction(this.$lastAction,true);this.$originalNode=null;this.$inTransaction=false;if(this.autoshow){if(this.autoshow==-1){this.autoshow=true;}else{this.hide();}}};this.begin=function(d,t,k,s){if(this.$inTransaction){if(this.autoshow){this.autoshow=-1;}this.rollback();}var q=this;this.$lastAction=d;if(!this.$lastAction){this.$lastAction=this.xmlRoot&&"update"||"add";}if(s){this.$setDynamicProperty("model","["+s.id+".selected]");}if(t&&this.$lastAction=="update"){this.xmlRoot=t;}if(!this.$at){this.$at=new apf.actiontracker();var o=function(x){q.setProperty(x.prop,x.value);};this.$at.addEventListener("prop.undolength",o);this.setProperty("undolength",0);this.$at.addEventListener("prop.redolength",o);this.setProperty("redolength",0);}if(!this.$helperModel){this.$helperModel=new apf.model();this.$helperModel["save-original"]=true;this.$helperModel.load("<data />");}this.$transactionNode=null;this.$addParent=null;this.$originalNode=this.xmlRoot;this.$inTransaction=true;function c(){this.$inTransaction=-1;this.$helperModel.data.appendChild(this.$transactionNode);this.load(this.$helperModel.data.firstChild);this.$inTransaction=true;if(this.disabled){this.enable();}if(this.autoshow){if(this.autoshow==-1){this.autoshow=true;}else{this.show();}}}s=this.dataParent&&this.dataParent.parent;if(!s||!s.$actions||!s.$actions[this.$lastAction]){s=this;}if(this.$lastAction=="add"){var r,b=s.$actions;if(b){if(t&&t.nodeType){r=b.getRule("add",t);}else{if(typeof t=="string"){if(t.trim().charAt(0)=="<"){t=apf.getXml(t);r=b.getRule("add",t);}else{var w=b.$rules.add;for(var m=0,g=w.length;m<g;m++){if(w[m].getAttribute("type")==t){t=null;r=w[m];break;}}}}}if(!r){r=(s.$actions.add||{})[0];}}else{r=null;}var n=this.$isTreeArch?this.selected||this.xmlRoot:this.xmlRoot;var u=function(A,B,x){if(B!=apf.SUCCESS){var C;C=new Error(apf.formatErrorString(1032,s,"Loading xml data","Could not add data for control "+s.name+"["+s.tagName+"] \nUrl: "+x.url+"\nInfo: "+x.message+"\n\n"+t));if(x.tpModule.retryTimeout(x,B,s,C)===true){return true;}throw C;}if(typeof A!="object"){A=apf.getXmlDom(A).documentElement;}if(A.getAttribute(apf.xmldb.xmlIdTag)){A.setAttribute(apf.xmldb.xmlIdTag,"");}if(!s.$startAction("add",A,q.rollback)){return false;}var y=(s.$actions&&s.$actions.getRule("add",s.$isTreeArch?s.selected:s.xmlRoot)||{})[2];if(k){q.$addParent=k;}else{if(y&&y.getAttribute("parent")){q.$addParent=s.xmlRoot.selectSingleNode(y.getAttribute("parent"));}else{q.$addParent=s.$isTreeArch?s.selected||s.xmlRoot:s.xmlRoot;}}if(!q.$addParent){q.$addParent=s.xmlRoot||s.getModel(true).data;}if(apf.isWebkit&&q.$addParent.ownerDocument!=A.ownerDocument){A=q.$addParent.ownerDocument.importNode(A,true);}q.$transactionNode=A;q.$transactionSubject=s;c.call(q);};if(t){return u(t,apf.SUCCESS);}else{if(r&&r.get){return apf.getData(r.get,{xmlNode:n,callback:u});}else{}}}else{if(!s.$startAction(this.$lastAction,this.xmlRoot,this.rollback)){return false;}this.$transactionSubject=s;this.$transactionNode=this.$originalNode.cloneNode(true);c.call(this);}};this.$canLoadData=function(){return true;};this.addEventListener("prop.model",function(b){return false;});this.clear=function(){this.documentId=this.xmlRoot=this.cacheId=null;};this.addEventListener("beforeload",function(c){var b=c.xmlNode;if(this.$inTransaction==-1){return;}if(this.$inTransaction){if(this.$transactionNode&&b!=this.$transactionNode){if(this.autoshow){this.autoshow=-1;}this.rollback(true);}else{return;}}if(this.autoshow){this.autoshow=-1;}if(this.begin("update",b)!==false){return false;}});};apf.GuiElement.propHandlers.transaction=function(c){if(!(this.transaction=apf.isTrue(c))){return;}if(!this.hasFeature(apf.__DATABINDING__)){this.implement(apf.StandardBinding);}if(!this.hasFeature(apf.__DATAACTION__)){this.implement(apf.DataAction);if(this.actions){this.$propHandlers.actions.call(this,this.actions,"actions");}}if(!this.hasFeature(apf.__TRANSACTION__)){this.implement(apf.Transaction);if(!this.validgroup){this.$validgroup=new apf.ValidationGroup();this.$validgroup.register(this);}if(!this.id){this.setProperty("id",this.localName+"_"+this.$uniqueId);}var b=this.attributes.getNamedItem("model");if(!b){this.attributes.push(b=new apf.AmlAttr(this,"model",null));}b.inheritedValue="{"+this.id+".root}";if(typeof this.autoshow=="undefined"&&(this.localName=="modalwindow"||this.localName=="window")){this.autoshow=true;}}};apf.__VIRTUALVIEWPORT__=1<<19;apf.VirtualViewport=function(){this.$init(true);this.$regbase=this.$regbase|apf.__VIRTUALVIEWPORT__;this.virtualVTimer=null;this._xmlUpdate=this.$xmlUpdate;apf.setStyleClass(this.$ext,"virtual");this.$deInitNode=function(k,m){this.viewport.redraw();};this.$moveNode=function(k,m){this.viewport.redraw();};this.emptyNode=apf.xmldb.getXml("<empty />");this.$addEmpty=this.$add;this.$add=function(n,m,o,r,k){var q=this.$pHtmlDoc.getElementById(m);if(!q){return;}this.$updateNode(n,q);};this.$fill=function(){};this.addEventListener("$load",function(){if(!this.viewport.limit){this.viewport.limit=1;}});this.clear=function(m,k){if(this.clearSelection){this.clearSelection(!k);}this.documentId=this.xmlRoot=this.cacheId=null;if(!m){this.viewport.offset=0;this.viewport.length=0;this.viewport.resize(0);this.viewport.sb.update();this.$setClearMessage(this["empty-message"]);}else{if(this.$removeClearMessage){this.$removeClearMessage();}}this.viewport.cache=null;};var b=this;this.viewport={offset:0,limit:2,length:0,sb:new apf.scrollbar(),host:this,cache:null,inited:false,draw:function(){this.inited=true;var k=this.limit;this.limit=0;this.resize(k,true);},redraw:function(){this.change(this.offset);},prepare:function(){if(!this.inited){this.draw();}var m=b.getTraverseNodes();if(!m){return;}var q=apf.xmldb.getXmlDocId(b.xmlRoot),r=b.$container.childNodes;for(var n=0,o=0,k=r.length;o<k;o++){if(r[o].nodeType!=1){continue;}r[o].style.display=(n>=m.length)?"none":"block";apf.xmldb.nodeConnect(q,m[n],r[o],b);n++;}},resize:function(k,o){this.cache=null;var n;if(k<this.limit){var m=b.$container.childNodes;for(n=m.length-1;n>=0;n--){if(m[n].nodeType!=1){continue;}b.$container.removeChild(m[n]);if(--this.limit==k){break;}}}else{if(k>this.limit){for(n=this.limit;n<k;n++){b.$addEmpty(b.emptyNode,"",b.xmlRoot,b.$container);}}else{return;}}this.limit=k;if(o){this.sb.update(this.$container);}},findNewLimit:function(s){var r=b.$container;if(!s){s=r.scrollTop;}if(!b.xmlRoot||r.lastChild&&r.lastChild.style.display=="none"){return;}if(!r.lastChild||r.lastChild.offsetTop+r.lastChild.offsetHeight<=r.offsetHeight+s){var m,n,k,q=b.$getSelection();while(this.limit<this.length-1&&(!r.lastChild||r.lastChild.offsetTop+r.lastChild.offsetHeight<=r.offsetHeight+s)){this.limit++;k=b.getTraverseNodes();if(k.length<this.limit){this.limit=k.length;break;}n=k[k.length-1];m=apf.xmldb.nodeConnect(b.documentId,n,null,b);b.$addEmpty(n,m,b.xmlRoot,r);if(q.indexOf(n)>-1){b.$select(r.lastChild);}else{b.$deselect(r.lastChild);}}}else{if(r.lastChild&&r.lastChild.offsetTop>r.offsetHeight+s){var o;while(this.limit>2&&(o=r.lastChild).offsetTop>r.offsetHeight+s){b.$container.removeChild(o);this.limit--;}}}if(!this.initialLimit){this.initialLimit=this.limit;}},change:function(q,G,x,o){var k;if(q<0){q=0;}if(q>this.length-this.limit-1){k=Math.floor(this.length-this.limit-1);}else{k=Math.floor(q);}if(!G){G=this.limit;}this.cache=null;var t=k-this.offset,E=this.limit;if(t*t>=this.limit*this.limit){t=false;}this.offset=k;if(t>0){var r=b.$container.lastChild;if(r.nodeType!=1){r=r.previousSibling;}}if(x){this.sb.$curValue=this.offset/(this.length-this.limit-1);this.sb.updatePos();}var w=b.getTraverseNodes();if(!w){return;}if(w.length<this.limit){if(q>0){alert("shouldnt get here");}else{this.resize(w.length);}}var B=apf.xmldb.getXmlDocId(b.xmlRoot),u=b.$container.childNodes,n,s,y,A,F,C,D;if(t>0){y=E-t;F=u.length,A=b.$getSelection();for(C=0,D=0;C<t&&D<F;D++){s=b.$container.firstChild;if(s.nodeType==1){C++;n=w[y++];if(n){apf.xmldb.nodeConnect(B,n,s,b);b.$updateNode(n,s);if(A.indexOf(n)>-1){b.$select(s);}else{b.$deselect(s);}s.style.display="block";}else{s.style.display="none";}}b.$container.appendChild(s);}}else{if(t<0){t=t*-1;y=0;A=b.$getSelection();for(C=0,D=u.length-1;C<t&&D>=0;D++){s=b.$container.lastChild;if(s.nodeType==1){C++;n=w[y++];apf.xmldb.nodeConnect(B,n,s,b);b.$updateNode(n,s);if(A.indexOf(n)>-1){b.$select(s);}else{b.$deselect(s);}s.style.display="block";}b.$container.insertBefore(s,b.$container.firstChild);}}else{if(t===false){F=u.length;A=b.$getSelection();for(C=0,D=0;D<F;D++){s=u[D];if(s.nodeType==1){n=w[C++];apf.xmldb.nodeConnect(B,n,s,b);b.$updateNode(n,s);if(A.indexOf(n)>-1){b.$select(s);}else{b.$deselect(s);}}}}}}if(!o){if(q>=this.length-this.initialLimit){t=q-(this.length-this.initialLimit)+2;b.$container.scrollTop=(b.$container.scrollHeight-b.$container.offsetHeight)*(t/2);}else{var m=(q%1)*b.$container.firstChild.offsetHeight;this.findNewLimit(m);b.$container.scrollTop=m;}if(x){this.sb.update();}return;}}};this.viewport.sb.parentNode=new apf.Class().$init();this.viewport.sb.parentNode.$container=this.$pHtmlNode;this.viewport.sb.dispatchEvent("DOMNodeInsertedIntoDocument");this.viewport.sb.attach(this.$container,this.viewport,function(n,o){var m=b.viewport;if(m.sb.realtime||!n){var k=m.length-m.initialLimit;if(k==0){b.$container.scrollTop=o*(b.$container.scrollHeight-b.$container.offsetHeight);}else{m.change(k*o,m.limit,false);}}else{clearTimeout(this.virtualVTimer);this.virtualVTimer=$setTimeout(function(){m.change(Math.round((m.length-m.initialLimit)*o),m.limit,false);},300);}});apf.layout.setRules(this.$container,"scrollbar","        var s = apf.all["+this.viewport.sb.$uniqueId+"];        s.update();    ",true);apf.layout.queue(this.$container);this.$isInViewport=function(o,q){var m=this.getTraverseNodes();for(var n=0,k=m.length;n<k;n++){if(m[n]==o){return true;}}return false;};this.scrollTo=function(m,n){var k={};this.$isInViewport(m,k);this.viewport.change(k.position+(n?this.viewport.limit-1:0));};this.getFirstTraverseNode=function(k){return this.getTraverseNodes(k)[0];};this.$clearVirtualDataset=function(k){var m=k.childNodes;for(var n=m.length-1;n>=0;n--){k.removeChild(m[n]);}};this.$createVirtualDataset=function(n,o,m){var k=n.selectSingleNode("a_marker")||n.appendChild(n.ownerDocument.createElement("a_marker"));k.setAttribute("start","0");if(o){k.setAttribute("end",o);k.setAttribute("reserved",++this.nodeCount[m]);this.nodeCount[m]+=o;}};this.$xmlUpdate=function(){this.viewport.cache=null;this.viewport.length=this.xmlRoot.selectNodes(this.each).length;this.viewport.sb.update(this.$container);this._xmlUpdate.apply(this,arguments);};this.$load=function(k){apf.xmldb.addNodeListener(k,this);if(!this.renderRoot&&!this.getTraverseNodes(k).length){return this.clear("loading");}if(this.$hasBindRule("load")){this.$createVirtualDataset(k);}this.viewport.cache=null;this.viewport.length=this.xmlRoot.selectNodes(this.each).length+1;this.viewport.prepare();var m=this.$addNodes(k,null,null,this.renderRoot);this.viewport.sb.update(this.$container);if(this.selectable){if(this.autoselect){if(m.length){this.$selectDefault(k);}else{this.setProperty("selected",null);}}else{this.clearSelection(true);var n=this.getFirstTraverseNode();if(n){this.setCaret(n);}this.setProperty("selected",null);this.setProperty("chosen",null);}}if(this.$focussable){apf.window.hasFocus(this)?this.$focus():this.$blur();}};this.$loadSubData=function(){};this.$loadPartialData=function(k,r,m){var q,o=this.$getBindRule("load",xmlRootNode);if(o&&(!o[1]||o[1](xmlRootNode))){this.$setLoadStatus(xmlRootNode,"loading");var n=this.getModel(true);n.$insertFrom(o.getAttribute("get"),{ascending:this.$sort?this.$sort.get().ascending:true,xmlNode:q,documentId:this.documentId,marker:k,start:r,length:m,insertPoint:this.xmlRoot,amlNode:this,callback:function(s){b.setProperty("root",b.xmlRoot);var t=parseInt(apf.queryValue(s,o.getAttribute("total")));if(b.viewport.length!=t){b.viewport.length=t;this.$createVirtualDataset(b.xmlRoot,b.viewport.length,b.documentId);}}});}};function c(k,n,o){for(var m=0;m<k;m++){n.push(b.documentId+"|"+(o+m));}}function d(q,w,k,u){var s,m,o,y=this.viewport.limit,x=[];if(w==-1){m=u.selectNodes(b.each);o=0;s=q[0];}else{if(k<0){c(Math.abs(k),x,parseInt(s.getAttribute("reserved"))+parseInt(s.getAttribute("end"))-parseInt(s.getAttribute("start"))+k);k=0;b.$loadPartialData(s);if(x.length==y){return x;}}m=q[w].selectNodes("following-sibling::"+this.each.split("|").join("following-sibling::"));o=q[w].getAttribute("end");s=q[++w];}do{var t=Math.min(s.getAttribute("start")-o,y);for(var r=k;r<t;r++){x.push(m[r]);}if(x.length==y){break;}var n=parseInt(s.getAttribute("end"))-parseInt(s.getAttribute("start"));c(Math.min(n,y-x.length),x,parseInt(s.getAttribute("reserved")));b.$loadPartialData(s);o=parseInt(s.getAttribute("end"));s=q[++w];k=0;}while(x.length<y&&s);b.viewport.cache=x;return x;}this.getTraverseNodes=function(n){if(!this.xmlRoot){return;}if(this.viewport.cache){return this.viewport.cache;}var r=this.viewport.offset+1,k=r+this.viewport.limit;var q=(n||this.xmlRoot).selectNodes("a_marker");if(!q.length){var o=(n||this.xmlRoot).selectNodes("("+this.each+")[position() >= "+r+" and position() < "+(k)+"]");return this.$sort?this.$sort.apply(o):o;}for(var m=0;m<q.length;m++){if(q[m].getAttribute("end")<r){if(m==q.length-1){return d(q,m,r-q[m].getAttribute("end"),(n||this.xmlRoot));}continue;}if(q[m].getAttribute("start")-k<=0&&r>=q[m].getAttribute("start")){return d(q,m,r-q[m].getAttribute("end"),(n||this.xmlRoot));}else{if(q[m-1]){return d(q,m-1,r-q[m-1].getAttribute("end"),(n||this.xmlRoot));}else{return d(q,-1,r,(n||this.xmlRoot));}}}};var g=this.getNextTraverseSelected;this.getNextTraverseSelected=function(o,k,r){if(!o){o=this.selected;}if(!r){r=1;}var q=g.call(this,o,k,r);if(q&&q!=o){return q;}var m=this.getTraverseNodes(),n=0;while(m[n]&&m[n]!=o){n++;}if(k){n=-1*(m.length-n-1);}this.viewport.change(Math.max(0,this.viewport.offset+n+(k?r:-1*r)),null,true,true);m=this.getTraverseNodes();return m[k?m.length-1:0];};this.caching=false;};apf.__XFORMS__=1<<17;apf.clipboard=new apf.Class().$init();apf.clipboard.store=null;apf.clipboard.empty=true;apf.clipboard.copied=null;apf.clipboard.put=function(b){this.store=b;this.setProperty("empty",b?false:true);};apf.clipboard.clear=function(){this.setProperty("empty",true);};apf.clipboard.get=function(){return this.store;};apf.clipboard.$highlightSelection=function(g,c,k){for(var d=0,b=c.length;d<b;d++){apf.setStyleClass(apf.xmldb.getHtmlNode(c[d],g),(k?"":"cut"),["cut"]);}};apf.clipboard.copySelection=function(c){var b=this.get()||[];this.$highlightSelection(c,b,true);this.put(c.getSelection().map(function(d){return apf.xmldb.getCleanCopy(d);}));this.copied=true;};apf.clipboard.cutSelection=function(c){var b=this.get()||[];this.$highlightSelection(c,b,true);this.put(b=c.getSelection());this.$highlightSelection(c,b);this.copied=false;};apf.clipboard.pasteSelection=function(g,k){var c=this.get();if(!c){return;}if(!k){k=g.selected||g.getFirstTraverseNode();}if(g.hasFeature(apf.__DRAGDROP__)){g.copy(c,k,undefined,!this.copied);}else{if(c[0].parentNode){for(var d=0,b=c.length;d<b;d++){apf.xmldb.moveNode(k,c[d]);}}else{for(var d=0,b=c.length;d<b;d++){apf.xmldb.appendChild(k,c[d]);}}}this.$highlightSelection(g,c,true);g.selectList(c);};apf.window=function(){this.$uniqueId=apf.all.push(this);this.apf=apf;this.toString=function(){return"[apf.window]";};this.getActionTracker=function(){return this.$at;};this.loadCodeFile=function(y){if(self[y]){apf.importClass(self[y],true,this.win);}else{apf.include(y);}};this.show=function(){if(apf.isDeskrun){jdwin.Show();}};this.hide=function(){if(apf.isDeskrun){jdwin.Hide();}else{this.loaded=false;if(this.win){this.win.close();}}};this.focus=function(){if(apf.isDeskrun){jdwin.SetFocus();}else{window.focus();}};this.setIcon=function(y){if(apf.isDeskrun){jdwin.icon=parseInt(y)==y?parseInt(y):y;}};this.setTitle=function(y){this.title=y||"";if(apf.isDeskrun){jdwin.caption=y;}else{document.title=(y||"");}};this.loadAml=function(y){if(y[apf.TAGNAME]=="deskrun"){this.loadDeskRun(y);}};this.vManager=new apf.visibilitymanager();this.zManager=new apf.zmanager();this.$tabList=[];this.$addFocus=function(A,B,y){if(!y){A.addEventListener("DOMNodeInserted",x);A.addEventListener("DOMNodeRemoved",o);if(A.$isWindowContainer>-2){A.addEventListener("focus",w);A.addEventListener("blur",w);A.$focusParent=A;if(A.$isWindowContainer>-1){if(!A.$tabList){A.$tabList=[A];}this.$tabList.push(A);return;}else{A.$tabList=[A];}}}var C=t(A),D=C.$tabList;if(!A.$isWindowContainer){A.$focusParent=C;}else{A.$focusParent2=C;}if(D[B]){D.insertIndex(A,B);}else{D.push(A);}};this.$removeFocus=function(y){if(!y.$focusParent){return;}y.$focusParent.$tabList.remove(y);if(!y.$isWindowContainer){y.removeEventListener("DOMNodeInserted",x);y.removeEventListener("DOMNodeRemoved",o);}if(y.$isWindowContainer>-2){y.removeEventListener("focus",w);y.removeEventListener("blur",w);}};var b;this.$focus=function(A,C,B){var y=this.document.activeElement;if(y==A&&!B){return;}this.$settingFocus=A;if(!C){C={};}C.toElement=A;C.fromElement=y;if(y&&y!=A&&b!=y){b=y;y.blur(true,C);if(b!=y){return false;}}(apf.activeElement=this.document.activeElement=A).focus(true,C);this.$settingFocus=null;apf.dispatchEvent("movefocus",{toElement:A});};this.$blur=function(A){var y=this.document.activeElement;if(y!=A){return false;}y.$focusParent.$lastFocussed=null;apf.activeElement=this.document.activeElement=null;apf.dispatchEvent("movefocus",{fromElement:A});};var n;this.$focusDefault=function(y,B){var A=t(y);this.$focusLast(A,B);};this.$focusRoot=function(y){var A=apf.document.documentElement;if(this.$focusLast(A,y)===false){}};this.$focusLast=function(B,F,A){var y=B.$lastFocussed;if(y&&y.parentNode&&y.$focussable===true&&(A||y.$ext.offsetHeight)){this.$focus(y,F,true);}else{var C,E=B,D;while(E){if(!D&&E.focussable!==false&&E.$focussable===true&&!E.$tabList&&(A||E.$ext&&E.$ext.offsetHeight)&&E.disabled<1){this.$focus(E,F,true);break;}if((C=!D&&E.firstChild||!(D=false)&&E.nextSibling)){E=C;if(E.$isWindowContainer>0){D=true;}}else{if(E==B){if(E.$isWindowContainer){this.$focus(E,F,true);}return;}else{do{E=E.parentNode;}while(E&&!E.nextSibling&&E!=B&&!E.$isWindowContainer);if(E==B){if(E.$isWindowContainer){this.$focus(E,F,true);}return;}if(E){if(E.$isWindowContainer){this.$focus(E,F,true);break;}E=E.nextSibling;}}}}if(!E){this.$focus(apf.document.documentElement);}}};function w(y){if(y.name=="blur"){if(y.srcElement!=this&&this.$blur){this.$blur();}return;}if(y.srcElement!=this&&this.$focus&&(!y||!y.mouse||this.$focussable==apf.KEYBOARD_MOUSE)){this.$focus();}if(y.srcElement==this||y.trackedChild){y.trackedChild=true;return;}this.$lastFocussed=y.srcElement;if(this.localName&&this.localName.indexOf("window")>-1){y.trackedChild=true;}}function t(y){var A=y;do{A=A.parentNode;}while(A&&!A.$isWindowContainer);return A||apf.document.documentElement;}function x(y){if(y&&y.currentTarget!=this){return;}if(this.$isWindowContainer){apf.window.$tabList.pushUnique(this);}else{apf.window.$addFocus(this,this.tabindex,true);}}function o(D){if(D&&(D.currentTarget!=this||D.$doOnlyAdmin)){return;}var C=this.$focusParent.$tabList;var A=this.childNodes;for(var B=0,y=A.length;B<y;B++){C.remove(A[B]);}if(apf.document.activeElement==this){apf.window.moveNext();}if(this.$isWindowContainer){apf.window.$tabList.remove(this);return;}if(!this.$focusParent){return;}C.remove(this);}this.hasFocus=function(y){return this.document.activeElement==y;};this.moveNext=function(J,C,y,I){if(y&&apf.document.activeElement){var B=apf.document.activeElement.$focusParent;if(B.visible&&B.modal){return false;}}var E,A,G,D=C||apf.document.activeElement,F=D?(y&&D.$isWindowContainer&&D.$isWindowContainer!=-1?apf.window:I&&I.innerList?D.$focusParent:D.$focusParent2||D.$focusParent):apf.document.documentElement,H=F.$tabList;if(D&&(y||D!=apf.document.documentElement)){A=(H||[]).indexOf(D);if(A==-1){return;}}else{A=-1;}if(this.document.activeElement&&this.document.activeElement==D&&H.length==1||H.length==0){return false;}E=(J?-1:1);G=A;if(A<0){A=0;}do{G+=E;if(G>=H.length){G=0;}else{if(G<0){G=H.length-1;}}if(A==G&&D){if(H[0].$isWindowContainer){this.$focus(H[0],I);}return false;}D=H[G];}while(!D||D.disabled>0||D==apf.document.activeElement||(y?!D.visible:D.$ext&&!D.$ext.offsetHeight)||D.focussable===false||y&&!D.$tabList.length);if(F==apf.window&&D.$isWindowContainer!=-2){this.$focusLast(D,{mouse:true},y);}else{(I||(I={})).shiftKey=J;this.$focus(D,I);}};this.focusDefault=function(){if(this.moveNext()===false){this.moveNext(null,apf.document.documentElement,true);}};apf.addListener(window,"beforeunload",function(){return apf.dispatchEvent("exit");});apf.addListener(window,"unload",function(){if(!apf){return;}apf.window.isExiting=true;apf.window.destroy();});var g,d="",s="";this.$focusfix=function(){d+="a";clearTimeout(g);$setTimeout("window.focus();");g=$setTimeout(c);};this.$focusfix2=function(){d+="b";clearTimeout(g);g=$setTimeout(c);};this.$blurfix=function(){d+="c";clearTimeout(g);g=$setTimeout(c);};function c(){clearTimeout(g);if(d=="e"||d=="c"||d.charAt(0)=="x"&&!d.match(/eb$/)||d=="ce"||d=="de"){if(s!="blur"){s="blur";apf.window.dispatchEvent("blur");}}else{if(s!="focus"){s="focus";apf.window.dispatchEvent("focus");}}d="";g=null;}apf.addListener(window,"focus",this.$focusevent=function(){if(apf.hasFocusBug){d+="d";clearTimeout(g);g=$setTimeout(c);}else{clearTimeout(u);k.newState="focus";u=$setTimeout(k,10);}});apf.addListener(window,"blur",this.$blurevent=function(){if(!apf){return;}if(apf.hasFocusBug){d+="e";clearTimeout(g);g=$setTimeout(c);}else{clearTimeout(u);k.newState="blur";u=$setTimeout(k,10);}});var u;function k(){clearTimeout(u);var y=k.newState;if(s==y){return;}s=y;apf.dispatchEvent(s);}this.hasFocus=function(){return(s=="focus");};apf.addListener(document,"contextmenu",function(B){if(!B){B=event;}var C,A,y=apf.findHost(B.srcElement||B.target)||apf.document.activeElement||apf.document&&apf.document.documentElement;if(y&&y.localName=="menu"){return false;}if(apf.contextMenuKeyboard){if(y){C=y.selected?apf.getAbsolutePosition(y.$selected):apf.getAbsolutePosition(y.$ext||y.$pHtmlNode);}else{C=[0,0];}A={x:C[0]+10+document.documentElement.scrollLeft,y:C[1]+10+document.documentElement.scrollTop,amlNode:y,htmlEvent:B};}else{if(B.htmlEvent){A=B;}else{A={x:B.clientX+document.documentElement.scrollLeft,y:B.clientY+document.documentElement.scrollTop,htmlEvent:B};}}A.bubbles=true;apf.contextMenuKeyboard=null;if((y||apf).dispatchEvent("contextmenu",A)===false||A.returnValue===false){if(B.preventDefault){B.preventDefault();}return false;}if(apf.config.disableRightClick){if(B.preventDefault){B.preventDefault();}return false;}});apf.addListener(document,"mouseup",function(y){if(!y){y=event;}apf.dispatchEvent("mouseup",{htmlEvent:y});});var m={INPUT:1,TEXTAREA:1,SELECT:1};apf.addListener(document,"mousedown",this.$mousedown=function(C){if(!C){C=event;}var B,y=apf.findHost(C.srcElement||C.target);if(apf.popup.last&&(!y||apf.popup.last!=y.$uniqueId)&&apf.popup.cache[apf.popup.last]&&!apf.isChildOf(apf.popup.cache[apf.popup.last].content,C.srcElement||C.target,true)){apf.popup.forceHide();}if(y===false){y=apf.document.activeElement;}if((!y||((!y.$focussable||y.focussable===false)&&y.canHaveChildren!=2&&!y.$focusParent))&&apf.config.allowBlur){n=null;if(apf.document.activeElement){apf.document.activeElement.blur();}}else{if(y){if((B=apf.document.activeElement&&apf.document.activeElement.$focusParent||n)&&B.visible&&B.modal&&y.$focusParent!=B&&y.$isWindowContainer!=-1){apf.window.$focusLast(B,{mouse:true,ctrlKey:C.ctrlKey});}else{if(!y&&apf.document.activeElement){apf.window.$focusRoot();}else{if(y.$isWindowContainer==-1){if(y.$tabList.length){apf.window.moveNext(null,y.$tabList[0],null,{mouse:true,innerList:true});}else{apf.window.$focus(y);}}else{if((y.disabled==undefined||y.disabled<1)&&y.focussable!==false){if(y.$focussable){apf.window.$focus(y,{mouse:true,ctrlKey:C.ctrlKey});}else{if(y.canHaveChildren==2){if(!apf.config.allowBlur||!apf.document.activeElement||apf.document.activeElement.$focusParent!=y){apf.window.$focusLast(y,{mouse:true,ctrlKey:C.ctrlKey});}}else{if(!apf.config.allowBlur||y!=apf.document.documentElement){apf.window.$focusDefault(y,{mouse:true,ctrlKey:C.ctrlKey});}}}}else{apf.window.$focusDefault(y,{mouse:true,ctrlKey:C.ctrlKey});}}}}if(apf.hasFocusBug){var D=(m[C.srcElement.tagName]||C.srcElement.isContentEditable)&&!C.srcElement.disabled||y.$isTextInput&&y.$isTextInput(C)&&y.disabled<1;if(!y||!D){apf.window.$focusfix();}}else{if(!s){apf.window.$focusevent();}}}}apf.dispatchEvent("mousedown",{htmlEvent:C,amlNode:y||apf.document.documentElement});if(apf.isIE||apf.isIphone){return;}var A=!((!apf.document&&(!apf.isParsingPartial||y)||apf.dragMode)&&!m[C.target.tagName]);if(A&&y){if(!C.target&&C.srcElement){C.target={};}var D=(m[C.target.tagName]||C.target.contentEditable=="true")&&!C.target.disabled||y.$isTextInput&&y.$isTextInput(C)&&y.disabled<1;if(!apf.config.allowSelect&&!D&&y.nodeType!=y.NODE_PROCESSING_INSTRUCTION&&!y.textselect){A=false;}}if(!A&&C.button!=2){if(C.preventDefault){C.preventDefault();}try{if(document.activeElement&&document.activeElement.contentEditable=="true"){document.activeElement.blur();}}catch(C){}}});apf.addListener(document,"selectstart",function(B){if(!B){B=event;}var y=apf.findHost(B.srcElement);var A=!(!apf.document&&(!apf.isParsingPartial||y)||apf.dragMode);if(A){if(!apf.config.allowSelect&&(y&&y.nodeType!=y.NODE_PROCESSING_INSTRUCTION&&!y.textselect)){A=false;}}if(!A){B.returnValue=false;return false;}});apf.addListener(document,"keyup",this.$keyup=function(B){if(!B){B=event;}var A={keyCode:B.keyCode,ctrlKey:B.ctrlKey,shiftKey:B.shiftKey,altKey:B.altkey,htmlEvent:B,bubbles:true};var y=apf.document&&apf.document.activeElement;if((y&&!y.disableKeyboard?y.dispatchEvent("keyup",A):apf.dispatchEvent("keyup",A))===false){apf.preventDefault(B);return false;}});var q=this.$mousewheel=function q(E){if(!E){E=event;}var G=null;if(E.wheelDelta){G=E.wheelDelta/120;if(apf.isOpera){G*=-1;}}else{if(E.detail){G=-E.detail/3;}}if(G!==null){if(apf.isIE){var C=E.srcElement||E.target;while(C&&C.scrollHeight<=C.offsetHeight){C=C.parentNode||C.$parentNode;}if(C&&C.nodeType==9){C=C.documentElement;}if(!C||C.nodeType!=1){return;}if(C&&C.tagName=="BODY"&&"auto|scroll".indexOf(apf.getStyle(C,"overflowY"))==-1){C=document.documentElement;}if(C&&"auto|scroll".indexOf(apf.getStyle(C,"overflowY"))>-1){var y,F=0.35*C.offsetHeight*G;if(G<0){if(C&&C.scrollTop>=(y=C.scrollHeight-C.offsetHeight+apf.getVerBorders(C))+F){C.scrollTop=y;E.returnValue=false;}}else{if(C&&C.scrollTop<=F){C.scrollTop=0;E.returnValue=false;}}}}var D={delta:G,target:E.target||E.srcElement,button:E.button,ctrlKey:E.ctrlKey,shiftKey:E.shiftKey,altKey:E.altKey,bubbles:true,htmlEvent:E};var B=apf.findHost(E.srcElement||E.target);var A=(B||apf).dispatchEvent("mousescroll",D);if(A===false||D.returnValue===false){if(E.preventDefault){E.preventDefault();}E.returnValue=false;}}};if(document.addEventListener){document.addEventListener("DOMMouseScroll",q,false);}window.onmousewheel=document.onmousewheel=q;apf.addListener(document,"keyup",function(A){A=A||event;if(A.ctrlKey&&A.keyCode==9&&apf.document.activeElement){var y=apf.document.activeElement.$focusParent;if(y.modal){if(A.preventDefault){A.preventDefault();}return false;}apf.window.moveNext(A.shiftKey,apf.document.activeElement.$focusParent,true);y=apf.document.activeElement.$focusParent;if(y&&y.bringToFront){y.bringToFront();}if(A.preventDefault){A.preventDefault();}return false;}});apf.addListener(document,"keydown",this.$keydown=function(F){F=F||event;if(F.keyCode==93){apf.contextMenuKeyboard=true;}var C=apf.document.activeElement,I=(F.explicitOriginalTarget||F.srcElement||F.target),D=(m[I.tagName]||I.contentEditable||I.contentEditable=="true")&&!I.disabled||C&&C.$isTextInput&&C.$isTextInput(F)&&C.disabled<1;var B,A=apf.isMac?F.metaKey:F.ctrlKey;if(!D&&apf.config.undokeys&&A){if(F.keyCode==90){B=apf.document.activeElement;while(B&&!B.getActionTracker&&!B.$at){B=B.parentNode;}if(!B){B=apf.window;}(B.$at||B.getActionTracker()).undo();}else{if(F.keyCode==89){B=apf.document.activeElement;while(B&&!B.getActionTracker&&!B.$at){B=B.parentNode;}if(!B){B=apf.window;}(B.$at||B.getActionTracker()).redo();}}}var G={ctrlKey:F.ctrlKey,metaKey:F.metaKey,shiftKey:F.shiftKey,altKey:F.altKey,keyCode:F.keyCode,htmlEvent:F,isTextInput:D,bubbles:true};delete G.currentTarget;var E=C;if((E&&!E.disableKeyboard&&!E.editable?E.dispatchEvent("keydown",G):apf.dispatchEvent("keydown",G))===false){apf.stopEvent(F);if(apf.canDisableKeyCodes){try{F.keyCode=0;}catch(F){}}return false;}else{if((!apf.config.disableTabbing||apf.document.activeElement)&&F.keyCode==9){if(F.ctrlKey&&apf.document.activeElement){var H=apf.document.activeElement.$focusParent;if(H.modal){if(F.preventDefault){F.preventDefault();}return false;}apf.window.moveNext(F.shiftKey,apf.document.activeElement.$focusParent,true);H=apf.document.activeElement.$focusParent;if(H&&H.bringToFront){H.bringToFront();}}else{if(!apf.document.activeElement||apf.document.activeElement.tagName!="menu"){apf.window.moveNext(F.shiftKey);}}if(F.preventDefault){F.preventDefault();}return false;}}var y=apf.isMac?F.metaKey:F.altKey;if(apf.config.disableBackspace&&F.keyCode==8&&!D){if(apf.canDisableKeyCodes){try{F.keyCode=0;}catch(F){}}F.returnValue=false;}if(apf.config.disableF5&&(F.keyCode==116||F.keyCode==117)){if(apf.canDisableKeyCodes){try{F.keyCode=0;}catch(F){}}else{F.preventDefault();F.stopPropagation();}}if(F.keyCode==27){F.returnValue=false;}if(!apf.config.allowSelect&&F.shiftKey&&(F.keyCode>32&&F.keyCode<41)&&!D){F.returnValue=false;}if(F.returnValue===false&&F.preventDefault){F.preventDefault();}return F.returnValue;});apf.document={};this.init=function(y){if(apf.actiontracker){this.$at=new apf.actiontracker();this.$at.name="default";apf.nameserver.register("actiontracker","default",this.$at);}this.$domParser=new apf.DOMParser();this.document=apf.document=this.$domParser.parseFromString(y,"text/xml",{timeout:apf.config.initdelay,callback:function(B){if(apf.parsed!=2){var A=apf.parsed;apf.parsed=2;apf.dispatchEvent("parse",{initial:A});apf.parsed=true;}if(!apf.loaded){if(!apf.document.activeElement&&(!apf.config.allowBlur||apf.document.documentElement&&apf.document.documentElement.editable)){apf.window.focusDefault();}apf.loaded=true;$setTimeout(function(){apf.dispatchEvent("load");apf.addEventListener("$event.load",function(C){C();});});}}});};var r;this.addEventListener("focus",function(y){if(!apf.document.activeElement&&n&&!apf.isIphone){r.focus();}});this.addEventListener("blur",function(y){if(!apf.document.activeElement||apf.isIphone){return;}apf.document.activeElement.blur(true,{srcElement:this});n=apf.document.activeElement.$focusParent;r=apf.document.activeElement;apf.activeElement=apf.document.activeElement=null;});this.getLastActiveElement=function(){return apf.activeElement||r;};this.destroy=function(){this.$at=null;apf.unload(this);apf=this.win=this.window=this.document=null;window.onfocus=window.onerror=window.onunload=window.onbeforeunload=window.onbeforeprint=window.onafterprint=window.onmousewheel=window.onblur=null;document.oncontextmenu=document.onmousedown=document.onmousemove=document.onmouseup=document.onmousewheel=document.onkeyup=document.onkeydown=null;if(document.body){document.body.onmousedown=document.body.onmousemove=document.body.onmouseup=null;document.body.innerHTML="";}};};apf.window.prototype=new apf.Class().$init();apf.window=new apf.window();apf.sanitizeTextbox=function(b){if(!apf.hasFocusBug){return;}b.onfocus=function(){if(apf.window){apf.window.$focusfix2();}};b.onblur=function(){if(apf.window){apf.window.$blurfix();}};};apf.runGecko=function(){if(apf.runNonIe){apf.runNonIe();}HTMLDocument.prototype.selectNodes=XMLDocument.prototype.selectNodes=function(k,g){try{var q=this.evaluate(k,(g||this),this.createNSResolver(this.documentElement),7,null);}catch(o){var r=o.message;if(o.code==o.INVALID_EXPRESSION_ERR){r=r.replace(/the expression/i,"'"+k+"'");}throw new c(o.lineNumber,"XPath error: "+r);}var m=new Array(q.snapshotLength);m.expr=k;for(var n=m.length-1;n>=0;n--){m[n]=q.snapshotItem(n);}return m;};Text.prototype.selectNodes=Attr.prototype.selectNodes=Element.prototype.selectNodes=function(g){return this.ownerDocument.selectNodes(g,this);};HTMLDocument.prototype.selectSingleNode=XMLDocument.prototype.selectSingleNode=function(k,g){try{var n=this.evaluate(k,(g||this),this.createNSResolver(this.documentElement),9,null);}catch(m){var o=m.message;if(m.code==m.INVALID_EXPRESSION_ERR){o=o.replace(/the expression/i,"'"+k+"'");}throw new c(m.lineNumber,"XPath error: "+o);}return n.singleNodeValue;};Text.prototype.selectSingleNode=Attr.prototype.selectSingleNode=Element.prototype.selectSingleNode=function(g){return this.ownerDocument.selectSingleNode(g,this);};var b=new XMLSerializer();var d=document.createElement("div");apf.insertHtmlNodes=function(m,r,k,o){var t,g,q,n;if(m){t=document.createDocumentFragment();for(n=m.length-1;n>=0;n--){q=m[n];t.insertBefore(q,t.firstChild);}}d.innerHTML=typeof o=="string"?o:apf.html_entity_decode(b.serializeToString(t)).replace(/<([^>]+)\/>/g,"<$1></$1>");t=document.createDocumentFragment();for(n=0,g=d.childNodes.length;n<g;n++){q=d.childNodes[0];t.appendChild(q);}if(k){r.insertBefore(t,k);}r.appendChild(t);};apf.insertHtmlNode=function(k,n,g,m){if(n.nodeType!=11&&!n.style){return n.appendChild(k);}if(!m){m=apf.html_entity_decode(k.serialize?k.serialize(true):((k.nodeType==3||k.nodeType==4||k.nodeType==2)?k.nodeValue:b.serializeToString(k)));}d.innerHTML=m.replace(/<([^>]+)\/>/g,"<$1></$1>");if(g){n.insertBefore(d.firstChild,g);}else{n.appendChild(d.firstChild);}return g?g.previousSibling:n.lastChild;};function c(g,k){this.message=k;this.nr=g;}apf.getHtmlLeft=function(g){return(g.offsetLeft+(parseInt(apf.getStyle(g.parentNode,"borderLeftWidth"))||0));};apf.getHtmlRight=function(g){var k;return(((k=g.offsetParent).tagName=="BODY"?apf.getWindowWidth():k.offsetWidth)-g.offsetLeft-g.offsetWidth-(2*(parseInt(apf.getStyle(k,"borderLeftWidth"))||0))-(parseInt(apf.getStyle(k,"borderRightWidth"))||0));};apf.getHtmlTop=function(g){return(g.offsetTop+(parseInt(apf.getStyle(g.parentNode,"borderTopWidth"))||0));};apf.getHtmlBottom=function(g){var k;return(((k=g.offsetParent).tagName=="BODY"?apf.getWindowHeight():k.offsetHeight)-g.offsetTop-g.offsetHeight-(2*(parseInt(apf.getStyle(k,"borderTopWidth"))||0))-(parseInt(apf.getStyle(k,"borderBottomWidth"))||0));};apf.getBorderOffset=function(g){return[-1*(parseInt(apf.getStyle(g,"borderLeftWidth"))||0),-1*(parseInt(apf.getStyle(g,"borderTopWidth"))||0)];};};apf.runIE=function(){var b=false,c=false;apf.getHttpReq=c?function(){if(apf.availHTTP.length){return apf.availHTTP.pop();}return new XMLHttpRequest();}:function(){if(apf.availHTTP.length){return apf.availHTTP.pop();}return new ActiveXObject("microsoft.XMLHTTP");};apf.getXmlDom=c?function(k,d){var g=getDOMParser(k,d);return g;}:function(m,d,k){var g=new ActiveXObject("microsoft.XMLDOM");g.setProperty("SelectionLanguage","XPath");if(k){g.preserveWhiteSpace=true;}if(m){if(apf.cantParseXmlDefinition){m=m.replace(/\] \]/g,"] ]").replace(/^<\?[^>]*\?>/,"");}g.loadXML(m);if(g.parseError!=0&&apf.xmldb&&apf.isJson(m)){try{g=apf.json2Xml(m,d);}catch(n){throw new Error(apf.formatErrorString(1051,null,"JSON to XML conversion error occurred."+n.message,"\nSource Text : "+m.replace(/\t/gi," ")));}}else{if(!d){this.xmlParseError(g);}}}return g;};apf.xmlParseError=function(g){var d=g.parseError;if(d!=0){throw new Error(apf.formatErrorString(1050,null,"XML Parse error on line "+d.line,d.reason+"Source Text:\n"+d.srcText.replace(/\t/gi," ")));}return g;};apf.getStyle=function(d,g){return d.currentStyle[g];};apf.insertHtmlNodes=function(k,n,g,m){var q;if(k){for(q=[],i=0,l=k.length;i<l;i++){q[i]=k[i].xml;}}q=m||apf.html_entity_decode(q.join(""));if(apf.isIE<7){q=q.replace(/style="background-image:([^"]*)"/g,"find='$1' style='background-image:$1'");}try{(g||n).insertAdjacentHTML(g?"beforebegin":"beforeend",q);}catch(o){document.body.insertAdjacentHTML("beforeend","<table><tr>"+q+"</tr></table>");var d=document.body.lastChild.firstChild.firstChild;for(i=d.childNodes.length-1;i>=0;i--){n.appendChild(d.childNodes[apf.hasDynamicItemList?0:i]);}}if(apf.isIE<7){$setTimeout(function(){var t=n.getElementsByTagName("*");for(var w,u=0,r=t.length;u<r;u++){if(w=t[u].getAttribute("find")){t[u].style.backgroundImage=w.trim();}}});}};apf.insertHtmlNode=function(k,m,d,o){if(m.nodeType!=11&&!m.style){return m.appendChild(k);}var g=d||m;if(!o){o=apf.html_entity_decode(k.serialize?k.serialize(true):k.xml||k.outerHTML||k.nodeValue);}try{g.insertAdjacentHTML(d?"beforeBegin":"beforeEnd",o);}catch(n){g.insertAdjacentHTML("afterEnd",o);return g.nextSibling;}if(d){return d.previousSibling;}else{return m.lastChild.nodeType==1?m.lastChild:m.lastChild.previousSibling;}};apf.getHtmlLeft=function(d){return(d.offsetLeft-(apf.isIE>7&&parseInt(d.parentNode.currentStyle.borderLeftWidth)||0));};apf.getHtmlRight=function(d){var g;return(((g=d.offsetParent).tagName=="BODY"?apf.getWindowWidth():g.offsetWidth)-d.offsetLeft-d.offsetWidth-(apf.isIE<8&&parseInt(g.currentStyle.borderLeftWidth)||0)-(parseInt(g.currentStyle.borderRightWidth)||0));};apf.getHtmlTop=function(d){return(d.offsetTop-(apf.isIE>7&&parseInt(d.offsetParent.currentStyle.borderTopWidth)||0));};apf.getHtmlBottom=function(d){var g;return(((g=d.offsetParent).tagName=="BODY"?apf.getWindowHeight():g.offsetHeight)-d.offsetTop-d.offsetHeight-(apf.isIE<8&&parseInt(g.currentStyle.borderTopWidth)||0)-(parseInt(g.currentStyle.borderBottomidth)||0));};apf.getBorderOffset=function(d){return apf.isIE<8&&[0,0]||[parseInt(d.currentStyle.borderLeftWidth)||0,parseInt(d.currentStyle.borderTopWidth)||0];};apf.getOpacity=function(d){return parseInt(((d.currentStyle.filter||"").match(/alpha\(opacity=(\d*)\)/)||[0,0])[1])/100;};apf.setOpacity=function(g,d){g.style.filter=d==1?"":"alpha(opacity="+Math.round(d*100)+")";};apf.popup2={cache:{},setContent:function(n,m,k,g,d){if(!this.popup){this.init();}this.cache[n]={content:m,style:k,width:g,height:d};if(m.parentNode){m.parentNode.removeChild(m);}if(k){apf.importCssString(k,this.popup.document);}return this.popup.document;},removeContent:function(d){this.cache[d]=null;delete this.cache[d];},init:function(){this.popup=window.createPopup();this.popup.document.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">                <html xmlns="http://www.w3.org/1999/xhtml" xmlns:a='+apf.ns.aml+' xmlns:xsl="http://www.w3.org/1999/XSL/Transform">                <head>                    <script>                    var apf = {                        all: [],                        lookup:function(uniqueId){                            return this.all[uniqueId] || {                                $setStyleClass:function(){}                            };                        }                    };                    function destroy(){                        apf.all=null;                    }                    <\/script>                    <style>                    HTML{border:0;overflow:hidden;margin:0}                    BODY{margin:0}                    </style>                </head>                <body onmouseover="if(!self.apf) return;if(this.c){apf.all = this.c.all;this.c.Popup.parentDoc=self;}"></body>                </html>');var d=apf;this.popup.document.body.onmousemove=function(){this.c=d;};},show:function(B,t,s,k,n,g,A,w){if(!this.popup){this.init();}var m=this.cache[B];this.popup.document.body.innerHTML=m.content.outerHTML;if(k){var u,r=7,q=0,d=this.popup;u=setInterval(function(){var o=++q*((A||m.height)/r);d.show(t,s,g||m.width,o,n);d.document.body.firstChild.style.marginTop=(q-r-1)*((A||m.height)/r);if(q>r){clearInterval(u);w(d.document.body.firstChild);}},10);}else{this.popup.show(t,s,g||m.width,A||m.height,n);}this.last=B;},hide:function(){if(this.popup){this.popup.hide();}},forceHide:function(){if(this.last){apf.lookup(this.last).dispatchEvent("popuphide");}},destroy:function(){if(!this.popup){return;}this.popup.document.body.c=null;this.popup.document.body.onmouseover=null;}};apf.importClass(apf.runXpath,true,self);};apf.runNonIe=function(){DocumentFragment.prototype.getElementById=function(o){return this.childNodes.length?this.childNodes[0].ownerDocument.getElementById(o):null;};if(XMLDocument.prototype.__defineGetter__){XMLDocument.prototype.__defineGetter__("xml",function(){return(new XMLSerializer()).serializeToString(this);});XMLDocument.prototype.__defineSetter__("xml",function(){throw new Error(apf.formatErrorString(1042,null,"XML serializer","Invalid assignment on read-only property 'xml'."));});Node.prototype.__defineGetter__("xml",function(){if(this.nodeType==3||this.nodeType==4||this.nodeType==2){return this.nodeValue;}return(new XMLSerializer()).serializeToString(this);});Element.prototype.__defineGetter__("xml",function(){return(new XMLSerializer()).serializeToString(this);});}if(typeof HTMLElement!="undefined"){if(!HTMLElement.prototype.insertAdjacentElement){Text.prototype.insertAdjacentElement=HTMLElement.prototype.insertAdjacentElement=function(o,q){switch(o.toLowerCase()){case"beforebegin":this.parentNode.insertBefore(q,this);break;case"afterbegin":this.insertBefore(q,this.firstChild);break;case"beforeend":this.appendChild(q);break;case"afterend":if(this.nextSibling){this.parentNode.insertBefore(q,this.nextSibling);}else{this.parentNode.appendChild(q);}break;}};}if(!HTMLElement.prototype.insertAdjacentHTML){Text.prototype.insertAdjacentHTML=HTMLElement.prototype.insertAdjacentHTML=function(q,t){var s=this.ownerDocument.createRange();s.setStartBefore(apf.isWebkit?document.body:(self.document?document.body:this));var o=s.createContextualFragment(t);this.insertAdjacentElement(q,o);};}if(!HTMLBodyElement.prototype.insertAdjacentHTML){HTMLBodyElement.prototype.insertAdjacentHTML=HTMLElement.prototype.insertAdjacentHTML;}if(!HTMLElement.prototype.insertAdjacentText){Text.prototype.insertAdjacentText=HTMLElement.prototype.insertAdjacentText=function(q,r){var o=document.createTextNode(r);this.insertAdjacentElement(q,o);};}HTMLElement.prototype.removeNode=function(){if(!this.parentNode){return;}this.parentNode.removeChild(this);};if(HTMLElement.prototype.__defineSetter__){HTMLElement.prototype.__defineSetter__("innerText",function(o){var q=""+o;this.innerHTML=q.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");});HTMLElement.prototype.__defineGetter__("innerText",function(){return this.innerHTML.replace(/<[^>]+>/g,"").replace(/\s\s+/g," ").replace(/^\s+|\s+$/g," ");});HTMLElement.prototype.__defineGetter__("outerHTML",function(){return(new XMLSerializer()).serializeToString(this);});}}var d=false;try{XMLDocument.prototype.async=true;d=true;}catch(m){}Document.prototype.onreadystatechange=null;Document.prototype.parseError=0;Array.prototype.item=function(o){return this[o];};Array.prototype.expr="";XMLDocument.prototype.$clearDOM=function(){while(this.hasChildNodes()){this.removeChild(this.firstChild);}};XMLDocument.prototype.$copyDOM=function(o){this.$clearDOM();if(o.nodeType==9||o.nodeType==11){var r=o.childNodes;for(var q=0;q<r.length;q++){this.appendChild(this.importNode(r[q],true));}}else{if(o.nodeType==1){this.appendChild(this.importNode(o,true));}}};XMLDocument.prototype.loadXML=function(r){apf.xmldb.setReadyState(this,1);var q=this.xml||this.serialize();var o=(new DOMParser()).parseFromString(r,"text/xml");apf.xmldb.setReadyState(this,2);this.$copyDOM(o);apf.xmldb.setReadyState(this,3);apf.xmldb.loadHandler(this);return q;};Node.prototype.getElementById=function(o){};HTMLElement.prototype.replaceNode=Element.prototype.replaceNode=function(o){if(!this.parentNode){return;}this.parentNode.insertBefore(o,this);this.parentNode.removeChild(this);};XMLDocument.prototype.$load=XMLDocument.prototype.load;XMLDocument.prototype.load=function(s){var o=document.implementation.createDocument("","",null);o.$copyDOM(this);this.parseError=0;apf.xmldb.setReadyState(this,1);try{if(this.async==false&&d){var q=new XMLHttpRequest();q.open("GET",s,false);q.overrideMimeType("text/xml");q.send(null);apf.xmldb.setReadyState(this,2);this.$copyDOM(q.responseXML);apf.xmldb.setReadyState(this,3);}else{this.$load(s);}}catch(r){this.parseError=-1;}finally{apf.xmldb.loadHandler(this);}return o;};var b=apf.getStyle=function(o,r){try{return(window.getComputedStyle(o,"")||{})[r]||"";}catch(q){}};HTMLDocument.prototype.setProperty=XMLDocument.prototype.setProperty=function(o,q){};apf.getHttpReq=function(){if(apf.availHTTP.length){return apf.availHTTP.pop();}return new XMLHttpRequest();};apf.getXmlDom=function(s,o,r){var q;if(s){if(r===false){s=s.replace(/>[\s\n\r]*</g,"><");}q=new DOMParser();q=q.parseFromString(s,"text/xml");if(q.getElementsByTagName("parsererror").length&&apf.xmldb&&apf.isJson(s)){try{q=apf.json2Xml(s,o);}catch(t){throw new Error(apf.formatErrorString(1051,null,"JSON to XML conversion error occurred.","\nSource Text : "+s.replace(/\t/gi," ")));}}else{if(!o){this.xmlParseError(q);}}}else{q=document.implementation.createDocument("","",null);}return q;};apf.xmlParseError=function(q){if(q.getElementsByTagName("parsererror").length){var t=q.documentElement.firstChild.nodeValue.split("\n"),r=t[2].match(/\w+ (\d+)/)[1],s=t[0].replace(/\w+ \w+ \w+: (.*)/,"$1"),o=q.documentElement.lastChild.firstChild.nodeValue;throw new Error(apf.formatErrorString(1050,null,"XML Parse Error on line "+r,s+"\nSource Text : "+o.replace(/\t/gi," ")));}return q;};apf.xmldb.setReadyState=function(o,q){o.readyState=q;if(o.onreadystatechange!=null&&typeof o.onreadystatechange=="function"){o.onreadystatechange();}};apf.xmldb.loadHandler=function(o){if(!o.documentElement||o.documentElement.tagName=="parsererror"){o.parseError=-1;}apf.xmldb.setReadyState(o,4);};apf.Init.add(function(){var q,o=document.getElementsByTagName("form");for(q=0;q<o.length;q++){o[q].removeNode();}o=document.getElementsByTagName("xml");for(q=0;q<o.length;q++){o[q].removeNode();}o=null;});if(document.body){document.body.focus=function(){};}if(!document.elementFromPoint){Document.prototype.elementFromPointRemove=function(o){if(!this.RegElements){return;}this.RegElements.remove(o);};Document.prototype.elementFromPointAdd=function(o){if(!this.RegElements){this.RegElements=[];}this.RegElements.push(o);};Document.prototype.elementFromPointReset=function(o){FoundValue=[];FoundNode=null;LastFoundAbs=document.documentElement;};Document.prototype.elementFromPoint=function(C,w){document.elementFromPointReset();if(this.RegElements){var D=-1,r,q,o,B,A,t,s,u;for(D=-1,q,r=0;r<this.RegElements.length;r++){o=this.RegElements[r];if(b(o,"display")=="none"){continue;}B=n(o);A=k(o);t=B+o.offsetWidth;s=A+o.offsetHeight;if(C>B&&C<t&&w>A&&w<s){u=g(o);if(u>D){q=[o,C,w,B,A];D=u;}}}if(q){c(q[0],q[1],q[2],0,FoundValue,q[3],q[4]);if(!FoundNode){FoundNode=q[0];LastFoundAbs=q[0];FoundValue=[D];}}}if(!this.RegElements||!this.RegElements.length){c(document.body,C,w,0,[],n(document.body),k(document.body));}return FoundNode;};function c(G,t,s,u,L,A,w){var M=L,D=u,F=G.childNodes,E,H,r,C,B,K,J,I,o,q;for(E,H=0;H<G.childNodes.length;H++){E=G.childNodes[H];if(E.nodeType==1&&b(E,"display")!="none"&&E.offsetParent){C=A+E.offsetLeft-E.offsetParent.scrollLeft;B=w+E.offsetTop-E.offsetParent.scrollTop;K=C+E.offsetWidth;J=B+E.offsetHeight;I=b(E,"position");I=(I=="absolute")||(I=="relative");o=b(E,"overflow")=="hidden";q=(t>C&&t<K&&s>B&&s<J);if(I&&o&&!q){continue;}u=D;L=M.copy();r=parseInt(b(E,"zIndex"))||0;if(I&&(r||r==0)||o){if(!I){r=0;}if(r>=(FoundValue[u]||0)){if(r>(L[u]||0)){L[u]=r;}u++;if(q&&u>=FoundValue.length){FoundNode=E;FoundValue=L;LastFoundAbs=E;}}else{continue;}}else{if(q&&u>=FoundValue.length){FoundNode=E;FoundValue=L;}}c(E,t,s,u,L,I?C:A,I?B:w);}}}function k(o){return o.offsetTop+parseInt(apf.getStyle(o,"borderTopWidth"))+(o.offsetParent?k(o.offsetParent):0);}function n(o){return o.offsetLeft+parseInt(apf.getStyle(o,"borderLeftWidth"))+(o.offsetParent?n(o.offsetParent):0);}function g(r){var q=0,s,o=r;while(o&&o.nodeType==1){q=Math.max(q,parseInt(b(o,"zIndex"))||-1);o=o.parentNode;}return q;}}apf.getOpacity=function(o){return apf.getStyle(o,"opacity");};apf.setOpacity=function(q,o){q.style.opacity=o;};};apf.runOpera=function(){if(apf.runNonIe){apf.runNonIe();}Document.prototype.selectNodes=XMLDocument.prototype.selectNodes=HTMLDocument.prototype.selectNodes=function(d,c){var m=this.evaluate(d,(c?c:this),this.createNSResolver(this.documentElement),XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var g=new Array(m.snapshotLength);g.expr=d;for(var k=0;k<g.length;k++){g[k]=m.snapshotItem(k);}return g;};Text.prototype.selectNodes=Attr.prototype.selectNodes=Element.prototype.selectNodes=function(c){var d=this.ownerDocument;if(!d.selectSingleNode){d.selectSingleNode=HTMLDocument.prototype.selectSingleNode;d.selectNodes=HTMLDocument.prototype.selectNodes;}if(d.selectNodes){return d.selectNodes(c,this);}else{throw new Error(apf.formatErrorString(1047,null,"XPath Selection","Method selectNodes is only supported by XML Nodes"));}};Document.prototype.selectSingleNode=XMLDocument.prototype.selectSingleNode=HTMLDocument.prototype.selectSingleNode=function(d,c){var g=this.selectNodes(d+"[1]",c?c:null);return g.length>0?g[0]:null;};Text.prototype.selectSingleNode=Attr.prototype.selectSingleNode=Element.prototype.selectSingleNode=function(c){var d=this.ownerDocument;if(!d.selectSingleNode){d.selectSingleNode=HTMLDocument.prototype.selectSingleNode;d.selectNodes=HTMLDocument.prototype.selectNodes;}if(d.selectSingleNode){return d.selectSingleNode(c,this);}else{throw new Error(apf.formatErrorString(1048,null,"XPath Selection","Method selectSingleNode is only supported by XML Nodes. \nInfo : "+e));}};var b=new XMLSerializer();apf.insertHtmlNodes=function(g,o,d,m){var n,q,k,c;if(g){q=document.createDocumentFragment();k=0;c=g.length;for(;k<c;k++){if(!(n=g[k])){continue;}q.appendChild(n);}}(d||o).insertAdjacentHTML(d?"beforebegin":"beforeend",m||apf.html_entity_decode(b.serializeToString(q)).replace(/<([^>]+)\/>/g,"<$1></$1>"));};apf.insertHtmlNode=function(d,k,c,g){if(k.nodeType!=11&&!k.style){return k.appendChild(d);}if(!g){g=apf.html_entity_decode(d.serialize?d.serialize(true):((d.nodeType==3||d.nodeType==4||d.nodeType==2)?d.nodeValue:b.serializeToString(d)));}(c||k).insertAdjacentHTML(c?"beforebegin":"beforeend",g.replace(/<([^>]+)\/>/g,"<$1></$1>"));return c?c.previousSibling:k.lastChild;};apf.getHtmlLeft=function(c){return(c.offsetLeft-(parseInt(apf.getStyle(c.parentNode,"borderLeftWidth"))||0));};apf.getHtmlRight=function(c){var d;return(((d=c.offsetParent).tagName=="BODY"?apf.getWindowWidth():d.offsetWidth)-c.offsetLeft-c.offsetWidth-(parseInt(apf.getStyle(d,"borderRightWidth"))||0));};apf.getHtmlTop=function(c){return(c.offsetTop-(parseInt(apf.getStyle(c.offsetParent,"borderTopWidth"))||0));};apf.getHtmlBottom=function(c){var d;return(((d=c.offsetParent).tagName=="BODY"?apf.getWindowHeight():d.offsetHeight)-c.offsetTop-c.offsetHeight-(parseInt(apf.getStyle(d,"borderBottomWidth"))||0));};apf.getBorderOffset=function(c){return[parseInt(apf.getStyle(c,"borderLeftWidth"))||0,parseInt(apf.getStyle(c,"borderTopWidth"))||0];};};apf.runWebkit=function(){HTMLDocument.prototype.selectNodes=XMLDocument.prototype.selectNodes=function(d,c){if(d.substr(0,2)=="//"){d="."+d;}try{var n=this.evaluate(d,(c||this),this.createNSResolver(this.documentElement),7,null);}catch(m){try{var n=this.evaluate("child::"+d,(c||this),this.createNSResolver(this.documentElement),7,null);}catch(m){throw new Error("XPath error: "+m.message+"\nLine: "+m.lineNumber+"\nExpression: '"+d+"'");}}var g=new Array(n.snapshotLength);g.expr=d;for(var k=g.length-1;k>=0;k--){g[k]=n.snapshotItem(k);}return g;};Text.prototype.selectNodes=Attr.prototype.selectNodes=Element.prototype.selectNodes=function(c){return this.ownerDocument.selectNodes(c,this);};HTMLDocument.prototype.selectSingleNode=XMLDocument.prototype.selectSingleNode=function(d,c){var g=this.selectNodes(d,c||null);return g[0]||null;};Text.prototype.selectSingleNode=Attr.prototype.selectSingleNode=Element.prototype.selectSingleNode=function(c){return this.ownerDocument.selectSingleNode(c,this);};var b=new XMLSerializer();apf.insertHtmlNodes=function(g,o,m,r){var c,q,n,k,d;if(g){q=document.createDocumentFragment();n=[],k=0,d=g.length;for(;k<d;k++){if(!(c=g[k])){continue;}q.appendChild(c);}}(m||o).insertAdjacentHTML(m?"beforebegin":"beforeend",r||apf.html_entity_decode(b.serializeToString(q)).replace(/<([^>]+)\/>/g,"<$1></$1>"));};apf.insertHtmlNode=function(d,k,c,g){if(k.nodeType!=11&&!k.style){return k.appendChild(d);}if(!g){g=apf.html_entity_decode(d.serialize?d.serialize(true):((d.nodeType==3||d.nodeType==4||d.nodeType==2)?d.nodeValue:b.serializeToString(d)));}(c||k).insertAdjacentHTML(c?"beforebegin":"beforeend",g.match(/<(IMG|LINK|META|BR|HR|BASEFONT)[^\/>]*/i)?g.replace(/<([^>]+)\/>/g,"<$1 />"):g.replace(/<([^>]+)\/>/g,"<$1></$1>"));return c?c.previousSibling:k.lastChild;};apf.getHtmlLeft=function(c){return c.offsetLeft;};apf.getHtmlRight=function(c){var d;return(((d=c.offsetParent).tagName=="BODY"?apf.getWindowWidth():d.offsetWidth)-c.offsetLeft-c.offsetWidth-(parseInt(apf.getStyle(d,"borderLeftWidth"))||0)-(parseInt(apf.getStyle(d,"borderRightWidth"))||0));};apf.getHtmlTop=function(c){return c.offsetTop;};apf.getHtmlBottom=function(c){var d;return(((d=c.offsetParent).tagName=="BODY"?apf.getWindowHeight():d.offsetHeight)-c.offsetTop-c.offsetHeight-(parseInt(apf.getStyle(d,"borderTopWidth"))||0)-(parseInt(apf.getStyle(d,"borderBottomWidth"))||0));};apf.getBorderOffset=function(c){return[0,0];};if(apf.runNonIe){apf.runNonIe();}};apf.crypto.Base64=(function(){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function c(r){var m,k,g,w,u,t,s,x,q=0,y=0,o="",n=[];if(!r){return r;}r=apf.crypto.UTF8.encode(r+"");do{m=r.charCodeAt(q++);k=r.charCodeAt(q++);g=r.charCodeAt(q++);x=m<<16|k<<8|g;w=x>>18&63;u=x>>12&63;t=x>>6&63;s=x&63;n[y++]=b.charAt(w)+b.charAt(u)+b.charAt(t)+b.charAt(s);}while(q<r.length);o=n.join("");switch(r.length%3){case 1:o=o.slice(0,-2)+"==";break;case 2:o=o.slice(0,-1)+"=";break;}return o;}function d(q){var m,k,g,u,t,s,r,w,o=0,x=0,n=[];if(!q){return q;}q+="";do{u=b.indexOf(q.charAt(o++));t=b.indexOf(q.charAt(o++));s=b.indexOf(q.charAt(o++));r=b.indexOf(q.charAt(o++));w=u<<18|t<<12|s<<6|r;m=w>>16&255;k=w>>8&255;g=w&255;if(s==64){n[x++]=String.fromCharCode(m);}else{if(r==64){n[x++]=String.fromCharCode(m,k);}else{n[x++]=String.fromCharCode(m,k,g);}}}while(o<q.length);return apf.crypto.UTF8.decode(n.join(""));}return{decode:d,encode:c};})();apf.crypto.UTF8={encode:function(k){k=(k+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var g=[],q=0,c=0,m,d;for(var o=0,b=k.length;o<b;o++){m=k.charCodeAt(o);d=null;if(m<128){c++;}else{if((m>127)&&(m<2048)){d=String.fromCharCode((m>>6)|192)+String.fromCharCode((m&63)|128);}else{d=String.fromCharCode((m>>12)|224)+String.fromCharCode(((m>>6)&63)|128)+String.fromCharCode((m&63)|128);}}if(d!==null){if(c>q){g.push(k.substring(q,c));}g.push(d);q=c=o+1;}}if(c>q){g.push(k.substring(q,k.length));}return g.join("");},decode:function(b){var d=[],k=0,n=0,m=0,g=0,c=0;b+="";while(k<b.length){m=b.charCodeAt(k);if(m<128){d[n++]=String.fromCharCode(m);k++;}else{if((m>191)&&(m<224)){g=b.charCodeAt(k+1);d[n++]=String.fromCharCode(((m&31)<<6)|(g&63));k+=2;}else{g=b.charCodeAt(k+1);c=b.charCodeAt(k+2);d[n++]=String.fromCharCode(((m&15)<<12)|((g&63)<<6)|(c&63));k+=3;}}}return d.join("");}};apf.crypto.MD5={hexcase:0,b64pad:"",chrsz:8,hex_md5:function(b){return this.binl2hex(this.core_md5(this.str2binl(b),b.length*this.chrsz));},b64_md5:function(b){return this.binl2b64(this.core_md5(this.str2binl(b),b.length*this.chrsz));},str_md5:function(b){return this.binl2str(this.core_md5(this.str2binl(b),b.length*this.chrsz));},hex_hmac_md5:function(b,c){return this.binl2hex(this.core_hmac_md5(b,c));},b64_hmac_md5:function(b,c){return this.binl2b64(this.core_hmac_md5(b,c));},str_hmac_md5:function(b,c){return this.binl2str(this.core_hmac_md5(b,c));},core_md5:function(w,q){w[q>>5]|=128<<((q)%32);w[(((q+64)>>>9)<<4)+14]=q;var u=1732584193,t=-271733879,s=-1732584194,r=271733878;for(var m=0;m<w.length;m+=16){var o=u,n=t,k=s,g=r;u=this.md5_ff(u,t,s,r,w[m+0],7,-680876936);r=this.md5_ff(r,u,t,s,w[m+1],12,-389564586);s=this.md5_ff(s,r,u,t,w[m+2],17,606105819);t=this.md5_ff(t,s,r,u,w[m+3],22,-1044525330);u=this.md5_ff(u,t,s,r,w[m+4],7,-176418897);r=this.md5_ff(r,u,t,s,w[m+5],12,1200080426);s=this.md5_ff(s,r,u,t,w[m+6],17,-1473231341);t=this.md5_ff(t,s,r,u,w[m+7],22,-45705983);u=this.md5_ff(u,t,s,r,w[m+8],7,1770035416);r=this.md5_ff(r,u,t,s,w[m+9],12,-1958414417);s=this.md5_ff(s,r,u,t,w[m+10],17,-42063);t=this.md5_ff(t,s,r,u,w[m+11],22,-1990404162);u=this.md5_ff(u,t,s,r,w[m+12],7,1804603682);r=this.md5_ff(r,u,t,s,w[m+13],12,-40341101);s=this.md5_ff(s,r,u,t,w[m+14],17,-1502002290);t=this.md5_ff(t,s,r,u,w[m+15],22,1236535329);u=this.md5_gg(u,t,s,r,w[m+1],5,-165796510);r=this.md5_gg(r,u,t,s,w[m+6],9,-1069501632);s=this.md5_gg(s,r,u,t,w[m+11],14,643717713);t=this.md5_gg(t,s,r,u,w[m+0],20,-373897302);u=this.md5_gg(u,t,s,r,w[m+5],5,-701558691);r=this.md5_gg(r,u,t,s,w[m+10],9,38016083);s=this.md5_gg(s,r,u,t,w[m+15],14,-660478335);t=this.md5_gg(t,s,r,u,w[m+4],20,-405537848);u=this.md5_gg(u,t,s,r,w[m+9],5,568446438);r=this.md5_gg(r,u,t,s,w[m+14],9,-1019803690);s=this.md5_gg(s,r,u,t,w[m+3],14,-187363961);t=this.md5_gg(t,s,r,u,w[m+8],20,1163531501);u=this.md5_gg(u,t,s,r,w[m+13],5,-1444681467);r=this.md5_gg(r,u,t,s,w[m+2],9,-51403784);s=this.md5_gg(s,r,u,t,w[m+7],14,1735328473);t=this.md5_gg(t,s,r,u,w[m+12],20,-1926607734);u=this.md5_hh(u,t,s,r,w[m+5],4,-378558);r=this.md5_hh(r,u,t,s,w[m+8],11,-2022574463);s=this.md5_hh(s,r,u,t,w[m+11],16,1839030562);t=this.md5_hh(t,s,r,u,w[m+14],23,-35309556);u=this.md5_hh(u,t,s,r,w[m+1],4,-1530992060);r=this.md5_hh(r,u,t,s,w[m+4],11,1272893353);s=this.md5_hh(s,r,u,t,w[m+7],16,-155497632);t=this.md5_hh(t,s,r,u,w[m+10],23,-1094730640);u=this.md5_hh(u,t,s,r,w[m+13],4,681279174);r=this.md5_hh(r,u,t,s,w[m+0],11,-358537222);s=this.md5_hh(s,r,u,t,w[m+3],16,-722521979);t=this.md5_hh(t,s,r,u,w[m+6],23,76029189);u=this.md5_hh(u,t,s,r,w[m+9],4,-640364487);r=this.md5_hh(r,u,t,s,w[m+12],11,-421815835);s=this.md5_hh(s,r,u,t,w[m+15],16,530742520);t=this.md5_hh(t,s,r,u,w[m+2],23,-995338651);u=this.md5_ii(u,t,s,r,w[m+0],6,-198630844);r=this.md5_ii(r,u,t,s,w[m+7],10,1126891415);s=this.md5_ii(s,r,u,t,w[m+14],15,-1416354905);t=this.md5_ii(t,s,r,u,w[m+5],21,-57434055);u=this.md5_ii(u,t,s,r,w[m+12],6,1700485571);r=this.md5_ii(r,u,t,s,w[m+3],10,-1894986606);s=this.md5_ii(s,r,u,t,w[m+10],15,-1051523);t=this.md5_ii(t,s,r,u,w[m+1],21,-2054922799);u=this.md5_ii(u,t,s,r,w[m+8],6,1873313359);r=this.md5_ii(r,u,t,s,w[m+15],10,-30611744);s=this.md5_ii(s,r,u,t,w[m+6],15,-1560198380);t=this.md5_ii(t,s,r,u,w[m+13],21,1309151649);u=this.md5_ii(u,t,s,r,w[m+4],6,-145523070);r=this.md5_ii(r,u,t,s,w[m+11],10,-1120210379);s=this.md5_ii(s,r,u,t,w[m+2],15,718787259);t=this.md5_ii(t,s,r,u,w[m+9],21,-343485551);u=this.safe_add(u,o);t=this.safe_add(t,n);s=this.safe_add(s,k);r=this.safe_add(r,g);}return[u,t,s,r];},md5_cmn:function(n,g,d,c,m,k){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(g,n),this.safe_add(c,k)),m),d);},md5_ff:function(m,k,r,q,g,o,n){return this.md5_cmn((k&r)|((~k)&q),m,k,g,o,n);},md5_gg:function(m,k,r,q,g,o,n){return this.md5_cmn((k&q)|(r&(~q)),m,k,g,o,n);},md5_hh:function(m,k,r,q,g,o,n){return this.md5_cmn(k^r^q,m,k,g,o,n);},md5_ii:function(m,k,r,q,g,o,n){return this.md5_cmn(r^(k|(~q)),m,k,g,o,n);},core_hmac_md5:function(d,m){var k=this.str2binl(d),b=Array(16),g=Array(16);if(k.length>16){k=this.core_md5(k,d.length*this.chrsz);}for(var c=0;c<16;c++){b[c]=k[c]^909522486;g[c]=k[c]^1549556828;}return this.core_md5(g.concat(this.core_md5(b.concat(this.str2binl(m)),512+m.length*this.chrsz)),512+128);},safe_add:function(b,g){var d=(b&65535)+(g&65535),c=(b>>16)+(g>>16)+(d>>16);return(c<<16)|(d&65535);},bit_rol:function(b,c){return(b<<c)|(b>>>(32-c));},str2binl:function(g){var d=[],c,b=(1<<this.chrsz)-1;for(c=0;c<g.length*this.chrsz;c+=this.chrsz){d[c>>5]|=(g.charCodeAt(c/this.chrsz)&b)<<(c%32);}return d;},binl2str:function(d){var g=[],c,b=(1<<this.chrsz)-1;for(c=0;c<d.length*32;c+=this.chrsz){g.push(String.fromCharCode((d[c>>5]>>>(c%32))&b));}return g.join("");},binl2hex:function(d){var c=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",g=[],b;for(b=0;b<d.length*4;b++){g.push(c.charAt((d[b>>2]>>((b%4)*8+4))&15)+c.charAt((d[b>>2]>>((b%4)*8))&15));}return g.join("");},binl2b64:function(g){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=[],c;for(c=0;c<g.length*4;c+=3){var k=(((g[c>>2]>>8*(c%4))&255)<<16)|(((g[c+1>>2]>>8*((c+1)%4))&255)<<8)|((g[c+2>>2]>>8*((c+2)%4))&255);for(var b=0;b<4;b++){if(c*8+b*6>g.length*32){m.push(this.b64pad);}else{m.push(d.charAt((k>>6*(3-b))&63));}}}return m.join("");}};(function(c){function b(m,k){var g=(m<<k)|(m>>>(32-k));return g;}function d(n){var m="";var k;var g;for(k=7;k>=0;k--){g=(n>>>(k*4))&15;m+=g.toString(16);}return m;}c.SHA1=function(G){var o,I,H,k=new Array(80),t=1732584193,r=4023233417,q=2562383102,n=271733878,m=3285377520,F,y,x,w,u,J;G=apf.crypto.UTF8.encode(G);var g=G.length,s=[];for(I=0;I<g-3;I+=4){H=G.charCodeAt(I)<<24|G.charCodeAt(I+1)<<16|G.charCodeAt(I+2)<<8|G.charCodeAt(I+3);s.push(H);}switch(g%4){case 0:I=2147483648;break;case 1:I=G.charCodeAt(g-1)<<24|8388608;break;case 2:I=G.charCodeAt(g-2)<<24|G.charCodeAt(g-1)<<16|32768;break;case 3:I=G.charCodeAt(g-3)<<24|G.charCodeAt(g-2)<<16|G.charCodeAt(g-1)<<8|128;break;}s.push(I);while((s.length%16)!=14){s.push(0);}s.push(g>>>29);s.push((g<<3)&4294967295);for(o=0;o<s.length;o+=16){for(I=0;I<16;I++){k[I]=s[o+I];}for(I=16;I<=79;I++){k[I]=b(k[I-3]^k[I-8]^k[I-14]^k[I-16],1);}F=t;y=r;x=q;w=n;u=m;for(I=0;I<=19;I++){J=(b(F,5)+((y&x)|(~y&w))+u+k[I]+1518500249)&4294967295;u=w;w=x;x=b(y,30);y=F;F=J;}for(I=20;I<=39;I++){J=(b(F,5)+(y^x^w)+u+k[I]+1859775393)&4294967295;u=w;w=x;x=b(y,30);y=F;F=J;}for(I=40;I<=59;I++){J=(b(F,5)+((y&x)|(y&w)|(x&w))+u+k[I]+2400959708)&4294967295;u=w;w=x;x=b(y,30);y=F;F=J;}for(I=60;I<=79;I++){J=(b(F,5)+(y^x^w)+u+k[I]+3395469782)&4294967295;u=w;w=x;x=b(y,30);y=F;F=J;}t=(t+F)&4294967295;r=(r+y)&4294967295;q=(q+x)&4294967295;n=(n+w)&4294967295;m=(m+u)&4294967295;}J=d(t)+d(r)+d(q)+d(n)+d(m);return J.toLowerCase();};})(apf.crypto);apf.JsParser=new (function(){var m={'"':4,"'":4,"[":2,"]":3,"{":2,"}":3,"(":2,")":3,"\n":6,"\r\n":6,"//":7,"/*":7,"*/":7,"/":8},c={"}":"{","]":"[",")":"("},d=/(\r?[\n]|\/[\/*]|\*\/|["'{(\[\])}\]\/])|([ \t]+)|([\w\$._])+|(\\?[\w._?,:;!=+-\\\/^&|*"'[\]{}()%$#@~`<>])/g;function k(){return this.t+"["+this.pos+"]";}function s(){return"Ln : "+this.line+", Col : "+this.col;}function q(){return this.type+" "+this.name+(this.def!==undefined?"="+this.def:"");}function b(){return"Marker:"+this.type+"  ["+this.pos+"] "+(this.args?"("+this.args.join(",")+")":"");}function n(){return this.type+" "+this.ret+" "+this.name+(this.args?"("+this.args.join(",")+")":"")+"  ["+this.pos+"]"+(this.doc?(" Doc: "+this.doc):"");}function r(A,x,C,w){for(var B=[],u=0,y=x;y<C;y+=3){B[u++]=(A[y]==2)?r(A[y+2],0,A[y+2].length):A[y+2];if(w&&y<C-3){B[u++]=w;}}return B.join("");}function g(t,u){return JsParser.line(t,u).toString();}var o={"throw":1,"return":1,"(":1,"[":1,",":1,"=":1,":":1};this.parse=function(A){var E=[],C=0,D=[],B=0,y=0,u,F=[],w=[];var x=null;A.replace(d,function(H,J,t,G,I,L){B=J?m[J]:(t?9:(G?5:0));if(!y){switch(B){case 8:if(o[x]||o[E[E.length-1]]){if(E[E.length-3]=="["){y="objRgx";var K=1;}else{y=H;}E[u=E.length]=B,E[++u]=L;C=[H];}else{E[u=E.length]=0;E[++u]=L;E[++u]=H;}break;case 4:case 7:E[u=E.length]=B,E[++u]=L;y=H;C=[H];break;case 2:E[u=E.length]=B;E[++u]=L;D.push(E);E=E[++u]=[0,L,H];break;case 3:if(E[2]!=c[H]){w.push({t:"Error closing "+H+" (opened with: "+E[2]+")",pos:L,toString:k});}else{E[u=E.length]=B;E[++u]=L;E[++u]=H;E=D.pop();}break;case 6:F[F.length]=L;break;case 9:break;default:E[u=E.length]=B;E[++u]=L;E[++u]=H;break;}}else{C[C.length]=H;if(y=="objRgx"){if(H=="["){K++;}else{if(H=="]"){K--;}}if(K==0){y=0;E[++u]=C.join("");}}switch(B){case 4:if(y==H){y=0;E[++u]=C.join("");}break;case 7:if(H=="*/"&&y=="/*"){y=0;E[++u]=C.join("");}else{if(H=="*/"&&y=="/"){y=0;E[++u]=C.join("");}}break;case 8:if(y=="/"){y=0;E[++u]=C.join("");}break;case 6:F[F.length]=L;if(y=="//"){y=0;C.pop();E[++u]=C.join("");}break;}}if(B<9){x=H;}});while(D.length){w.push({t:"Not closed: "+(u=E[2],E=D.pop(),u),pos:g(F,E[E.length-2]),toString:k});}if(y){w.push({t:"Blockmode not closed of "+C[0],pos:g(F,E[E.length-1]),toString:k});}return{tree:E,lines:F,err:w};};this.dump=function(y,w,A){for(var u=0;u<w.length;u+=3){var x=w[u];if(x==2){this.dump(y,w[u+2],A+1);}else{y.push(Array(A).join("----"),x," ",w[u+2],"\n");}}};this.line=function(t,x){for(var w=0,u=t.length;w<u&&t[w]<x;w++){}return{line:w+1,col:x-t[w-1],toString:s};};this.scan=function(A,u,y,C,D,B,x,w){};})();apf.lm=new (function(){var bB={"var":1,"for":1,"while":1,"do":1,"if":1,"else":1,"switch":1,"case":1,"break":1,"continue":1,"default":1,"function":2,"return":1,"try":1,"catch":1,"throw":1,"debugger":1,alert:1,confirm:1,setTimeout:1,setInterval:1,"delete":1,"export":1,"import":1,label:1,foreach:1,each:1,eachrev:1,foreachrev:1,node:1,local:1,yield:1,let:1,"finally":1,"delete":1},aA={"\n":1,"\r\n":1,"==":2,"++":2,"--":2,'"':5,"'":5,"<!--":6,"-->":6,"/*":6,"//":6,"*/":6,"{":7,"}":8,"[":9,"]":10,"(":11,")":12,"<":13,">":14,"+=":2,"-=":2,"/=":2,"*=":2,"!=":2},aS={"{":"}","[":"]","(":")","{{":"}"},aV={ancestor:1,"ancestor-or-self":1,attribute:1,child:1,descendant:1,"descendant-or-self":1,following:1,"following-sibling":1,namespace:1,parent:1,preceding:1,self:1},a4={";":1,",":2,"^":3,"=":4,"+=":4,"-=":4,"/=":4,"*=":4,"/":5,":":6},aU={"~":"_val(_n,","%":"_nod(_n,","*":"_nods(_n,","#":"_cnt(_n,","$":"_lng("},r={"~":"_val(_n,","%":"_xml(_n,","*":"_xmls(_n,","#":"_cnt(_n,","$":"_lng("},bh={"~":"_val(_n,","%":"_val(_n,","*":"_val(_n,","#":"_cnt(_n,","$":"_lng("},bI,G={"~":"_val(_n,","%":"_xml(_n,","*":"_xmls(_n,","#":"_cnt(_n,","$":"_lng("},an={"~":"_val(_n,","%":"_xml(_n,","*":"_xmls(_n,","#":"_cnt(_n,","$":"_lnged("},q={"[":1,"(":1,",":1,"=":1,"return":1,"throw":1},ae={"else":1,"return":1,"delete":1},aE={"do":1,"else":1,"try":1},a9={"=":"_asn(","+=":"_add(","-=":"_sub(","/=":"_div(","*=":"_mul("},aG={"+":1,"%":1,"-":1,"/":1,"=":1,"(":1,"?":1,"|":1,"^":1,"[":1,"&":1,"*":1,"!":1,":":1,"<":1,",":1},aW={"{":1,"} ":1,")":1,")   ":1,";":1,"\n":1,"else":1},P={"{":1,";":1,"\n":1,"else":1},y={"} ":1,")   ":1,"(":1,";":1,"&":1,"^":1,"|":1,",":1,'"':1,"'":1,"=":1,"!=":2,"+=":2,"-=":2,"/=":2,"*=":2,"?":1,"{":1,"}":1,">":1,"[":1,"+":1,":":1,"else":1,"return":1},J={'"':1,"'":1,">":1,"]":1,"}":1},by={'\\"':'"',"\\'":"'","\\{":"{","\\}":"}","\\[":"[","\\]":"]","\\(":"(","\\)":")","\\\\":"\\"},bE={alert:1,confirm:1,setTimeout:1,setInterval:1,"switch":1,call:1,"return":1,"throw":1,"case":1,"catch":1,abs:1,acos:1,asin:1,atan:1,atan2:1,ceil:1,cos:1,exp:1,floor:1,log:1,max:1,min:1,pow:1,random:1,round:1,sin:1,sqrt:1,tan:1,lin:1,linear:1,idx:1,sort:1,"typeof":1},w={" ":1,"\n":1},a7={"{":1,";":1,"(":1,"\n":1},bo={"\\{":"{","\\}":"}","\\[":"[","\\]":"]","\\(":"(","\\)":")"},F={"\\{":"{","\\}":"}","\\[":"[","\\]":"]","\\(":"(","\\)":")","\\\\":"\\\\\\\\","\\":"\\\\","\\<":"<","\\>":">"},aw={lte:"<=",gte:">=",lt:"<",gt:">",and:"&&",or:"||",andbin:"&",orbin:"|",LTE:"<=",GTE:">=",LT:"<",GT:">",AND:"&&",OR:"||",ANDBIN:"&",ORBIN:"|"},S={0:"_val(_n,",1:"_valcr(_n,_cr,",2:"_nod(_n,",3:"_nodcr(_n,_cr,",4:"_nods(_n,",5:"_xpt(_n,",6:"_valst(_n,",7:"_valed(_n,",8:"_valattr(_n,",foreach:"_nods(_n,",each:"_nods(_n,",foreachrev:"_nods(_n,",eachrev:"_nods(_n,",xabs:"_valst(_n,",local:"_nod(_n,",tagName:"_nod(_n,",localName:"_nod(_n,",xml:"_xmlq(",_call:"_val(_n,"},a5={"_val(_n,":"_valm(","_valcr(_n,_cr,":"_valcr(0,_cr,","_nod(_n,":"_nodm(","_nodcr(_n,_cr,":"_nodcr(0,_cr,","_nods(_n,":"_nodsm(","_argwrap(_n,":"_argwrapm(","_xml(_n,":"_xml(0,","_xmls(_n,":"_xmls(0,","_cnt(_n,":"_cntm(","_xpt(_n,":"_xptm(","_valst(_n,":"_valm(","_valed(_n,":"_valed(0,","_lng(":"_lng(","_lnged(":"_lnged("},ah=/(\r?[\n]|\/\*|\*\/|\/\/|\<\!\-\-|\-\-\>|[=\!+\/\*-]=|\+\+|\-\-|["'{(\[\])}\]\<\>]|$)|([ \t]+)|([a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF.$_][\w.$_]*)|(\d[x\d.]*)|(\\?[\w._?,:;!=+-\\\/^&|*"'[\]{}()%$#@~`<>]?)/g,aj=/(^|\|)(?!\@|text\(\)|\.\.|[\w\-\:]+?\:\:)/g,aC={},aH={},aD={},bz=apf.$asyncObjects||{comm:1,rpc:1,http:1,"apf.ajax":1},ar,aJ,bG,aK,n,aP,a3,ap,aq,ag,bk,aL,bJ,bH,W,ai=[],bj,ay=[],az=[],bs,bb,x,bu,bL,K,aF,br,ao,D,bw,aN,ac,aX,am,aM,bg,bq,O;aC["if"]="if(",aH["if"]=")",aC["while"]="while(",aH["while"]=")",aC["for"]="for(",aH["for"]=")",aC["switch"]="switch(",aH["switch"]=")",aC["catch"]="catch(",aH["catch"]=")",aH["function"]=")  ";aC.foreach=aC.each="\nfor(var _t=_t||[],_t=(_t.push(_n,0,(",aH.foreach=aH.each=")||[]),_t);(_n=_t[_t.length-1][_t[_t.length-2]++])||(_t.length-=2,_n=_t.pop(),0);)",aC.foreachrev=aC.eachrev="\nfor(var _t=_t||[],_t=(_t.push(_n,0,(",aH.foreachrev=aH.eachrev=")||[]),_t);(_n=_t[_t.length-1][_t[_t.length-1].length-(_t[_t.length-2]++)-1])||(_t.length-=2,_n=_t.pop(),0);)",aC.local="\nfor(var _t=_t||[],_t=(_t.push(_n,((_n=_local(",aH.local=")),1)),_t);(_t[_t.length-1]--&&_n)||(_t.length--,_n=_t.pop(),0);)",aC._editlm="_valedx(true, ",aC._editnormal="_valedx(false, ",aH.edit=")",aC.xabs="  (  ",aH.xabs="  )  ",aC.localName="_localName(_n",aH.localName=")",aC.output="_o.join(''",aH.output=")",aC.reset="(_o=[],l=0",aH.reset=")",aC.index="apf.getChildNumber.call(apf",aH.index=")",aC.item="(_t[_t.length-1][_t[_t.length-2]-1]",aH.item=")",aC.first="(_t[_t.length-2]==1",aH.first=")",aC.last="(_t[_t.length-2]==_t[_t.length-1].length",aH.last=")",aC.total="(_t[_t.length-1].length",aH.total=")",aC.pos="(_t[_t.length-2]-1",aH.pos=")",aC.tagName="_tagName(_n",aH.tagName=")",aC._nodeValue="_nodeValue(_n",aH._nodeValue=")",aH.async="])",aH.precall="])",aH._call=")";var R={_call:".call(_n",localName:aC.localName,tagName:aC.tagName,nodeValue:aC.nodeValue,index:aC.index},C="(function(){var _o=[],_l=0;\n",N=";return _l==1?_o[0]:_o.join('');})()",B="_async(_n,_c,_a,_w,_f,this,",E="',_a[++_a.i]||[",I="_r=",af,av="_o[_l++]=",bD="",aT="{var _o=[],_l=0,_n=this;\n",a6=";\nreturn _l==1?_o[0]:_o.join('');}",a2="(_a=_a||{}).i=0;try{\n",be="}catch(_e){if(_e.x)return;throw(_e);}\n",a1="(_a=_a||{}).i=0;try{_precall(_w);",bd="}catch(_e){if(_e.x)return;throw(_e);}",bf="with(_w){",bn="}",bA="var _o=[],_l=0;_o[_l++]=",X="var _o=[],_l=0;\n",bK=";\nreturn _ret(_l==1?_o[0]:_o.join(''));",U=";\n_c(_ret(_l==1?_o[0]:_o.join('')),apf.SUCCESS,apf.$lmx);apf.$lmx=null;",al="return _ret(",ax=");",a8="_c(_ret(",bi="),apf.SUCCESS,apf.$lmx);apf.$lmx=null;\n",H="var _r=",u="var _r;",Q=";\nreturn _r;",d=";\n_c(_r,apf.SUCCESS,apf.$lmx);apf.$lmx=null;",c=";\n_c(0,apf.SUCCESS,apf.$lmx);apf.$lmx=null;;",a0="return ",bc="",aR="_c(",aZ=",apf.SUCCESS);",ba="var _f=function(_n,_c,_w,_a){",g="var _f=function(_n,_w){",m="var _f=function(_n){",ab="var _f=function(_n,_c,_w,_cr,_a){",k="var _f=function(_n,_w,_cr,){",ak="var _f=function(_n,_cr){",Y="var _f=function(event,_c,_w,_a,_n){",bl="var _f=function(event,_w,_n){",aa="var _f=function(event,_n){",A="}",T="var _f=function(_m){",M=";\nif(_n=_r){if(!_n.nodeType)_n=_m;",au=";\nif(_n=",aB="){if(!_n.nodeType)_n=_m;",bm="\nreturn ",aQ="\nreturn _ret(",aY=");",b="\nreturn _n;",bv="\nreturn (_r = (",bF="))?(_r.nodeType?_r:_n):(_r===null?null:_n);",bp="var _r, _n = _m;",L=";\n_n = _m;",t="\nreturn _ret(_nodeValue(_n));",aO="\nreturn _n;",bC="\n}";function Z(o){var bt,s;if(ap[bb-1]=="{{"){bt=bb-1;}else{for(s=bj-2,bt=0;s>=0&&ap[bt=(ai[s]&268435455)-1]!="{{";s-=2){}}if(!o&&aq>bt+1){ap[bt]=C+av;}else{ap[bt]=C;}bs=1;}function aI(bT,bN,s,bM,o,bt,bP){var bS,bR,bQ,bO=bN?aA[bN]:(s?0:(bM?3:(o?4:(bT?2:15))));switch(bs){case 0:case 1:switch(bO){case 0:if((D==3&&ao!="$")||D==4){ap[aq++]=" ";}else{if(aU[ao]){D=0;}}break;case 1:aF++,bg=bP;if(ap[aq-1]!="\n"&&!a7[ao]){ap[aq++]="\n";}if(aU[ao]){D=0;}break;case 2:if(bR=a4[bT]){switch(bR){case 1:if(!ai[bj-1]){ap[aq++]=")",bj-=2;}if(!bs){if(ap[aq-1]!="\n"&&ao!="{"&&ao!=";"){ap[aq++]="\n";}}else{if(!bj||ai[bj-1]){ap[aq++]=";";}}break;case 2:if(!ai[bj-1]){ap[aq++]=")",bj-=2;}ap[aq++]=",";break;case 3:if(ap[aq-1]=="\n"||ap[aq-1]==";"||ao=="{"||ao=="} "||aq==bb){if(!bs){Z();}ap[aq++]="  ";}else{ap[aq++]="^";}break;case 4:if(ao!="<"&&ao!=">"){if(!bs&&ap[bb-1]!="("){Z(true);}ap[aq++]=bT;for(bR=aq;bR>=bb&&!bB[ap[bR]]&&!((ap[bR]=="  "||ap[bR]==(br?av:af))&&(ap[bR]="",1));bR--){}if(D==3&&bw>0&&ao.charAt(0)!="."){if(aP){aq-=2;while(w[ap[aq]]){aq--;}bQ=ao;ap[aq++]=a9[bT],ap[aq++]=bQ.slice(0,bw),ap[aq++]=",'",ap[aq++]=bQ.slice(bw+1),ap[aq++]="',",ai[bj++]=bb|(bs<<28),ai[bj++]="";}}}else{ap[aq++]=bT;}break;case 5:if(q[ao]){ai[bj++]=bb|(bs<<28);ai[bj++]=ap[aq++]=bT;bb=x=aq-1;br++,bs=5,bu=bT;}else{ap[aq++]="/";}break;case 6:if(bj>2&&ai[bj-1]=="{{"&&(aq<bb+4&&D==5)||(aq<bb+3&&(D==3||D==4))){ap[bb-1]=ai[bj-1]="{";bs=(bR=ai[bj-2])>>28;ai[bj-2]=bR&268435455,br--;}else{if(ap[aq-3]=="case"||(D==5&&O=="case")){bT=";";}}ap[aq++]=":";break;default:ap[aq++]=bT;break;}}else{ap[aq++]=by[bT]||bT;}break;case 3:case 4:if(bR=aw[bT]){ap[aq++]=bT=bR,bO=2;}else{bR=bS=bQ=0;bw=(O=bT).lastIndexOf(".");if(bT.charAt(0)!="."&&((bR=(bS=((aW[ao]||ap[aq-1]=="\n")&&!aG[ao]))&&!ai[bj-1].indexOf("{")&&aq>bb)||(bQ=bB[bT]))&&!bs){if(bQ==2&&ai[bj-1].indexOf("{")){bQ=0;}Z(bQ);}if(bS&&!ai[bj-1]){ap[aq-1]=="\n"&&(ap[aq-1]=""),ap[aq++]=")",ap[aq++]="\n",bR=1,bj-=2;}if(bR&&bs&&!bB[bT]&&!bE[bT]){ap[aq++]=(br?av:af);}if(bw>0&&bT.charAt(0)!="."){aL[ap[aq++]=ac=bT]=1;}else{ap[aq++]=bT;}}break;case 5:if((bR=(bS=((aW[ao]||ap[aq-1]=="\n")&&!aG[ao]))&&!ai[bj-1].indexOf("{")&&aq>bb)&&!bs){Z();}if(bS&&!ai[bj-1]){ap[aq-1]=="\n"&&(ap[aq-1]=""),ap[aq++]=")",ap[aq++]="\n",bR=1,bj-=2;}if(bR){ap[aq++]=(ap[aq-2]!="\n"&&J[ao])?"+":(br?av:af);}else{if(J[ao]){ap[aq++]="+";}}ai[bj++]=bb|(bs<<28),ai[bj++]=ap[aq++]=bT;bb=x=aq-1,br++,bs=5,bu=bT;break;case 6:if(bT=="*/"||bT=="-->"){throw {t:"Unmatched comment "+bT,p:bP};}aX=bs,am=ao,aM=D,bs=6,bu=bT;break;case 7:if(ap[aq-1]==")  "||(ap[aq-2]==")  "&&aq--)){if(ai[bj-1]!="("&&ai[bj-1]!="["){ai[bj++]=bb|(bs<<28),ai[bj++]="{{",ap[aq++]=aT,bb=aq,bs=1,br++,ap[aq++]="";}else{ai[bj++]=bb,ai[bj++]=ap[aq++]=bT,bb=aq;bs=1;}}else{if((aC[ai[bj+1]]&&ao==")   ")||aE[ao]){ai[bj++]=bb,ai[bj++]=ap[aq++]=bT,bb=aq;ap[aq++]="";}else{if((bR=(bS=((aW[ao]||ap[aq-1]=="\n")&&!aG[ao]))&&!ai[bj-1].indexOf("{")&&aq>bb)&&!bs){Z();}if(bS&&!ai[bj-1]){ap[aq-1]=="\n"&&(ap[aq-1]=""),ap[aq++]=")",ap[aq++]="\n",bR=1,bj-=2;}if(bR){ap[aq++]=(ap[aq-2]!="\n"&&J[ao])?"+''+":(br?av:af);}else{if(J[ao]){ap[aq++]=(ao=="}")?"+''+":"+";}}ai[bj++]=bb|(bs<<28),ai[bj++]=ap[aq++]="{{";if(!br&&bb!=aq){bJ++;}br++,x=bb=aq,bs=0;}}break;case 8:if(!ai[bj-1]){ap[aq++]=")",ap[aq++]="\n",bj-=2;}if(aS[bR=ai[--bj]]!=(ap[aq++]=bT)){throw {t:"Cannot close "+bR+" with "+bT,p:bP};}if(bR=="{{"){if(bb==aq-1){if((ai[bj-1]>>28)<=1){ap[bb-1]="{",ap[aq-1]="}";}else{ap[bb-1]=ap[aq-1]="'";}}else{if(!bs){ap[bb-1]="(",ap[aq-1]=")";}else{if(ap[bb-1]==aT){if(bb==aq-2){ap[bb-1]="{",ap[aq-1]="}";}else{ap[aq-1]=a6;}}else{ap[aq-1]=N;}}}bs=(bR=ai[--bj])>>28,bb=bR&268435455;x=aq,br--;if(!br){bJ++;}if(bs==7){ap[aq++]='+"\\"',bs=4;}}else{bb=ai[--bj];}break;case 9:if(((D==3&&!ae[ao]&&ao!="$")||ao==")"||ao=="]")&&ap[aq-1]!="\n"){ap[aq++]="[",ai[bj++]=bb|(bs<<28),ai[bj++]=bT,x=bb=aq;}else{aN=null;if((bQ=aU[ao])){aq--,ao=ap[aq-1];}else{bQ=S[ai[bj-1]]||S[br?0:aJ];}if((bR=(bS=((aW[ao]||ap[aq-1]=="\n")&&!aG[ao]))&&!ai[bj-1].indexOf("{")&&(aq>bb||ai[bj-1].length==1))&&!bs){Z();}if(bS&&!ai[bj-1]){ap[aq-1]=="\n"&&(ap[aq-1]=""),ap[aq++]=")",ap[aq++]="\n",bR=1,bj-=2;}if(bR){ap[aq++]=(ap[aq-2]!="\n"&&J[ao])?"+":(br?av:af);}else{if(J[ao]){ap[aq++]="+";}}if(!br&&aq!=bb){bJ++;}br++,ai[bj++]=bb|(bs<<28),ai[bj++]=ap[aq++]=bQ,x=bb=aq,ay[bb]=bP,bs=3;}break;case 10:if(!ai[bj-1]){ap[aq++]=")",bj-=2;}if(aS[bR=ai[--bj]]!=(ap[aq++]=bT)){throw {t:"Cannot close "+bR+" with "+bT,p:bP};}bb=ai[--bj]&268435455;break;case 11:if(((bR=(bS=((P[ao]||ap[aq-1]=="\n")&&!aG[ao]))&&!ai[bj-1].indexOf("{")&&aq>bb))&&!bs){Z();}if(bS&&!ai[bj-1]){ap[aq-1]=="\n"&&(ap[aq-1]=""),ap[aq++]=")",ap[aq++]="\n",bR=1,bj-=2;}if(bR&&bs){ap[aq++]=(br?av:af),D=0;}if(bQ=aC[ao]){if(ap[aq-1]==" "){aq--;}ap[aq-1]=bQ,ai[bj++]=bb,ai[bj++]=ao,bb=x=aq;}else{if(D==3){if(bw<0){bR=0;if(ao=="function"||ap[aq-3]=="function"||ap[aq-4]=="function"){ai[bj++]=bb,ai[bj++]="function",ap[aq++]="(",bb=x=aq;if(ao!="function"&&a3&&bj==4){ap[bR=(ap[aq-4]=="function")?(aq-4):(aq-5)]="var "+ao+" = "+a3+"."+ao+" = function";ap[bR+2]="";}}else{if(!bE[ao]&&ap[aq-3]!="new"){ap[aq++]=".call(_n",ai[bj++]=bb,ai[bj++]="_call",bb=x=aq;}else{ai[bj++]=bb,ai[bj++]=ap[aq++]=bT,bb=x=aq;}}}else{if(bw>1&&ar&&(bz[bR=ao.substring(0,bw)]||bz[bR=ao])){if(ap[--aq]==" "){aq--;}ap[aq++]=B,ap[aq++]=bR,ap[aq++]=",'";ap[aq++]=ao.slice(bw+1);ap[aq++]=E,ai[bj++]=bb,ai[bj++]="async",bb=x=aq,ag++;}else{if(ao.indexOf(".")!=bw){aL[ao.slice(0,bw)]=1;}ai[bj++]=bb,ai[bj++]=ap[aq++]=bT,bb=x=aq;}}}else{ai[bj++]=bb,ai[bj++]=ap[aq++]=bT,bb=x=aq;}if(ao==ac){delete aL[ao];}}break;case 12:if(!ai[bj-1]){ap[aq-1]=="\n"&&(ap[aq-1]=""),ap[aq++]=")",ap[aq++]="\n",bR=1,bj-=2;}if(bQ=aH[bR=ai[--bj]]){if(bR!="_call"){bT=")   ";}if((bS=R[bR])&&bS!=ap[aq-1]){ap[bb-1]=bS+",";}ap[aq++]=bQ;}else{if(aS[bR]!=(ap[aq++]=bT)){throw {t:"Cannot close "+bR+" with "+bT,p:bP};}}bb=ai[--bj]&268435455;break;case 13:if(aq==bb||y[ao]||ap[aq-1]=="\n"){if((bR=(bS=((aW[ao]||ap[aq-1]=="\n")&&!aG[ao]))&&!ai[bj-1].indexOf("{")&&aq>bb)&&!bs){Z();}if(bS&&!ai[bj-1]){ap[aq-1]=="\n"&&(ap[aq-1]=""),ap[aq++]=")",ap[aq++]="\n",bR=1,bj-=2;}if(bR){ap[aq++]=(ap[aq-2]!="\n"&&J[ao])?"+''+":(br?av:af);}else{if(J[ao]){ap[aq++]="+";}}bq=null,ap[aq++]='"',ap[aq++]="<",br++,ai[bj++]=bb|(bs<<28),bj+=3,ai[bj-2]=ai[bj-1]=0;x=bb=aq-1,bs=4;}else{ap[aq++]="<";}break;case 14:ap[aq++]=">";break;case 15:if(bj&&!ai[bj-1]){ap[aq-1]=="\n"&&(ap[aq-1]=""),ap[aq++]=")",ap[aq++]="\n",bR=1,bj-=2;}break;}break;case 2:switch(bO){case 1:aF++,bg=bP;if(aq!=bb&&aq!=x){ap[aq++]="\\n";}break;case 2:if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ap[aq++]=F[bT]||bT;break;case 3:if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}if(bT.charAt(bT.length-1)=="$"){ap[aq++]=bT.slice(0,-1);ap[aq++]=bT="$";}else{ap[aq++]=bT;}break;case 5:if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ap[aq++]=(bT=='"')?'\\"':"'";break;case 7:if(aq==x){if(aq!=bb){ap[aq++]="+";}}else{ap[aq++]='"+',br||bJ++;}ai[bj++]=bb|536870912,ai[bj++]=ap[aq++]="{{",br++,x=bb=aq,bs=0;break;case 9:aN=null;if((bQ=r[ao])&&ap[aq-1]==ao){if(--aq-1==bb){aq--;}}else{bQ=S[(br||bb!=aq)?0:aJ];}if(aq!=bb){ap[aq]=(aq++==x)?"+":(br||bJ++,'"+');if(!br){bJ++;}}ai[bj++]=bb|536870912,ai[bj++]=ap[aq++]=bQ,x=bb=aq,br++,bs=3;break;case 15:if(bj){throw {t:"Unclosed "+ai[bj-1]+" found at end in textmode",p:bP};}if(aq!=bb&&aq!=x){ap[aq++]='"',br||bJ++;}break;default:if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ap[aq++]=bT;}break;case 3:switch(bO){case 0:if(aq!=bb){if(aq==x){ap[aq++]='+"';}ap[aq++]=bT;}break;case 1:aF++,bg=bP;break;case 2:if(bT==":"&&ao==":"&&!aV[bQ=ap[aq-2]]&&((bR=ai[bj-2])>>28)!=6){if(ap[aq-2]=='+"'){ap[aq-2]=ap[aq-1]="",aN="#";}else{ap[aq-1]='"';if(x==bb){aN=ap.slice(x+1,aq-1).join("");}else{aN="#";}}if(!(bQ=a5[ap[bb-1]])){throw {t:"Invalid model found for: "+ap[bb-1],p:bP};}ap[bb-1]=bQ,ap[aq++]=",",x=bb=aq;}else{if(bT==","&&(bR=(ai[bj-2]>>28))<=1){aq=bb-1,bS=bL.slice(ay[bb]+1,bP+1);D=9,bs=bR,ap[aq++]=ao="[";ai[bj-2]=(ai[bj-2]&268435455)|(bs<<28),ai[bj-1]=ao,x=bb=aq,br--;if(!br){bH--;}if(bS.length>1){az.push(bL);(bL=bS).replace(ah,aI);bL=az.pop();}}else{if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ap[aq++]=by[bT]||bT;}}break;case 3:if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}if(bT.charAt(bT.length-1)=="$"){ap[aq++]=bT.slice(0,-1);ap[aq++]=bT="$";}else{ap[aq++]=bT;}break;case 5:if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}if(ai[bj-1]=="["){ai[bj-1]=bT;}else{if(ai[bj-1]==bT){ai[bj-1]="[";}}if(bT=='"'){ap[aq++]="\\";}ap[aq++]=bT;break;case 7:if(aq==x){if(aq!=bb){ap[aq++]="+''+";}}else{ap[aq++]='"+';}ai[bj++]=bb|805306368,ai[bj++]=ap[aq++]="{{",br++,x=bb=aq,bs=0;if(aN&&ai[bj-3]!=r["$"]){bk.push(aN,"#");aN=null,W++;}break;case 9:if(ai[bj-1]=="'"||ai[bj-1]=='"'||((D!=3||ao=="$")&&ao!=")"&&ao!="]")){if(aN){bk.push(aN,"#"),W++;}aN=null;if((bQ=r[ao])&&ap[aq-1]==ao){aq--;}else{bQ=S[0];}if(aq==x){if(aq!=bb){ap[aq++]="+";}}else{ap[aq++]='"+';}ai[bj++]=bb|805306368,ai[bj++]=ap[aq++]=bQ,br++,x=bb=aq,bs=3;}else{if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ai[bj++]=bb|1610612736,ai[bj++]=ap[aq++]="[";}break;case 10:bj--,bs=(bQ=ai[--bj])>>28,bQ=bQ&268435455;if(bs==6){if(ai[bj+1]!="["){throw {t:"In xpath, cannot close "+ai[bj+1]+" with "+bT,p:bP};}if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ap[aq++]="]";bs=3;}else{if(aq==bb){if((ai[bj]>>28)<=1){ap[bb-1]="[",ap[aq++]="]";}else{ap[bb-1]=ap[aq++]='"';}x=aq;}else{if(aq!=x){ap[aq++]='"';}if(x==bb){bR=ap.slice(x+1,aq-1).join("");if(n&&ap[bb-1]!=","&&bR!=(bS=bR.replace(aj,"$1self::"))&&ai[bj+1]!=r["$"]){ap[bb+1]=bR=bS;for(bS=bb+2;bS<aq-1;bS++){ap[bS]="";}}}else{if((bS=ap[bb-1])!=","){bR="#";if(n){ap[bb-1]=bS+"_injself(",ap[aq++]=")";}}else{bR="";}}if(ai[bj+1]!=r["$"]&&bR){bk.push(aN,bR);if(aN){W++;}}ap[aq++]=") ",x=aq;if(bs==7){ap[aq++]='+"\\"',bs=4;}}br--,aN=null;if(!br){bJ++,bH++;}}bb=bQ;break;case 11:if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ai[bj++]=bb|805306368,ai[bj++]=ap[aq++]="(";break;case 12:if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}if(aS[bR=ai[--bj]]!=(ap[aq++]=bT)){throw {t:"Cannot close "+bR+" with "+bT,p:bP};}bb=ai[--bj]&268435455;break;case 15:throw {t:"Unexpected end whilst parsing xpath",p:bP};break;default:if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ap[aq++]=bT;break;}break;case 4:switch(bO){case 0:if(aq==x){ap[aq++]='+"';}ap[aq++]=" ",D=0;break;case 1:if(aq==x){ap[aq++]='+"';}aF++,bg=bP,ap[aq++]="\\n",D=1;break;case 2:if(aq==x){ap[aq++]='+"';}if(bT=="/"&&ao=="<"){bj-=4;if(ai[bj]||ai[bj+2]){throw {t:"Unexpected closing tag whilst parsing xml",p:bP};}}else{if(bT==":"&&D==3&&ap[aq-2]=="<"){bq=ao;}}ap[aq++]=F[bT]||bT;break;case 3:if(aq==x){ap[aq++]='+"';}if(bT.charAt(bT.length-1)=="$"){ap[aq++]=bT.slice(0,-1);ap[aq++]=bT="$";}else{ap[aq++]=bT;}break;case 5:if(aq==x){ap[aq++]='+"';}if(bT=='"'){ap[aq++]="\\";}ap[aq++]=bT;break;case 6:if(bT=="//"&&!ai[bj-1]){if(aq==x){ap[aq++]='+"';}ap[aq++]=bT;}else{if(bT=="*/"){throw {t:"Unmatched comment "+bT,p:bP};}aX=bs,am=ao,aM=D,bs=6,bu=bT;}break;case 13:bq=null;if(aq==x){ap[aq++]='+"';}ap[aq++]=bT,ai[bj]=ai[bj+2]=0,bj+=4,ai[bj-1]=0;break;case 14:if(aq==x){ap[aq++]='+"';}ap[aq++]=bT;if(ao!="<"){if(ao=="/"){bj-=4;if(ai[bj+2]){throw {t:"Unexpected / whilst parsing xml",p:bP};}if(ap[aq-3]=="<"){aq-=2,ap[aq-1]="";}}else{bj-=2;}if(ai[bj]){br--,ap[aq++]='"',bb=ai[bj],x=aq,bs=bb>>28,bb=bb&268435455;}else{ai[bj-1]=1;}}else{aq--,ap[aq-1]="";}break;case 9:aN=null;if(ao=="!"&&ap[aq-2]=="<"&&!ai[bj-1]){ap[aq++]=bT,ai[bj++]=bb|(bs<<28);ai[bj++]="]]>",bb=x=aq-1;br++,bs=5;}else{if(ai[bj-1]){if((bR=bI[ao])){aq--;}else{bR=S[bG];}ai[bj++]=bb|1073741824;}else{ai[bj++]=bb|1073741824;if((bR=bh[ao])){aq--;if(ap[aq-1]=="="){ao="=";}}else{bR=S[bq?aK:8];}if(ao=="="){ap[aq++]='\\"',ai[bj-1]=bb|1879048192;}}ap[aq]=(aq++==x)?"+''+":'"+';br++,ai[bj++]=ap[aq++]=bR,x=bb=aq,bs=3;}break;case 7:if(!ai[bj-1]&&ao=="="){ap[aq++]='\\"',ai[bj++]=bb|1879048192;}else{ai[bj++]=bb|1073741824;}ap[aq]=(aq++==x)?"+''+":'"+';ai[bj++]=ap[aq++]="{{",br++;x=bb=aq,bs=0;break;default:if(aq==x){ap[aq++]='+"';}ap[aq++]=bT;break;case 15:throw {t:"Unexpected end whilst parsing xml",p:bP};break;}break;case 5:switch(bO){case 1:aF++,bg=bP;if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ap[aq++]="\\n";break;case 2:if(bT=="/"&&ai[bj-1]=="/"){ap[aq++]="/",bb=ai[bj-=2],x=aq,bs=bb>>28,bb=bb&268435455,br--;}else{if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ap[aq++]=(ai[bj-1]!="/"&&bo[bT])||bT;}break;case 3:if(aq==x){ap[aq]=(aq++==bb)?"":'+"';}if(bT.charAt(bT.length-1)=="$"){ap[aq++]=bT.slice(0,-1);ap[aq++]=bT="$";}else{ap[aq++]=bT;}break;case 5:if(ai[bj-1]==bT){if(bb!=x){ap[aq]=(aq++!=x)?(bT+")"):")";}else{ap[aq++]=bT;}bb=ai[bj-=2],x=aq,bs=bb>>28;bb=bb&268435455,br--;}else{if(aq==x){ap[aq]=(aq++==bb)?'"':'+"';}ap[aq++]=bT=='"'?'\\"':bT;}break;case 6:if(ai[bj-1]=="/"&&bT=="*/"){ap[aq++]="*/",bb=ai[bj-=2],x=aq,bs=bb>>28,bb=bb&268435455,br--;}else{if(aq==x){ap[aq]=(aq++==bb)?"":'+"';}ap[aq++]=bT;}break;case 7:if(ai[bj-1]!="'"&&ai[bj-1]!="/"){if(ai[bj-1]=='"'){ap[bb]='("';}if(aq==x){if(aq!=bb){ap[aq++]="+";}}else{ap[aq++]='"+';}ai[bj++]=bb|1342177280,ap[aq++]=ai[bj++]="{{",br++,x=bb=aq,bs=0;}else{ap[aq++]=bT;}break;case 9:if(ai[bj-1]!="'"&&ai[bj-1]!="/"&&(ai[bj-1]=='"'&&(ap[bb]='("')||aq!=bb+2||ao!="CDATA")){aN=null;if((bQ=r[ao])&&ap[aq-1]==ao){aq--;}else{bQ=S[0];}if(aq!=bb){ap[aq]=(aq++==x)?"+":'"+';}ai[bj++]=bb|1342177280,ai[bj++]=ap[aq++]=bQ,x=bb=aq,br++,bs=3;}else{ap[aq++]=bT;}break;case 14:if(aq==x){ap[aq]=(aq++==bb)?"":'+"';}ap[aq++]=bT;if(ai[bj-1]=="]]>"&&ao=="]"&&ap[aq-3]=="]"){bb=ai[bj-=2],bs=bb>>28;bb=bb&268435455,br--;bj-=4;if(ai[bj]){br--,ap[aq++]='"',bb=ai[bj],x=aq,bs=bb>>28,bb=bb&268435455;}else{ai[bj-1]=1;}}break;case 15:throw {t:"Unexpected end whilst parsing string",p:bP};break;default:if(aq==x){ap[aq]=(aq++==bb)?"":'+"';}ap[aq++]=bT;break;}break;case 6:switch(bO){case 1:aF++,bg=bP;if(bu=="//"){bs=aX,bT=ao=am,bO=D=aM;}break;case 6:if((bu=="/*"&&bT=="*/")||(bu=="<!--"&&bT=="-->")){bs=aX,bT=ao=am,bO=D=aM;}break;case 15:if(bu!="//"){throw {t:"Unexpected end whilst parsing comment",p:bP};}else{bs=aX,bT=ao=am,bO=D=aM;if(bj&&!ai[bj-1]){ap[aq-1]=="\n"&&(ap[aq-1]=""),ap[aq++]=")",ap[aq++]="\n",bR=1,bj-=2;}}break;}break;}if(bO>1){ao=bT,D=bO;}}this.lastCode=function(){if(typeof(ap)=="object"){return ap.join("");}return ap;};function bx(bM,o,s,bt){if(bM.t){throw new Error(apf.formatErrorString(0,null,"Parsing live markup source","Error whilst parsing: "+bM.t+" on line:"+aF+" col:"+(bM.p-o-2)+(s?(" part: "+s):"")+"\n"+bL));}else{throw new Error(apf.formatErrorString(0,null,"Compiling live markup function on line "+bt,"Error whilst compiling: "+bM.message+"\nInput:\n"+bL+"\nGenerated:\n"+apf.lm.lastCode()));}}var ad={},V={};this.resetCache=function(){ad={};};var at=/^\s*~~(c\d+)~~/;this.compile=function(bt,s){if(!s){s=V;}if(bt==null||!bt.length){return(s.nostring||s.event)?function(){return bt;}:{type:2,str:bt};}var bQ,bN,o;if(bt.charAt(0)=="~"&&(bQ=bt.match(at))){if(bQ=apf.lm_exec[bQ[1]]){return bQ;}alert("ERROR, undefined live markup cache marker found:"+bt);return{type:2,str:bt};}var bM=(s.xpathmode|(s.withopt&&16)|(s.precall&&32)|(s.alwayscb&&64)|(s.nostring&&128)|(s.parsecode&&256)|(s.nostate&&512)|(s.liveedit&&1024)|(s.langedit&&2048)|(s.injectself&&4096)|(s.event&&8192)|(s.funcglobal&&16384))+bt;if(bQ=ad[bM]){return bQ;}n=s.injectself,aJ=s.xpathmode||0,aK=s.nostate?0:6,bG=0;a3=s.funcglobal?"self":(s.withopt?"_w":null);ar=!s.event;S.edit=s.liveedit?"_argwrap(_n,":"_argwrap(_n,";aC.edit=s.liveedit?aC._editlm:aC._editnormal;bI=s.langedit?an:G;aL={},bk=[],ai=[],ap=["","","",""],bL=bt,K=bL.length;aq=bb=x=ap.length,bJ=bH=ag=W=br=aF=D=bg=0;if(s.parsecode){bs=0,bj=2,ai[0]=aq,ai[1]="{{",ao="{",af=s.event?"":(aJ<=1?av:I);}else{bs=2,bj=ao=0,af=av;}if(s.nothrow){bL.replace(ah,aI);}else{try{bL.replace(ah,aI);}catch(bO){bx(bO,bg);return null;}}if(s.parsecode){if(br||ai[bj-1].length==1){bx({t:"Unclosed "+ai[bj-1]+" found at end in codemode",p:K},bg);}if(x!=aq){bJ++;}}else{if((aq==7||aq==8)&&bJ==1){o=0;for(bQ in aL){o++;}if(o!=1){o=0;}}}if((!s.nostring&&!s.event)&&(bs==2&&x==4||aq==4)){return{type:2,str:ap.slice(5,-1).join("").replace(/\\n/g,"\n").replace(/\\"/g,'"')};}if(ag||s.alwayscb){if(s.event){if(bs==1){ap[3]="";}ap[aq++]=c;}else{if(aJ){if(bs==1){ap[3]=(ap[3]!=C)?H:u,ap[aq++]=d;}else{ap[3]=aR,ap[aq++]=aZ;}}else{if(bs==1){ap[3]=(ap[3]!=C)?bA:X,ap[aq++]=U;}else{ap[3]=a8,ap[aq++]=bi;}}}if(ag){if(bs==1){if(s.precall){ap[2]=a1,ap[aq-1]=bd+ap[aq-1];}else{ap[2]=a2,ap[aq-1]=be+ap[aq-1];}}else{ap[aq++]=ap[3]+"_r"+ap[aq-2];if(s.precall){ap[2]=a1,ap[3]=H,ap[aq-2]=bd;}else{ap[2]=a2,ap[3]=H,ap[aq-2]=be;}}}if(s.withopt){ap[1]=bf,ap[aq++]=bn;}ap[0]=s.event?Y:((aJ==1||aJ==3)?ab:ba);ap[aq++]=A;}else{if(s.event){if(bs==1){ap[3]="";}}else{if(aJ){if(bs==1){ap[3]=(ap[3]!=C)?H:u,ap[aq++]=Q;}else{ap[3]=a0,ap[aq++]=bc;}}else{if(bs==1){ap[3]=(ap[3]!=C)?bA:X,ap[aq++]=bK;}else{ap[3]=al,ap[aq++]=ax;}}}if(s.withopt){ap[2]=bf,ap[aq++]=bn;}ap[0]=s.event?(s.withopt?bl:aa):(s.withopt?((aJ==1||aJ==3)?k:g):((aJ==1||aJ==3)?ak:m));ap[aq++]=A;}if(s.nothrow){bN=apf.lm_exec.compile(ap.join(""));}else{try{bN=apf.lm_exec.compile(ap.join(""));}catch(bO){if(!apf.isIE){var bP=window.onerror;window.onerror=function(bR,bT,bS){window.onerror=bP;bx(bO,bg,null,bS);return true;};apf.include("","",null,ap.join(""));window.onerror=bP;}else{bx(bO,bg);}return null;}}bN.type=(bJ==1&&bH==1)?3:(o?4:1);bN.xpaths=bk,bN.models=W,bN.props=aL,bN.asyncs=ag;ad[bM]=bN;return bN;};this.compileMatch=function(bO,o){if(!o){o=V;}aL={},bk=[],ap=[T,bp],ai=[],br=0,aq=ap.length,bI=G;for(var bM,s,bN=0,bt=bO.length;bN<bt;bN+=2){if(bL=bO[bN]){K=ai.length,aJ=2;if(bN){ap[aq++]=L;}ap[aq++]="";ai[0]=s=aq=bb=x=ap.length,af=I;aF=D=bJ=bH=ag=bs=bg=0;bj=2,ai[1]="{{",ao="{";n=1;if(o.nothrow){bL.replace(ah,aI);}else{try{bL.replace(ah,aI);}catch(bQ){bx(bQ,bg);return null;}}if(br||ai[bj-1].length==1){bx({t:"Unclosed "+ai[bj-1]+" found at end in codemode",p:K});}if(ag){bx({t:"Asynchronous calls not supported in match/value"});}if(bs==1){ap[s-1]=(ap[s-1]!=C)?af:"",ap[aq++]=M;}else{ap[s-1]=au,ap[aq++]=aB;}}if(bL=bO[bN+1]){K=ai.length;if(!bO[bN]&&bN){ap[aq++]=L;}ap[aq++]="";s=aq=bb=x=ap.length,af=av;aJ=n=ao=bj=aF=bJ=bH=D=ag=bg=0;if(o.node){aJ=2;}bs=2,n=0;if(o.nothrow){bL.replace(ah,aI);}else{try{bL.replace(ah,aI);}catch(bQ){bx(bQ,bg);return null;}}if(ag){bx({t:"Asynchronous calls not supported in match/value"});}if(o.node){if(bs==2&&x==s||aq==s){ap[s-1]=b;}else{ap[s-1]=bv,ap[aq++]=bF;}}else{if(bs==2&&x==s||aq==s){ap[s-1]=bm;}else{ap[s-1]=aQ,ap[aq++]=aY;}}if(bO[bN]){ap[aq++]=bC;}else{break;}}else{if(!bO[bN]){bx({t:"Both match and value are empty"});}if(o.node){ap[aq++]=aO;}else{ap[aq++]=t;}aJ=2;ap[aq++]=bC;}}ap[aq++]=A;var bP;if(o.nothrow){bP=apf.lm_exec.compile(ap.join(""));}else{try{bP=apf.lm_exec.compile(ap.join(""));}catch(bQ){bx(bQ,bg);return null;}}bP.type=1,bP.xpaths=bk,bP.props=aL,bP.asyncs=ag;return bP;};this.setWarnLevel=function(o){apf.lm_exec.setWarnLevel(o);};this.parseExpression=function(s,o){if(!o){o=V;}aL={},bk=[],ap=[],ai=[],br=0,bI=G;bL=s,K=bL.length;ob=aq=bb=x=ap.length,af=av;aJ=n=ao=bj=aF=bJ=bH=D=ag=bg=0;bs=2;if(o.nothrow){bL.replace(ah,aI);}else{try{bL.replace(ah,aI);}catch(bt){bx(bt,bg);return null;}}return ap.join("");};})();apf.lm_exec=new (function(){var wlvl=1;this.setWarnLevel=function(lvl){wlvl=lvl;};function wxpath(x,t){apf.console.warn("Live Markup warning in "+t+", no results for xpath: '"+x+"'");}function wnode(x,t){apf.console.warn("Live Markup warning in "+t+", xpath on null node: '"+x+"'");}function wmodel(m,x,t){apf.console.log("Live Markup warning in "+t+", xpath on empty model: '"+m+"' xpath: '"+x+"'");}function wlang(x,t){apf.console.log("Live Markup warning in "+t+", language symbol not found: '"+x+"'");}function xmlParse(str){var n=apf.getXmlDom("<_apflmlist_>"+str+"</_apflmlist_>");if(!n||!(n=n.documentElement)){return null;}return(n.firstChild==n.lastChild)?n.firstChild:n;}function __val(n,x){if(!n){return("");}return(n=(!n.nodeType&&n||(n=n.selectSingleNode(x))&&(n.nodeType!=1&&n||(n=n.firstChild)&&n.nodeType!=1&&n)))&&n.nodeValue||("");}var __valattrrx=/(["'])/g;function __valattrrp(m,a){return m=='"'?"&quot;":"&apos;";}function __valattr(n,x){if(!n){return("");}return(n=(n.nodeType!=1&&n||(n=n.selectSingleNode(x))&&(n.nodeType!=1&&n||(n=n.firstChild)&&n.nodeType!=1&&n)))&&n.nodeValue.replace(__valattrrx,__valattrrp)||("");}function __valm(m,x){var n;if(!m||!(n=(m.charAt&&((m.charAt(0)=="<"&&xmlParse(m))||((n=apf.nameserver.lookup.model[m])&&n.data)))||(m.$isModel?m.data:(m.charAt?0:m)))){return("");}return(n=(n.nodeType!=1&&n||(n=n.selectSingleNode(x))&&(n.nodeType!=1&&n||(n=n.firstChild)&&n.nodeType!=1&&n)))&&n.nodeValue||("");}function __nod(n,x){return n?n.selectSingleNode(x):(null);}function _nods(n,x){return n?n.selectNodes(x):([]);}function __nodm(m,x){var n;if(!m||!(n=(m.charAt&&((m.charAt(0)=="<"&&xmlParse(m))||((n=apf.nameserver.lookup.model[m])&&n.data)))||(m.$isModel?m.data:(m.charAt?0:m)))){return(null);}return n.selectSingleNode(x);}function _nodsm(m,x){var n;if(!m||!(n=(m.charAt&&((m.charAt(0)=="<"&&xmlParse(m))||((n=apf.nameserver.lookup.model[m])&&n.data)))||(m.$isModel?m.data:(m.charAt?0:m)))){return([]);}return n.selectNodes(x);}function __cnt(n,x){return n?n.selectNodes(x).length:(0);}function __cntm(m,x){var n;if(!m||!(n=(m.charAt&&((m.charAt(0)=="<"&&xmlParse(m))||((n=apf.nameserver.lookup.model[m])&&n.data)))||(m.$isModel?m.data:(m.charAt?0:m)))){return(0);}return n.selectNodes(x).length;}function _xpt(n,x){return{xpath:x,toString:function(){return"LM Xpath object: "+this.x;}};}function _xptm(m,x){if(m&&!m.$isModel){var node=m;m=apf.xmldb.findModel(m);x=apf.xmlToXpath(node,m.data)+"/"+x;}return{model:m,xpath:x,toString:function(){return"LM Xpath object with model: "+this.x;}};}function _xml(n,m,x){if(n){x=m;}else{if(!m||!(n=(m.charAt&&((m.charAt(0)=="<"&&xmlParse(m))||((n=apf.nameserver.lookup.model[m])&&n.data)))||(m.$isModel?m.data:(m.charAt?0:m)))){return("");}}return(n&&(n=n.selectSingleNode(x)))&&n.xml||("");}function _xmls(n,m,x){if(n){x=m;}else{if(!m||!(n=(m.charAt&&((m.charAt(0)=="<"&&xmlParse(m))||((n=apf.nameserver.lookup.model[m])&&n.data)))||(m.$isModel?m.data:(m.charAt?0:m)))){return("");}}for(var i=0,j=((n=n.selectNodes(x))).length,o=[];i<j;i++){o[i]=n[i].xml;}return o.join("");}function _valcr(n,cr,m,x){if(n){x=m;}else{if(!m||!(n=(m.charAt&&((m.charAt(0)=="<"&&xmlParse(m))||((n=apf.nameserver.lookup.model[m])&&n.data)))||(m.$isModel?m.data:(m.charAt?0:m)))){return("");}}if(cr){apf.createNodeFromXpath(ni,x);}else{if(n=ni.selectSingleNode(x)){return(n=(n.nodeType!=1&&n||(n=n.selectSingleNode(x))&&(n.nodeType!=1&&n||(n=n.firstChild)&&n.nodeType!=1&&n)))&&n.nodeValue||"";}}return("");}function _nodcr(n,cr,m,x){if(n){x=m;}else{if(!m||!(n=(m.charAt&&((m.charAt(0)=="<"&&xmlParse(m))||((n=apf.nameserver.lookup.model[m])&&n.data)))||(m.$isModel?m.data:(m.charAt?0:m)))){return(null);}}return n.selectSingleNode(x)||(cr&&apf.createNodeFromXpath(n,x));}function _valst(n,x){var m=apf.xmldb.findModel(n);if(!m){return("");}return"["+m.id+"::"+apf.xmlToXpath(n,m.data,true)+(!x||x=="."?"":"/"+x)+"]";}function _asn(o,p,v){if(!o||typeof(o)!="object"){throw new Error(apf.formatErrorString(0,0,"LM Property Assign","Cannot assign property on non object, property:"+p));}if(o.setAttribute){o.setAttribute(p,v);}else{o[p]=v;}return v;}function _add(o,p,v){return _asn(o,p,o&&o[p]+v);}function _sub(o,p,v){return _asn(o,p,o&&o[p]-v);}function _div(o,p,v){return _asn(o,p,o&&o[p]/v);}function _mul(o,p,v){return _asn(o,p,o&&o[p]*v);}function _local(n){if(n&&n.charAt&&n.charAt(0)=="<"){return apf.getXmlDom(n).documentElement;}return n;}function _tagName(n1,n2){return(n2&&n2.tagName)||(n1&&n1.tagName);}function _localName(n1,n2){return(n2&&n2[apf.TAGNAME])||(n1&&n1[apf.TAGNAME]);}function _nodeValue(n,n2){if(n2){n=n2;}return(n=(n.nodeType!=1&&n||(n.nodeType!=1&&n||(n=n.firstChild)&&n.nodeType!=1&&n)))&&n.nodeValue||"";}function __ret(r){return r;}function __lng(x,x2){return"$["+x+"]";}function _lnged(x,x2){return"$["+x+"]";}function _(n,m,x){return'<span class="liveEdit" xpath="'+(n?(m.substr(0,1)!="/"?apf.xmlToXpath(n,null,false):"")+"/"+m:"")+'">'+((n?__val(n,m):__valm(m,x))||"&#32;")+"</span>";}function _argwrap(n,x){return[n,x];}function _argwrapm(m,x){return[0,m,x];}function _valedx(editMode,args,opt){args[3]=opt;args[4]=editMode;return _valed.apply(this,args);}function _valed(n,m,x,options,editMode){var res=(n?__val(n,m):__valm(m,x));if(options&&options.multiline&&options.editor!="richtext"){res=res.replace(/\n/g,"<br />");}if(editMode!==false){return'<div onmousedown="apf.LiveEdit.mousedown(this, event)" class="liveEdit'+(options&&options.multiline?" liveeditMultiline":"")+(!res&&options&&options.initial?" liveEditInitial":"")+'" xpath="'+(n?((m.substr(0,1)!="/"?apf.xmlToXpath(n,null,false):"")+"/"+m).replace(/([\[\{\}\]])/g,"\\$1"):"")+'"'+(options?' options="'+apf.serialize(options).escapeHTML().replace(/"/g,"&quot;").replace(/([\[\{\}\]])/g,"\\$1")+'"'+(options.editor?' editor="'+options.editor+'"':""):"")+">"+(res||options&&options.initial||"&#32;")+"</div>";}else{return res;}}var selfrx=/(^|\|)(?!\@|text\(\)|\.\.|[\w\-\:]+?\:\:)/g;function _injself(s){return s.charAt?s.replace(selfrx,"$1self::"):s;}apf.$lmx=null;function _async(_n,_c,_a,_w,_f,_this,obj,func,args){var i=_a.i,v;if(!_a.ret){_a.ret=[];}if(_a[i]){return _a.ret[i];}_a[i]=true;if(!obj.exec){return _a.ret[i]=(func)?obj[func].apply(obj,args):obj.apply(obj,args);}var cb=function(data,state,extra){if(_w){delete _w._pc;}if(state!=apf.SUCCESS){_c(null,state,extra);}else{apf.$lmx=extra;_a.ret[i]=data;if(_w){_f.call(_this,_n,_c,_w,_a);}else{_f.call(_this,_n,_c,_a);}}};if(_w&&_w._pc){_w._pc={obj:obj,func:func,args:args,message:obj.createMessage&&obj.createMessage(func,args),_c:_c,cb:cb};}else{obj.exec(func,args,cb);}throw ({x:1});}function _precall(_w){var o;if(typeof(o=_w._pc)!="object"||!o){return;}o.obj.exec(o.func,o.args,o.cb,{message:o.message});throw ({x:1});}var _clut=apf.color?apf.color.colorshex:{},_cparse=/^(rgb|hsv|hsb)\(\s+(\d+)\s+,\s+(\d+)\s+,\s+(\d+)\)/;function sort(set,xpath,options){var s=new apf.Sort();options=options||{};if(!xpath.charAt){xpath="";}if(xpath.charAt(0)=="@"){xpath=xpath.slice(1);options.getValue=function(n){return n.getAttribute(xpath);};}else{options.getValue=function(n){return apf.queryValue(n,xpath);};}s.set(options);return s.apply(apf.getArrayFromNodelist(set));}function _cthex(c){var t;if((t=typeof(c))=="string"){if(c.indexOf("#")==0){if(c.length==7){return parseInt(c.slice(-1),16);}return parseInt(c.slice(-1),16);}if(t=_clut[a]){return t;}if(c=c.match(_cparse)){if((t=c[1])=="rgb"){return(((t=c[2])<0?0:(t>255?255:parseInt(t)))<<16)+(((t=c[3])<0?0:(t>255?255:parseInt(t)))<<8)+(((t=c[4])<0?0:(t>255?255:parseInt(t))));}else{var h=parseFloat(c[2]),s=parseFloat(c[3]),v=parseFloat(c[4]),i,m=v*(1-s),n=v*(1-s*((i=floor(((h<0?-h:h)%1)*6))?h-i:1-(h-i)));switch(i){case 6:case 0:return((v&255)<<16)+((n&255)<<8)+(m&255);case 1:return((n&255)<<16)+((v&255)<<8)+(m&255);case 2:return((m&255)<<16)+((v&255)<<8)+(n&255);case 3:return((m&255)<<16)+((n&255)<<8)+(v&255);case 4:return((n&255)<<16)+((m&255)<<8)+(v&255);default:case 5:return((v&255)<<16)+((m&255)<<8)+(n&255);}}}}else{if(t=="number"){return t;}}return null;}function lin(f,a,b){var fa=parseFloat(a),fb=parseFloat(b),fm=1-(f=f<0?0:(f>1?1:f));if(fa!=a||fb!=b){return(((fa=_cthex(a))&16711680)*f+((fb=_cthex(b))&16711680)*fm)&16711680|((fa&65280)*f+(fb&65280)*fm)&65280|((fa&255)*f+(fb&255)*fm)&255;}return f*fa+fm*fb;}var abs=Math.abs,acos=Math.acos,asin=Math.asin,atan=Math.atan,atan2=Math.atan2,ceil=Math.ceil,cos=Math.cos,exp=Math.exp,floor=Math.floor,log=Math.log,max=Math.max,min=Math.min,pow=Math.pow,random=Math.random,round=Math.round,sin=Math.sin,sqrt=Math.sqrt,tan=Math.tan,linear=lin;function tsin(x){return 0.5*sin(x)+0.5;}function tcos(x){return 0.5*cos(x)+0.5;}function usin(x){return 0.5-0.5*sin(x);}function ucos(x){return 0.5-0.5*cos(x);}function snap(a,b){return round(a/b)*b;}function clamp(a,b,c){return a<b?b:(a>c?c:a);}this.compile=function(code){var _ret=__ret,_val=__val,_valm=__valm,_nod=__nod,_nodm=__nodm,_cnt=__cnt,_cntm=__cntm,_lng=__lng,_valattr=__valattr;eval(code);return _f;};this.compileWith=function(code,withs){var _ret=__ret,_val=__val,_valm=__valm,_nod=__nod,_nodm=__nodm,_cnt=__cnt,_cntm=__cntm,_lng=__lng,_valattr=__valattr;eval(code);return _f;};var LMBEGINCACHE;var LMENDCACHE;})();apf.url=function(q){var k;var d=(window.location&&window.location.toString())||"";if(q.indexOf(":")==-1&&(k=d).indexOf(":")!=-1){k=new apf.url(k);q=apf.getAbsolutePath(k.protocol+"://"+k.host+(k.directory.charAt(0)=="/"?"":"/")+(k.directory.charAt(k.directory.length-1)=="/"?k.directory:k.directory+"/"),q).replace(/\/\/\/\//,"///");}var n=apf.url.options,c=n.parser[n.strictMode?"strict":"loose"].exec(q),g=14;this.uri=q.toString();while(g--){this[n.key[g]]=c[g]||"";}this[n.q.name]={};var b=this;this[n.key[12]].replace(n.q.parser,function(o,m,r){if(m){b[n.q.name][m]=r;}});this.isSameLocation=function(){if(this.uri.length&&this.uri.charAt(0)=="#"){return false;}if(!this.protocol&&!this.port&&!this.host){return true;}if(!this.protocol&&this.host&&this.port&&window.location.hostname==this.host&&window.location.port==this.port){return true;}if(!this.protocol&&this.host&&!this.port&&window.location.hostname==this.host&&window.location.port==80){return true;}return window.location.protocol==(this.protocol+":")&&window.location.hostname==this.host&&(window.location.port==this.port||!window.location.port&&!this.port);};};apf.url.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};apf.runXpath=function(){apf.XPath={cache:{},getSelf:function(htmlNode,tagName,info,count,num,sResult){var numfound=0,result=null,data=info[count];if(data){data[0](htmlNode,data[1],info,count+1,numfound++,sResult);}else{sResult.push(htmlNode);}},getChildNode:function(htmlNode,tagName,info,count,num,sResult){var numfound=0,result=null,data=info[count];var nodes=htmlNode.childNodes;if(!nodes){return;}for(var i=0;i<nodes.length;i++){if(tagName&&(tagName!=nodes[i].tagName)&&(nodes[i].style?nodes[i].tagName.toLowerCase():nodes[i].tagName)!=tagName){continue;}htmlNode=nodes[i];if(data){data[0](nodes[i],data[1],info,count+1,numfound++,sResult);}else{sResult.push(nodes[i]);}}},doQuery:function(htmlNode,qData,info,count,num,sResult){var result=null,data=info[count];var query=qData[0];var returnResult=qData[1];try{var qResult=eval(query);}catch(e){apf.console.error(e.name+" "+e.type+":"+apf.XPath.lastExpr+"\n\n"+query);return;}if(returnResult){return sResult.push(qResult);}if(!qResult||qResult.dataType==apf.ARRAY&&!qResult.length){return;}if(data){data[0](htmlNode,data[1],info,count+1,0,sResult);}else{sResult.push(htmlNode);}},getTextNode:function(htmlNode,empty,info,count,num,sResult){var data=info[count],nodes=htmlNode.childNodes;for(var i=0;i<nodes.length;i++){if(nodes[i].nodeType!=3&&nodes[i].nodeType!=4){continue;}if(data){data[0](nodes[i],data[1],info,count+1,i,sResult);}else{sResult.push(nodes[i]);}}},getAnyNode:function(htmlNode,empty,info,count,num,sResult){var data=info[count],nodes=htmlNode.getElementsByTagName("*");for(var i=0;i<nodes.length;i++){if(data){data[0](nodes[i],data[1],info,count+1,i,sResult);}else{sResult.push(nodes[i]);}}},getAttributeNode:function(htmlNode,attrName,info,count,num,sResult){if(!htmlNode||htmlNode.nodeType!=1){return;}if(attrName=="*"){var nodes=htmlNode.attributes;for(var i=0;i<nodes.length;i++){arguments.callee.call(this,htmlNode,nodes[i].nodeName,info,count,i,sResult);}return;}var data=info[count],value=htmlNode.getAttributeNode(attrName);if(data){data[0](value,data[1],info,count+1,0,sResult);}else{if(value){sResult.push(value);}}},getAllNodes:function(htmlNode,x,info,count,num,sResult){var data=info[count],tagName=x[0],inclSelf=x[1],prefix=x[2],nodes,i,l;if(inclSelf&&(htmlNode.tagName==tagName||tagName=="*"||tagName=="node()")){if(data){data[0](htmlNode,data[1],info,count+1,0,sResult);}else{sResult.push(htmlNode);}}if(tagName=="node()"){tagName="*";prefix="";if(apf.isIE){nodes=htmlNode.getElementsByTagName("*");}else{nodes=[];(function recur(x){for(var n,i=0;i<x.childNodes.length;i++){n=x.childNodes[i];if(n.nodeType!=1){continue;}nodes.push(n);recur(n);}})(htmlNode);}}else{nodes=htmlNode.getElementsByTagName((prefix&&(apf.isGecko||apf.isOpera||htmlNode.nodeFunc)?prefix+":":"")+tagName);}for(i=0,l=nodes.length;i<l;i++){if(data){data[0](nodes[i],data[1],info,count+1,i,sResult);}else{sResult.push(nodes[i]);}}},getAllAncestorNodes:function(htmlNode,x,info,count,num,sResult){var data=info[count],tagName=x[0],inclSelf=x[1],i=0,s=inclSelf?htmlNode:htmlNode.parentNode;while(s&&s.nodeType==1){if(s.tagName==tagName||tagName=="*"||tagName=="node()"){if(data){data[0](s,data[1],info,count+1,++i,sResult);}else{sResult.push(s);}}s=s.parentNode;}},getParentNode:function(htmlNode,empty,info,count,num,sResult){var data=info[count],node=htmlNode.parentNode;if(data){data[0](node,data[1],info,count+1,0,sResult);}else{if(node){sResult.push(node);}}},getPrecedingSibling:function(htmlNode,tagName,info,count,num,sResult){var data=info[count],node=htmlNode.previousSibling;while(node){if(tagName!="node()"&&(node.style?node.tagName.toLowerCase():node.tagName)!=tagName){node=node.previousSibling;continue;}if(data){data[0](node,data[1],info,count+1,0,sResult);}else{if(node){sResult.push(node);break;}}}},getFollowingSibling:function(htmlNode,tagName,info,count,num,sResult){var result=null,data=info[count];var node=htmlNode.nextSibling;while(node){if(tagName!="node()"&&(node.style?node.tagName.toLowerCase():node.tagName)!=tagName){node=node.nextSibling;continue;}if(data){data[0](node,data[1],info,count+1,0,sResult);}else{if(node){sResult.push(node);break;}}}},multiXpaths:function(contextNode,list,info,count,num,sResult){for(var i=0;i<list.length;i++){info=list[i][0];var rootNode=(info[3]?contextNode.ownerDocument.documentElement:contextNode);info[0](rootNode,info[1],list[i],1,0,sResult);}sResult.makeUnique();},compile:function(sExpr){var isAbsolute=sExpr.match(/^\//);sExpr=sExpr.replace(/\[(\d+)\]/g,"/##$1").replace(/\|\|(\d+)\|\|\d+/g,"##$1").replace(/\.\|\|\d+/g,".").replace(/\[([^\]]*)\]/g,function(match,m1){return"/##"+m1.replace(/\|/g,"_@_");});if(sExpr=="/"||sExpr=="."){return sExpr;}return this.processXpath(sExpr.replace(/\/\//g,"descendant::"),isAbsolute);},processXpath:function(sExpr,isAbsolute){var results=[],i,l,m,query;sExpr=sExpr.replace(/'[^']*'/g,function(m){return m.replace("|","_@_");});sExpr=sExpr.split("|");for(i=0,l=sExpr.length;i<l;i++){sExpr[i]=sExpr[i].replace(/_\@\_/g,"|");}if(sExpr.length==1){sExpr=sExpr[0];}else{for(i=0,l=sExpr.length;i<l;i++){sExpr[i]=this.processXpath(sExpr[i]);}results.push([this.multiXpaths,sExpr]);return results;}var sections=sExpr.split("/");for(i=0,l=sections.length;i<l;i++){if(sections[i]=="."||sections[i]==""){continue;}else{if(sections[i]==".."){results.push([this.getParentNode,null]);}else{if(sections[i].match(/^[\w\-_\.]+(?:\:[\w\-_\.]+){0,1}$/)){results.push([this.getChildNode,sections[i]]);}else{if(sections[i].match(/^\#\#(\d+)$/)){results.push([this.doQuery,["num+1 == "+parseInt(RegExp.$1)]]);}else{if(sections[i].match(/^\#\#(.*)$/)){query=RegExp.$1;m=[query.match(/\(/g),query.match(/\)/g)];if(m[0]||m[1]){while(!m[0]&&m[1]||m[0]&&!m[1]||m[0].length!=m[1].length){if(!sections[++i]){break;}query+="/"+sections[i];m=[query.match(/\(/g),query.match(/\)/g)];}}results.push([this.doQuery,[this.compileQuery(query)]]);}else{if(sections[i]=="*"){results.push([this.getChildNode,null]);}else{if(sections[i].substr(0,2)=="[]"){results.push([this.getAllNodes,["*",false]]);}else{if(sections[i].match(/descendant-or-self::node\(\)$/)){results.push([this.getAllNodes,["*",true]]);}else{if(sections[i].match(/descendant-or-self::([^\:]*)(?:\:(.*)){0,1}$/)){results.push([this.getAllNodes,[RegExp.$2||RegExp.$1,true,RegExp.$1]]);}else{if(sections[i].match(/descendant::([^\:]*)(?:\:(.*)){0,1}$/)){results.push([this.getAllNodes,[RegExp.$2||RegExp.$1,false,RegExp.$1]]);}else{if(sections[i].match(/ancestor-or-self::([^\:]*)(?:\:(.*)){0,1}$/)){results.push([this.getAllAncestorNodes,[RegExp.$2||RegExp.$1,true,RegExp.$1]]);}else{if(sections[i].match(/ancestor::([^\:]*)(?:\:(.*)){0,1}$/)){results.push([this.getAllAncestorNodes,[RegExp.$2||RegExp.$1,false,RegExp.$1]]);}else{if(sections[i].match(/^\@(.*)$/)){results.push([this.getAttributeNode,RegExp.$1]);}else{if(sections[i]=="text()"){results.push([this.getTextNode,null]);}else{if(sections[i]=="node()"){results.push([this.getChildNode,null]);}else{if(sections[i].match(/following-sibling::(.*)$/)){results.push([this.getFollowingSibling,RegExp.$1.toLowerCase()]);}else{if(sections[i].match(/preceding-sibling::(.*)$/)){results.push([this.getPrecedingSibling,RegExp.$1.toLowerCase()]);}else{if(sections[i]=="self::node()"){results.push([this.getSelf,null]);}else{if(sections[i].match(/self::(.*)$/)){results.push([this.doQuery,["apf.XPath.doXpathFunc(htmlNode, 'local-name') == '"+RegExp.$1+"'"]]);}else{query=sections[i];m=[query.match(/\(/g),query.match(/\)/g)];if(m[0]||m[1]){while(!m[0]&&m[1]||m[0]&&!m[1]||m[0].length!=m[1].length){if(!sections[++i]){break;}query+="/"+sections[i];m=[query.match(/\(/g),query.match(/\)/g)];}}results.push([this.doQuery,[this.compileQuery(query),true]]);}}}}}}}}}}}}}}}}}}}}results[0][3]=isAbsolute;return results;},compileQuery:function(code){return new apf.CodeCompilation(code).compile();},doXpathFunc:function(contextNode,type,nodelist,arg2,arg3,xmlNode,force){if(!nodelist||nodelist.length==0){nodelist="";}if(type=="not"){return !nodelist;}if(!force){var arg1,i,l;if(typeof nodelist=="object"||nodelist.dataType==apf.ARRAY){if(nodelist&&!nodelist.length){nodelist=[nodelist];}var res=false,value;for(i=0,l=nodelist.length;i<l;i++){xmlNode=nodelist[i];if(!xmlNode||typeof xmlNode=="string"||"position|last|count|local-name|name".indexOf(type)>-1){value=xmlNode;}else{if(xmlNode.nodeType==1&&xmlNode.firstChild&&xmlNode.firstChild.nodeType!=1){xmlNode=xmlNode.firstChild;}value=xmlNode.nodeValue;}if(res=arguments.callee.call(this,contextNode,type,value,arg2,arg3,xmlNode,true)){return res;}}return res;}else{arg1=nodelist;}}switch(type){case"position":return apf.getChildNumber(contextNode)+1;case"format-number":return apf.formatNumber(arg1);case"floor":return Math.floor(arg1);case"ceiling":return Math.ceil(arg1);case"starts-with":return arg1?arg1.substr(0,arg2.length)==arg2:false;case"string-length":return arg1?arg1.length:0;case"count":return arg1?arg1.length:0;case"last":return arg1?arg1[arg1.length-1]:null;case"name":var c=xmlNode||contextNode;return c.nodeName||c.tagName;case"local-name":var c=xmlNode||contextNode;if(c.nodeType!=1){return false;}return c.localName||(c.tagName||"").split(":").pop();case"substring":return arg1&&arg2?arg1.substring(arg2,arg3||0):"";case"contains":return arg1&&arg2?arg1.indexOf(arg2)>-1:false;case"concat":var str="";for(i=1,l=arguments.length;i<l;i++){if(typeof arguments[i]=="object"){str+=getNodeValue(arguments[i][0]);continue;}str+=arguments[i];}return str;case"translate":for(i=0,l=arg2.length;i<l;i++){arg1=arg1.replace(arg2.substr(i,1),arg3.substr(i,1));}return arg1;}},selectNodeExtended:function(sExpr,contextNode,match){var sResult=this.selectNodes(sExpr,contextNode);if(sResult.length==0){return null;}if(!match){return sResult;}for(var i=0,l=sResult.length;i<l;i++){if(String(getNodeValue(sResult[i]))==match){return[sResult[i]];}}return null;},getRoot:function(xmlNode){while(xmlNode.parentNode&&xmlNode.parentNode.nodeType==1){xmlNode=xmlNode.parentNode;}return xmlNode.parentNode;},selectNodes:function(sExpr,contextNode){if(!this.cache[sExpr]){this.cache[sExpr]=this.compile(sExpr);}if(typeof this.cache[sExpr]=="string"){if(this.cache[sExpr]=="."){return[contextNode];}if(this.cache[sExpr]=="/"){return[(contextNode.nodeType==9?contextNode.documentElement:this.getRoot(contextNode))];}}if(typeof this.cache[sExpr]=="string"&&this.cache[sExpr]=="."){return[contextNode];}var info=this.cache[sExpr][0],rootNode=(info[3]?(contextNode.nodeType==9?contextNode.documentElement:this.getRoot(contextNode)):contextNode),sResult=[];if(rootNode){info[0](rootNode,info[1],this.cache[sExpr],1,0,sResult);}return sResult;}};function getNodeValue(sResult){if(sResult.nodeType==1){return sResult.firstChild?sResult.firstChild.nodeValue:"";}if(sResult.nodeType>1||sResult.nodeType<5){return sResult.nodeValue;}return sResult;}apf.CodeCompilation=function(code){this.data={F:[],S:[],I:[],X:[]};this.compile=function(){code=code.replace(/ or /g," || ").replace(/ and /g," && ").replace(/!=/g,"{}").replace(/=/g,"==").replace(/\{\}/g,"!=");this.tokenize();this.insert();code=code.replace(/, \)/g,", htmlNode)");return code;};this.tokenize=function(){var data=this.data.F;code=code.replace(/(translate|format-number|contains|substring|local-name|last|position|round|starts-with|string|string-length|sum|floor|ceiling|concat|count|not)\s*\(/g,function(d,match){return(data.push(match)-1)+"F_";});data=this.data.S;code=code.replace(/'([^']*)'/g,function(d,match){return(data.push(match)-1)+"S_";}).replace(/"([^"]*)"/g,function(d,match){return(data.push(match)-1)+"S_";});data=this.data.X;code=code.replace(/(^|\W|\_)([\@\.\/A-Za-z\*][\*\.\@\/\w\:\-]*(?:\(\)){0,1})/g,function(d,m1,m2){return m1+(data.push(m2)-1)+"X_";}).replace(/(\.[\.\@\/\w]*)/g,function(d,m1,m2){return(data.push(m1)-1)+"X_";});data=this.data.I;code=code.replace(/(\d+)(\W)/g,function(d,m1,m2){return(data.push(m1)-1)+"I_"+m2;});};this.insert=function(){var data=this.data;code=code.replace(/(\d+)X_\s*==\s*(\d+S_)/g,function(d,nr,str){return"apf.XPath.selectNodeExtended('"+data.X[nr].replace(/'/g,"\\'")+"', htmlNode, "+str+")";}).replace(/(\d+)([FISX])_/g,function(d,nr,type){var value=data[type][nr];if(type=="F"){return"apf.XPath.doXpathFunc(htmlNode, '"+value+"', ";}else{if(type=="S"){return"'"+value+"'";}else{if(type=="I"){return value;}else{if(type=="X"){return"apf.XPath.selectNodeExtended('"+value.replace(/'/g,"\\'")+"', htmlNode)";}}}}}).replace(/, \)/g,")");};};};apf.BindingRule=function(c,b){this.$init(b||true,apf.NODE_HIDDEN,c);};(function(){this.$bindingRule=true;this.compile=function(b){return(this["c"+b]=apf.lm.compile(this[b],{xpathmode:3,injectself:true}));};this.$compile=function(c,b){return(this["c"+c+"2"]=apf.lm.compile(this[c],b));};this.$attrExcludePropBind=apf.extend({value:1,match:1},this.$attrExcludePropBind);this.$booleanProperties.hasaml=true;this.$propHandlers.value=this.$propHandlers.match=function(c,d){delete this["c"+d];if(this.$amlLoaded){var b=this;while(b&&b.$bindingRule){b=b.parentNode;}if(!b){return;}apf.queue.add("reload"+b.$uniqueId,function(){b.reload();});if(b.$bindings.$isCompiled){b.$bindings.$compiled=b.$bindings.compile(this.localName!="each"&&this.localName);}}};this.addEventListener("DOMNodeInserted",function(c){var b=this;while(b.$bindingRule){b=b.parentNode;}apf.queue.add("reload"+b.$uniqueId,function(){b.reload();});if(c.currentTarget==this){(b.$bindings[this.localName]||(b.$bindings[this.localName]=[])).push(this);}else{if(!this.attributes.getNamedItem("value")){this.value=apf.serializeChildren(this);}else{return;}}if(b.$bindings.$isCompiled){b.$bindings.$compiled=b.$bindings.compile(this.localName!="each"&&this.localName);}});this.addEventListener("DOMNodeRemoved",function(c){if(this.$amlDestroyed){return;}var d,b=this;while(b&&b.$bindingRule){b=b.parentNode;}if(!b){return;}if(c.currentTarget==this){if(b.$bindings&&b.$bindings[this.localName]){b.$bindings[this.localName].remove(this);}else{return;}}else{if(!this.attributes.getNamedItem("value")&&(d=this.firstChild)){if(d.nodeType==this.NODE_PROCESSING_INSTRUCTION){if(d.target=="lm"){this.value="{"+d.nodeValue+"}";}else{this.value=d.nodeValue;}}else{this.value=apf.serializeChildren(this).trim();}}else{return;}}apf.queue.add("reload"+b.$uniqueId,function(){if(!b.$amlDestroyed){b.reload();}});if(b.$bindings.$isCompiled){b.$bindings.$compiled=b.$bindings.compile(this.localName!="each"&&this.localName);}});this.addEventListener("DOMNodeInsertedIntoDocument",function(d){var g;if(!this.value&&this.localName!="each"&&(g=this.$aml&&this.$aml.firstChild||this.firstChild)){if(g.nodeType==this.NODE_PROCESSING_INSTRUCTION){if(g.target=="lm"){this.value="{"+g.nodeValue+"}";}else{this.value=g.nodeValue;}}else{this.value=apf.serializeChildren(this.$aml).trim();}}var b=this.parentNode;while(b.$bindingRule){b=b.parentNode;}var k=b.$bindings||(b.$bindings=new apf.ruleList());(k[this.localName]||(k[this.localName]=[])).push(this);if(b.localName!="bindings"&&(this.localName!="each"||!this.childNodes.length)){var c=this;while((c=c.nextSibling)&&c.nodeType!=1){}if(!c||!c.$bindingRule){b.$cbindings=b.$bindings.compile(b.$bindings.$isCompiled?this.localName:null);b.dispatchEvent("bindingsload",{bindings:b.$bindings,compiled:b.$cbindings});b.$checkLoadQueue();}}});}).call(apf.BindingRule.prototype=new apf.AmlElement());apf.aml.setElement("icon",apf.BindingRule);apf.aml.setElement("image",apf.BindingRule);apf.aml.setElement("caption",apf.BindingRule);apf.aml.setElement("tooltip",apf.BindingRule);apf.aml.setElement("css",apf.BindingRule);apf.aml.setElement("selectable",apf.BindingRule);apf.aml.setElement("value",apf.BindingRule);apf.aml.setElement("src",apf.BindingRule);apf.aml.setElement("collapsed",apf.BindingRule);apf.aml.setElement("expanded",apf.BindingRule);apf.aml.setElement("empty",apf.BindingRule);apf.ActionRule=function(c,b){this.$init(b||true,apf.NODE_HIDDEN,c);};(function(){this.$actionRule=true;this.compile=function(c,b){return(this["c"+c]=apf.lm.compile(this[c],b||{xpathmode:2}));};this.$attrExcludePropBind=apf.extend({set:1,get:1,undo:1,lock:1,match:1,parent:1},this.$attrExcludePropBind);this.$propHandlers.set=this.$propHandlers.get=this.$propHandlers.parent=this.$propHandlers.match=function(b,c){delete this["c"+c];};this.addEventListener("DOMNodeInserted",function(c){if(c.currentTarget==this){var b=this.parentNode;if(!b.$actions){b.$actions=new apf.ruleList();}(b.$actions[this.localName]||(b.$actions[this.localName]=[])).push(this);}else{if(this.attributes.getNamedItem("value")){return;}this.value=apf.serializeChildren(this);}});this.addEventListener("DOMNodeRemoved",function(b){if(this.$amlDestroyed){return;}if(b.currentTarget==this){this.parentNode.$actions[this.localName].remove(this);}else{if(this.attributes.getNamedItem("value")){return;}this.value=apf.serializeChildren(this);}});this.addEventListener("DOMNodeInsertedIntoDocument",function(b){if(!this.get){this.get=apf.serializeChildren(this.$aml).trim();}var c=this.parentNode.$actions||(this.parentNode.$actions=new apf.ruleList());(c[this.localName]||(c[this.localName]=[])).push(this);});}).call(apf.ActionRule.prototype=new apf.AmlElement());apf.aml.setElement("rename",apf.ActionRule);apf.aml.setElement("remove",apf.ActionRule);apf.aml.setElement("add",apf.ActionRule);apf.aml.setElement("update",apf.ActionRule);apf.aml.setElement("copy",apf.ActionRule);apf.aml.setElement("move",apf.ActionRule);apf.aml.setElement("check",apf.ActionRule);apf.aml.setElement("change",apf.ActionRule);apf.actions=function(c,b){this.$init(b||"actions",apf.NODE_HIDDEN,c);this.$actions=new apf.ruleList();this.$amlNodes={};};(function(){this.$smartbinding=null;this.register=function(b){if(b.localName=="smartbinding"){this.$smartbinding=b;this.$smartbinding.add(this);return;}this.$amlNodes[b.$uniqueId]=b;b.$actions=this.$actions;b.$actionsElement=this;b.dispatchEvent("actionsload",{bindings:this});};this.unregister=function(b){this.$amlNodes[b.$uniqueId]=null;delete this.$amlNodes[b.$uniqueId];delete b.$actionsElement;delete b.$actions;b.dispatchEvent("actionsunload",{bindings:this});};this.addEventListener("DOMNodeInsertedIntoDocument",function(k){var c=this.childNodes;for(var g,d=0,b=c.length;d<b;d++){if((g=c[d]).nodeType!=1){continue;}g.dispatchEvent("DOMNodeInsertedIntoDocument");}this.register(this.parentNode);});}).call(apf.actions.prototype=new apf.AmlElement());apf.aml.setElement("actions",apf.actions);apf.actiontracker=function(c,b){this.$init(b||"actiontracker",apf.NODE_HIDDEN,c);this.$undostack=[];this.$redostack=[];this.$execstack=[];};(function(){this.$lastExecStackItem=null;this.realtime=true;this.undolength=0;this.redolength=0;this.$booleanProperties={};this.$booleanProperties.realtime=true;this.$supportedProperties=["realtime","undolength","redolength","alias","length","position"];this.$handlePropSet=function(g,d,c){if(this.$booleanProperties[g]){d=apf.isTrue(d);}switch(g){case"undolength":this.undolength=this.$undostack.length;break;case"redolength":this.redolength=this.$redostack.length;break;default:this[g]=d;}};this.item=function(c){if(c<this.$undostack.length){return this.$undostack[c];}return this.$redostack[c-this.$undostack.length];};this.add=function(c,d){throw new Error("Not implemented yet");};this.remove=function(c){throw new Error("Not implemented yet");};this.clearUndo=function(){this.setProperty("undolength",this.$undostack.length=0);this.dispatchEvent("afterchange",{action:"clear-undo"});};this.clearRedo=function(){this.setProperty("redolength",this.$redostack.length=0);this.dispatchEvent("afterchange",{action:"clear-redo"});};this.define=function(d,c){apf.actiontracker.actions[d]=c;};this.getParent=function(){return this.parentNode&&this.parentNode.getActionTracker?this.parentNode.getActionTracker(true):(apf.window.$at!=this?apf.window.$at:null);};this.getDone=function(d){if(typeof d!="number"){return[];}for(var g,c=this.$undostack.length;c>=0;--c){if(!(g=this.$undostack[c])||!g.timestamp){continue;}if(g.timestamp>=d){return this.$undostack.slice(c);}}return[];};this.getUndone=function(g){if(typeof g!="number"){return[];}for(var k,d=0,c=this.$redostack.length;d<c;++d){if(!(k=this.$redostack[d])||!k.timestamp){continue;}if(k.timestamp<=g){return this.$redostack.slice(0,d+1);}}return[];};this.execute=function(c){if(this.dispatchEvent("beforechange",c)===false){return false;}var d=new apf.UndoData(c,this);if(c.action&&!c.transaction){apf.actiontracker.actions[c.action](d,false,this);}d.id=this.$undostack.push(d)-1;this.setProperty("undolength",this.$undostack.length);if(d.multiple){this.$addToQueue(d.multiple,false,true);}else{this.$addToQueue(d,false);}if(!c.rdb){this.$redostack.length=0;this.setProperty("redolength",this.$redostack.length);}this.dispatchEvent("afterchange",{action:"do"});return d;};this.purge=function(d,c){if(true){if(this.$execstack.length){this.$execstack[0].undoObj.saveChange(this.$execstack[0].undo,this);this.$lastExecStackItem=this.$execstack[this.$execstack.length-1];}}else{if(parent){this.reset();}}};this.reset=function(){this.$undostack.length=this.$redostack.length=0;this.setProperty("undolength",0);this.setProperty("redolength",0);this.dispatchEvent("afterchange",{action:"reset"});};this.undo=function(g,d,c){b.call(this,g,d,true,c);};this.redo=function(g,d,c){b.call(this,g,d,false,c);};function b(q,o,d,c){var g=d?this.$undostack:this.$redostack,n=d?this.$redostack:this.$undostack;if(!g.length){return;}if(o){var m=g[q];if(!m){return;}g.length--;n.push(m);if(m.action){apf.actiontracker.actions[m.action](m,d,this);}if(!c){if(m.multiple){this.$addToQueue(m.multiple,d,true);}else{this.$addToQueue(m,d);}}this.setProperty("undolength",this.$undostack.length);this.setProperty("redolength",this.$redostack.length);return m;}if(this.dispatchEvent("beforechange")===false){return;}if(q==-1){q=g.length;}if(!q){q=1;}var k=0;while(k<q&&g.length>0){if(!g[g.length-1]){g.length--;this.$undostack=[];this.$redostack=[];return false;}else{b.call(this,g.length-1,true,d,c);k++;}}this.dispatchEvent("afterchange",{action:d?"undo":"redo",rollback:c});}this.$receive=function(k,g,c,d,n){if(g==apf.TIMEOUT&&c.tpModule.retryTimeout(c,g,this)===true){return true;}if(g!=apf.SUCCESS){if(this.dispatchEvent("actionfail",apf.extend(c,{state:g,message:"Could not sent Action RPC request for control "+this.name+"["+this.localName+"] \n\n"+c.message,bubbles:true}))===false){return true;}if(typeof apf.offline!="undefined"&&!apf.offline.reloading){this.undo(d.id,c.userdata,true);}if(n){n(!c.userdata);}if(!c.userdata){this.$execstack=[];var m=new Error(apf.formatErrorString(0,this,"Executing action","Error sending action to the server:\n"+(c.url?"Url:"+c.url+"\n\n":"")+c.message));if((d&&d.xmlActionNode||c.amlNode||apf).dispatchEvent("error",apf.extend({error:m,state:g,bubbles:true},c))===false){return;}throw m;}}else{this.dispatchEvent("actionsuccess",apf.extend(c,{state:g,bubbles:true},c));if(n){n();}}this.$queueNext(d,n);};this.$addToQueue=function(k,d,o){if(!o&&this.$execstack.length&&!k.state&&this.$execstack[this.$execstack.length-1].undoObj==k){this.$execstack.length--;return;}var c,m,n;if(o){var m,n=this.$execstack.shift();for(var g=0;g<k.length;g++){m=k[g];this.$execstack.unshift({undoObj:(m.tagName?m:new apf.UndoData(m,this)).preparse(d,this),undo:d});}if(n){this.$execstack.unshift(n);}return;}n={undoObj:k.preparse(d,this),undo:d};this.$execstack.push(n)-1;if(this.$execstack.length==1&&this.realtime){k.saveChange(d,this);}};this.$queueNext=function(d,g){if(!this.$execstack[0]||this.$execstack[0].undoObj!=d){throw new Error(apf.formatErrorString(0,this,"Executing Next                 action in queue","The execution stack was corrupted. This is                 a fatal error. The application should be restarted. You will                 lose all your changes. Please contact the administrator."));}d.state=null;var c=this.$execstack.shift();if(!this.$execstack[0]||c==this.$lastExecStackItem){return;}this.$execstack[0].undoObj.saveChange(this.$execstack[0].undo,this,g);};}).call(apf.actiontracker.prototype=new apf.AmlElement());apf.aml.setElement("actiontracker",apf.actiontracker);apf.application=function(){this.$init("application",apf.NODE_HIDDEN);if(!apf.isO3){this.$int=document.body;this.$tabList=[];this.$focussable=apf.KEYBOARD;this.focussable=true;this.visible=true;this.$isWindowContainer=true;this.focus=function(){this.dispatchEvent("focus");};this.blur=function(){this.dispatchEvent("blur");};apf.window.$addFocus(this);}};apf.application.prototype=new apf.AmlElement();apf.aml.setElement("application",apf.application);apf.appsettings=function(c,b){this.$init(b||"appsettings",apf.NODE_HIDDEN,c);};(function(){this.$parsePrio="001";this.$attrExcludePropBind={language:1,login:1,logout:1};this.$supportedProperties=["debug","name","baseurl","resource-path","disable-right-click","allow-select","allow-blur","auto-disable-actions","auto-disable","disable-f5","auto-hide-loading","disable-space","disable-backspace","undokeys","initdelay","default-page","query-append","outline","drag-outline","resize-outline","resize-outline","iepngfix","iepngfix-elements","iphone-fullscreen","iphone-statusbar","iphone-icon","iphone-icon-is-glossy","iphone-fixed-viewport","skinset","language","storage","offline","login"];this.$booleanProperties={debug:1,"disable-right-click":1,"allow-select":1,"allow-blur":1,"auto-disable-actions":1,"auto-disable":1,"disable-f5":1,"auto-hide-loading":1,"disable-space":1,"disable-backspace":1,undokeys:1,initdelay:1,outline:1,iepngfix:1,"iphone-fullscreen":1,"iphone-icon-is-glossy":1,"iphone-fixed-viewport":1};var b=this.setProperty;this.setProperty=function(m,k,g,d,c){if(c!=2){b.apply(this,arguments);}};this.$handlePropSet=function(g,d,c){if(this.$booleanProperties[g]){d=apf.isTrue(d);}this[g]=d;apf.config.setProperty(g,d);};this.addEventListener("DOMNodeInsertedIntoDocument",function(c){});}).call(apf.appsettings.prototype=new apf.AmlElement());apf.aml.setElement("appsettings",apf.appsettings);apf.section=function(c,b){this.$init(b||"section",apf.NODE_VISIBLE,c);};apf.menubar=function(c,b){this.$init(b||"menubar",apf.NODE_VISIBLE,c);};apf.bar=function(c,b){this.$init(b||"bar",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;this.$canLeechSkin=true;this.$isLeechingSkin=false;this.$propHandlers.caption=function(b){this.$int.innerHTML=b;};this.addEventListener("AMLReparent",function(b,d,c){if(!this.$amlLoaded){return;}if(this.$isLeechingSkin&&!c&&this.skinName!=d.skinName||!this.$isLeechingSkin&&this.parentNode.$hasLayoutNode&&this.parentNode.$hasLayoutNode(this.localName)){this.$isLeechingSkin=true;this.$forceSkinChange(this.parentNode.skinName.split(":")[0]+":"+skinName);}});this.$draw=function(){this.$ext=this.$getExternal(this.$isLeechingSkin?this.localName:"main");if(this.oDrag){this.oDrag.parentNode.removeChild(this.oDrag);}this.oDrag=this.$getLayoutNode(this.$isLeechingSkin?this.localName:"main","dragger",this.$ext);this.$int=this.$getLayoutNode(this.$isLeechingSkin?this.localName:"main","container",this.$ext);};this.$loadAml=function(b){};this.$skinchange=function(){};}).call(apf.bar.prototype=new apf.Presentation());apf.menubar.prototype=apf.section.prototype=apf.bar.prototype;apf.aml.setElement("bar",apf.bar);apf.aml.setElement("menubar",apf.menubar);apf.aml.setElement("section",apf.section);apf.BindingColorRule=function(c,b){this.$init(b,apf.NODE_HIDDEN,c);};(function(){this.addEventListener("DOMNodeInsertedIntoDocument",function(c){if(this.$bindings&&this.$bindings.color){var b=this.$bindings.color[0];apf.setStyleRule("."+this.$baseCSSname+(apf.isIE?" .records .highlight SPAN":" .records .highlight span"),"color",b.getAttribute("text"),null,this.oWin);apf.setStyleRule("."+this.$baseCSSname+(apf.isIE?" .records .highlight SPAN":" .records .highlight span"),"backgroundColor",b.getAttribute("row"),null,this.oWin);apf.setStyleRule("."+this.$baseCSSname+(apf.isIE?" .records .highlight":" .records .highlight"),"backgroundColor",b.getAttribute("row"),null,this.oWin);}apf.importStylesheet([["."+this.className,"width:"+this.$width+(this.$isPercentage?"%;":"px;")+"text-align:"+h.align],["."+this.className,"width:"+this.$width+(this.$isPercentage?"%;":"px;")+"text-align:"+h.align]]);this.$draw();});}).call(apf.BindingColorRule.prototype=new apf.BindingRule());apf.aml.setElement("color",apf.BindingColorRule);apf.BindingColumnRule=function(c,b){this.$init(b,apf.NODE_HIDDEN,c);this.$className="col"+this.$uniqueId;};(function(){this.$defaultwidth="100";this.$width=100;this.$sortable=true;this.$resizable=true;this.$movable=true;this.$cssInit=false;this.$attrExcludePropBind=apf.extend({css:1,icon:1,caption:1,eachcaption:1,eachvalue:1,each:1,icon:1},this.$attrExcludePropBind);this.$supportedProperties.push("tree","icon","caption","width","options","check","editor","colspan","align","css","sorted","each","eachvalue","eachcaption","model");this.$booleanProperties.tree=true;this.$booleanProperties.check=true;this.$booleanProperties.sorted=true;this.$propHandlers.width=function(b,c){if(!b){b=this.$defaultwidth;}this.$isPercentage=b&&String(b).indexOf("%")>-1;this.$width=parseFloat(b);};this.$propHandlers.options=function(b,c){this.$sortable=b.indexOf("sort")>-1;this.$resizable=b.indexOf("size")>-1;this.$movable=b.indexOf("move")>-1;};this.resize=function(c,A){var s;if(this.$isPercentage){var w=(this.$ext.offsetWidth-(A.$widthdiff-3)),u=c/w,t=[],m=[],x=0,d=this.$ext.nextSibling;while(d&&d.getAttribute("hid")){s=apf.all[d.getAttribute("hid")];if(s.$isPercentage){t.push(s);x+=s.$width;}else{m.push(s);}d=d.nextSibling;}if(m.length&&!t.length){return m[0].resize(m[0].$width+(w-c),A);}var k=u*this.$width,r=k-this.$width,q=(x-r)/x;if(q<0.01){if(c<20){return;}return this.resize(c-10,A);}for(var b,o=0;o<t.length;o++){b=t[o];b.$width*=q;apf.setStyleRule("."+b.$className,"width",b.$width+"%");}this.$width=k;apf.setStyleRule("."+this.$className,"width",this.$width+"%");}else{var y=c-this.$width;this.$width=c;if(apf.isIE&&A.oIframe){this.$ext.style.width=c+"px";}else{}apf.setStyleRule("."+this.$className,"width",c+"px",null,A.oWin);A.$fixed+=y;var g=(A.$fixed)+"px";if(!this.$isFixedGrid){apf.setStyleRule("."+A.$baseCSSname+" .row"+A.$uniqueId,"paddingRight",g,null,this.oWin);apf.setStyleRule("."+A.$baseCSSname+" .row"+A.$uniqueId,"marginRight","-"+g,null,A.oWin);A.$container.style.paddingRight=A.$head.style.paddingRight=g;}}};this.hide=function(){apf.setStyleRule("."+this.$baseCSSname+" .records ."+h.$className,"visibility","hidden",null,this.oWin);};this.show=function(){apf.setStyleRule("."+this.$baseCSSname+" .records ."+h.$className,"visibility","visible",null,this.oWin);};this.sort=function(c,b){if(c.$lastSorted==this){apf.setStyleClass(this.$int,c.toggleSortOrder()?"ascending":"descending",["descending","ascending"]);return;}var d;if(d=c.$lastSorted){apf.setStyleRule("."+d.$className,"background","white");apf.setStyleClass(d.$int,"",["descending","ascending"]);}apf.setStyleRule("."+this.$className,"background","#f3f3f3");apf.setStyleClass(this.$int,"ascending",["descending","ascending"]);c.resort({order:"ascending",xpath:(this.cvalue||this.compile("value")).xpaths[1]},false,b||!c.length);c.$lastSorted=this;};this.move=function(d,k){if(d&&this==d){return;}var g=this,c=apf.getChildNumber(g.$int),m=d&&apf.getChildNumber(d.$int);k.$head.insertBefore(g.$int,d&&d.$int||null);if(!k.length){return;}(function b(n){for(var q,o=0;o<n.length;o++){if(n[o].nodeType!=1){continue;}q=n[o];if(k.$isTreeArch&&q.tagName=="BLOCKQUOTE"){b(q.childNodes);}else{q.insertBefore(q.childNodes[c],m!=undefined&&q.childNodes[m]||null);}}})(k.$container.childNodes);};this.$draw=function(k,d,n,m){var k=k||this.parentNode;while(k.$bindingRule){k=k.parentNode;}if(!k.hasFeature(apf.__PRESENTATION__)){return;}if(n){this.$propHandlers.width.call(this,n);}apf.importStylesheet([["."+this.$className,"width:"+this.$width+(this.$isPercentage?"%;":"px;")+"text-align:"+this.align]]);k.$getNewContext("headitem");var c=k.$getLayoutNode("headitem");c.setAttribute("class",this.$className+(m?" "+m:""));c.setAttribute("hid",this.$uniqueId);var g=k.$getLayoutNode("headitem","caption");g.nodeValue=this.caption||d||"&nbsp";this.$ext=this.$int=apf.insertHtmlNode(c,k.$head||k.$container);var o=false;var b=this;if(this.sorted){this.sort(k,true);}this.$int.onmouseup=function(q){if(!q){q=event;}if(k.disabled||!apf.isChildOf(o,this,true)){return;}apf.setStyleClass(this,"hover",["down"]);if(b.$sortable){b.sort(k);}k.dispatchEvent("sortcolumn",b);};this.$int.onmousedown=function(u){if(!u){u=event;}o=target=this;if(k.disabled){return;}var B=apf.getAbsolutePosition(target),w=k.$head.scrollLeft;var A=u.clientX-B[0]+w;if(A<4||target.offsetWidth-A-8<3&&apf.getChildNumber(b.$int)<k.$headings.length-1){var E=A<4&&target.previousSibling||target;if(b.$resizable){B=apf.getAbsolutePosition(E);apf.setStyleClass(k.$pointer,"size_pointer",["move_pointer"]);k.$pointer.style.display="block";k.$pointer.style.left=(E.offsetLeft-w-1)+"px";k.$pointer.style.width=(E.offsetWidth-k.$widthdiff+1)+"px";apf.plane.show(k.$pointer,null,true);o=true;document.onmouseup=function(){if(!u){u=event;}document.onmouseup=document.onmousemove=null;apf.all[E.getAttribute("hid")].resize(k.$pointer.offsetWidth,k);o=false;k.$pointer.style.display="none";apf.plane.hide();};document.onmousemove=function(t){if(!t){t=event;}k.$pointer.style.width=Math.max(10,Math.min(k.$container.offsetWidth-k.$pointer.offsetLeft-20,t.clientX-B[0]-1+w))+"px";};return;}}apf.setStyleClass(target,"down",["hover"]);if(!b.$movable){document.onmouseup=function(t){document.onmouseup=null;o=false;};return;}apf.setStyleClass(k.$pointer,"move_pointer",["size_pointer"]);var D=u.clientX-target.offsetLeft,s=u.clientX,C=u.clientY-target.offsetTop,r=u.clientY,q;document.onmouseup=function(y){if(!y){y=event;}document.onmouseup=document.onmousemove=null;o=false;k.$pointer.style.display="none";if(!q){return;}q.style.top="-100px";var x=document.elementFromPoint(y.clientX,y.clientY);if(x.parentNode==q.parentNode){var F=apf.getAbsolutePosition(x);var t=(y.clientX-F[0]>x.offsetWidth/2?x.nextSibling:x);b.move(t?apf.all[t.getAttribute("hid")]:null,k);}apf.destroyHtmlNode(q);};document.onmousemove=function(y){if(!y){y=event;}if(!q){if(Math.abs(y.clientX-s)<3&&Math.abs(y.clientY-r)<3){return;}q=target.cloneNode(true);q.style.position="absolute";var x=apf.getWidthDiff(target);q.style.width=(target.offsetWidth-x-k.$widthdiff+2)+"px";q.style.left=target.offsetLeft;q.style.top=target.offsetTop;q.style.margin=0;q.removeAttribute("hid");apf.setStyleClass(q,"drag",["ascending","descending"]);target.parentNode.appendChild(q);}q.style.top="-100px";k.$pointer.style.display="none";var t=document.elementFromPoint(y.clientX,y.clientY);if(t.parentNode==q.parentNode){var F=apf.getAbsolutePosition(t);k.$pointer.style.left=(t.offsetLeft+((y.clientX-F[0]>t.offsetWidth/2)?t.offsetWidth-8:0))+"px";k.$pointer.style.display="block";}q.style.left=(y.clientX-D)+"px";q.style.top=(y.clientY-C)+"px";};};this.$int.onmouseout=function(r){if(!r){r=event;}if(k.disabled){return;}var q=this;this.$timer=setTimeout(function(){k.$ext.style.cursor="";apf.setStyleClass(q,"",["hover","down"]);},10);};this.$int.onmousemove=function(s){if(o||k.disabled){return;}if(!s){s=event;}var w=apf.getAbsolutePosition(this),q=k.$head.scrollLeft;var u=s.clientX-w[0]+q;if(u<4||this.offsetWidth-u-k.$widthdiff<3&&apf.getChildNumber(b.$int)<k.$headings.length-1){var r=u<4?this.previousSibling:this;k.$ext.style.cursor=r&&b.$resizable?"w-resize":"default";apf.setStyleClass(this,"",["hover","down"]);}else{k.$ext.style.cursor="default";apf.setStyleClass(this,"hover",["down"]);}};if(!this.options&&k.options){this.$propHandlers.options.call(this,this.options=k.options);}return this;};this.addEventListener("DOMNodeInsertedIntoDocument",function(b){this.$draw();});this.addEventListener("DOMNodeRemovedFromDocument",function(b){if(!this.$int){return;}this.$int.onmouseover=this.$int.onmouseup=this.$int.onmousedown=this.$int.onmousemove=this.$int.onmouseout=null;});}).call(apf.BindingColumnRule.prototype=new apf.BindingRule());apf.aml.setElement("column",apf.BindingColumnRule);apf.BindingDndRule=function(c,b){this.$init(b,apf.NODE_HIDDEN,c);};(function(){this.compile=function(c){if(!this[c]){return;}var b;if(c=="value"){b=apf.lm.compile(this[c],{xpathmode:3});}else{if(c=="match"){b=apf.lm.compile(this[c],{xpathmode:3,injectself:true});}else{if(c=="target"){b=apf.lm.compile(this[c],{xpathmode:2,injectself:true});}else{if(c=="action"){b=apf.lm.compile(this[c],{nostring:true});}else{if(c=="copy"){b=apf.lm.compile(this[c],{withopt:true,nostring:true});}else{throw new Error("Missing property handler for compile");}}}}}return(this["c"+c]=b);};this.$attrExcludePropBind=apf.extend({target:1,parent:1,action:1,dragcopy:1},this.$attrExcludePropBind);this.$propHandlers.target=this.$propHandlers.parent=this.$propHandlers.action=this.$propHandlers.dragcopy=function(b,c){delete this["c"+c];};this.$noderegister=function(b){apf.GuiElement.propHandlers.drop.call(b.amlNode,true);};this.addEventListener("DOMNodeInsertedIntoDocument",function(g){var d=this;while(d&&d.$bindingRule){d=d.parentNode;}if(!d){return;}if(d.localName=="bindings"){d.addEventListener("noderegister",this.$noderegister);var b=d.$amlNodes;for(var c=0;c<b.length;c++){apf.GuiElement.propHandlers.drop.call(b[c],true);}}else{apf.GuiElement.propHandlers.drop.call(d,true);}});}).call(apf.BindingDndRule.prototype=new apf.BindingRule());apf.aml.setElement("drag",apf.BindingDndRule);apf.aml.setElement("drop",apf.BindingDndRule);apf.BindingEachRule=function(d,c){this.$init(c,apf.NODE_HIDDEN,d);var b=this;this.$noderegister=function(g){g.amlNode.$handleBindingRule(b.match,"each");g.amlNode.$sort=b.sort?new apf.Sort(b):null;};};(function(){this.$attrExcludePropBind=apf.extend({sort:1,"data-type":1,"date-format":1,"sort-method":1,order:1,"case-order":1},this.$attrExcludePropBind);this.$booleanProperties.animate=true;this.$propHandlers.sort=this.$propHandlers["data-type"]=this.$propHandlers["date-format"]=this.$propHandlers.order=this.$propHandlers["case-order"]=function(c,d){delete this["c"+d];};this.$updateEach=function(m){var k=this.parentNode;if(k.localName=="bindings"){var d=k.$amlNodes,g=0,c=d.length;for(;g<c;++g){if(d[g].each!=m){d[g].$handleBindingRule(m,"each");}}}else{if(k.each!=m){k.$handleBindingRule(m,"each");}}};this.$getFilteredMatch=function(x){if(!x){return this.match;}var q=x.trim().toLowerCase().split(" ");var w=this.match.charAt(0)=="["&&this.match.charAt(this.match.length-1)=="]"?this.match.replace(/^\[|\]$/g,""):this.match;var r;if(w.indexOf("::")>-1){var u=w.split("::");if(!apf.xPathAxis[u[0]]){r=u[0];w=u[1];}}var y=[],c,t,s=this.$fields||["text()"];for(var o=0,g=q.length;o<g;o++){t=[],c=q[o];for(var m=0,n=s.length;m<n;m++){t.push("contains(translate("+s[m]+", 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), '"+c+"')");}y.push(t.join(" or "));}var d="("+y.join(") and (")+")";w=w.split("|");var k=[];for(o=0,g=w.length;o<g;o++){k.push("("+w[o]+")["+d+"]");}return k.join("|");};this.$propHandlers.filter=function(c,d){if(!this.$amlLoaded){return;}this.$updateEach(this.$getFilteredMatch(c));};this.$propHandlers["filter-fields"]=function(c,d){this.$fields=c.splitSafe(",");};this.addEventListener("prop.match",function(c){if(!this.$amlLoaded){return;}if(this.filter){this.$propHandlers.filter.call(this,this.filter);}else{this.$updateEach(this.match);}});var b;this.addEventListener("DOMNodeInserted",b=function(n){if(n.currentTarget!=this){return;}var g=this.$getFilteredMatch(this.filter);var m=this.parentNode;if(m.localName=="bindings"){m.addEventListener("noderegister",this.$noderegister);var d=m.$amlNodes,k=0,c=d.length;for(;k<c;++k){d[k].$handleBindingRule(g,"each");d[k].$sort=this.sort?new apf.Sort(this):null;}}else{m.$handleBindingRule(g,"each");m.$sort=this.sort?new apf.Sort(this):null;}});this.addEventListener("DOMNodeRemoved",function(m){if(m.currentTarget!=this){return;}var k=this.parentNode;if(k.localName=="bindings"){k.removeEventListener("noderegister",this.$noderegister);var d=k.$amlNodes,g=0,c=d.length;for(;g<c;++g){delete d[g].$sort;}}else{delete k.$sort;}});this.addEventListener("DOMNodeInsertedIntoDocument",b);}).call(apf.BindingEachRule.prototype=new apf.BindingRule());apf.aml.setElement("each",apf.BindingEachRule);apf.BindingLoadRule=function(c,b){this.$init(b,apf.NODE_HIDDEN,c);};(function(){this.$attrExcludePropBind=apf.extend({get:1},this.$attrExcludePropBind);this.$propHandlers.get=function(b,c){delete this["c"+c];};}).call(apf.BindingLoadRule.prototype=new apf.BindingRule());apf.aml.setElement("load",apf.BindingLoadRule);apf.aml.setElement("insert",apf.BindingLoadRule);apf.BindingQuicksandRule=function(c,b){this.$init(b,apf.NODE_HIDDEN,c);};(function(){function getFilteredNodes(pNode){pNode=pNode||this.$parent;var attr,tmp,res=[],dataIDs=[],xmlNodes=pNode.$getDataNode("quicksand",pNode.xmlRoot,false,null,true),domNodes=pNode.$ext.childNodes,i=0,l=xmlNodes.length;if(!domNodes.length||!l){return res;}for(;i<l;++i){dataIDs.push(xmlNodes[i].getAttribute("a_id"));}for(i=0,l=domNodes.length;i<l;++i){if(!domNodes[i]||!(attr=domNodes[i].getAttribute("id"))){continue;}tmp=attr.split("|");tmp.pop();if(dataIDs.indexOf(tmp.join("|"))>-1){res.push(domNodes[i]);}}return res;}function nodeInFilter(node,filtered){var i=0,l=filtered.length,s=node.getAttribute("id");for(;i<l;++i){if(filtered[i].getAttribute("id")==s){return filtered[i];}}return null;}function quicksand(parent,customOptions){parent=this.$parent.$ext;var i,l,dest,src,offset,_self=this,coll=getFilteredNodes.call(this),parentOffset=apf.getAbsolutePosition(parent),offsets=[],callbackFunction=typeof(arguments[1])=="function"?arguments[1]:typeof arguments[2]=="function"?arguments[2]:apf.K,postCallback=function(){_self.dispatchEvent("afterquicksand");callbackFunction.call(_self);},options={steps:60,anim:apf.tween.easeInOutQuad,onfinish:postCallback,adjustHeight:true};apf.extend(options,customOptions);if(apf.isIE&&apf.isIE<7){parent.innerHTML="";for(i=0,l=coll.length;i<l;i++){parent.appendChild(coll[i]);}return;}var $source=parent.childNodes;var correctionOffset=[0,0];parent.style.height=parent.offsetHeight+"px";apf.tween.clearQueue(parent,true);for(i=0,l=$source.length;i<l;++i){src=$source[i];offsets[i]=apf.getAbsolutePosition(src,parent,false);}for(i=0,l=$source.length;i<l;++i){src=$source[i];with(src.style){position="absolute";margin="0";top=(offsets[i][1]-parentOffset[1])+"px";left=(offsets[i][0]-parentOffset[0])+"px";}}var $dest=parent.cloneNode(false);$dest.setAttribute("id","");for(i=0,l=coll.length;i<l;++i){$dest.appendChild(coll[i].cloneNode(true));coll[i].$offset=apf.getAbsolutePosition(coll[i]);}parent.parentNode.insertBefore($dest,parent);with($dest.style){zIndex=1;opacity=0;margin=0;position="absolute";top=parentOffset[1]-correctionOffset[1]+"px";left=parentOffset[0]-correctionOffset[0]+"px";}if(false){apf.tween.single(parent,{steps:options.steps,anim:options.anim,type:"height",from:parent.offsetHeight,to:$dest.offsetHeight});}var insets=[];for(i=0,l=$source.length;i<l;++i){src=$source[i];if(dest=nodeInFilter(src,coll)){offset=insets.shift()||offsets[i];options.tweens=[{type:"top",from:dest.$offset[1]-parentOffset[1],to:offset[1]-parentOffset[1]},{type:"left",from:dest.$offset[0]-parentOffset[0],to:offset[0]-parentOffset[0]},{type:"opacity",from:apf.getStyle(src,"opacity"),to:1}];if(apf.supportCSSAnim){options.tweens.push({type:"transform",subType:"scale",from:0,to:1});}apf.tween.multi(src,options);}else{options.tweens=[{type:"opacity",from:apf.getStyle(src,"opacity"),to:0}];if(apf.supportCSSAnim){options.tweens.push({type:"transform",subType:"scale",from:1,to:0});}insets.push(offsets[i]);apf.tween.multi(src,options);}}for(i=0,l=coll.length;i<l;++i){var item=coll[i];if(!nodeInFilter(item,$source)){dest=nodeInFilter(item,coll);options.tweens=[{type:"opacity",from:0,to:1}];if(!apf.isIE){}offset=apf.getAbsolutePosition(dest);dest=dest.cloneNode(true);with(dest.style){position="absolute";margin="0";top=(offset[1]-parentOffset[1])+"px";left=(offset[0]-parentOffset[0])+"px";opacity="0";transform="scale(.0)";}parent.appendChild(dest);apf.tween.multi(dest,options);}}}this.addEventListener("DOMNodeInsertedIntoDocument",function(e){var pNode=this;while(pNode&&pNode.$bindingRule){pNode=pNode.parentNode;}this.$parent=pNode;if(!pNode){return;}var _self=this;setTimeout(function(){quicksand.call(_self);});});}).call(apf.BindingQuicksandRule.prototype=new apf.BindingRule());apf.aml.setElement("quicksand",apf.BindingQuicksandRule);apf.bindings=function(c,b){this.$init(b||"bindings",apf.NODE_HIDDEN,c);this.$bindings=new apf.ruleList();this.$amlNodes={};};(function(){this.$smartbinding=null;this.register=function(b){if(b.localName=="smartbinding"){this.$smartbinding=b;this.$smartbinding.add(this);return;}if(!b.hasFeature(apf.__DATABINDING__)){return;}this.$amlNodes[b.$uniqueId]=b;if(!this.$amlLoaded){return;}if(!this.$bindings.$isCompiled){this.$cbindings=this.$bindings.compile();}b.$bindings=this.$bindings;b.$cbindings=this.$cbindings;b.$bindingsElement=this;b.dispatchEvent("bindingsload",{bindings:this.$bindings,compiled:this.$cbindings});this.dispatchEvent("noderegister",{amlNode:b});b.$checkLoadQueue();};this.unregister=function(b){this.$amlNodes[b.$uniqueId]=null;delete this.$amlNodes[b.$uniqueId];b.$bindingsElement=b.$bindings=b.$cbindings=false;b.dispatchEvent("bindingsunload",{bindings:this.$bindings,compiled:this.$cbindings});};this.reload=function(){for(var b in this.$amlNodes){this.$amlNodes[b].reload();}};this.addEventListener("DOMNodeInsertedIntoDocument",function(k){var c=this.childNodes;for(var g,d=0,b=c.length;d<b;d++){if(!(g=c[d]).$amlLoaded&&g.nodeType==1){g.dispatchEvent("DOMNodeInsertedIntoDocument");}}this.register(this.parentNode);for(var m in this.$amlNodes){this.register(this.$amlNodes[m]);}});}).call(apf.bindings.prototype=new apf.AmlElement());apf.ruleList=function(){this.$compiled={};};apf.ruleList.prototype={$isCompiled:false,getRule:function(c,g){var n=this[c];if(!n){return false;}for(var k,m,d=0,b=n.length;d<b;d++){m=n[d];if(!m.match){return m;}k=m.cmatch||m.compile("match",{injectself:true,xpathmode:2});if(k&&k(g)){return m;}}},compile:function(d){var o,k,q=this.$compiled,m=false;if(d){k=[];o=this[d];for(var n,g=0,b=o.length;g<b;g++){if(!(n=o[g]).match&&!n.value){continue;}k.push(n.match,n.value);if(!m&&n.value){m=n.hasaml||n.value.indexOf("<a:")>-1;}}q[d]=apf.lm.compileMatch(k);q[d].hasAml=m;return q;}for(d in this){if(d=="each"){continue;}o=this[d];if(o.dataType!=apf.ARRAY){continue;}k=[],m=false;for(var n,g=0,b=o.length;g<b;g++){if(!(n=o[g]).match&&!n.value){continue;}k.push(n.match,n.value);if(!m&&n.value){m=n.hasaml||n.value.indexOf("<a:")>-1;}}q[d]=apf.lm.compileMatch(k);q[d].hasAml=m;}this.$isCompiled=true;return q;},getRuleIndex:function(c,b){var d=this[c][b];if(d.value){if(!d.cvalue){d.compile("value");}}else{if(d.match){if(!d.cmatch){d.compile("match");}}}return d;},getDataNode:function(b,q,o,k,s){var m,g,d,c,n,r=this[b];if(!r){return;}for(n,m=0,g=r.length;m<g;m++){n=r[m];d=n.cvaluematch;if(!d){if(n.match&&n.value&&n.value.match(/^\[.*\]$/)){n.valuematch="{_n = "+n.match+"; %[child::"+n.value.substr(1,n.value.length-2).split("|").join("|child::")+"]}";}else{n.valuematch=n.match||n.value;}d=n.$compile("valuematch",{xpathmode:s?4:3,injectself:n.match?true:false});}if(d&&(c=d(q,o))){if(k){k.push(n);}return c;}}return false;}};apf.aml.setElement("bindings",apf.bindings);apf.BindingSeriesRule=function(c,b){this.$init(b||"series",apf.NODE_HIDDEN,c);};(function(){this.$attrExcludePropBind=apf.extend({formula:1},this.$attrExcludePropBind);this.$propHandlers.formula=function(b,c){delete this["c"+c];};}).call(apf.BindingSeriesRule.prototype=new apf.BindingRule());apf.aml.setElement("series",apf.BindingSeriesRule);apf.AmlConfig=function(){this.$init("config",apf.NODE_VISIBLE);};(function(){this.focussable=false;this.$canLeechSkin=true;this.$draw=function(){this.$ext=this.$int=this.$getExternal(this.$isLeechingSkin?this.localName:"main");};}).call(apf.AmlConfig.prototype=new apf.Presentation());apf.aml.setElement("config",apf.AmlConfig);apf.browser=function(c,b){this.$init(b||"browser",apf.NODE_VISIBLE,c);};(function(){this.implement(apf.DataAction,apf.StandardBinding);this.$supportedProperties.push("value","src");this.$propHandlers.src=this.$propHandlers.value=function(value,force){try{this.$browser.src=value||"about:blank";}catch(e){this.$browser.src="about:blank";}};this.$propHandlers.border=apf.Presentation.prototype.$propHandlers.border;this.getValue=function(){return this.value||this.src;};this.getURL=function(){return this.$browser.src;};this.back=function(){this.$browser.contentWindow.history.back();};this.forward=function(){this.$browser.contentWindow.history.forward();};this.reload=function(){this.$browser.src=this.$browser.src;};this.print=function(){this.$browser.contentWindow.print();};this.runCode=function(str,noError){if(noError){try{this.$browser.contentWindow.eval(str);}catch(e){}}else{this.$browser.contentWindow.eval(str);}};this.$draw=function(parentNode){if(!parentNode){parentNode=this.$pHtmlNode;}if(apf.cannotSizeIframe){this.$ext=parentNode.appendChild(document.createElement("DIV")).appendChild(document.createElement("<iframe frameborder='0'></iframe>")).parentNode;this.$ext.style.width="100px";this.$ext.style.height="100px";this.$browser=this.$ext.firstChild;this.$browser.style.width="100%";this.$browser.style.height="100%";this.$browser.frameBorder=0;}else{this.$ext=parentNode.appendChild(document.createElement("iframe"));this.$ext.style.width="100px";this.$ext.style.height="100px";this.$browser=this.$ext;}this.$ext.className="apfbrowser";var _self=this;apf.addListener(this.$browser,"load",function(){_self.dispatchEvent("load");});apf.addListener(this.$browser,"error",function(){_self.dispatchEvent("error");});this.$ext.host=this;};}).call(apf.browser.prototype=new apf.GuiElement());apf.aml.setElement("browser",apf.browser);apf.submit=function(c,b){this.$init(b||"submit",apf.NODE_VISIBLE,c);};apf.trigger=function(c,b){this.$init(b||"trigger",apf.NODE_VISIBLE,c);};apf.reset=function(c,b){this.$init(b||"reset",apf.NODE_VISIBLE,c);};apf.button=function(c,b){this.$init(b||"button",apf.NODE_VISIBLE,c);};(function(){this.$useExtraDiv;this.$childProperty="caption";this.$inited=false;this.$isLeechingSkin=false;this.$canLeechSkin=true;this.$focussable=apf.KEYBOARD;this.value=null;this.$init(function(){var q,k=this,g;this.$propHandlers["default"]=function(s){if(parseInt(s)!=s){s=apf.isTrue(s)?1:0;}this["default"]=parseInt(s);if(!this.focussable&&s||q){this.setAttribute("focussable",q=s);}if(g){g.removeEventListener("focus",o);g.removeEventListener("blur",m);}if(!s){return;}var r=this.parentNode;while(r&&!r.focussable&&s--){r=r.parentNode;}if(r){r.addEventListener("focus",o);r.addEventListener("blur",m);}};function o(r){if(r.defaultButtonSet||r.returnValue===false){return;}r.defaultButtonSet=true;if(this.$useExtraDiv){k.$ext.appendChild(apf.button.$extradiv);}k.$setStyleClass(k.$ext,k.$baseCSSname+"Default");if(r.srcElement!=k&&k.$focusParent){k.$focusParent.addEventListener("keydown",n);}}function m(r){if(this.$useExtraDiv&&apf.button.$extradiv.parentNode==k.$ext){k.$ext.removeChild(apf.button.$extradiv);}k.$setStyleClass(k.$ext,"",[k.$baseCSSname+"Default"]);if(r.srcElement!=k&&k.$focusParent){k.$focusParent.removeEventListener("keydown",n);}}function n(s){var t;var r=apf.document.activeElement;if(r){if(r.hasFeature(apf.__MULTISELECT__)){return;}t=r.multiline;}if(!k.$ext.onmouseup){return;}if(t&&t!="optional"&&s.keyCode==13&&s.ctrlKey||(!t||t=="optional")&&s.keyCode==13&&!s.ctrlKey&&!s.shiftKey&&!s.altKey){apf.preventDefault(s.htmlEvent);k.$ext.onmouseup(s.htmlEvent,true);}}this.addEventListener("focus",o);this.addEventListener("blur",m);this.$enable=function(){if(this["default"]){o({});if(apf.document.activeElement){apf.document.activeElement.focus(true);}}if(this.state&&this.value){this.$setState("Down",{});}else{if(this.$mouseOver){this.$updateState({},"mouseover");}else{this.$doBgSwitch(1);}}};this.$disable=function(){if(this["default"]){m({});}this.$doBgSwitch(4);this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Over",this.$baseCSSname+"Down"]);};});this.$booleanProperties.state=true;this.$supportedProperties.push("icon","value","tooltip","state","color","caption","action","target","default","submenu","hotkey");this.$propHandlers.icon=function(g){if(!this.oIcon){return;}if(g){this.$setStyleClass(this.$ext,this.$baseCSSname+"Icon");}else{this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Icon"]);}apf.skins.setIcon(this.oIcon,g,this.iconPath);};this.$propHandlers.value=function(g){if(!this.state&&!this.submenu){return;}if(g===undefined){g=!this.value;}this.value=g;if(this.value){this.$setState("Down",{});}else{this.$setState("Out",{});}};this.$propHandlers.state=function(g){if(g){this.$setStateBehaviour(this.value);}else{this.$setNormalBehaviour();}};this.$propHandlers.color=function(g){if(this.oCaption){this.oCaption.parentNode.style.color=g;}};this.$propHandlers.caption=function(g){if(!this.oCaption){return;}if(g){this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Empty"]);}else{this.$setStyleClass(this.$ext,this.$baseCSSname+"Empty");}if(this.oCaption.nodeType==1){this.oCaption.innerHTML=String(g||"").trim();}else{this.oCaption.nodeValue=String(g||"").trim();}};this.$propHandlers.hotkey=function(k){if(this.$hotkey){apf.setNodeValue(this.$hotkey,k);}if(this.$lastHotkey){apf.removeHotkey(this.$lastHotkey);}if(k){this.$lastHotkey=k;var g=this;apf.registerHotkey(k,function(){g.$setState("Over",{});$setTimeout(function(){g.$setState("Out",{});},200);if(g.$clickHandler&&g.$clickHandler()){g.$updateState(e||event,"click");}else{g.dispatchEvent("click");}});}if(this.tooltip){apf.GuiElement.propHandlers.tooltip.call(this,this.tooltip);}};function b(n){return;var g=n.keyCode;var k,m=apf.getChildNumber(this);if(g==37){k=m==0?this.parentNode.childNodes.length-1:m-1;this.parentNode.childNodes[k].dispatchEvent("mouseover");}else{if(g==39){k=(m>=this.parentNode.childNodes.length-1)?0:m+1;this.parentNode.childNodes[k].dispatchEvent("mouseover");}}}function d(k){var m=self[this.submenu],g;this.value=!this.value;if(this.value){this.$setState("Down",{});}if(!this.value){m.hide();this.$setState("Over",{},"toolbarover");if(g=this.parentNode.$button1){g.$setState("Over",{},"toolbarover");}this.parentNode.menuIsPressed=false;if(this.parentNode.hasMoved){this.value=false;}if(apf.hasFocusBug){apf.window.$focusfix();}return false;}this.parentNode.menuIsPressed=this;m.display(null,null,false,this,null,null,this.$ext.offsetWidth-2);this.parentNode.hasMoved=false;if(k){apf.stopPropagation(k.htmlEvent);}return false;}function c(){var k=this.parentNode.menuIsPressed;if(!k||k==this){return;}var m=self[this.submenu];if(m.getAttribute("pinned")){return;}k.setValue(false);var g=self[k.submenu];g.$propHandlers.visible.call(g,false,true);this.setValue(true);this.parentNode.menuIsPressed=this;var n=apf.getAbsolutePosition(this.$ext,m.$ext.offsetParent);m.display(n[0],n[1]+this.$ext.offsetHeight,true,this,null,null,this.$ext.offsetWidth-2);this.$focus();this.parentNode.hasMoved=true;return false;}this.$propHandlers.submenu=function(g){if(!g){if(this.value&&this.parentNode){d.call(this);}this.$focussable=true;this.$setNormalBehaviour();this.removeEventListener("mousedown",d);this.removeEventListener("mouseover",c);this.removeEventListener("keydown",b,true);return;}this.$focussable=false;this.$setStateBehaviour();this.addEventListener("mousedown",d);this.addEventListener("mouseover",c);this.addEventListener("keydown",b,true);};this.setValue=function(g){this.setProperty("value",g,false,true);};this.showMenu=function(){if(this.submenu&&!this.value){d.call(this);}};this.hideMenu=function(){if(this.submenu&&this.value){d.call(this);}};this.setCaption=function(g){this.setProperty("caption",g,false,true);};this.setIcon=function(g){this.setProperty("icon",g,false,true);};this.$setStateBehaviour=function(g){this.value=g||false;this.isBoolean=true;this.$setStyleClass(this.$ext,this.$baseCSSname+"Bool");if(this.value){this.$setStyleClass(this.$ext,this.$baseCSSname+"Down");this.$doBgSwitch(this.states.Down);}};this.$setNormalBehaviour=function(){this.value=null;this.isBoolean=false;this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Bool"]);};this.$setState=function(m,o,n){var g=this.parentNode;if(n&&this.dispatchEvent(n,{htmlEvent:o})===false){return;}if(g&&g.$button2&&g.$button2.value&&!this.submenu){return;}this.$doBgSwitch(this.states[m]);var k=this.$baseCSSname;this.$setStyleClass(this.$ext,(m!="Out"?k+m:""),[(this.value?"":k+"Down"),k+"Over"]);if(this.submenu){k=this.$baseCSSname+"menu";this.$setStyleClass(this.$ext,(m!="Out"?k+m:""),[(this.value?"":k+"Down"),k+"Over"]);}};this.$clickHandler=function(){if(this.isBoolean&&!this.submenu){this.setProperty("value",!this.value);return true;}};this.$submenu=function(g,k){if(g){this.setValue(false);this.$setState("Out",{},"mouseout");this.parentNode.menuIsPressed=false;}};this.addEventListener("$skinchange",function(g){if(this.tooltip){apf.GuiElement.propHandlers.tooltip.call(this,this.tooltip);}});this.$draw=function(){var k,g=(k=this.parentNode)&&k.parentNode.localName=="toolbar";if(g){if(typeof this.focussable=="undefined"){this.focussable=false;}this.$focussable=apf.KEYBOARD;}this.$ext=this.$getExternal();this.oIcon=this.$getLayoutNode("main","icon",this.$ext);this.oCaption=this.$getLayoutNode("main","caption",this.$ext);this.$useExtraDiv=apf.isTrue(this.$getOption("main","extradiv"));if(!apf.button.$extradiv&&this.$useExtraDiv){(apf.button.$extradiv=document.createElement("div")).className="extradiv";}if(this.localName=="submit"){this.action="submit";}else{if(this.localName=="reset"){this.action="reset";}}this.$setupEvents();};this.addEventListener("$skinchange",function(){if(this.caption){this.$propHandlers.caption.call(this,this.caption);}if(this.icon){this.$propHandlers.icon.call(this,this.icon);}this.$updateState({reset:1});});this.addEventListener("click",function(m){var k=this.action;if(!k){k=this.localName;}var g=this;$setTimeout(function(){(apf.button.actions[k]||apf.K).call(g);});});}).call(apf.button.prototype=new apf.BaseButton());apf.submit.prototype=apf.trigger.prototype=apf.reset.prototype=apf.button.prototype;apf.aml.setElement("submit",apf.submit);apf.aml.setElement("trigger",apf.trigger);apf.aml.setElement("reset",apf.reset);apf.aml.setElement("button",apf.button);apf.submit.action=apf.trigger.actions=apf.reset.actions=apf.button.actions={undo:function(g){var d;if(this.target&&self[this.target]){d=self[this.target].localName=="actiontracker"?self[this.target]:self[this.target].getActionTracker();}else{var b,c=this;while(c.parentNode){b=(c=c.parentNode).$at;}}(d||apf.window.$at)[g||"undo"]();},redo:function(){apf.button.actions.undo.call(this,"redo");},remove:function(){if(this.target&&self[this.target]){self[this.target].remove();}},add:function(){if(this.target&&self[this.target]){self[this.target].add();}},rename:function(){if(this.target&&self[this.target]){self[this.target].startRename();}},submit:function(k){var b,c;var d=this.target&&self[this.target]?self[this.target]:this.parentNode;if(d.$isModel){c=d;}else{if(!d.$validgroup){d.$validgroup=d.validgroup?self[d.validgroup]:new apf.ValidationGroup();}b=d.$validgroup;if(!b.childNodes.length){b.childNodes=d.childNodes.slice();}function g(n){for(var q,o=0,m=n.length;o<m;o++){q=n[o];if(q.getModel){c=q.getModel();if(c){return false;}}if(q.childNodes.length){if(g(q.childNodes)===false){return false;}}}}g(d.childNodes);if(!c){c=apf.globalModel;if(!c){return;}}}if(k){c.reset();return;}if(b&&!b.isValid()){return;}c.submit();},reset:function(){apf.button.actions.submit.call(this,true);},ok:function(){var b;if(this.target){b=self[this.target];}else{var b=this.parentNode;while(b&&!b.hasFeature(apf.__TRANSACTION__)){b=b.parentNode;}if(b&&!b.hasFeature(apf.__TRANSACTION__)){return;}}if(b.commit()&&b.close){b.close();}},cancel:function(){var b;if(this.target){b=self[this.target];}else{var b=this.parentNode;while(b&&!b.hasFeature(apf.__TRANSACTION__)){b=b.parentNode;}if(b&&!b.hasFeature(apf.__TRANSACTION__)){return;}}b.rollback();if(b.close){b.close();}},apply:function(){var b;if(this.target){b=self[this.target];}else{var b=this.parentNode;while(b&&!b.hasFeature(apf.__TRANSACTION__)){b=b.parentNode;}if(b&&!b.hasFeature(apf.__TRANSACTION__)){return;}}if(b.autoshow){b.autoshow=-1;}if(b.commit(true)){b.begin("update");}},close:function(){var b=this.target&&self[this.target]?self[this.target]:this.parentNode;while(b&&!b.close){b=b.parentNode;}if(b&&b.close){b.close();}}};apf.checkbox=function(c,b){this.$init(b||"checkbox",apf.NODE_VISIBLE,c);};(function(){this.implement(apf.DataAction);this.$focussable=apf.KEYBOARD;this.checked=false;this.$values=[1,0];this.$booleanProperties.checked=true;this.$supportedProperties.push("value","checked","label","values");this.$propHandlers.value=function(b){b=(typeof b=="string"?b.trim():b);this.checked=(typeof b!="undefined"&&b!==null&&b.toString()==this.$values[0].toString());if(this.checked){apf.setStyleClass(this.$ext,this.$baseCSSname+"Checked");}else{apf.setStyleClass(this.$ext,"",[this.$baseCSSname+"Checked"]);}};this.$propHandlers.checked=function(b){if(!this.$values){if(this.getAttribute("values")){this.$propHandler.values.call(this,this.getAttribute("values"));}else{this.$values=[true,false];}}this.setProperty("value",this.$values[b?0:1]);};this.$propHandlers.label=function(c){if(!this.$ext){return;}var b=this.$getLayoutNode("main","label",this.$ext);if(!b){return;}if(b.nodeType==1){b.innerHTML=c;}else{b.nodeValue=c;}};this.$propHandlers.values=function(b){this.$values=typeof b=="string"?b.split("|"):(b||[1,0]);this.$propHandlers.value.call(this,this.value);};this.setValue=function(b){if(!this.$values){return;}this.setProperty("value",b,false,true);};this.getValue=function(){return this.xmlRoot?this.$values[this.checked?0:1]:this.value;};this.check=function(){this.setProperty("value",this.$values[0],false,true);};this.uncheck=function(){this.setProperty("value",this.$values[1],false,true);};this.addEventListener("$clear",function(){this.setProperty("value",this.$values[1]);});this.$enable=function(){if(this.$input){this.$input.disabled=false;}this.$doBgSwitch(1);};this.$disable=function(){if(this.$input){this.$input.disabled=true;}this.$doBgSwitch(4);};this.$setState=function(b,d,c){this.$doBgSwitch(this.states[b]);this.$setStyleClass(this.$ext,(b!="Out"?this.$baseCSSname+b:""),[this.$baseCSSname+"Down",this.$baseCSSname+"Over"]);this.state=b;if(c){this.dispatchEvent(c,{htmlEvent:d});}};this.$clickHandler=function(){this.change(this.$values[(!this.checked)?0:1]);if(this.validate){this.validate(true);}return true;};this.$draw=function(){this.$ext=this.$getExternal();this.$input=this.$getLayoutNode("main","input",this.$ext);this.$notfromext=this.$input&&this.$input!=this.$ext;this.$setupEvents();};this.$childProperty="label";this.addEventListener("$skinchange",function(){if(this.label){this.$propHandlers.label.call(this,this.label);}});}).call(apf.checkbox.prototype=new apf.BaseButton());apf.aml.setElement("checkbox",apf.checkbox);apf.comment=function(){this.$init("comment",apf.NODE_HIDDEN);};apf.comment.prototype=new apf.AmlComment();apf.aml.setElement("comment",apf.comment);apf.contextmenu=function(){this.$init("contextmenu",apf.NODE_HIDDEN);};(function(){this.$amlNodes=[];this.$attrExcludePropBind=apf.extend({match:1},this.$attrExcludePropBind);this.register=function(b){if(!b.contextmenus){b.contextmenus=[];}b.contextmenus.push(this);};this.unregister=function(b){b.contextmenus.remove(this);};this.addEventListener("DOMNodeInsertedIntoDocument",function(b){this.register(this.parentNode);});}).call(apf.contextmenu.prototype=new apf.AmlElement());apf.aml.setElement("contextmenu",apf.contextmenu);apf.datagrid=function(c,b){this.$init(b||"datagrid",apf.NODE_VISIBLE,c);this.$headings=[],this.$cssRules=[];this.$lastOpened={};this.$editors={};this.$dynCssClasses=[];};(function(){var g=1<<1,q=1<<2,o=1<<3,k=1<<4,m=this.$treeState;this.implement(apf.DataAction);this.bufferselect=false;this.$useTable=false;this.$focussable=true;this.$isWindowContainer=-1;this.$widthdiff=0;this.$defaultwidth=0;this.$useiframe=0;this.$needsDepth=true;this.canrename=false;this.$booleanProperties.iframe=true;this.$mode=0;this.$propHandlers.mode=function(r){if("check|radio".indexOf(r)>-1){if(!this.hasFeature(apf.__MULTICHECK__)){this.implement(apf.MultiCheck);}this.addEventListener("afterrename",d);this.multicheck=r=="check";this.$mode=this.multicheck?1:2;}else{this.removeEventListener("afterrename",d);this.$mode=0;}};function d(){}this.$propHandlers.options=function(t){for(var s=0,r=this.$headings.length;s<r;s++){this.$headings[s].setAttribute("options",t);}};function c(s,t){for(var r=0;r<s.length;r++){if(!s[r][1]){continue;}if(apf.isIE){(t||window).document.styleSheets[0].addRule(s[r][0],s[r][1]);}else{(t||window).document.styleSheets[0].insertRule(s[r][0]+" {"+s[r][1]+"}",0);}}}function b(){var r=(this.current||this.$selected),s=this.$container;s.scrollTop=(r.offsetTop)-21;}this.$getCaptionElement=function(){if(!this.$selected){return false;}var r=this.$head.childNodes,t=this.$selected.childNodes,s=0;nodeIter=t[s];while(nodeIter){if(nodeIter.nodeType!=1){nodeIter=nodeIter.nextSibling;continue;}h=apf.all[r[s].getAttribute("hid")];if(h.tree||h.rename){return this.$getLayoutNode(h.tree?"treecell":"cell","caption",nodeIter)||nodeIter;}s++;nodeIter=nodeIter.nextSibling;}throw new Error("Datagrid without rename column specified");};this.$focus=function(){if(!this.$ext||(apf.isIE&&this.$useiframe&&this.cssfix)){return;}this.$setStyleClass(this.$ext,this.$baseCSSname+"Focus");if(this.oDoc){this.$setStyleClass(this.oDoc.documentElement,this.$baseCSSname+"Focus");}};this.$blur=function(){if(!this.$ext||(apf.isIE&&this.$useiframe&&this.cssfix)){return;}this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Focus"]);if(this.oDoc){this.$setStyleClass(this.oDoc.documentElement,"",[this.$baseCSSname+"Focus"]);}n.call(this);};this.addEventListener("bindingsload",this.$loaddatabinding=function(x){var A=x.bindings.column;if(!A||!A.length){return;}this.$headings=A;var u=0,w=false;for(var t,s=0,r=A.length;s<r;s++){t=A[s];if(!t.$isPercentage){u+=parseFloat(t.$width)||0;}else{w=true;}}if(!w){this.$isFixedGrid=true;this.$setStyleClass(this.$ext,"fixed");if(this.$useiframe){this.$setStyleClass(this.oDoc.documentElement,"fixed");}}else{}if(u>0&&!this.$isFixedGrid){var y=u;this.$cssRules.push(["."+this.$baseCSSname+" .row"+this.$uniqueId,"padding-right:"+y+"px;margin-right:-"+y+"px"]);this.$container.style.paddingRight=this.$head.style.paddingRight=y+"px";}this.$fixed=u;this.$first=0;this.$withContainer=x.bindings.description?true:false;c(this.$cssRules,window);if(this.$useiframe){c(this.$cssRules,this.oWin);}});this.$initNode=function(F,t,D,A){this.$getNewContext("item");var u=this.$getLayoutNode("item");u.setAttribute("id",D);u.setAttribute("class",u.getAttribute("class")+" "+m[t]+" item"+this.$uniqueId);this.$setStyleClass(this.$getLayoutNode("item","container"),m[t]);u.setAttribute("ondblclick","var o = apf.lookup("+this.$uniqueId+");o.choose(null, true);"+(this.$withContainer?"o.slideToggle(this, null, true);":"")+(this.celledit&&!this.namevalue?"o.startRename(null, null, true);":""));if(this.hasFeature(apf.__DRAGDROP__)){u.setAttribute("onmouseout","this.hasPassedDown = false;");u.setAttribute("onmousedown","var o = apf.lookup("+this.$uniqueId+");                var xmlNode = apf.xmldb.findXmlNode(this);                 var isSelected = o.isSelected(xmlNode);                 this.hasPassedDown = true;                 if (!o.hasFeature(apf.__DRAGDROP__) || !isSelected && !event.ctrlKey)                     o.select(this, event.ctrlKey, event.shiftKey, -1);"+(this.cellselect||this.namevalue?"o.selectCell(event, this, isSelected);":""));u.setAttribute("onmouseup","if (!this.hasPassedDown) return;                var o = apf.lookup("+this.$uniqueId+");                 var xmlNode = apf.xmldb.findXmlNode(this);                 var isSelected = o.isSelected(xmlNode);                 if (o.hasFeature(apf.__DRAGDROP__))                     o.select(this, event.ctrlKey, event.shiftKey, -1);");}else{u.setAttribute("onmousedown","var o = apf.lookup("+this.$uniqueId+");                var wasSelected = o.$selected == this;                o.select(this, event.ctrlKey, event.shiftKey, -1);"+(this.cellselect||this.namevalue?"o.selectCell(event, this, wasSelected);":""));}for(var E,G,B,y=0;y<this.$headings.length;y++){B=this.$headings[y];if(B.tree&&B.check){E="treecheckcell";this.$getNewContext("treecheckcell");G=this.$getLayoutNode("treecheckcell");var s=this.$getLayoutNode("treecheckcell","openclose");s.setAttribute("style","margin-left:"+(((A||0))*15+4)+"px;");s.setAttribute("onmousedown","var o = apf.lookup("+this.$uniqueId+");                    o.slideToggle(this, null, null, true);                    event.cancelBubble = true;                    apf.window.$mousedown(event);");s.setAttribute("ondblclick","event.cancelBubble = true");}else{if(B.tree){E="treecell";this.$getNewContext("treecell");G=this.$getLayoutNode("treecell");var s=this.$getLayoutNode("treecell","openclose");s.setAttribute("style","margin-left:"+(((A||0))*15+4)+"px;");s.setAttribute("onmousedown","var o = apf.lookup("+this.$uniqueId+");                    o.slideToggle(this, null, null, true);                    event.cancelBubble = true;                    apf.window.$mousedown(event);");s.setAttribute("ondblclick","event.cancelBubble = true");}else{E=B.check?"checkcell":"cell";this.$getNewContext(E);G=this.$getLayoutNode(E);}}if(this.$mode&&B.check){var H=this.$getLayoutNode(E,"check");if(H){H.setAttribute("onmousedown","var o = apf.lookup("+this.$uniqueId+");                        o.checkToggle(this, true);o.$skipSelect = true;");if(apf.isTrue(this.$applyBindRule("checked",F))){this.$checkedList.push(F);this.$setStyleClass(u,"checked");}else{if(this.isChecked(F)){this.$setStyleClass(u,"checked");}}}else{return false;}}apf.setStyleClass(G,B.$className);if(B.css){apf.setStyleClass(G,(apf.lm.compile(B.css))(F));}if(B.icon){var x=this.$getLayoutNode(E,"caption",u.appendChild(G));x=(x.nodeType==1&&x||x.parentNode);x.setAttribute("style","background-image:url("+apf.getAbsolutePath(this.iconPath,((B.cicon||B.$compile("icon",{nostring:true}))(F)||""))+");");this.$setStyleClass(x,"iconCell",[]);}if(B.value){if(!B.cvalue2){B.$compile("value",{nostring:true});if(B.value){B.cvalue2.hasAml=B.value.indexOf("<a:")>-1;}}if(B.cvalue2.hasAml){var r=(this.$amlBindQueue||(this.$amlBindQueue={}));var w=this.$getLayoutNode(E,"caption",u.appendChild(G));w.setAttribute("id","placeholder_"+this.$uniqueId+"_"+((r.column||(r.column=[])).push(F)-1));apf.setNodeValue(w,"&nbsp");}else{apf.setNodeValue(this.$getLayoutNode(E,"caption",u.appendChild(G)),B.cvalue2(F)||"&nbsp");}}}if(this.$bindings&&this.$bindings.color){var C=this.$getDataNode("color",F);this.$setStyleClass(u,C?"highlight":null,C?["highlight"]:null);}var I=this.$applyBindRule("css",F);if(I){this.$setStyleClass(u,I);if(I){this.$dynCssClasses.push(I);}}return u;};this.$updateNode=function(B,A){if(!A){return;}var r=this.$head.childNodes,t=A.childNodes,C,s;if(!this.namevalue&&this.$curBtn){s=this.$curBtn.parentNode;}var w,x,u=0;w=t[0];while(w){if(w.nodeType!=1){w=w.nextSibling;continue;}x=apf.all[r[u].getAttribute("hid")];C=this.$getLayoutNode(x.tree?"treecell":"cell","caption",w)||w;if(x.css){apf.setStyleClass(C,(apf.lm.compile(x.css))(B));}if(x.tree){}if(x.value){if(!x.cvalue2){x.$compile("value",{nostring:true});if(x.value){x.cvalue2.hasAml=x.value.indexOf("<a:")>-1;}}if(!x.cvalue2.hasAml){C.innerHTML=x.cvalue2(B)||"";}}if(x.icon){(C.nodeType==1&&C||C.parentNode).style.backgroundImage="url("+apf.getAbsolutePath(this.iconPath,((x.cicon||x.$compile("icon",{nostring:true}))(B)||""))+")";}u++;w=w.nextSibling;}if(this.$bindings&&this.$bindings.color){var y=this.$getDataNode("color",B);this.$setStyleClass(A,y?"highlight":null,y?["highlight"]:null);}var D=this.$applyBindRule("css",B);if(D||this.$dynCssClasses.length){this.$setStyleClass(A,D,this.$dynCssClasses);if(D&&!this.$dynCssClasses.contains(D)){this.$dynCssClasses.push(D);}}};this.$dblclick=function(A){var w=this,E,r;while(!(E=A.getAttribute(apf.xmldb.htmlIdTag))||E.indexOf("|")==-1){A=(r=A).parentNode;if(A.nodeType!=1){return;}}if(this.$lastEditor&&this.$lastEditor[3]==A){return;}var K,s=r.className.match(/(col\d+)/)[1];for(var J=0;J<this.$headings.length;J++){if(this.$headings[J].$className==s){K=this.$headings[J];break;}}if(!K.editor){return;}var t=apf.xmldb.getNode(A);var I=K.tree?this.$getLayoutNode("cell","caption",r):r;var D,x=K.editor;var y=apf.lm.compile(x,{xpathmode:2});var G=I.childNodes;for(var J=0,H=G.length;J<H;J++){if(!G[J].host){if(G[J].nodeType==1){G[J].style.display="none";}else{this.$lastTextValue=G[J].nodeValue;G[J].nodeValue="";}}}if(y.type==2){if(!this.$editors[x]){var F=apf.namespaces[apf.ns.aml].elements[x];var L={htmlNode:I,style:"position:relative;z-index:10000",value:"[{"+this.id+".selected}::"+(v=K.value).substr(1,v.length-2)+"]",focussable:false};if(!K.tree){L.width="100%-3";}if(F.prototype.hasFeature(apf.__MULTISELECT__)){L.caption=K.eachcaption||"[text()]";L.eachvalue=K.eachvalue;var u;if(u=K.getAttribute("model")){L.model=u;L.each=K.each;}else{L.model="{"+this.id+".selected}";L.each=K.each;}}if(K.skin){L.skin=K.skin;}D=this.$editors[x]=new F(L);var B=apf.getBox(apf.getStyle(D.$ext,"margin"));if(B[1]||B[3]){D.setAttribute("width","100%+2-"+(B[1]+B[3]));}D.addEventListener("blur",function(){n.call(w);});D.parentNode=this;D.realtime=false;D.$focusParent=this;D.setAttribute("focussable","true");D.addEventListener("keydown",function(M){if(M.keyCode==13){n.call(w);w.$focus();}else{if(M.keyCode==27){D.removeAttribute("value");n.call(w);}}});D.$executeAction=function(){this.parentNode.$executeAction.apply(this.parentNode,arguments);};}else{D=this.$editors[x];if(D.hasFeature(apf.__MULTISELECT__)&&!K.model){D.setAttribute("value","[{"+this.id+".selected}::"+(v=K.value).substr(1,v.length-2)+"]");}D.setProperty("visible",true);I.appendChild(D.$ext);D.setAttribute("width",K.tree?"":"100%-3");}}else{var C=y.call(this,this.xmlRoot);if(C.localName=="template"){}else{}}if(D.localName=="textbox"){D.select();}D.focus();D.$focus();this.$setStyleClass(A,"editing");this.$lastEditor=[D,I,t,A,this.getActionTracker().undolength];};this.addEventListener("mousedown",function(r){if(this.$lastEditor&&!apf.isChildOf(this.$lastEditor[1],r.htmlEvent.srcElement||r.htmlEvent.target,true)){n.call(this);}});var n=function(w){if(this.$lastEditor){var t=this.$lastEditor;this.$lastEditor=null;if(t[0].hasFeature(apf.__MULTISELECT__)){t[0].$clearDynamicProperty("value");}t[0].setProperty("visible",false);var s=t[1].childNodes;for(var u=0,r=s.length;u<r;u++){if(!s[u].host){if(s[u].nodeType==1){s[u].style.display="";}else{if(!t[0].value){s[u].nodeValue=this.$lastTextValue;}}}}this.$setStyleClass(t[3],"",["editing"]);this.focus();}};this.addEventListener("beforeselect",n);this.getColumn=function(r){return this.$headings[r||this.$lastcol||0];};this.resizeColumn=function(t,s){var r=this.$headings[t];r.resize(s);};this.hideColumn=function(s){var r=this.$headings[s];r.hide();};this.showColumn=function(s){var r=this.$headings[s];r.show();};this.sortColumn=function(r){var s=this.$headings[nr];s.sort();};this.moveColumn=function(t,s){var r=this.$headings[nr];r.move(s);};this.$draw=function(){this.$drawBase();var r=this;this.$ext.onmousedown=function(u){r.dispatchEvent("mousedown",{htmlEvent:u||event});};this.$head=this.$getLayoutNode("main","head",this.$ext);this.$pointer=this.$getLayoutNode("main","pointer",this.$ext);if(this.$head.firstChild){this.$head.removeChild(this.$head.firstChild);}if(this.$container.firstChild){this.$container.removeChild(this.$container.firstChild);}var s=this.$widthdiff=this.$getOption("main","widthdiff")||0;this.$defaultwidth=this.$getOption("main","defaultwidth")||"100";this.$useiframe=apf.isIE&&(apf.isTrue(this.$getOption("main","iframe"))||this.iframe);if(this.$useiframe&&!this.oIframe){var t=this.$container.className;this.oIframe=this.$container.appendChild(document.createElement(apf.isIE?"<iframe frameborder='0'></iframe>":"iframe"));this.oIframe.frameBorder=0;this.oWin=this.oIframe.contentWindow;this.oDoc=this.oWin.document;this.oDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">                <html xmlns="http://www.w3.org/1999/xhtml">                    <head><script>                        apf = {                            lookup : function(uid){                                return window.parent.apf.lookup(uid);                            },                            Init : {add:function(){},run:function(){}}                        };<\/script>                    </head>                    <body></body>                </html>');this.$container=this.oDoc.body;this.$container.className=t;this.oDoc.documentElement.className=this.$ext.className;apf.skins.loadCssInWindow(this.skinName,this.oWin,this.mediaPath,this.iconPath);if(apf.isIE){this.$setStyleClass(this.oDoc.documentElement,this.$baseCSSname+"Focus");}apf.convertIframe(this.oIframe,true);if(apf.getStyle(this.oDoc.documentElement,"overflowY")=="auto"){this.oIframe.onresize=function(){r.$head.style.marginRight=r.oDoc.documentElement.scrollHeight>r.oDoc.documentElement.offsetHeight?"16px":"0";};this.addEventListener("afterload",this.oIframe.onresize);this.addEventListener("xmlupdate",this.oIframe.onresize);}this.oDoc.documentElement.onscroll=function(){if(r.$isFixedGrid){r.$head.scrollLeft=r.oDoc.documentElement.scrollLeft;}};}else{if(apf.getStyle(this.$container,"overflowY")=="auto"){this.$resize=function(){r.$head.style.marginRight=r.$container.scrollHeight>r.$container.offsetHeight?"16px":"0";};apf.layout.setRules(this.$ext,this.$uniqueId+"_datagrid","var o = apf.all["+this.$uniqueId+"];                     if (o) o.$resize()");apf.layout.queue(this.$ext);this.addEventListener("afterload",this.$resize);this.addEventListener("xmlupdate",this.$resize);}this.$container.onscroll=function(){if(r.$isFixedGrid){r.$head.scrollLeft=r.$container.scrollLeft;}};}this.$container[this.clickedit?"onmousedown":"ondblclick"]=function(u){if(!u){u=event;}r.$dblclick(u.srcElement||u.target);};};this.$destroy=function(){this.$ext.onclick=this.$container.onresize=null;apf.layout.removeRule(this.$container,"dg"+this.$uniqueId);apf.layout.activateRules(this.$container);};}).call(apf.datagrid.prototype=new apf.BaseTree());apf.aml.setElement("datagrid",apf.datagrid);apf.aml.setElement("description",apf.BindingRule);apf.aml.setElement("color",apf.BindingRule);apf.aml.setElement("contents",apf.BindingRule);if(apf.hasRequireJS){require.def("apf/elements/debugger",[],function(){apf.dbg=function(c,b){this.$init(b||"debugger",apf.NODE_HIDDEN,c);};(function(){this.$host=null;this.$debugger=null;this.$supportedProperties.push("state-running","state-attached","model-sources","model-stacks","model-breakpoints","activeframe");this.$createModelPropHandler=function(c,b,d){return function(g){if(!g){return;}this[c]=apf.setReference(g,apf.nameserver.register("model",g,new apf.model()));this[c].id=this[c].name=g;this[c].load(b);};};this.$createStatePropHandler=function(b){return function(c){if(!c){return;}this[b]=apf.setReference(c,apf.nameserver.register("state",c,new apf.state()));this[b].id=this[b].name=c;this[b].deactivate();};};this.$propHandlers["model-sources"]=this.$createModelPropHandler("$mdlSources","<sources />");this.$propHandlers["model-stack"]=this.$createModelPropHandler("$mdlStack","<frames />");this.$propHandlers["model-breakpoints"]=this.$createModelPropHandler("$mdlBreakpoints","<breakpoints />");this.$propHandlers["state-running"]=this.$createStatePropHandler("$stRunning");this.$propHandlers["state-attached"]=this.$createStatePropHandler("$stAttached");this.$propHandlers.activeframe=function(b){if(this.$debugger){this.$ignoreFrameEvent=true;this.$debugger.setFrame(b);this.$ignoreFrameEvent=false;}this.dispatchEvent("changeframe",{data:b});};this.attach=function(d,c){var b=this;d.$attach(this,c,function(k,g){b.$host=d;b.$debugger=g;g.addEventListener("afterCompile",b.$onAfterCompile.bind(b));b.$stAttached.activate();b.$stRunning.setProperty("active",g.isRunning());g.addEventListener("changeRunning",b.$onChangeRunning.bind(b));g.addEventListener("break",b.$onBreak.bind(b));g.addEventListener("detach",b.$onDetach.bind(b));g.addEventListener("changeFrame",b.$onChangeFrame.bind(b));b.$loadSources(function(){g.setBreakpoints(b.$mdlBreakpoints,function(){b.$debugger.backtrace(b.$mdlStack,function(){var q=b.$mdlStack.queryNode("frame[1]");if(q){var r=q.getAttribute("scriptid");var o=b.$mdlSources.queryValue("file[@scriptid='"+r+"']/@scriptname");if(o){var m=q.getAttribute("line");var n=b.$mdlBreakpoints.queryNode("breakpoint[@script='"+o+"' and @line='"+m+"']");}if(!o||!n){b.$debugger.continueScript();}}});});});});};this.$onChangeRunning=function(){var b=this.$debugger&&this.$debugger.isRunning();if(this.$stRunning.active&&!b){this.$onBreak();}this.$stRunning.setProperty("active",b);};this.$onBreak=function(){var b=this;if(!this.$debugger||this.$debugger.isRunning()){return;}this.$debugger.backtrace(this.$mdlStack,function(){b.dispatchEvent("break");});};this.$onAfterCompile=function(c){var d=c.script.getAttribute("id");var b=this.$mdlSources.queryNode("//file[@id='"+d+"']");if(b){this.$mdlSources.removeXml(b);}this.$mdlSources.appendXml(c.script);};this.$onDetach=function(){if(this.$debugger){this.$debugger.destroy();this.$debugger=null;}this.$host=null;this.$mdlSources.load("<sources />");this.$mdlStack.load("<frames />");this.$stAttached.deactivate();this.setProperty("activeframe",null);};this.$onChangeFrame=function(){if(!this.$ignoreFrameEvent){this.setProperty("activeframe",this.$debugger.getActiveFrame());}};this.changeFrame=function(b){this.$debugger.setFrame(b);};this.detach=function(b){this.continueScript();if(this.$host){this.$host.$detach(this.$debugger,b);}else{this.$onDetach();}};this.$loadSources=function(b){this.$debugger.scripts(this.$mdlSources,b);};this.loadScript=function(b,c){this.$debugger.loadScript(b,c);};this.loadObjects=function(b,c){this.$debugger.loadObjects(b,c);};this.loadFrame=function(b,c){this.$debugger.loadFrame(b,c);};this.toggleBreakpoint=function(b,k){var c=this.$mdlBreakpoints;if(this.$debugger){this.$debugger.toggleBreakpoint(b,k,c);}else{var g=b.getAttribute("scriptname");var d=c.queryNode("breakpoint[@script='"+g+"' and @line='"+k+"']");if(d){c.removeXml(d);}else{var d=apf.n("<breakpoint/>").attr("script",g).attr("line",k).attr("text",b.getAttribute("path")+":"+k).attr("lineoffset",0).node();c.appendXml(d);}}};this.continueScript=function(b){this.dispatchEvent("beforecontinue");if(this.$debugger){this.$debugger.continueScript(b);}else{b&&b();}};this.stepInto=function(){this.dispatchEvent("beforecontinue");this.$debugger&&this.$debugger.stepInto();};this.stepNext=function(){this.dispatchEvent("beforecontinue");this.$debugger&&this.$debugger.stepNext();};this.stepOut=function(){this.dispatchEvent("beforecontinue");this.$debugger&&this.$debugger.stepOut();};this.suspend=function(){this.$debugger&&this.$debugger.suspend();};this.evaluate=function(g,d,c,b,k){this.$debugger&&this.$debugger.evaluate(g,d,c,b,k);};this.changeLive=function(g,b,d,c){this.$debugger&&this.$debugger.changeLive(g,b,d,c);};}).call(apf.dbg.prototype=new apf.AmlElement());apf.aml.setElement("debugger",apf.dbg);window.adbg={exec:function(o,g,n,d){if(o=="loadScript"){var b=g[0];var c=g[1];b.loadScript(c,function(q){if(d&&d.callback){d.callback(apf.escapeXML(q),apf.SUCCESS);}else{n("<file><![CDATA["+q.replace("]]>","]] >")+"]]></file>",apf.SUCCESS);}});}else{if(o=="loadObjects"){var b=g[0];var k=g[1];b.loadObjects(k,function(q){if(d&&d.callback){d.callback(q,apf.SUCCESS);}else{n(q,apf.SUCCESS);}});}else{if(o=="loadFrame"){var b=g[0];var m=g[1];b.loadFrame(m,function(q){if(d&&d.callback){d.callback(q,apf.SUCCESS);}else{n(q,apf.SUCCESS);}});}}}}};(apf.$asyncObjects||(apf.$asyncObjects={}))["adbg"]=1;return apf.dbg;});}if(apf.hasRequireJS){require.def("apf/elements/debughost",["apf/elements/dbg/chromedebughost","apf/elements/dbg/v8debughost","apf/elements/dbg/v8websocketdebughost"],function(b,d,c){apf.debughost=function(k,g){this.$init(g||"debughost",apf.NODE_HIDDEN,k);};(function(){this.port=9222;this.server="localhost";this.type="chrome";this.autoinit=false;this.$modelTabs=null;this.$stateConnected=null;this.$host=null;this.$booleanProperties.autostart=true;this.$supportedProperties.push("port","server","type","autoinit","model-tabs","state-connected","strip");this.$propHandlers["model-tabs"]=function(g){if(!g){return;}this.$modelTabs=apf.nameserver.get("model",g)||apf.setReference(g,apf.nameserver.register("model",g,new apf.model()));this.$modelTabs.id=this.$modelTabs.name=g;this.$modelTabs.load("<tabs/>");};this.$propHandlers["state-connected"]=function(g){if(!g){return;}this.$stateConnected=apf.nameserver.get("state",g)||apf.setReference(g,apf.nameserver.register("state",g,new apf.state()));this.$stateConnected.id=this.$stateConnected.name=g;this.$stateConnected.deactivate();};this.init=function(){if(this.$host){return;}if(this.type=="chrome"||this.type=="v8"||this.type=="v8-ws"){if(!apf.debughost.$o3obj&&this.type!=="v8-ws"){apf.debughost.$o3obj=window.o3Obj||o3.create("8A66ECAC-63FD-4AFA-9D42-3034D18C88F4",{oninstallprompt:function(){alert("can't find o3 plugin");},product:"O3Demo"});}if(this.type=="chrome"){this.$host=new b(this.server,this.port,apf.debughost.$o3obj);}else{if(this.type=="v8"){this.$host=new d(this.server,this.port,apf.debughost.$o3obj);}else{if(this.type=="v8-ws"){var g=this.dispatchEvent("socketfind");if(!g){throw new Error("no socket found!");}this.$host=new c(g);}else{if(this.type=="chrome-ws"){var g=this.dispatchEvent("socketfind");if(!g){throw new Error("no socket found!");}this.$host=new b(null,null,null,g);}}}}var k=this;this.$host.addEventListener("connect",function(){k.dispatchEvent("connect");k.$stateConnected.activate();});this.$host.addEventListener("disconnect",function(){k.dispatchEvent("disconnect");k.$stateConnected.deactivate();});this.loadTabs();}};this.loadTabs=function(){if(!this.$host){this.init();}var g=this;this.$host.loadTabs(this.$modelTabs,function(){g.$dispatchEvent("tabsloaded");});};this.addEventListener("DOMNodeInsertedIntoDocument",function(g){if(this.autoinit){this.init();}});this.$attach=function(k,m,o){if(!this.$host){this.init();}if(m){var n=m.getAttribute("id");}else{var n=null;}var g=this;this.$host.attach(n,function(r,q){q.setStrip(g.strip||"");o(r,q);});};this.$detach=function(g,k){if(!this.$host){return;}this.$host.detach(g,k);};this.disconnect=function(){if(!this.$host){return;}this.$host.disconnect();this.$host=null;};}).call(apf.debughost.prototype=new apf.AmlElement());apf.aml.setElement("debughost",apf.debughost);return apf.debughost;});}apf.defaults=function(c,b){this.$init(b||"services",apf.NODE_HIDDEN,c);};(function(){this.$parsePrio="002";this.$propHandlers["for"]=function(b){if(this.$lastFor){apf.nameserver.remove("defaults_"+this.$lastFor,this);}apf.nameserver.add("defaults_"+b,this);this.$lastFor=b;};this.addEventListener("DOMNodeRemovedFromDocument",function(b){apf.nameserver.remove("defaults_"+this.$lastFor,this);});}).call(apf.defaults.prototype=new apf.AmlElement());apf.aml.setElement("defaults",apf.defaults);apf.divider=function(c,b){this.$init(b||"divider",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;this.implement(apf.ChildValue);this.$childProperty="caption";this.addEventListener("AMLReparent",function(b,d,c){if(!this.$amlLoaded){return;}if(!c&&this.skinName!=d.skinName){this.loadAml();}});this.$supportedProperties.push("caption","value","for","textalign");this.$propHandlers.caption=function(b){if(this.$caption){this.$setStyleClass(this.$ext,this.$baseCSSname+"Caption");this.$caption.innerHTML=b;}else{this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Caption"]);}};this.$canLeechSkin=true;this.$draw=function(){if(this.parentNode.isPaged&&this.parentNode.$buttons){this.$pHtmlNode=this.parentNode.$buttons;}if(this.$isLeechingSkin){this.$ext=apf.insertHtmlNode(this.parentNode.$getLayoutNode("divider"),this.$pHtmlNode);}else{this.$ext=this.$getExternal("main");this.$caption=this.$getLayoutNode("main","caption",this.$ext);}};}).call(apf.divider.prototype=new apf.Presentation);apf.aml.setElement("divider",apf.divider);apf.dropdown=function(c,b){this.$init(b||"dropdown",apf.NODE_VISIBLE,c);};(function(){this.$animType=1;this.$animSteps=5;this.$animSpeed=20;this.$itemSelectEvent="onmouseup";this.dragdrop=false;this.reselectable=true;this.$focussable=apf.KEYBOARD;this.autoselect=false;this.multiselect=false;this.disableremove=true;this.delayedselect=false;this.maxitems=5;this.$booleanProperties.disableremove=true;this.$supportedProperties.push("maxitems","disableremove","initial-message","fill");this.$propHandlers.maxitems=function(c){this.sliderHeight=c?(Math.min(this.maxitems||100,c)*this.itemHeight):10;this.containerHeight=c?(Math.min(this.maxitems||100,c)*this.itemHeight):10;};this.slideToggle=function(c,d){if(!c){c=event;}if(d&&this.disabled){return;}if(this.isOpen){this.slideUp();}else{this.slideDown(c);}};this.slideDown=function(d){if(this.dispatchEvent("slidedown")===false){return false;}this.isOpen=true;this.$propHandlers.maxitems.call(this,this.xmlRoot&&this.each?this.getTraverseNodes().length:this.childNodes.length);this.oSlider.style.display="block";if(!this.ignoreOverflow){this.oSlider.style[apf.supportOverflowComponent?"overflowY":"overflow"]="visible";this.$container.style.overflowY="hidden";}this.oSlider.style.display="";this.$setStyleClass(this.$ext,this.$baseCSSname+"Down");this.oSlider.style.height=(this.sliderHeight-1)+"px";this.oSlider.style.width=(this.$ext.offsetWidth-2-this.widthdiff)+"px";var c=this;apf.popup.show(this.$uniqueId,{x:0,y:this.$ext.offsetHeight,animate:true,container:this.$getLayoutNode("container","contents",this.oSlider),ref:this.$ext,width:this.$ext.offsetWidth-this.widthdiff,height:this.containerHeight,callback:function(g){if(!c.ignoreOverflow){c.$container.style.overflowY="auto";}}});};this.slideUp=function(){if(this.isOpen==2){return false;}if(this.dispatchEvent("slideup")===false){return false;}this.isOpen=false;if(this.selected){var c=apf.xmldb.findHtmlNode(this.selected,this);if(c){this.$setStyleClass(c,"",["hover"]);}}this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Down"]);apf.popup.hide();return false;};this.$setLabel=function(c){this.oLabel.innerHTML=c||this["initial-message"]||"";this.$setStyleClass(this.$ext,c?"":this.$baseCSSname+"Initial",!c?[]:[this.$baseCSSname+"Initial"]);};this.addEventListener("afterselect",function(c){if(!c){c=event;}this.slideUp();if(!this.isOpen){this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Over"]);}this.$setLabel(c.selection.length?this.$applyBindRule("caption",this.selected):"");});function b(){if(this.isOpen==2){this.slideDown();}}this.addEventListener("afterload",b);this.addEventListener("xmlupdate",function(){b.call(this);this.$setLabel(this.$applyBindRule("caption",this.selected));});this.$blur=function(){this.slideUp();if(!this.isOpen){this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Over"]);}this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Focus"]);};this.$setClearMessage=function(c){this.$setLabel(c);};this.$removeClearMessage=function(){this.$setLabel("");};this.addEventListener("popuphide",this.slideUp);this.addEventListener("keydown",function(n){var k=n.keyCode;if(!this.xmlRoot){return;}var m;switch(k){case 32:this.slideToggle(n.htmlEvent);break;case 38:if(n.altKey){this.slideToggle(n.htmlEvent);return;}if(!this.selected){return;}m=this.getNextTraverseSelected(this.caret||this.selected,false);if(m){this.select(m);}break;case 40:if(n.altKey){this.slideToggle(n.htmlEvent);return;}if(!this.selected){m=this.getFirstTraverseNode();if(!m){return;}}else{m=this.getNextTraverseSelected(this.selected,true);}if(m){this.select(m);}break;default:if(k==9||!this.xmlRoot){return;}if(!this.lookup||new Date().getTime()-this.lookup.date.getTime()>1000){this.lookup={str:"",date:new Date()};}this.lookup.str+=String.fromCharCode(k);var d,c=this.getTraverseNodes();for(var g=0;g<c.length;g++){d=this.$applyBindRule("caption",c[g]);if(d&&d.indexOf(this.lookup.str)>-1){this.select(c[g]);return;}}return;}return false;},true);this.$draw=function(){this.$getNewContext("main");this.$getNewContext("container");this.$animType=this.$getOption("main","animtype")||1;this.clickOpen=this.$getOption("main","clickopen")||"button";this.$ext=this.$getExternal(null,null,function(d){d.setAttribute("onmouseover","var o = apf.lookup("+this.$uniqueId+');o.$setStyleClass(o.$ext, o.$baseCSSname + "Over", null, true);');d.setAttribute("onmouseout","var o = apf.lookup("+this.$uniqueId+');if(o.isOpen) return;o.$setStyleClass(o.$ext, "", [o.$baseCSSname + "Over"], true);');var c=this.$getLayoutNode("main","button",d);if(c){c.setAttribute("onmousedown","apf.lookup("+this.$uniqueId+").slideToggle(event, true);");}var g=this.$getLayoutNode("main","label",d);if(this.clickOpen=="both"){g.parentNode.setAttribute("onmousedown","apf.lookup("+this.$uniqueId+").slideToggle(event, true);");}});this.oLabel=this.$getLayoutNode("main","label",this.$ext);if(this.oLabel.nodeType==3){this.oLabel=this.oLabel.parentNode;}this.oIcon=this.$getLayoutNode("main","icon",this.$ext);if(this.$button){this.$button=this.$getLayoutNode("main","button",this.$ext);}this.oSlider=apf.insertHtmlNode(this.$getLayoutNode("container"),document.body);this.$container=this.$getLayoutNode("container","contents",this.oSlider);this.$container.host=this;this.$pHtmlDoc=apf.popup.setContent(this.$uniqueId,this.oSlider,apf.skins.getCssString(this.skinName));this.listtype=parseInt(this.$getLayoutNode("main","type"))||1;this.itemHeight=this.$getOption("main","item-height")||18.5;this.widthdiff=this.$getOption("main","width-diff")||0;this.ignoreOverflow=apf.isTrue(this.$getOption("main","ignore-overflow"))||false;};this.addEventListener("DOMNodeInsertedIntoDocument",function(){if(typeof this["initial-message"]=="undefined"){this.$setInheritedAttribute("initial-message");}if(!this.selected&&this["initial-message"]){this.$setLabel();}});this.$destroy=function(){apf.popup.removeContent(this.$uniqueId);apf.destroyHtmlNode(this.oSlider);this.oSlider=null;};}).call(apf.dropdown.prototype=new apf.BaseList());apf.config.$inheritProperties["initial-message"]=1;apf.aml.setElement("dropdown",apf.dropdown);apf.errorbox=function(c,b){this.$init(b||"errorbox",apf.NODE_VISIBLE,c);};(function(){this.$positioning="basic";this.display=function(d){this.host=d;var c=d.validityState&&d.validityState.$errorHtml||d.$ext;document.body.appendChild(this.$ext);var b=(parseFloat(d.$getOption&&d.$getOption("main","erroffsetx")||0)),g=(parseFloat(d.$getOption&&d.$getOption("main","erroffsety")||0));this.show();apf.popup.show(this.$uniqueId,{x:b,y:g,animate:false,ref:c});this.$setStyleClass(this.$ext,b+this.$ext.offsetWidth>this.$ext.offsetParent.offsetWidth?"rightbox":"leftbox",["leftbox","rightbox"]);};this.setMessage=function(b){if(b&&b.indexOf(";")>-1){b=b.split(";");b="<strong>"+b.shift()+"</strong>"+b.join(";");}this.$int.innerHTML=b||"";};this.$draw=function(){this.$ext=this.$getExternal();this.$int=this.$getLayoutNode("main","container",this.$ext);this.oClose=this.$getLayoutNode("main","close",this.$ext);if(this.oClose){var b=this;this.oClose.onclick=function(){b.hide();if(apf.document.activeElement){apf.document.activeElement.focus(true,{mouse:true});}};}this.$ext.onmousedown=function(c){(c||event).cancelBubble=true;if(apf.hasFocusBug){apf.window.$focusfix();}};apf.popup.setContent(this.$uniqueId,this.$ext,"",null,null);};this.$loadAml=function(b){if(!apf.isTrue(this.getAttribute("visible"))){this.hide();}};this.$destroy=function(){if(this.oClose){this.oClose.onclick=null;}this.$ext.onmousedown=null;apf.popup.removeContent(this.$uniqueId);};}).call(apf.errorbox.prototype=new apf.Presentation());apf.aml.setElement("errorbox",apf.errorbox);apf.event=function(c,b){this.$init(b||"event",apf.NODE_HIDDEN,c);};(function(){this.$hasInitedWhen=false;this.$booleanProperties.repeat=true;this.$supportedProperties.push("when","message","icon","repeat");this.$propHandlers.when=function(c){if(this.$hasInitedWhen&&c&&this.parentNode&&this.parentNode.popup){var b=this;$setTimeout(function(){b.parentNode.popup(b.message,b.icon,b);});}this.$hasInitedWhen=true;if(this.repeat){delete this.when;}};this.$loadAml=function(b){};}).call(apf.event.prototype=new apf.AmlElement());apf.aml.setElement("event",apf.event);apf.filler=function(c,b){this.$init(b||"filler",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;this.flex=1;this.$draw=function(){this.$ext=this.$pHtmlNode.appendChild(this.$pHtmlNode.ownerDocument.createElement("div"));};}).call(apf.filler.prototype=new apf.GuiElement());apf.aml.setElement("filler",apf.filler);apf.panel=function(c,b){this.$init(b||"panel",apf.NODE_VISIBLE,c);};apf.fieldset=function(c,b){this.$init(b||"fieldset",apf.NODE_VISIBLE,c);};apf.frame=function(c,b){this.$init(b||"submit",apf.NODE_VISIBLE,c);};(function(){this.implement(apf.BaseStateButtons);this.$focussable=false;this.$supportedProperties.push("caption","url");this.$propHandlers.caption=function(b){if(!this.oCaption){return;}if(this.oCaption.nodeType==1){this.oCaption.innerHTML=b;}else{this.oCaption.nodeValue=b;}};this.$propHandlers.icon=function(b){var c=this.$getLayoutNode("main","icon",this.$ext);if(!c){return;}if(c.nodeType==1){c.style.display=b?"block":"none";}apf.skins.setIcon(c,b,this.iconPath);};this.$propHandlers.url=function(c){var b=this.oCaption;if(b.tagName=="A"||b.nodeType!=1){b=b.parentNode;}b.innerHTML="<a href='"+c+"' "+(c.match(/^http:\/\//)?"target='_blank'":"")+">"+this.caption+"</a>";this.oCaption=this.oCaption.firstChild;};this.setTitle=function(b){this.setProperty("title",b);};this.$draw=function(){this.$ext=this.$getExternal(null,null,function(b){this.$initButtons(b);});this.oCaption=this.$getLayoutNode("main","caption",this.$ext);this.$int=this.$getLayoutNode("main","container",this.$ext);this.$buttons=this.$getLayoutNode("main","buttons",this.$ext);};this.$loadAml=function(b){};}).call(apf.frame.prototype=new apf.Presentation());apf.panel.prototype=apf.fieldset.prototype=apf.frame.prototype;apf.aml.setElement("panel",apf.panel);apf.aml.setElement("fieldset",apf.fieldset);apf.aml.setElement("frame",apf.frame);apf.hbox=function(c,b){this.$init(b||"hbox",apf.NODE_VISIBLE,c);};apf.vbox=function(c,b){this.$init(b||"vbox",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;this.$useLateDom=true;this.$box=true;this.$layout=true;var n="-moz-stack";var d={INPUT:1,SELECT:1,TEXTAREA:1};this.$booleanProperties.splitters=true;this.$supportedProperties.push("padding","reverse","edge","pack","align","splitters");this.$propHandlers.padding=function(y){this.padding=parseInt(y);var t,q=this.childNodes,s=[];for(var w=0,u=q.length;w<u;w++){if((t=q[w]).nodeFunc==apf.NODE_VISIBLE&&t.$amlLoaded&&t.visible!==false){s.push(t);}}if(!s.length){return;}for(var A,x,r,w=s.length-2;w>=0;w--){x=(r=s[w]).margin&&apf.getBox(r.margin)||[0,0,0,0];if((!A||!A.$splitter)&&!r.$splitter){x[this.$vbox?2:1]+=this.padding;if(!apf.hasFlexibleBox&&w!=0&&this.align=="stretch"&&this.$vbox){x[0]+=this.padding;}}r.$ext.style.margin=x.join("px ")+"px";A=r;}x=(r=s[s.length-1]).margin&&apf.getBox(r.margin)||[0,0,0,0];r.$ext.style.margin=x.join("px ")+"px";if(!apf.hasFlexibleBox){this.$resize();}};this.$propHandlers.reverse=function(q){if(apf.hasFlexibleBox){this.$int.style[apf.CSSPREFIX+"BoxDirection"]=q?"reverse":"normal";}else{}};this.$propHandlers.edge=function(r){var q=!apf.hasFlexibleBox&&this.$vbox?this.$ext:this.$int;q.style.padding=(this.$edge=apf.getBox(r)).join("px ")+"px";if(!apf.hasFlexibleBox){this.$resize();}};this.$propHandlers.pack=function(t){if(apf.hasFlexibleBox){this.$int.style[apf.CSSPREFIX+"BoxPack"]=t||"start";}else{if(this.$amlLoaded){if(this.$vbox){this.$int.style.verticalAlign=t=="center"?"middle":(t=="end"?"bottom":"top");}else{this.$int.style.textAlign="";var r=this.childNodes;for(var s=0,q=r.length;s<q;s++){if((node=r[s]).nodeFunc!=apf.NODE_VISIBLE||!node.$amlLoaded){continue;}node.$ext.style.textAlign=apf.getStyle(node.$ext,"textAlign")||"left";}this.$int.style.textAlign=t=="center"?"center":(t=="end"?"right":"left");}}}};this.$propHandlers.align=function(x){if(apf.hasFlexibleBox){this.$int.style[apf.CSSPREFIX+"BoxAlign"]=x||"stretch";if(apf.isGecko){this.$int.style.overflow="visible";}var q=!x||x=="stretch";var r=this.childNodes;var A=this.$vbox?"width":"height";var t=false,y=this;while(!t&&y){t=y[A]||y.anchors||(y.$vbox?y.top&&y.bottom:y.left&&y.right);if(!y.flex){break;}y=y.parentNode||y.$parentNode;}for(var w=0,u=r.length;w<u;w++){if(!(node=r[w]).$ext||node.$ext.nodeType!=1){continue;}if(q&&!node[A]){node.$ext.style[A]=apf.isGecko&&(this.flex||node.flex)?(t?"1px":"auto"):(apf.isWebkit&&d[node.$ext.tagName]?"100%":(apf.isWebkit&&node[this.$vbox?"minwidth":"minheight"]&&this.flex?"0px":"auto"));}else{if(node[A]){c["true"][A].call(node,node[A]);}}}}else{if(this.$amlLoaded){var q=!x||x=="stretch";if(!this.$vbox){var r=this.childNodes;for(var w=0,u=r.length;w<u;w++){if((node=r[w]).nodeFunc!=apf.NODE_VISIBLE||!node.$amlLoaded){continue;}node.$ext.style.verticalAlign=x=="center"?"middle":(x=="end"?"bottom":"top");}}else{var s=!apf.hasFlexibleBox&&this.$vbox?this.$ext:this.$int;s.style.textAlign="";var r=this.childNodes;for(var w=0,u=r.length;w<u;w++){if((node=r[w]).nodeFunc!=apf.NODE_VISIBLE||!node.$amlLoaded){continue;}if(node.visible!==false){node.$ext.style.display=x=="stretch"?"block":apf.INLINE;node.$br.style.display=x=="stretch"?"none":"";if(apf.needZoomForLayout){node.$ext.style.zoom=1;}}node.$ext.style.textAlign=apf.getStyle(node.$ext,"textAlign")||"left";}s.style.textAlign=x=="center"?"center":(x=="end"?"right":"left");}}}};function k(r){if(this.parentNode.splitters&&!this.$splitter){if(!r.value){if(this.nextSibling&&this.nextSibling.$splitter){this.nextSibling.removeNode();}else{if(this.previousSibling&&this.previousSibling.$splitter){this.previousSibling.removeNode();}}}else{var q=o(this);if(!q){if(!this.nextSibling.$splitter){this.parentNode.insertBefore(this.ownerDocument.createElementNS(apf.ns.aml,"splitter"),this.nextSibling);}}else{if(this.previousSibling&&!this.previousSibling.$splitter){this.parentNode.insertBefore(this.ownerDocument.createElementNS(apf.ns.aml,"splitter"),this);}}}}this.parentNode.$propHandlers.padding.call(this.parentNode,this.parentNode.padding);apf.layout.forceResize(this.parentNode.$int);if(apf.hasFlexibleBox){if(this.$altExt){this.$altExt.style.display=r.value?(apf.isGecko?n:apf.CSSPREFIX2+"-box"):"none";}return;}if(r.value){this.$ext.style.display=this.parentNode.$vbox&&this.parentNode.align=="stretch"?"block":apf.INLINE;if(apf.needZoomForLayout){this.$ext.style.zoom=1;}if(this.$br){this.$br.style.display=this.parentNode.align=="stretch"?"none":"";}}else{if(this.$br){this.$br.style.display="none";}}this.parentNode.$resize();}function g(){if(!this.flex){if(this.$isRszHandling||this.$lastSizeChild&&this.$lastSizeChild[0]==this.$ext.offsetWidth&&this.$lastSizeChild[1]==this.$ext.offsetHeight){return;}this.parentNode.$resize(true);this.$lastSizeChild=[this.$ext.offsetWidth,this.$ext.offsetHeight];}}var c={"true":{optimize:function(q){this.optimize=apf.isTrue(q);},width:function(q){(this.$altExt||this.$ext).style.width=q?(parseFloat(q)==q?q+"px":q):"";},height:function(q){(this.$altExt||this.$ext).style.height=q?(parseFloat(q)==q?q+"px":q):(apf.isGecko&&this.flex&&this.parentNode.$vbox?"auto":"");},margin:function(r){var q=apf.getBox(r);if(!o(this)){q[this.parentNode.$vbox?2:1]+=this.parentNode.padding;}this.$ext.style.margin=q.join("px ")+"px";},flex:function(r){this.flex=r=parseInt(r);if(r){if(!this.optimize&&!this.$altExt){this.$altExt=this.$ext.ownerDocument.createElement("div");this.parentNode.$int.replaceChild(this.$altExt,this.$ext);this.$altExt.appendChild(this.$ext);this.$altExt.style[apf.CSSPREFIX+"BoxSizing"]="border-box";this.$altExt.style.display=apf.CSSPREFIX2+"-box";this.$altExt.style[apf.CSSPREFIX+"BoxOrient"]="vertical";this.$ext.style[apf.CSSPREFIX+"BoxFlex"]=1;var q=this.parentNode.$vbox?"height":"width";if(apf.isWebkit){if(!this.preventforcezero){this.$altExt.style[q]="0px";}}else{if(apf.isGecko){this.$altExt.style[q]="0px";if(!this.$box){this.$altExt.style.overflow="hidden";}if(apf.getStyle(this.$ext,"overflow")=="visible"){this.$ext.style.overflow="hidden";}this.$ext.style[q]="1px";this.$altExt.style.minHeight=this.$ext.style.minHeight;this.$altExt.style.maxHeight=this.$ext.style.maxHeight;this.$altExt.style.minWidth=this.$ext.style.minWidth;this.$altExt.style.maxWidth=this.$ext.style.maxWidth;}}}(this.$altExt||this.$ext).style[apf.CSSPREFIX+"BoxFlex"]=parseInt(r)||1;}else{if(this.$altExt){this.parentNode.$int.replaceChild(this.$ext,this.$altExt);this.$ext.style[apf.CSSPREFIX+"BoxFlex"]="";if(apf.isGecko){this.$ext.style.overflow="";}delete this.$altExt;}}}},"false":{width:function(q){this.$ext.style.width=q?(parseFloat(q)==q?Math.max(0,q-apf.getWidthDiff(this.$ext))+"px":q):"";},height:function(q){this.$ext.style.height=q?(parseFloat(q)==q?Math.max(0,q-apf.getHeightDiff(this.$ext))+"px":q):"";},margin:function(r){var q=apf.getBox(r);if(this.padding){if(!o(this)){q[this.parentNode.$vbox?2:1]+=this.padding;}if(this!=this.parentNode.firstChild&&this.parentNode.align=="stretch"&&this.parentNode.$vbox){q[0]+=this.padding;}}this.$ext.style.margin=q.join("px ")+"px";},flex:function(q){this.flex=parseInt(q);if(this.$amlLoaded){this.parentNode.$resize(true);}}}};function o(q){var r=q.parentNode.lastChild;while(r&&(r.nodeFunc!=apf.NODE_VISIBLE||r.visible===false||r.visible==2&&apf.isFalse(r.getAttribute("visible")))){r=r.previousSibling;}return r&&r==q;}this.register=function(s,y){if(s.$altExt){return;}s.$propHandlers.left=s.$propHandlers.top=s.$propHandlers.right=s.$propHandlers.bottom=apf.K;var r=c[apf.hasFlexibleBox];for(var q in r){s.$propHandlers[q]=r[q];}if(s.nodeFunc==apf.NODE_VISIBLE){if(apf.hasFlexibleBox){if(s.$ext.tagName=="INPUT"||apf.isWebkit&&d[s.$ext.tagName]){var w=s.$ext.ownerDocument;s.$altExt=w.createElement("div");s.parentNode.$int.replaceChild(s.$altExt,s.$ext);s.$altExt.style[apf.CSSPREFIX+"BoxSizing"]="border-box";s.$altExt.appendChild(s.$ext);if(apf.isWebkit){var u=apf.getDiff(s.$ext);s.$altExt.style.height="100%";s.$altExt.style.width="0";s.$altExt.style.lineHeight=0;s.$altExt.style.margin="-1px 0 0 0";s.$ext.style.width="100%";s.$ext.style.height="100%";s.$ext.style.top="1px";s.$ext.style.position="relative";}else{s.$altExt.style.display=apf.CSSPREFIX2+"-box";s.$altExt.style[apf.CSSPREFIX+"BoxOrient"]="horizontal";s.$altExt.style[apf.CSSPREFIX+"BoxAlign"]="stretch";s.$ext.style[apf.CSSPREFIX+"BoxFlex"]=1;}}else{if(apf.getStyle(s.$ext,"display")=="inline"){s.$ext.style.display="block";}}s.$ext.style[apf.CSSPREFIX+"BoxSizing"]="border-box";}else{if(this.$vbox){s.$br=this.$int.insertBefore(s.$ext.ownerDocument.createElement("br"),s.$ext.nextSibling);if(s.visible===false){s.$br.style.display="none";}}else{if(s.visible!==false){s.$ext.style.display=apf.INLINE;if(apf.needZoomForLayout){s.$ext.style.zoom=1;}}this.$int.style.whiteSpace="";s.$ext.style.whiteSpace=apf.getStyle(s.$ext,"whiteSpace")||"normal";this.$int.style.whiteSpace="nowrap";}this.$int.style.fontSize="0";if(!s.$box){var A=apf.getStyle(s.$ext,"fontSize");if(A=="0px"){s.$ext.style.fontSize="";var x=this.$int.parentNode;while(apf.getStyle(x,"fontSize")=="0px"){x=x.parentNode;}A=apf.getStyle(x,"fontSize");}s.$ext.style.fontSize=A;}s.addEventListener("resize",g);}s.addEventListener("prop.visible",k);this.$noResize=true;if(s.height){r.height.call(s,s.height);}if(s.width){r.width.call(s,s.width);}if(s.margin){r.margin.call(s,s.margin);}if(s.flex){r.flex.call(s,s.flex);}var t=o(s);if(t||y){this.$propHandlers.padding.call(this,this.padding);this.$propHandlers.align.call(this,this.align);if(!apf.hasFlexibleBox){this.$propHandlers.pack.call(this,this.pack);}if(y&&s.visible!==false){k.call(s,{value:true});}}else{if(this.splitters&&!s.$splitter&&s.visible!==false){this.insertBefore(this.ownerDocument.createElementNS(apf.ns.aml,"splitter"),s.nextSibling);}}delete this.$noResize;if(!apf.hasFlexibleBox&&t){this.$resize();}}};this.unregister=function(q){q.$propHandlers.left=q.$propHandlers.top=q.$propHandlers.right=q.$propHandlers.bottom=null;var r=c[apf.hasFlexibleBox];for(var s in r){delete q.$propHandlers[s];}if(q.nodeFunc==apf.NODE_VISIBLE){if(q.flex){r.flex.call(q,0);}if(apf.hasFlexibleBox){q.$ext.style[apf.CSSPREFIX+"BoxSizing"]="";if(apf.isGecko){this.$int.style.overflow="visible";if(q.$ext.style.display=="block"){q.$ext.style.display="";}}}else{q.$ext.style.verticalAlign="";q.$ext.style.textAlign="";q.$ext.style.whiteSpace="";if(q.$br){q.$br.parentNode.removeChild(q.$br);delete q.$br;}q.removeEventListener("resize",g);}q.removeEventListener("prop.visible",k);q.$ext.style.display=q.visible?"block":"none";if(q.margin){q.$ext.style.margin="";}if(q.width){q.$ext.style.width="";}if(this.splitters&&!q.$splitter&&q.nextSibling&&q.nextSibling.$splitter){q.nextSibling.$splitter.removeNode();}}};this.addEventListener("DOMNodeRemoved",function(q){if(q.$doOnlyAdmin||q.currentTarget==this){return;}if(q.relatedNode==this){this.unregister(q.currentTarget);}});this.addEventListener("DOMNodeInserted",function(q){if(q.currentTarget==this||q.currentTarget.nodeType!=1){return;}if(q.relatedNode==this&&!q.$isMoveWithinParent){q.currentTarget.$setLayout(this.localName,true);if(q.currentTarget.$altExt){return false;}}});function m(q){if(q.value){this.$int.style.display=apf.CSSPREFIX2+"-box";}}function b(r){clearInterval(this.$heighttimer);if(r.value||this.align!="stretch"){delete this.$heighttimer;}else{if(!this.$heighttimer){var q=this;this.$heighttimer=$setInterval(function(){if(q.$amlDestroyed){return;}var t=q.childNodes;for(var w,u=0,s=t.length;u<s;u++){if(!(w=(node=t[u]).$int||node.$container)){continue;}if(Math.min(w.scrollHeight,node.maxheight||10000)>w.offsetHeight){return q.$resize(true);}}if(q.flex){clearInterval(this.$heighttimer);}},this.flex?1:500);}}}this.$draw=function(){var r=this.$pHtmlNode.ownerDocument;this.$ext=this.$pHtmlNode.appendChild(r.createElement("div"));this.$ext.className=this.localName;this.$vbox=this.localName=="vbox";this.$int=apf.isGecko&&!this.parentNode.$box||!apf.hasFlexibleBox&&this.$vbox?this.$ext.appendChild(r.createElement("div")):this.$ext;this.$ext.host=this;if(apf.isGecko&&!this.parentNode.$box){this.$int.style.width="100%";this.$int.style.height="100%";}else{if(!apf.hasFlexibleBox&&this.$vbox){this.$int.style.display=apf.INLINE;if(apf.needZoomForLayout){this.$int.style.zoom=1;}this.$int.style.width="100%";}}if(apf.hasFlexibleBox){this.$display="-"+apf.CSSPREFIX+"-box";this.$int.style.display=apf.CSSPREFIX2+"-box";this.$int.style[apf.CSSPREFIX+"BoxOrient"]=this.localName=="hbox"?"horizontal":"vertical";if(apf.isGecko){this.$int.style[apf.CSSPREFIX+"BoxSizing"]="border-box";}this.$int.style[apf.CSSPREFIX+"BoxAlign"]="stretch";this.addEventListener("prop.visible",m);}else{if(!this.$vbox){this.$int.style.whiteSpace="nowrap";this.addEventListener("prop.height",b);}var q=(!apf.hasFlexibleBox&&this.$vbox?this.$ext:this.$int).appendChild(r.createElement("strong"));q.style.height="100%";q.style.display=apf.INLINE;if(apf.needZoomForLayout){q.style.zoom=1;}q.style.verticalAlign="middle";this.addEventListener("resize",this.$resize);}if(this.getAttribute("class")){apf.setStyleClass(this.$ext,this.getAttribute("class"));}this.$originalMin=[this.minwidth||0,this.minheight||0];};this.$resize=function(t){if(!this.$amlLoaded||this.$noResize){return;}if(t!==true&&this.$lastSize&&this.$lastSize[0]==this.$int.offsetWidth&&this.$lastSize[1]==this.$int.offsetHeight){return;}if(!apf.window.vManager.check(this,this.$uniqueId,this.$resize)){return;}this.$noResize=true;this.$lastSize=[this.$int.offsetWidth,this.$int.offsetHeight];var T=0;var E=this.$vbox?"width":"height";var O=this.$vbox?"minWidth":"minHeight";var s=this.$vbox?"height":"width";var r=this.$vbox?"scrollWidth":"scrollHeight";var y=this.$vbox?"offsetWidth":"offsetHeight";var w=this.$vbox?"offsetHeight":"offsetWidth";var q=this.$vbox?"getWidthDiff":"getHeightDiff";var A=this.$vbox?"getHeightDiff":"getWidthDiff";var S=this.$vbox?"getHtmlInnerWidth":"getHtmlInnerHeight";var F=this.$vbox?"getHtmlInnerHeight":"getHtmlInnerWidth";var x=this.$vbox?"getVerBorders":"getHorBorders";var H=this.childNodes,G=[],P=0,M=0;for(var J,L=0;L<H.length;L++){if((J=H[L]).nodeFunc!=apf.NODE_VISIBLE||J.visible===false||!J.$amlLoaded){continue;}G.push(J);if(!J[E]){var I=J.margin&&apf.getBox(J.margin);if(I&&this.$vbox){I.unshift();}var N=(I?I[0]+I[2]:0);M=Math.max(M,N+Math.min(J.$ext[r]+apf[x](J.$ext),J["max"+E]||10000));}if(parseInt(J.flex)){T+=parseFloat(J.flex);}else{var I=J.margin&&apf.getBox(J.margin);if(I&&!this.$vbox){I.shift();}P+=J.$ext[w]+(I?I[0]+I[2]:0);}}if(!M&&this[E]){M=this[E]-apf[A](this.$ext);}if(this.align=="stretch"){var K=G.length;var D=M;for(var L=0;L<K;L++){J=G[L];if(!J[E]&&!this.$vbox||this.$vbox&&d[J.$ext.tagName]){var I=J.margin&&apf.getBox(J.margin);if(I&&this.$vbox){I.unshift();}var N=(I?I[0]+I[2]:0);if(M&&Math.min(J.$ext[r],J["max"+E]||10000)!=M){J.$ext.style[E]=Math.max(0,M-apf[q](J.$ext)-N)+"px";}else{J.$ext.style[E]="";}}}}if(T>0){if(this.$vbox){this.$int.style.height="100%";}this.$int.style.overflow="hidden";var u=apf.n(this).children("a:splitter").length()*2;var R=this.$int[w]-apf[A](this.$int)-P-((G.length-1-u)*this.padding);var Q=R,C=0;for(var L=0,K=G.length;L<K;L++){if((J=G[L]).flex){var B=(L%2==0?Math.floor:Math.ceil)((R/T)*parseInt(J.flex));C+=parseInt(J.flex);var I=J.margin&&apf.getBox(J.margin);if(I&&!this.$vbox){I.shift();}J.$ext.style[s]=Math.max(0,(C==T?Q:B)-apf[A](J.$ext)-(I?I[0]+I[2]:0))+"px";Q-=B;}}}else{if(this.$vbox){this.$int.style.height="";}this.$int.style.overflow="";}this.$noResize=false;};this.$loadAml=function(q){if(this.padding==undefined){this.padding=0;}if(this.edge==undefined){this.$propHandlers.edge.call(this,this.edge=0);}if(this.pack==undefined){this.$propHandlers.pack.call(this,this.edge="start");}if(this.align==undefined){this.align="stretch";}if(!apf.hasFlexibleBox&&!this.$vbox&&!this.height&&this.align=="stretch"){b.call(this,{});}};}).call(apf.vbox.prototype=new apf.GuiElement());apf.hbox.prototype=apf.vbox.prototype;apf.aml.setElement("hbox",apf.hbox);apf.aml.setElement("vbox",apf.vbox);apf.item=function(c,b){this.$init(b||"item",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;this.$childProperty="caption";this.$canLeechSkin="item";this.checked=false;this.selected=false;this.implement(apf.ChildValue);this.$attrExcludePropBind=apf.extend({match:1},this.$attrExcludePropBind);this.$supportedProperties.push("submenu","value","match","group","icon","checked","selected","disabled","caption","type");this.$propHandlers.submenu=function(c){apf.setStyleClass(this.$ext,"submenu");};this.$propHandlers.select=function(c){this.select=c?"self::"+c.split("|").join("|self::"):c;};this.$propHandlers.group=function(c){if(this.$group&&this.$group.$removeRadio){this.$group.$removeRadio(this);}if(!c){this.$group=null;return;}var d=typeof c=="string"?apf.nameserver.get("radiogroup",c):c;if(!d){d=apf.nameserver.register("radiogroup",c,new apf.$group());d.setAttribute("id",c);d.dispatchEvent("DOMNodeInsertedIntoDocument");d.parentNode=this;}this.$group=d;this.$group.$addRadio(this);};this.$propHandlers.hotkey=function(d){if(this.$hotkey){apf.setNodeValue(this.$hotkey,apf.isMac?apf.hotkeys.toMacNotation(d):d);}if(this.$lastHotkey){apf.hotkeys.remove(this.$lastHotkey);}if(d){this.$lastHotkey=d;var c=this;apf.hotkeys.register(d,function(){if(c.disabled||!c.visible){return;}var m=apf.document.getElementsByTagNameNS(apf.ns.aml,"button");for(var k=0;k<m.length;k++){if(m[k].submenu==c.parentNode.name){var g=m[k];g.$setState("Over",{});$setTimeout(function(){g.$setState("Out",{});},200);break;}}c.$down();c.$up();c.$click();});}};this.$propHandlers.icon=function(c){if(this.$icon){apf.skins.setIcon(this.$icon,c,this.parentNode.iconPath);}};this.$propHandlers.caption=function(c){if(this.$caption){apf.setNodeValue(this.$caption,c);}};this.$propHandlers.type=function(c){apf.setStyleClass(this.$ext,c,["item","check","radio"]);};this.$values=[1,0];this.$propHandlers.values=function(c){this.$values=c&&c.split("|");};this.$propHandlers.value=function(c){if(this.type!="check"){return;}this.setProperty("checked",this.$values.indexOf(c)==0);};this.$propHandlers.checked=function(c){if(this.type!="check"){return;}if(apf.isTrue(c)){apf.setStyleClass(this.$ext,"checked");}else{apf.setStyleClass(this.$ext,"",["checked"]);}if(this.$values&&this.$values[c?0:1]!=this.value){return this.setProperty("value",this.$values[c?0:1]);}};this.select=function(){this.parentNode.select(this.group,this.value||this.caption);};this.check=function(){this.setProperty("checked",true);};this.uncheck=function(){this.setProperty("checked",false);};this.$check=function(){apf.setStyleClass(this.$ext,"selected");};this.$uncheck=function(){apf.setStyleClass(this.$ext,"",["selected"]);};this.$propHandlers.selected=function(c){if(this.type!="radio"){return;}if(this.$group){this.$group.setProperty("value",this.value);}if(apf.isTrue(c)){this.$check();}else{this.$uncheck();}};this.$propHandlers.disabled=function(c){if(apf.isTrue(c)){apf.setStyleClass(this.$ext,"disabled");}else{apf.setStyleClass(this.$ext,"",["disabled"]);}};this.addEventListener("AMLReparent",function(c,g,d){if(!this.$amlLoaded){return;}if(!d&&this.skinName!=g.skinName){this.loadAml();}});this.$down=function(){};this.$up=function(){if(this.type=="radio"){this.parentNode.select(this.group,this.value||this.caption);}else{if(this.type=="check"){this.setProperty("checked",!this.checked);}}if(this.submenu){this.$over(null,true);return;}this.parentNode.$hideTree=true;this.parentNode.hide();this.parentNode.dispatchEvent("itemclick",{value:this.value||this.caption,relatedNode:this,checked:this.checked,selected:this.selected});this.dispatchEvent("click",{xmlContext:this.parentNode.xmlReference,opener:this.parentNode.opener});};this.$click=function(){};var b;this.$out=function(d){if(apf.isChildOf(this.$ext,d.toElement||d.explicitOriginalTarget)||apf.isChildOf(this.$ext,d.srcElement||d.target)){return;}clearTimeout(b);if(!this.submenu||this.$submenu(true)){apf.setStyleClass(this.$ext,"",["hover"]);var c=this.parentNode.$selected;if(c&&c!=this){apf.setStyleClass(c.$ext,"",["hover"]);}this.parentNode.$selected=null;}};this.$over=function(k,g){if(this.parentNode.$selected==this){return;}if(this.parentNode.$selected){apf.setStyleClass(this.parentNode.$selected.$ext,"",["hover"]);}apf.setStyleClass(this.$ext,"hover");this.parentNode.$selected=this;if(!g&&(apf.isChildOf(this.$ext,k.toElement||k.explicitOriginalTarget)||apf.isChildOf(this.$ext,k.fromElement||k.target))){return;}var c=this,m=this.parentNode.$showingSubMenu;if(m&&m.name==this.submenu){return;}clearTimeout(b);function d(){if(m&&m.visible){m.hide();if(c.parentNode.$showingSubMenu==m){c.parentNode.$showingSubMenu=null;}}if(c.submenu&&c.parentNode.opener&&c.parentNode.opener.visible){c.$submenu();}}if(g){d();}else{b=$setTimeout(function(){d();b=null;},210);}};this.$submenu=function(c,d){if(!this.submenu){return true;}var g=self[this.submenu];if(!g){return;}if(!c){this.parentNode.$showingSubMenu=g;var k=apf.getAbsolutePosition(this.$ext,this.parentNode.$ext.offsetParent);g.display(k[0]+this.$ext.offsetWidth-3,k[1]+3,true,this,this.parentNode.xmlReference,this.parentNode.$uniqueId);g.setAttribute("zindex",(this.parentNode.zindex||1)+1);}else{if(g.visible&&!d){return false;}if(this.parentNode.$showingSubMenu==g){this.parentNode.$showingSubMenu=null;}apf.setStyleClass(this.$ext,"",["hover"]);g.hide();return true;}};this.$draw=function(d){var k=this.parentNode;while(k.$canLeechSkin=="item"){k=k.parentNode;}if(k.hasFeature(apf.__MULTISELECT__)){var c=this;if(!this.$hasSetSkinListener){var g;this.parentNode.addEventListener("$skinchange",g=function(){if(c.$amlDestroyed){return;}if(c.$ext.parentNode){this.$deInitNode(c,c.$ext);}var o=k==c.parentNode?k.$container:c.parentNode.$container;var n=o.lastChild;k.$add(c,c.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId,c.parentNode,o!=k.$container&&o,null);k.$fill();if(k.$isTreeArch){c.$container=k.$getLayoutNode("item","container",c.$ext=n&&n.nextSibling||o.firstChild);}else{c.$ext=n&&n.nextSibling||o.firstChild;}var m=c;while((m=m.nextSibling)&&m.nodeType!=1){}if(!m||m.$canLeechSkin!="item"){k.dispatchEvent("afterload");}});this.addEventListener("DOMNodeRemoved",function(m){if(m.currentTarget==this){this.parentNode.removeEventListener("$skinchange",g);}});this.$hasSetSkinListener=true;}if(!k.$itemInited){k.canrename=false;k.$removeClearMessage();k.$itemInited=[k.getTraverseNodes,k.getFirstTraverseNode,k.getTraverseParent];k.getTraverseNodes=function(m){return(m||k).getElementsByTagNameNS(apf.ns.apf,"item");};k.getFirstTraverseNode=function(m){return(m||k).getElementsByTagNameNS(apf.ns.apf,"item")[0];};k.getTraverseParent=function(m){return m&&m.parentNode;};k.each=(this.prefix?this.prefix+":":"")+"item";k.$preventDataLoad=true;k.$initingModel=true;k.$setDynamicProperty("icon","[@icon]");k.$setDynamicProperty("image","[@image]");k.$setDynamicProperty("caption","[label/text()|@caption|text()]");k.$setDynamicProperty("eachvalue","[value/text()|@value|text()]");k.$canLoadDataAttr=false;if(!k.xmlRoot){k.xmlRoot=k;}}this.$loadAml=function(){if(!this.getAttribute("caption")){this.setAttribute("caption",this.caption);}var o=k==this.parentNode?k.$container:this.parentNode.$container;var n=o.lastChild;if(!k.documentId){k.documentId=apf.xmldb.getXmlDocId(this);}k.$add(this,apf.xmldb.nodeConnect(k.documentId,this,null,k),this.parentNode,o!=k.$container&&o,null);k.$fill();if(k.$isTreeArch){this.$container=k.$getLayoutNode("item","container",this.$ext=n&&n.nextSibling||o.firstChild);}else{this.$ext=n&&n.nextSibling||o.firstChild;}var m=this;while((m=m.nextSibling)&&m.nodeType!=1){}if(!m||m.$canLeechSkin!="item"){k.dispatchEvent("afterload");if(k.autoselect){k.$selectDefault(this.parentNode);}}};return;}this.$ext=this.$getExternal(this.$isLeechingSkin?"item":"main",null,function(m){var n="var o = apf.lookup("+this.$uniqueId+"); if (o.disabled) return; o";m.setAttribute("onmouseup",n+".$up(event)");m.setAttribute("onmousemove",n+".$over(event)");m.setAttribute("onmouseout",n+".$out(event)");m.setAttribute("onmousedown",n+".$down()");m.setAttribute("onclick",n+".$click()");});this.$caption=this.$getLayoutNode("item","caption",this.$ext);this.$icon=this.$getLayoutNode("item","icon",this.$ext);this.$hotkey=this.$getLayoutNode("item","hotkey",this.$ext);if(!d&&this.nextSibling&&this.nextSibling.$ext){this.$ext.parentNode.insertBefore(this.$ext,this.nextSibling.$ext);}};this.addEventListener("DOMNodeInsertedIntoDocument",function(d){var c=this.$ext?true:false;if(c){if(typeof this.checked!=="undefined"){this.$handlePropSet("checked",this.checked);}else{if(typeof this.selected!=="undefined"){this.$handlePropSet("selected",this.selected);}}if(this.disabled){this.$handlePropSet("disabled",this.disabled);}if(this.caption){this.$handlePropSet("caption",this.caption);}}});}).call(apf.item.prototype=new apf.Presentation());apf.aml.setElement("item",apf.item);apf.junction=function(){this.$init("junction",apf.NODE_HIDDEN);};(function(){this.$focussable=false;this.autoshow=true;this.$booleanProperties.autoshow=true;this.$propHandlers["for"]=function(c){if(this.$amlLoaded){b.call(this);}};function b(d){var c=this;if(apf.window.vManager.permanent(this.parentNode,function(){c.$reparent();},function(){})){this.$reparent();}}this.$reparent=function(){var c=self[this["for"]];if(!c){return;}if(this.autoshow){c.show();}this.parentNode.insertBefore(c,this);};this.addEventListener("DOMNodeInsertedIntoDocument",b);}).call(apf.junction.prototype=new apf.AmlElement());apf.aml.setElement("junction",apf.junction);apf.label=function(c,b){this.$init(b||"label",apf.NODE_VISIBLE,c);};(function(){this.implement(apf.DataAction,apf.ChildValue);var b=this;this.$focussable=false;var c;this.setValue=function(d){this.setProperty("value",d,false,true);};this.getValue=function(){return this.value;};this.$supportedProperties.push("caption","for","textalign");this.$propHandlers.caption=function(d){this.$caption.innerHTML=d;};this.$propHandlers["for"]=function(d){c=typeof d=="string"?self[d]:d;};this.$propHandlers.textalign=function(d){this.$caption.style.textAlign=d||"";};this.$draw=function(){this.$ext=this.$getExternal();this.$caption=this.$getLayoutNode("main","caption",this.$ext);if(this.$caption.nodeType!=1){this.$caption=this.$caption.parentNode;}this.$ext.onmousedown=function(){if(c&&c.$focussable&&c.focussable){c.focus();}};var d=this;apf.addListener(this.$ext,"click",function(g){if(!d.disabled){d.dispatchEvent("click",{htmlEvent:g});}});apf.addListener(this.$ext,"mouseover",function(g){if(!d.disabled){d.dispatchEvent("mouseover",{htmlEvent:g});}});apf.addListener(this.$ext,"mouseout",function(g){if(!d.disabled){d.dispatchEvent("mouseout",{htmlEvent:g});}});};this.$childProperty="caption";}).call(apf.label.prototype=new apf.BaseSimple());apf.aml.setElement("label",apf.label);apf.list=function(c,b){this.$init(b||"list",apf.NODE_VISIBLE,c);};apf.thumbnail=function(c,b){this.$init(b||"thumbnail",apf.NODE_VISIBLE,c);};apf.select=function(c,b){this.$init(b||"select",apf.NODE_VISIBLE,c);};apf.select1=function(c,b){this.$init(b||"selectl",apf.NODE_VISIBLE,c);};(function(){this.morePos="end";if(!apf.isIphone){this.implement(apf.Rename);}this.$getCaptionElement=function(){if(!(this.$caret||this.$selected)){return;}var c=this.$getLayoutNode("item","caption",this.$caret||this.$selected);if(!c){return;}return c.nodeType==1?c:c.parentNode;};this.$supportedProperties.push("appearance","mode","more","thumbsize","morepos");this.$propHandlers.morepos=function(c){this.morePos=c;};this.$propHandlers.thumbsize=function(g){var d=this.thumbclass;if(apf.isIE){d=d.splitSafe(",");for(var c=0;c<d.length;c++){apf.setStyleRule(d[c],"width",g+"px");apf.setStyleRule(d[c],"height",g+"px");}return;}apf.setStyleRule(d,"width",g+"px");apf.setStyleRule(d,"height",g+"px");};this.$propHandlers.appearance=function(c){};this.$propHandlers.more=function(c){if(c){this.delayedselect=false;this.addEventListener("xmlupdate",b);this.addEventListener("afterload",b);this.$addMoreItem=function(d){if(!this.moreItem){this.$fill();}if(this.morePos=="begin"){this.$container.insertBefore(this.moreItem,this.$container.firstChild);}else{this.$container.appendChild(this.moreItem);}};this.$updateClearMessage=function(){};this.$removeClearMessage=function(){};}else{this.removeEventListener("xmlupdate",b);this.removeEventListener("afterload",b);}};function b(c){if((!c.action||"insert|add|synchronize|move".indexOf(c.action)>-1)&&this.moreItem){if(this.morePos=="begin"){this.$container.insertBefore(this.moreItem,this.$container.firstChild);}else{this.$container.appendChild(this.moreItem);}}}this.addEventListener("keydown",this.$keyHandler,true);this.$draw=function(){this.appearance=this.getAttribute("appearance")||"compact";this.$ext=this.$getExternal();this.$container=this.$getLayoutNode("main","container",this.$ext);if(apf.hasCssUpdateScrollbarBug&&!this.mode){this.$fixScrollBug();}var c=this;this.$ext.onclick=function(d){c.dispatchEvent("click",{htmlEvent:d||event});};this.listtype=parseInt(this.$getOption("main","type"))||1;this.behaviour=parseInt(this.$getOption("main","behaviour"))||1;this.thumbsize=this.$getOption("main","thumbsize");this.thumbclass=this.$getOption("main","thumbclass");};this.$loadAml=function(c){};this.$destroy=function(){if(this.$ext){this.$ext.onclick=null;}apf.destroyHtmlNode(this.oDrag);this.oDrag=null;};}).call(apf.list.prototype=new apf.BaseList());apf.thumbnail.prototype=apf.select.prototype=apf.select1.prototype=apf.list.prototype;apf.aml.setElement("thumbnail",apf.thumbnail);apf.aml.setElement("select",apf.select);apf.aml.setElement("select1",apf.select1);apf.aml.setElement("list",apf.list);apf.loader=function(){this.$init("loader",apf.NODE_HIDDEN);this.show=function(){this.$ext.style.display="block";};this.hide=function(){this.$ext.style.display="none";};this.addEventListener("DOMNodeInsertedIntoDocument",function(c){var d;if(!(d=this.parentNode.$int)){return;}this.$ext=apf.insertHtmlNode(null,d,null,(this.$aml?(this.$aml.serialize?this.$aml.serialize():this.$aml.xml):this.serialize()).replace(/^<[^>]*>\s*|\s*<[^>]*>$/g,""));if(!apf.loaded){var b=this;apf.addEventListener("load",function(){if(apf.config.autoHideLoading){apf.queue.empty();b.hide();}});}});};apf.loader.prototype=new apf.AmlElement();apf.aml.setElement("loader",apf.loader);apf.menu=function(c,b){this.$init(b||"menu",apf.NODE_VISIBLE,c);this.animate=apf.enableAnim;};(function(){this.$focussable=apf.KEYBOARD;this.$positioning="basic";this.zindex=10000000;this.visible=false;this.matchhide=false;this.$booleanProperties.animate=true;this.$booleanProperties.autohide=true;this.$booleanProperties.matchhide=true;this.$propHandlers.visible=function(n,q,m,k,d){if(n){this.$ext.style.display="block";if(this.opener&&this.opener.localName.indexOf("item")>-1){this.opener.parentNode.$showingSubMenu=this;}}else{this.$ext.style.display="none";var o=apf.menu.lastFocus;if(o!=this.opener&&this.opener&&this.opener.$blur){this.opener.$blur();}if(this.opener&&this.opener.parentNode.localName=="menu"){if(!this.$hideTree){this.$hideTree=-1;}this.opener.parentNode.focus();}else{if(o){if(apf.window.$settingFocus){if(apf.window.$settingFocus!=o&&o.$blur){o.$blur();}this.$blur();if(apf.window.$settingFocus.localName!="menu"){apf.menu.lastFocus=null;}}else{if(!apf.window.hasFocus()){if(o.$blur){o.$blur();}this.$blur();apf.document.activeElement=o;if(o.$focusParent){o.$focusParent.$lastFocussed=o;}apf.menu.lastFocus=null;}else{if(this.$hideTree){if(!this.$hideTree){this.$hideTree=-1;}var g=(o.disabled||!o.visible)&&o!=apf.document.documentElement;if(k||g){if(o.$blur){o.$blur();}this.$blur();apf.document.activeElement=null;if(g&&apf.window.moveNext()===false){apf.window.$focusRoot();}}else{o.focus(null,null,true);}apf.menu.lastFocus=null;}}}}}clearTimeout(this.$submenuTimer);if(this.$showingSubMenu){this.$showingSubMenu.hide();this.$showingSubMenu=null;}if(this.opener&&this.opener.$submenu){this.opener.$submenu(true,true);if(this.$hideTree===true&&this.opener.parentNode.localName=="menu"){this.opener.parentNode.$hideTree=true;this.opener.parentNode.hide();}this.opener=null;}this.$hideTree=null;if(this.$selected){apf.setStyleClass(this.$selected.$ext,"",["hover"]);this.$selected=null;}}};var c;this.display=function(t,r,n,s,B,o,w){this.opener=s;if(B){var A,m,g,d=this.childNodes,q=0,k=d.length,C;for(m=0;m<k;m++){g=d[m];if(g.nodeType!=1){continue;}C=!B||!g.match||(g.cmatch||(g.cmatch=apf.lm.compile(g.match,{xpathmode:3,injectself:true})))(B);if(C){if(this.matchhide){g.show();}else{g.enable();}if(g.localName=="divider"&&this.matchhide){A=g;if(q==0){g.hide();}q=0;}else{q++;}}else{if(this.matchhide){g.hide();}else{g.disable();}if(!g.nextSibling&&q==0){A.hide();}}}}if(this.oOverlay){if(w){this.oOverlay.style.display="block";this.oOverlay.style.width=w+"px";}else{this.oOverlay.style.display="none";}}function u(){this.dispatchEvent("display",{opener:s});if(t===null){apf.popup.show(this.$uniqueId,{x:0,y:s.$ext.offsetHeight,animate:n||!this.animate?false:"fade",steps:10,ref:s.$ext,allowTogether:o,autohide:this.autohide!==false,noleft:this.left!==undefined});}else{var x=apf.getAbsolutePosition(document.body);apf.popup.show(this.$uniqueId,{x:t-x[0],y:r-x[1]-(apf.isIE&&apf.isIE<8?1:0),animate:n||!this.animate?false:"fade",steps:10,allowTogether:o,autohide:this.autohide!==false});}var y=apf.menu.lastFocus=s&&s.$focussable===true?s:apf.menu.lastFocus||apf.document.activeElement;apf.popup.last=null;this.focus();if(y&&y!=this&&y.$focus){y.$focus();}this.xmlReference=B;}this.visible=false;if(this.$rendered!==false){this.show();u.call(this);}else{this.addEventListener("afterrender",u);this.show();}};this.getValue=function(d){return this.getSelected(d).value||"";};this.getSelected=function(m){var g=this.childNodes;var k,d=g.length;for(k=0;k<d;k++){if(g[k].group!=m){continue;}if(g[k].selected){return g[k];}}return false;};this.select=function(n,m){var g=this.childNodes;var k,d=g.length;for(k=0;k<d;k++){if(g[k].group!=n){continue;}if(g[k].value==m||!g[k].value&&g[k].caption==m){g[k].$handlePropSet("selected",true);}else{if(g[k].selected){g[k].$handlePropSet("selected",false);}}}};this.addEventListener("keydown",function(m){var k,d=m.keyCode;switch(d){case 13:if(!this.$selected){return;}k=this.$selected;k.$down();k.$up();k.$click();break;case 27:this.hide();break;case 38:k=this.$selected&&this.$selected.previousSibling||this.lastChild;if(k&&k.localName=="divider"){k=k.previousSibling;}if(!k){return;}if(this.$selected){apf.setStyleClass(this.$selected.$ext,"",["hover"]);}apf.setStyleClass(k.$ext,"hover");this.$selected=k;break;case 40:k=this.$selected&&this.$selected.nextSibling||this.firstChild;if(k&&k.localName=="divider"){k=k.nextSibling;}if(!k){return;}if(this.$selected){apf.setStyleClass(this.$selected.$ext,"",["hover"]);}apf.setStyleClass(k.$ext,"hover");this.$selected=k;break;case 37:if(!this.opener){return;}if(this.opener.localName=="button"){k=this.opener.previousSibling;while(k&&!k.submenu){k=k.previousSibling;}if(k){k.dispatchEvent("mouseover");var g=k.parentNode.menuIsPressed;if(g){self[g.submenu].dispatchEvent("keydown",{keyCode:40});}}}else{if(this.opener.parentNode.localName=="menu"){var n=this.opener;this.hide();apf.setStyleClass(n.$ext,"hover");n.parentNode.$showingSubMenu=null;}}break;case 39:if(this.$selected&&this.$selected.submenu){this.$selected.$submenu(null,true);this.$showingSubMenu.dispatchEvent("keydown",{keyCode:40});return;}if(this.opener){var n=this.opener;while(n&&n.parentNode&&n.parentNode.localName=="menu"){n=n.parentNode.opener;}if(n&&n.localName=="button"){k=n.nextSibling;while(k&&!k.submenu){k=k.nextSibling;}if(k){k.dispatchEvent("mouseover");var g=k.parentNode.menuIsPressed;if(g){self[g.submenu].dispatchEvent("keydown",{keyCode:40});}return;}}}if(!this.$selected){arguments.callee.call(this,{keyCode:40});}break;default:return;}return false;},true);function b(d){if(this.$showingSubMenu||this.autohide===false||apf.isChildOf(d.fromElement,d.toElement)){return;}if(this.$hideTree!=-1){this.$hideTree=true;this.hide();}return false;}this.addEventListener("focus",function(){apf.popup.last=this.$uniqueId;});this.addEventListener("blur",b);this.addEventListener("popuphide",b);this.$draw=function(){this.$pHtmlNode=document.body;this.$ext=this.$getExternal();this.oOverlay=this.$getLayoutNode("main","overlay",this.$ext);apf.popup.setContent(this.$uniqueId,this.$ext,"",null,null);};this.$loadAml=function(d){this.$int=this.$getLayoutNode("main","container",this.$ext);};this.$destroy=function(){apf.popup.removeContent(this.$uniqueId);};}).call(apf.menu.prototype=new apf.Presentation());apf.aml.setElement("menu",apf.menu);apf.method=function(c,b){this.$init(b||"method",apf.NODE_HIDDEN,c);this.async=true;this.caching=false;this["ignore-offline"]=false;};(function(){this.$parsePrio="002";this.$booleanProperties.async=true;this.$booleanProperties.caching=true;this.$booleanProperties["ignore-offline"]=true;this.$supportedProperties.push("name","receive","async","caching","ignore-offline","method-name","type","url");this.$propHandlers["ignore-offline"]=function(b){this.ignoreOffline=b;};this.$propHandlers["method-name"]=function(b){this.methodName=b;};this.addEventListener("DOMNodeInserted",function(b){if(this.parentNode.$addMethod&&b.currentTarget==this){this.parentNode.$addMethod(this);}});this.addEventListener("DOMNodeRemoved",function(b){if(this.parentNode.$removeMethod&&b.currentTarget==this){this.parentNode.$removeMethod(this);}});this.addEventListener("DOMNodeInsertedIntoDocument",function(b){if(this.parentNode.$addMethod){this.parentNode.$addMethod(this);}});}).call(apf.method.prototype=new apf.AmlElement());apf.aml.setElement("method",apf.method);apf.WinServer={count:9000,wins:[],setTop:function(d,c){if(d.zindex||d.modal){return;}if(d.$opened){if(d.$opened.visible){return;}else{delete d.$opened;}}var b;if(!c&&this.wins.length){var b=this.wins[this.wins.length-1];if(b==d){return;}if(!b.modal||!b.visible){b=null;}else{if(b&&d.modal){d.$opener=b;b.$opened=d;b=null;}}}this.count+=2;d.setProperty("zindex",this.count);this.wins.remove(d);this.wins.push(d);if(b){this.setTop(b,true);}return d;},setNext:function(){if(this.wins.length<2){return;}var b,c=this.wins.shift();do{if(this.setTop(b||c).visible){break;}b=this.wins.shift();}while(c!=b);},setPrevious:function(){if(this.wins.length<2){return;}this.wins.unshift(this.wins.pop());var b,c=this.wins.pop();do{if(this.setTop(b||c).visible){break;}b=this.wins.pop();}while(c!=b);},remove:function(b){this.wins.remove(b);}};apf.toolwindow=function(c,b){this.$init(b||"toolwindow",apf.NODE_VISIBLE,c);};apf.modalwindow=function(c,b){this.$init(b||"modalwindow",apf.NODE_VISIBLE,c);};apf.AmlWindow=function(c,b){this.$init(b||"window",apf.NODE_VISIBLE,c);};(function(){this.implement(apf.BaseStateButtons);this.$isWindowContainer=true;this.collapsedHeight=30;this.canHaveChildren=2;this.visible=false;this.showdragging=false;this.kbclose=false;this.$focussable=apf.KEYBOARD;this.$editableCaption=["title"];this.setTitle=function(d){this.setProperty("title",d,false,true);return this;};this.setIcon=function(d){this.setProperty("icon",d,false,true);return this;};this.show=function(d){this.execAction=d;this.setProperty("visible",true,false,true);return this;};this.slideIn=function(n,k){if(!n){n="bottom";}var r=this.center;this.center=false;this.setProperty("visible",true);this.center=r;var g=0,u=0,q=(apf.isIE?this.$ext.offsetParent.offsetWidth:window.innerWidth),m=(apf.isIE?this.$ext.offsetParent.offsetHeight:window.innerHeight),t=Math.max(0,((q-this.$ext.offsetWidth)/2)),s=Math.max(0,((m-this.$ext.offsetHeight)/3)),d="top",o=10;switch(n){case"top":g=-(this.$ext.offsetHeight)-o;u=k?0:s;break;case"left":g=-(this.$ext.offsetWidth)-o;u=k?0:t;d="left";break;case"bottom":g=m+this.$ext.offsetHeight+o;u=k?m-this.$ext.offsetHeight:s;break;case"right":g=q+this.$ext.offsetLeft+o;u=k?q-this.$ext.offsetWidth:t;d="left";break;}apf.tween.single(this.$ext,{steps:apf.isIphone?5:30,interval:10,from:g,to:u,type:d,anim:apf.tween.EASEIN});return this;};this.slideOut=function(g){if(!g){g="bottom";}var o=0,n=0,m="top",k=10;switch(g){case"top":o=this.$ext.offsetTop;n=-(this.$ext.offsetHeight)-k;break;case"left":o=this.$ext.offsetLeft;n=-(this.$ext.offsetWidth)-k;m="left";break;case"bottom":o=this.$ext.offsetTop;n=(apf.isIE?this.$ext.offsetParent.offsetHeight:window.innerHeight)+this.$ext.offsetHeight+k;break;case"right":o=this.$ext.offsetLeft;n=(apf.isIE?this.$ext.offsetParent.offsetWidth:window.innerWidth)+this.$ext.offsetLeft+k;m="left";break;}var d=this;apf.tween.single(this.$ext,{steps:apf.isIphone?5:30,interval:10,from:o,to:n,type:m,anim:apf.tween.EASEOUT,onfinish:function(){d.setProperty("visible",false);}});return this;};this.bringToFront=function(){apf.WinServer.setTop(this);return this;};this.$booleanProperties.modal=true;this.$booleanProperties.center=true;this.$booleanProperties.transaction=true;this.$booleanProperties.hideselects=true;this.$booleanProperties.showdragging=true;this.$booleanProperties.kbclose=true;this.$supportedProperties.push("title","icon","modal","minwidth","minheight","hideselects","center","kbclose","maxwidth","maxheight","showdragging","transaction");this.$propHandlers.modal=function(d){if(d){if(this.visible){apf.plane.show(this.$ext,false,null,null,{color:"black",opacity:0.5,protect:this.$uniqueId});}}else{apf.plane.hide(this.$uniqueId);}};this.$propHandlers.center=function(d){this.$ext.style.position="absolute";};this.$propHandlers.title=function(d){if(this.oTitle){this.oTitle.nodeValue=d;}};this.$propHandlers.icon=function(d){if(!this.oIcon){return;}this.oIcon.style.display=d?"":"none";apf.skins.setIcon(this.oIcon,d,this.iconPath);};this.$afterRender=function(){if(this.center&&!this.left&&!this.top&&!this.right&&!this.bottom&&!this.anchors){apf.layout.processQueue();var d=!this.$ext.offsetParent||this.$ext.offsetParent.tagName=="BODY"?[apf.getWindowWidth(),apf.getWindowHeight()]:[this.$ext.offsetParent.offsetWidth,this.$ext.offsetParent.offsetHeight,0,0];if(d.length==2){d.push(document.documentElement.scrollLeft,document.documentElement.scrollTop);}this.$ext.style.left=(Math.max(0,((d[0]-parseInt(this.$ext.offsetWidth||0))/2))+d[2])+"px";this.$ext.style.top=(Math.max(0,((d[1]-parseInt(this.$ext.offsetHeight||0))/3))+d[3])+"px";}if(this.$amlLoaded&&(this.model||(!this.dockable||!this.aData)&&!this.$isWidget&&this.localName!="toolwindow")){this.focus(false,{mouse:true});}this.dispatchEvent("show");};var c=[],b;this.$propHandlers.visible=function(n){if(apf.isTrue(n)){if(this.dispatchEvent("beforeshow")===false){return(this.visible=false);}if(this.modal){apf.plane.show(this.$ext,false,null,null,{color:"black",opacity:0.5,protect:this.$uniqueId});}this.state=this.state.split("|").remove("closed").join("|");this.$ext.style.display="";if(!apf.canHaveHtmlOverSelects&&this.hideselects){c=[];var k=document.getElementsByTagName("select");for(var m=0;m<k.length;m++){var g=apf.getStyle(k[m],"display");c.push([k[m],g]);k[m].style.display="none";}}if(apf.isIE){var d=this.$ext.className;this.$ext.className="rnd"+Math.random();this.$ext.className=d;}if(this.$rendered===false){this.addEventListener("afterrender",this.$afterRender);}else{this.$afterRender();}}else{if(this.modal){apf.plane.hide(this.$uniqueId);}this.$ext.style.display="none";if(!apf.canHaveHtmlOverSelects&&this.hideselects){for(var m=0;m<c.length;m++){c[m][0].style.display=c[m][1];}}if(this.hasFocus()){apf.window.moveNext(true,this,true);}this.visible=false;this.dispatchEvent("hide");}if(apf.layout&&this.$int){apf.layout.forceResize(this.$int);}b=n;};this.$propHandlers.zindex=function(d){this.$ext.style.zIndex=d+1;};this.addEventListener("keydown",function(k){var g=k.keyCode;var n=k.ctrlKey;var d=k.shiftKey;var m=false;switch(g){case 38:if(d&&this.resizable){this.setProperty("height",Math.max(this.minheight||0,this.$ext.offsetHeight-(n?50:10)));}else{if(this.draggable){this.setProperty("top",this.$ext.offsetTop-(n?50:10));}}break;case 37:if(d&&this.resizable){this.setProperty("width",Math.max(this.minwidth||0,this.$ext.offsetWidth-(n?50:10)));}else{if(this.draggable){this.setProperty("left",this.$ext.offsetLeft-(n?50:10));}}break;case 39:if(d&&this.resizable){this.setProperty("width",Math.min(this.maxwidth||10000,this.$ext.offsetWidth+(n?50:10)));}else{if(this.draggable){this.setProperty("left",this.$ext.offsetLeft+(n?50:10));}}break;case 40:if(d&&this.resizable){this.setProperty("height",Math.min(this.maxheight||10000,this.$ext.offsetHeight+(n?50:10)));}else{if(this.draggable){this.setProperty("top",this.$ext.offsetTop+(n?50:10));}}break;default:m=null;return;}if(apf.hasSingleRszEvent){apf.layout.forceResize(this.$int);}return m;},true);this.addEventListener("keydown",function(d){if(d.keyCode==27&&this.buttons.indexOf("close")>-1&&(!this.dockable||!this.aData)&&this.kbclose){this.close();}});this.$draw=function(){this.popout=apf.isTrue(this.getAttribute("popout"));if(this.popout){this.$pHtmlNode=document.body;}this.$ext=this.$getExternal(null,null,function(g){this.$initButtons(g);});this.oTitle=this.$getLayoutNode("main","title",this.$ext);this.oIcon=this.$getLayoutNode("main","icon",this.$ext);this.oDrag=this.$getLayoutNode("main","drag",this.$ext);this.$buttons=this.$getLayoutNode("main","buttons",this.$ext);if(this.popout){this.$ext.style.position="absolute";}if(this.oIcon){this.oIcon.style.display="none";}var d=this;if(this.oDrag){this.oDrag.host=this;this.oDrag.onmousedown=function(g){if(!g){g=event;}if(!d.$isWidget&&(!d.aData||!d.dockable||d.aData.hidden==3)){apf.WinServer.setTop(d);}if(d.$lastState.maximized){return false;}if(d.aData&&d.dockable){if(d.$lastState.normal){d.startDocking(g);}return false;}};}this.$ext.onmousedown=function(){var g=apf.document.activeElement;if(g&&g.$focusParent!=d&&g.$focusParent.modal){return false;}if(!d.$isWidget&&(!d.aData||!d.dockable||d.aData.hidden==3)){apf.WinServer.setTop(d);}if(!d.$lastState.normal){return false;}};this.$ext.onmousemove=function(){if(!d.$lastState.normal){return false;}};};this.$loadAml=function(g){apf.WinServer.setTop(this);this.$int=this.$getLayoutNode("main","container",this.$ext);if(this.oTitle){var d=this;(this.oTitle.nodeType!=1?this.oTitle.parentNode:this.oTitle).ondblclick=function(k){if(d.state.indexOf("normal")==-1){d.restore();}else{if(d.buttons.indexOf("max")>-1){d.maximize();}else{if(d.buttons.indexOf("min")>-1){d.minimize();}}}};}if(typeof this.draggable=="undefined"){(this.$propHandlers.draggable||apf.GuiElement.propHandlers.draggable).call(this,true);this.draggable=true;}if(typeof this.buttons=="undefined"){this.buttons="";}if(this.modal===undefined){this.$propHandlers.modal.call(this,true);this.modal=true;}if(!this.visible){this.$ext.style.display="none";}else{if(this.modal){var d=this;apf.queue.add("focus",function(){d.focus(false,{mouse:true});});}}if(this.minwidth===undefined){this.minwidth=this.$getOption("Main","min-width");}if(this.minheight===undefined){this.minheight=this.$getOption("Main","min-height");}if(this.maxwidth===undefined){this.maxwidth=this.$getOption("Main","max-width");}if(this.maxheight===undefined){this.maxheight=this.$getOption("Main","max-height");}if(this.center&&this.visible){this.visible=false;this.$ext.style.display="none";var d=this;$setTimeout(function(){d.setProperty("visible",true);});}};this.addEventListener("$skinchange",function(){if(this.title){this.$propHandlers.title.call(this,this.title);}if(this.icon){this.$propHandlers.icon.call(this,this.icon);}});this.$destroy=function(d){if(this.oDrag){this.oDrag.host=null;this.oDrag.onmousedown=null;apf.destroyHtmlNode(this.oDrag);this.oDrag=null;}this.oTitle=this.oIcon=null;if(this.$ext&&!d){this.$ext.onmousedown=null;this.$ext.onmousemove=null;}};}).call(apf.modalwindow.prototype=new apf.Presentation());apf.AmlWindow.prototype=apf.toolwindow.prototype=apf.modalwindow.prototype;apf.aml.setElement("toolwindow",apf.toolwindow);apf.aml.setElement("modalwindow",apf.modalwindow);apf.aml.setElement("window",apf.modalwindow);apf.model=function(c,b){this.$init(b||"model",apf.NODE_HIDDEN,c);this.$amlNodes={};this.$propBinds={};this.$listeners={};this.$proplisteners={};if(!apf.globalModel){apf.globalModel=this;apf.nameserver.register("model","@default",this);}};(function(){this.$parsePrio="020";this.$isModel=true;this.canHaveChildren=false;this.enablereset=false;this.$state=0;this.$attrExcludePropBind=apf.extend({submission:1,src:1,session:1},this.$attrExcludePropBind);this.$booleanProperties.autoinit=true;this.$booleanProperties.enablereset=true;this.$supportedProperties=["submission","src","session","autoinit","enablereset","remote"];this.$propHandlers.src=this.$propHandlers.get=function(b,c){if(this.$amlLoaded){this.$loadFrom(b);}};this.register=function(m,n){if(!m||!m.load){return this;}var g=m.$model==this;if(m.$model&&!g){m.$model.unregister(m);}var q=this.$amlNodes[m.$uniqueId]={amlNode:m,xpath:n};m.$model=this;if(typeof m.noloading=="undefined"&&m.$setInheritedAttribute&&!m.$setInheritedAttribute("noloading")){m.noloading=false;}if(this.$state==1){if(m.clear&&!m.noloading){m.clear("loading");}}else{if(this.data){this.$loadInAmlNode(q);}else{if(m.hasFeature(apf.__CACHE__)){m.clear("empty");}}}var d,k,o=m.$propsUsingMainModel,c=m.$uniqueId;for(var b in o){this.$unbindXmlProperty(m,b);d=this.$bindXmlProperty(m,b,o[b].xpath,o[b].optimize);if(this.data){if(k=d.listen?this.data.selectSingleNode(d.listen):this.data){m.$execProperty(b,k);}else{this.$waitForXml(m,b);}}}return this;};this.$register=function(c,b){this.$amlNodes[c.$uniqueId].xpath=b;};this.unregister=function(b){delete this.$amlNodes[b.$uniqueId];var c=b.$propsUsingMainModel;for(var d in c){this.$unbindXmlProperty(b,d);}b.dispatchEvent("unloadmodel");};this.getXpathByAmlNode=function(b){var c=this.$amlNodes[b.$uniqueId];if(!c){return false;}return c.xpath;};this.$loadInAmlNode=function(g){var d;var b=g.xpath;var c=g.amlNode;if(this.data&&b){d=this.data.selectSingleNode(b);}else{d=this.data||null;}if(d){delete this.$listeners[c.$uniqueId];c.load(d);}else{this.$waitForXml(c);}};this.$loadInAmlProp=function(m,c){var k,d,g=this.$propBinds[m],b=apf.all[m];if(!b){delete this.$propBinds[m];return;}if(b.$noInitModel){delete b.$noInitModel;return;}for(k in g){if(c&&(d=g[k].listen?c.selectSingleNode(g[k].listen):c)){apf.xmldb.addNodeListener(c,b,"p|"+m+"|"+k+"|"+this.$uniqueId);delete this.$proplisteners[m+k];b.$execProperty(k,d);}else{this.$waitForXml(b,k);}}};this.$bindXmlProperty=function(k,b,n,s,o){var c,g,d=k.$uniqueId;if(!this.$propBinds[d]){this.$propBinds[d]={};}g=this.$propBinds[d][b]={bind:n};if(s&&false){if((c=this.$amlNodes[d])&&c.xpath){n=(g.root=c.xpath)+"/"+n;}var m=n.split("/"),r=m.pop();if(r.indexOf("@")==0||r.indexOf("text()")>-1||r.indexOf("node()")>-1){g.listen=m.join("/");}else{g.listen=n;}}else{if((c=this.$amlNodes[d])&&c.xpath){g.listen=c.xpath;}}if(o){g.listen=".";}if(this.data){var t=k.$noInitModel?k.xmlRoot:(g.listen?this.data.selectSingleNode(g.listen):this.data);if(t){apf.xmldb.addNodeListener(t,k,"p|"+k.$uniqueId+"|"+b+"|"+this.$uniqueId);return g;}}this.$waitForXml(k,b);return g;};this.$unbindXmlProperty=function(c,k){var g=c.$uniqueId;var d=this.$propBinds[g]&&this.$propBinds[g][k];if(!d){return;}if(this.data){var b=d.listen?this.data.selectSingleNode(d.listen):this.data;if(b){apf.xmldb.removeNodeListener(b,c,"p|"+g+"|"+k+"|"+this.$uniqueId);}}delete this.$proplisteners[g+k];delete this.$propBinds[g][k];return d;};this.getXml=function(){return this.data?apf.xmldb.cleanNode(this.data.cloneNode(true)):false;};this.setQueryValue=function(b,d){if(!this.data){return false;}var c=apf.createNodeFromXpath(this.data,b);if(!c){return null;}apf.setNodeValue(c,d,true);return c;};this.setQueryValues=function(d,k){if(!this.data){return[];}var c=this.data.selectNodes(d);for(var g=0,b=c.length;g<b;g++){apf.setNodeValue(node,k,true);}return c;};this.queryValue=function(b){if(!this.data){return false;}return apf.queryValue(this.data,b);};this.queryValues=function(b){if(!this.data){return[];}return apf.queryValue(this.data,b);};this.queryNode=function(b){if(!this.data){return null;}return this.data.selectSingleNode(b);};this.queryNodes=function(b){if(!this.data){return[];}return this.data.selectNodes(b);};this.appendXml=function(d,b){var c=b?apf.createNodeFromXpath(this.data,b):this.data;if(!c){return null;}if(typeof d=="string"){d=apf.getXml(d);}else{d=!d.nodeType?d.getXml():apf.xmldb.getCleanCopy(d);}if(!d){return;}apf.xmldb.appendChild(c,d);this.dispatchEvent("update",{xmlNode:d});return d;};this.removeXml=function(b){if(typeof b=="string"){var c=this.data.selectNodes(b);}else{if(!b.length){c=[b];}}if(c.length){apf.xmldb.removeNodeList(c);}};this.clear=function(){this.load(null);doc=null;};this.reset=function(){var b=this.data.ownerDocument;this.data.parentNode.replaceChild(this.$copy,this.data);this.load(this.$copy);};this.savePoint=function(){this.$copy=apf.xmldb.getCleanCopy(this.data);};this.reloadAmlNode=function(d){if(!this.data){return;}var c=this.$amlNodes[d];var b=c.xpath?this.data.selectSingleNode(c.xpath):this.data;c.amlNode.load(b);};this.addEventListener("DOMNodeInsertedIntoDocument",function(d){var b=this.$aml;if(this.parentNode&&this.parentNode.hasFeature(apf.__DATABINDING__)){if(!this.name){this.setProperty("id","model"+this.parentNode.$uniqueId);}this.register(this.parentNode);}if(!this.src){var g,c=b;if(c&&c.childNodes.length){if(apf.getNode(c,[0])){if((g=c.xml||c.serialize()).match(/^[\s\S]*?>([\s\S]*)<[\s\S]*?$/)){g=RegExp.$1;if(!apf.supportNamespaces){g=g.replace(/xmlns=\"[^"]*\"/g,"");}}return this.load(apf.getXmlDom(g).documentElement);}else{if(apf.isJson(c.childNodes[0].nodeValue)){return this.load(apf.getXmlDom(c.childNodes[0].nodeValue).documentElement);}}}if(this.submission){this.load("<data />");}}if(!apf.isFalse(this.autoinit)){this.init();}return this;});this.init=function(b){if(this.session){this.$loadFrom(this.session,{isSession:true});}else{if(this.src){this.$loadFrom(this.src,{callback:b});}}};this.$loadFrom=function(c,d){var k=c.split(":");if(!d){d={};}if(!d.isSession){this.src=c;this.$srcOptions=[c,d];}this.dispatchEvent("beforeretrieve");var o,g;for(o in this.$amlNodes){if(!(g=this.$amlNodes[o])||!g.amlNode){continue;}if(!g.amlNode.noloading){g.amlNode.clear("loading");}}this.$state=1;if(!this.$callCount){this.$callCount=1;}else{this.$callCount++;}var b=this,m=this.$callCount,n=d.callback;d.callback=function(s,r,q){if(m!=b.$callCount){return;}b.dispatchEvent("afterretrieve");if(r!=apf.SUCCESS){var t;t=new Error(apf.formatErrorString(1032,b,"Loading xml data","Could not load data\nInstruction: "+c+"\nUrl: "+q.url+"\nInfo: "+q.message+"\n\n"+s));if(n&&n.apply(this,arguments)===true){return true;}if(q.tpModule&&q.tpModule.retryTimeout(q,r,b,t)===true){return true;}b.$state=0;throw t;}if(d&&d.isSession&&!s){if(this.src){return b.$loadFrom(this.src);}}else{if(d&&d.cancel){return;}b.load(s);b.dispatchEvent("receive",{data:s});if(n){n.apply(this,arguments);}}};return apf.getData(c,d);};this.reload=function(){if(!this.data){return;}if(this.$srcOptions){this.$loadFrom.apply(this,this.$srcOptions);}else{if(this.src){this.$loadFrom(this.src);}}};this.load=function(o,q){if(typeof o=="string"){if(o.charAt(0)=="<"){if(o.substr(0,5).toUpperCase()=="<!DOC"){o=o.substr(o.indexOf(">")+1);}if(!apf.supportNamespaces){o=o.replace(/xmlns\=\"[^"]*\"/g,"");}o=apf.getXmlDom(o,null,true).documentElement;}else{if(apf.isJson(o)){o=apf.json2Xml(o).documentElement;}else{return this.$loadFrom(o,q);}}}if(this.ownerDocument&&this.ownerDocument.$domParser.$shouldWait){var m=this;this.data=o;apf.xmldb.getXmlDocId(o,this);this.$queueLoading=true;apf.queue.add("modelload"+this.$uniqueId,function(){if(m.ownerDocument&&m.ownerDocument.$domParser.$shouldWait){apf.queue.add("modelload"+m.$uniqueId,arguments.callee);}else{m.load(o,q);m.$queueLoading=false;}});return;}else{if(this.$queueLoading){apf.queue.remove("modelload"+this.$uniqueId);}}this.$state=0;if(this.dispatchEvent("beforeload",{xmlNode:o})===false){return false;}var n=o?o.ownerDocument:null;if(o){if(!apf.supportNamespaces){var d=[],k=o.attributes;for(var g=0,c=k.length;g<c;g++){if(k[g].nodeName.substr(0,5)=="xmlns"){d.push(k[g].xml);}}if(d.length){n.setProperty("SelectionNamespaces",d.join(" "));}}apf.xmldb.addNodeListener(o,this);apf.xmldb.nodeConnect(apf.xmldb.getXmlDocId(o,this),o,null,this);if((!q||!q.nocopy)&&this.enablereset){this.$copy=apf.xmldb.getCleanCopy(o);}}this.data=o;this.dispatchEvent("afterload",{xmlNode:o});this.dispatchEvent("update",{xmlNode:o});for(var b in this.$amlNodes){this.$loadInAmlNode(this.$amlNodes[b]);}for(b in this.$propBinds){this.$loadInAmlProp(b,o);}return this;};this.$waitForXml=function(b,c){if(c){this.$proplisteners[b.$uniqueId+c]={id:b.$uniqueId,amlNode:b,prop:c};}else{this.$listeners[b.$uniqueId]=b;}if(b.xmlRoot){b.clear();}};this.$xmlUpdate=function(n,g,m,k){if(n=="replacenode"&&g==this.data.ownerDocument.documentElement){var d=this;setTimeout(function(){d.load(g);});return;}var o,c;for(var q in this.$listeners){if(g=this.data.selectSingleNode(this.$amlNodes[q].xpath||".")){this.$listeners[q].load(g);delete this.$listeners[q];}}for(q in this.$proplisteners){o=this.$proplisteners[q];c=this.$propBinds[o.id][o.prop];if(g=c.listen?this.data.selectSingleNode(c.listen):this.data){delete this.$proplisteners[q];apf.xmldb.addNodeListener(g,o.amlNode,"p|"+o.id+"|"+o.prop+"|"+this.$uniqueId);o.amlNode.$execProperty(o.prop,c.root?this.data.selectSingleNode(c.root):this.data);}}this.dispatchEvent("update",{xmlNode:g,action:n,undoObj:k});};this.$insertFrom=function(c,d){if(!c){return false;}this.dispatchEvent("beforeretrieve");var g=d.callback,b=this;d.callback=function(n,m,k){b.dispatchEvent("afterretrieve");if(!k){k={};}if(m!=apf.SUCCESS){var o;if(k.tpModule.retryTimeout(k,m,d.amlNode||b,o)===true){return true;}if(g&&g.call(this,k.data,m,k)===false){return;}throw o;}if(typeof d.insertPoint=="string"){d.insertPoint=b.data.selectSingleNode(d.insertPoint);}if(typeof d.clearContents=="undefined"&&k.userdata){d.clearContents=apf.isTrue(k.userdata[1]);}(d.amlNode||b).insert(n,d);if(g){g.call(this,k.data,m,k);}};apf.getData(c,d);};this.insert=function(d,b){if(typeof d=="string"){if(d.charAt(0)=="<"){if(d.substr(0,5).toUpperCase()=="<!DOC"){d=d.substr(d.indexOf(">")+1);}if(!apf.supportNamespaces){d=d.replace(/xmlns\=\"[^"]*\"/g,"");}d=apf.getXmlDom(d).documentElement;}else{if(apf.isJson(d)){d=apf.json2Xml(d).documentElement;}else{return this.$insertFrom(d,b);}}}if(!b.insertPoint){b.insertPoint=this.data;}if(typeof b.copyAttributes=="undefined"){b.copyAttributes=true;}var c=apf.mergeXml(d,b.insertPoint,b);apf.xmldb.applyChanges("insert",b.insertPoint);return d;};this.convertXml=function(b){if(!b){return this.data.xml;}return apf.convertXml(this.data,b);};this.submit=function(b,k,g,d){if(!b){b=this.submission;}if(!g){g=this.data;}if(!k){k="form";}if(this.dispatchEvent("beforesubmit",{instruction:b})===false){return false;}var c=this;function n(r,q,o){if((q==apf.TIMEOUT||(c.retryOnError&&q==apf.ERROR))&&o.retries<apf.maxHttpRetries){return o.tpModule.retry(o.id);}else{if(q!=apf.SUCCESS){c.dispatchEvent("submiterror",o);}else{c.dispatchEvent("submitsuccess",apf.extend({data:r},o));}}}var m;if(k.indexOf("xml")>-1){m=apf.getXmlString(g);}else{if(k.indexOf("form")>-1){m=apf.convertXml(apf.xmldb.getCleanCopy(g),"cgiobjects");}else{if(k.indexOf("json")>-1){m=apf.convertXml(g,"json");}}}apf.saveData(b,apf.extend({xmlNode:g,data:m,callback:n},d));this.dispatchEvent("aftersubmit");};this.$destroy=function(){if(this.session&&this.data){apf.saveData(this.session,{xmlNode:this.getXml()});}};}).call(apf.model.prototype=new apf.AmlElement());apf.aml.setElement("model",apf.model);apf.page=function(c,b){this.$init(b||"page",apf.NODE_VISIBLE,c);};(function(){this.canHaveChildren=true;this.$focussable=false;this.closebtn=false;this.setCaption=function(b){this.setProperty("caption",b,false,true);};this.setIcon=function(b){this.setProperty("icon",b,false,true);};this.addEventListener("beforerender",function(){this.parentNode.dispatchEvent("beforerender",{page:this});});this.addEventListener("afterrender",function(){this.parentNode.dispatchEvent("afterrender",{page:this});});this.$booleanProperties.visible=true;this.$booleanProperties.fake=true;this.$booleanProperties.closebtn=true;this.$supportedProperties.push("fake","caption","icon","tooltip","type","buttons","closebtn","trans-in","trans-out");this.$propHandlers.closebtn=function(b){this.closebtn=b;};this.$propHandlers.tooltip=function(c){if(!this.parentNode){return;}var b=this.parentNode.$getLayoutNode("button","caption",this.$button);(b.nodeType==1?b:b.parentNode).setAttribute("title",c||"");};this.$propHandlers.caption=function(c){if(!this.parentNode){return;}var b=this.parentNode.$getLayoutNode("button","caption",this.$button);if(b.nodeType==1){b.innerHTML=c;}else{b.nodeValue=c;}};this.$propHandlers.icon=function(c){if(!this.parentNode){return;}var b=this.parentNode.$getLayoutNode("button","icon",this.$button);if(b&&b.nodeType==1){apf.skins.setIcon(b,c,this.parentNode.iconPath);}};this.$propHandlers.visible=function(g){if(!this.parentNode){return;}if(g){if(this.$fake){this.parentNode.set(this.$fake);this.visible=false;return;}this.$ext.style.display="";if(this.parentNode.$hasButtons){this.$button.style.display="block";}if(!this.parentNode.$activepage){this.parentNode.set(this);}}else{if(this.$active){this.$deactivate();var d=this.parentNode.activepagenr+1;var c=this.parentNode.getPages();var b=c.length;while(d<b&&!c[d].visible){d++;}if(d==b){d=this.parentNode.activepagenr-1;while(d>=0&&b&&!c[d].visible){d--;}}if(d>=0){this.parentNode.set(d);}else{this.parentNode.activepage=this.parentNode.activepagenr=this.parentNode.$activepage=null;}}this.$ext.style.display="none";if(this.parentNode.$hasButtons){this.$button.style.display="none";}}};this.$propHandlers.fake=function(b){if(this.$ext){apf.destroyHtmlNode(this.$ext);this.$int=this.$ext=null;}};this.$propHandlers.type=function(b){this.setProperty("fake",true);if(this.relPage&&this.$active){this.relPage.$deactivate();}this.relPage=this.parentNode.getPage(b);if(this.$active){this.$activate();}};this.addEventListener("DOMNodeRemoved",function(b){if(b&&b.currentTarget!=this){return;}if(this.$button){if(this.$position&1){this.parentNode.$setStyleClass(this.$button,"",["firstbtn","firstcurbtn"]);}if(this.$position&2){this.parentNode.$setStyleClass(this.$button,"",["lastbtn"]);}}if(!b.$doOnlyAdmin){if(this.$button){this.$button.parentNode.removeChild(this.$button);}if(this.parentNode&&this.parentNode.$activepage==this){if(this.$button){this.parentNode.$setStyleClass(this.$button,"",["curbtn"]);}this.parentNode.$setStyleClass(this.$ext,"",["curpage"]);}}});this.addEventListener("DOMNodeInserted",function(b){if(b&&b.currentTarget!=this||!this.$amlLoaded||!b.$oldParent){return;}if(!b.$isMoveWithinParent&&this.skinName!=this.parentNode.skinName){this.$destroy();}else{if(this.$button&&b.$oldParent.$hasButtons){this.parentNode.$buttons.insertBefore(this.$button,b.$beforeNode&&b.$beforeNode.$button||null);}}},true);this.$position=0;this.$first=function(b){if(b){this.$isFirst=false;this.$position-=1;this.parentNode.$setStyleClass(this.$button,"",["firstbtn","firstcurbtn"]);}else{this.$isFirst=true;this.$position=this.$position|1;this.parentNode.$setStyleClass(this.$button,"firstbtn"+(this.parentNode.$activepage==this?" firstcurbtn":""));}};this.$last=function(b){if(b){this.$isLast=false;this.$position-=2;this.parentNode.$setStyleClass(this.$button,"",["lastbtn"]);}else{this.$isLast=true;this.$position=this.$position|2;this.parentNode.$setStyleClass(this.$button,"lastbtn");}};this.$deactivate=function(b){this.$active=false;if(this.parentNode.$hasButtons){if(this.$position>0){this.parentNode.$setStyleClass(this.$button,"",["firstcurbtn"]);}this.parentNode.$setStyleClass(this.$button,"",["curbtn"]);}if((!this.fake||this.relPage)&&!b){this.parentNode.$setStyleClass(this.fake?this.relPage.$ext:this.$ext,"",["curpage"]);if(this.fake){if(!this.relPage.visible){this.relPage.$ext.style.display="none";}this.relPage.dispatchEvent("prop.visible",{value:false});}this.dispatchEvent("prop.visible",{value:false});}};this.$activate=function(){this.$active=true;if(!this.$drawn){var c;this.addEventListener("DOMNodeInsertedIntoDocument",c=function(d){this.removeEventListener("DOMNodeInsertedIntoDocument",c);if(!this.$active){return;}this.$activate();});return;}if(this.parentNode.$hasButtons){if(this.$isFirst){this.parentNode.$setStyleClass(this.$button,"firstcurbtn");}this.parentNode.$setStyleClass(this.$button,"curbtn");}if(!this.fake||this.relPage){if(this.fake){if(this.relPage){this.relPage.$ext.style.display="";this.parentNode.$setStyleClass(this.relPage.$ext,"curpage");this.relPage.$fake=this;if(this.relPage.$render){this.relPage.$render();}this.relPage.dispatchEvent("prop.visible",{value:true});}}else{this.parentNode.$setStyleClass(this.$ext,"curpage");}if(apf.layout&&this.relPage){apf.layout.forceResize(this.fake?this.relPage.$int:this.$int);}}if(this.$render){this.$render();}if(!this.fake){if(apf.isIE){var b=this.$ext.className;this.$ext.className="rnd"+Math.random();this.$ext.className=b;}this.dispatchEvent("prop.visible",{value:true});}};this.addEventListener("$skinchange",function(){if(this.caption){this.$propHandlers.caption.call(this,this.caption);}if(this.icon){this.$propHandlers.icon.call(this,this.icon);}});this.$enable=function(){if(this.$button){this.$setStyleClass(this.$button,null,["btnDisabled"]);}};this.$disable=function(){if(this.$button){this.$setStyleClass(this.$button,"btnDisabled");}};this.$canLeechSkin=true;this.$draw=function(c){this.skinName=this.parentNode.skinName;var b=this.getAttribute("type");if(b){this.fake=true;this.relPage=this.parentNode.getPage(b)||null;}if(this.parentNode.$hasButtons){this.parentNode.$getNewContext("button");var d=this.parentNode.$getLayoutNode("button");d.setAttribute(this.parentNode.$getOption("main","select")||"onmousedown","var page = apf.lookup("+this.$uniqueId+');                 if (page.disabled) return;                 if (event.button == 2 &amp;&amp; page.parentNode.contextmenu) {                    page.parentNode.contextPage = page;                    return;                 }                 page.parentNode.set(page);                 page.canHaveChildren = 2;                 page.$setStyleClass(this, "down", null, true);');d.setAttribute("onmouseup","apf.lookup("+this.parentNode.$uniqueId+').$setStyleClass(this, "", ["down"], true);');d.setAttribute("onmouseover","var o = apf.lookup("+this.parentNode.$uniqueId+");if(apf.lookup("+this.$uniqueId+') != o.$activepage) o.$setStyleClass(this, "over", null, true);');d.setAttribute("onmouseout","var o = apf.lookup("+this.parentNode.$uniqueId+');                  o.$setStyleClass(this, "", ["over"], true);                  var page = apf.lookup('+this.$uniqueId+");                  page.canHaveChildren = true;");var q=this.getAttribute("class");if(q){apf.setStyleClass(d,q);}var m=this.getAttribute("closebtn");if((apf.isTrue(m)||((this.parentNode.buttons||"").indexOf("close")>-1&&!apf.isFalse(m)))){var n=this.parentNode.$getLayoutNode("button","container");this.parentNode.$getNewContext("btnclose");var k=this.parentNode.$getLayoutNode("btnclose");if(k){apf.setStyleClass(d,"btnclose");k.setAttribute("onmousedown","apf.cancelBubble(event, apf.lookup("+this.$uniqueId+"));");k.setAttribute("onclick","var page = apf.lookup("+this.$uniqueId+");                         page.parentNode.remove(page, event);");n.appendChild(k);}}this.$button=apf.insertHtmlNode(d,this.parentNode.$buttons);if(this.parentNode.$scale){var o=apf.getHtmlInnerWidth(this.parentNode.$buttons);var g=this.parentNode.getPages().length;this.$button.style.width=Math.round(Math.min(o/g,this.parentNode.$maxBtnWidth))+"px";}if(!c&&this.nextSibling&&this.nextSibling.$button){this.$button.parentNode.insertBefore(this.$button,this.nextSibling.$button);}this.$button.host=this;}if(this.fake){return;}if(this.$ext){this.$ext.parentNode.removeChild(this.$ext);}this.$ext=this.parentNode.$getExternal("page",this.parentNode.oPages,null,this);this.$ext.host=this;this.$int=this.parentNode.$getLayoutNode("page","container",this.$ext);if(this.$isLast){this.$last();}if(this.$isFirst){this.$first();}};this.$destroy=function(){if(this.$button){if(!this.parentNode.$amlDestroyed){this.$button.parentNode.removeChild(this.$button);}this.$button.host=null;this.$button=null;}};}).call(apf.page.prototype=new apf.Presentation());apf.aml.setElement("page",apf.page);apf.pager=function(c,b){this.$init(b||"pager",apf.NODE_VISIBLE,c);};(function(){this.previous="Previous";this.next="Next";this.range=5;this.curpage=1;this.totalpages=0;this.autohide=false;this.oEmpty=null;this.$attrExcludePropBind=apf.extend({pageload:1},this.$attrExcludePropBind);this.$supportedProperties.push("range","curpage","totalpages","previous","next","autohide","pageload");this.$booleanProperties.autohide=true;this.$propHandlers.curpage=function(b){this.gotoPage(b);};this.gotoPage=function(m,g,k){if(k&&this.disabled){return;}var d=this.curpage;this.curpage=m||this.curpage+g;if(d!=this.curpage){this.setProperty("curpage",this.curpage);}if(this.curpage<1){this.curpage=1;}else{if(this.totalpages&&this.curpage>this.totalpages){this.curpage=this.totalpages;}}if(this.dispatchEvent("beforepagechange",{page:this.curpage})===false){return false;}var c=this.getModel(true),b=this;if(c){c.$loadFrom(this.pageload,{xmlNode:this.xmlRoot,page:this.curpage,callback:function(){b.dispatchEvent("afterpagechange",{page:b.curpage});}});}else{$setTimeout(function(){var n=b.getModel(true);if(n){n.$loadFrom(b.pageload,{xmlNode:b.xmlRoot,page:b.curpage,callback:function(){b.dispatchEvent("afterpagechange",{page:b.curpage});}});}b.removeEventListener("afterload",arguments.callee);});}};this.addEventListener("$clear",function(b){return false;});this.$setClearMessage=function(c,b){if(!this.$empty){this.$empty=this.$container.ownerDocument.createElement("span");this.$setStyleClass(this.$empty,"loader");}if(b=="loading"){this.$setStyleClass(this.$ext,this.$baseCSSname+"Loading");this.$container.appendChild(this.$empty);}};this.$removeClearMessage=function(){if(this.$empty&&this.$empty.parentNode){this.$empty.parentNode.removeChild(this.$empty);this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Loading"]);}};this.$draw=function(){this.$ext=this.$getExternal("main");this.$container=this.$getLayoutNode("main","container",this.$ext);};this.$load=function(g){this.setProperty("curpage",parseInt(this.$applyBindRule("current",g)));this.setProperty("totalpages",parseInt(this.$applyBindRule("total",g)));var k=this.curpage,o=this.totalpages,b=[],d;this.$container.innerHTML="";if(!o){return;}if(k!=1||!this.autohide){this.$getNewContext("button");d=this.$getLayoutNode("button");this.$getLayoutNode("button","caption").nodeValue=this.previous;this.$setStyleClass(d,"previous");if(k!=1){d.setAttribute("onclick","apf.lookup("+this.$uniqueId+").gotoPage(null, -1, true)");d.setAttribute("onmousedown",'apf.setStyleClass(this, "down");');d.setAttribute("onmouseup",'apf.setStyleClass(this,"", ["down"]);');}else{this.$setStyleClass(d,"disabled");}b.push(d);}var q=Math.floor(this.range/2),c=Math.max(1,k-q),m=Math.min(o+1,c+this.range),n;if(m-c<this.range&&c!=1){c=Math.max(m-this.range,1);}for(n=c;n<m;n++){this.$getNewContext("button");d=this.$getLayoutNode("button");this.$getLayoutNode("button","caption").nodeValue=n;d.setAttribute("onclick","apf.lookup("+this.$uniqueId+").gotoPage("+n+", null, true)");d.setAttribute("onmousedown",'apf.setStyleClass(this, "down");');d.setAttribute("onmouseup",'apf.setStyleClass(this,"", ["down"]);');b.push(d);if(n==k){this.$setStyleClass(d,"current");}}if(k!=o||!this.autohide){this.$getNewContext("button");d=this.$getLayoutNode("button");this.$getLayoutNode("button","caption").nodeValue=this.next;this.$setStyleClass(d,"next");if(k!=o){d.setAttribute("onclick","apf.lookup("+this.$uniqueId+").gotoPage(null, 1, true)");d.setAttribute("onmousedown",'apf.setStyleClass(this, "down");');d.setAttribute("onmouseup",'apf.setStyleClass(this,"", ["down"]);');}else{this.$setStyleClass(d,"disabled");}b.push(d);}apf.insertHtmlNodes(b,this.$container);if(this.$empty){this.$container.appendChild(this.$empty);}};}).call(apf.pager.prototype=new apf.StandardBinding());apf.aml.setElement("pager",apf.pager);apf.aml.setElement("total",apf.BindingRule);apf.aml.setElement("current",apf.BindingRule);apf.param=function(c,b){this.$init(b||"param",apf.NODE_HIDDEN,c);};apf.param.prototype=new apf.AmlElement();apf.param.prototype.$parsePrio="002";apf.aml.setElement("variable",apf.param);apf.aml.setElement("param",apf.param);apf.propedit=function(c,b){this.$init(b||"propedit",apf.NODE_VISIBLE,c);this.$nodes=[];this.$editors={};this.$dynCssClasses=[];};(function(){this.$init(function(){this.addEventListener("keydown",b,true);});this.implement(apf.Cache);this.implement(apf.DataAction);this.$focussable=true;this.$isTreeArch=true;this.$isWindowContainer=-1;this.startClosed=true;this.$animType=apf.tween.NORMAL;this.$animSteps=3;this.$animSpeed=20;this.$useiframe=0;this.$attrExcludePropBind=apf.extend({properties:3},this.$attrExcludePropBind);this.$booleanProperties.iframe=true;this.$propHandlers.properties=function(m){if(!m){return this.clear();}var d=this;var k={load:function(n){d.$loadingProps=false;if(typeof n=="string"){n=apf.getXml(n);}d.$properties=n;d.$allowLoad=true;if(d.$loadqueue){d.$checkLoadQueue();}else{if(d.xmlRoot){d.load(d.xmlRoot);}}delete d.$allowLoad;},clear:function(){d.$loadingProps=false;},xmlRoot:this.xmlRoot};var g;this.$loadingProps=true;if(typeof m=="string"){if(m.substr(0,1)=="<"){k.load(m);}else{apf.setModel(m,k);}}else{if(m.$isModel){m.register(k);}else{if(this.$properties==m&&!this.caching){return;}k.load(m);}}if(this.$properties){this.$prevProperties=this.$properties;}delete this.$properties;};this.addEventListener("prop.properties",function(d){if(!d.changed&&this.$loadqueue){this.$propHandlers.properties.call(this,d.value);}});this.$columns=["50%","50%"];this.$propHandlers.columns=function(d){this.$columns=d&&d.splitSafe(",")||["50%","50%"];if(this.$headings){this.$headings[0].setProperty("width",this.$columns[0]);this.$headings[1].setProperty("width",this.$columns[1]);}};this.$propHandlers.filter=function(m){if(!m){this.$allowLoad=2;var o=this.xmlRoot;this.clear();if(this.$searchProperties){this.$properties=this.$searchProperties;delete this.$searchProperties;}this.load(o);delete this.$allowLoad;return;}var n=(this.$searchProperties||(this.$searchProperties=this.$getProperties())).cloneNode(true);var d=n.selectNodes("//node()[not(local-name()='group' or contains(translate(@caption, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), '"+m+"'))]");for(var g=d.length-1;g>=0;g--){d[g].parentNode.removeChild(d[g]);}d=n.selectNodes("//node()[local-name()='group' and not(node())]");var k;for(var g=d.length-1;g>=0;g--){k=d[g].parentNode;k.removeChild(d[g]);if(!k.childNodes.length&&k.parentNode){k.parentNode.removeChild(k);}}var o=this.xmlRoot;this.clear();this.$properties=n;this.$allowLoad=2;this.load(o,{force:true});delete this.$allowLoad;};function c(){var d=(this.current||this.$selected),g=this.$body;g.scrollTop=(d.offsetTop)-21;}this.$findHtmlNode=function(d){return this.$pHtmlDoc.getElementById(d);};function b(x){var D=x.keyCode,k=x.ctrlKey,r=x.shiftKey;var d=this.$lastEditor&&this.$lastEditor[2],B=this.$useiframe?this.oDoc.documentElement:this.$body,q,u,n,C,A,s,g;switch(D){case 36:return false;case 35:return false;case 107:break;case 37:this.$slideToggle(this.$selected.firstChild);return false;case 107:case 39:this.$slideToggle(this.$selected.firstChild);return false;case 38:var u=d;var y=d.previousSibling;while(y&&y.nodeType!=1){y=y.previousSibling;}if(y){var m=y,t;while((t=m.selectNodes("prop")).length){m=t[t.length-1];}y=m;}else{y=u.parentNode;if(y[apf.TAGNAME]!="prop"){y=y.previousSibling;while(y&&y.nodeType!=1){y=y.previousSibling;}if(y&&y[apf.TAGNAME]!="prop"){y=(t=y.selectNodes("prop"))[t.length-1];while(y&&y.nodeType!=1){y=y.previousSibling;}}}}if(!y){return;}var w=apf.xmldb.findHtmlNode(y,this);while(!w.offsetWidth){w=apf.xmldb.findHtmlNode(y=y.parentNode,this);}var o=apf.getAbsolutePosition(w,this.$body)[1]-(w.offsetHeight/2);if(o<=this.$ext.scrollTop){this.$ext.scrollTop=o;}this.select(w);return false;case 40:var u,y=(u=d).selectSingleNode("prop")||u.nextSibling;do{while(y&&(y.nodeType!=1||y[apf.TAGNAME]!="prop")){y=y.nextSibling;}if(!y){y=u.parentNode.nextSibling;if(y&&y[apf.TAGNAME]!="prop"){y=y.selectSingleNode("prop");}}}while(y&&y.nodeType!=1);if(!y){return;}var w=apf.xmldb.findHtmlNode(y,this);while(!w.offsetWidth){w=apf.xmldb.findHtmlNode(y=y.parentNode,this);}if(y==u){y=u.nextSibling;while(y&&(y.nodeType!=1||y[apf.TAGNAME]!="prop")){y=y.nextSibling;}var w=apf.xmldb.findHtmlNode(y,this);}var o=apf.getAbsolutePosition(w,this.$body)[1]+(w.offsetHeight/2);if(o>this.$ext.scrollTop+this.$ext.offsetHeight){this.$ext.scrollTop=o-this.$ext.offsetHeight;}this.select(w);return false;}}this.$focus=function(){if(!this.$ext||(apf.isIE&&this.$useiframe&&this.cssfix)){return;}this.$setStyleClass(this.oFocus||this.$ext,this.$baseCSSname+"Focus");if(this.oDoc){this.$setStyleClass(this.oDoc.documentElement,this.$baseCSSname+"Focus");}if(this.$lastEditor){this.$lastEditor[0].$focus();}};this.$blur=function(){if(this.renaming){this.stopRename(null,true);}if(!this.$ext||(apf.isIE&&this.$useiframe&&this.cssfix)){return;}this.$setStyleClass(this.oFocus||this.$ext,"",[this.$baseCSSname+"Focus"]);if(this.oDoc){this.$setStyleClass(this.oDoc.documentElement,"",[this.$baseCSSname+"Focus"]);}if(this.$lastEditor){this.$lastEditor[0].$blur();}};this.$slideToggle=function(d){container=d.parentNode.lastChild;if(apf.getStyle(container,"display")=="block"){d.className=d.className.replace(/min/,"plus");this.$slideClose(container);}else{d.className=d.className.replace(/plus/,"min");this.$slideOpen(container);}};this.$slideOpen=function(d){d.style.display="";apf.tween.single(d,{type:"scrollheight",from:3,diff:-2,to:d.scrollHeight,anim:this.$animType,steps:this.$animSteps,interval:this.$animSpeed,onfinish:function(g){g.style.overflow="visible";g.style.height="auto";}});};this.$slideClose=function(d){d.style.height=d.offsetHeight;d.style.overflow="hidden";apf.tween.single(d,{type:"scrollheight",from:d.scrollHeight,diff:-2,to:0,anim:this.$animType,steps:this.$animSteps,interval:this.$animSpeed,onfinish:function(g,k){g.style.display="none";}});};this.$findContainer=function(g){var d=g.nextSibling;if(!d){return g;}return d.nodeType==1?d:d.nextSibling;};this.addEventListener("bindingsload",this.$loaddatabinding=function(k){var m=k.bindings.properties;if(!m||!m.length){return;}for(var g=0,d=m.length;g<d;g++){}});this.$unloaddatabinding=function(){};this.getColumn=function(d){return this.$headings[d||this.$lastcol||0];};this.resizeColumn=function(k,g){var d=this.$headings[k];d.resize(g);};this.hideColumn=function(g){var d=this.$headings[g];d.hide();};this.showColumn=function(g){var d=this.$headings[g];d.show();};this.$getProperties=function(g){if(this.properties){return this.$properties||false;}else{if(this.$bindings.properties){var k=this.$bindings.properties;for(var d=0;d<k.length;d++){if(!k[d].match){return xx;}}}}return false;};this.$canLoadData=function(){if(this.$allowLoad||!this.$attrBindings.properties){return this.$getProperties()?true:false;}else{if(false){var d=this;apf.queue.add("load"+this.$uniqueId,function(){d.$allowLoad=true;d.$checkLoadQueue();delete d.$allowLoad;});return false;}}};this.$generateCacheId=function(d){var g=this.$getProperties();return g?g.getAttribute(apf.xmldb.xmlIdTag)||apf.xmldb.nodeConnect(apf.xmldb.getXmlDocId(g),g):0;};this.$getCurrentFragment=function(){var d=this.$container.ownerDocument.createDocumentFragment();d.properties=this.$searchProperties||this.$prevProperties||this.$properties;while(this.$container.childNodes.length){d.appendChild(this.$container.childNodes[0]);}this.clearSelection();return d;};this.$setCurrentFragment=function(d){this.$container.appendChild(d);if(!apf.window.hasFocus(this)){this.blur();}apf.xmldb.addNodeListener(this.xmlRoot,this);if(this.filter&&this.$allowLoad!=2){delete this.$searchProperties;this.$prevProperties=d.properties;this.$propHandlers.filter.call(this,this.filter);}else{this.$xmlUpdate(null,this.xmlRoot);this.$properties=d.properties;this.select(apf.xmldb.findHtmlNode(this.$properties.selectSingleNode(".//prop"),this));}};this.$load=function(n){var q=this.$getProperties();if(!q){return false;}var k=[];var m=this.documentId=apf.xmldb.getXmlDocId(q);apf.xmldb.addNodeListener(n,this);var d=this,o=q.ownerDocument;(function g(t,E,A){for(var G,H,F,D,C,B,w,y=0,x=t.length;y<x;y++){w=t[y];d.$getNewContext("row");B=d.$getLayoutNode("row");if(w[apf.TAGNAME]=="group"){d.$getNewContext("cell");apf.setStyleClass(B,"heading");F=B.appendChild(d.$getLayoutNode("cell"));apf.setNodeValue(d.$getLayoutNode("cell","caption",F),(w.getAttribute("caption")||"").trim()||"");C=B.appendChild(o.createElement("blockquote"));g(w.selectNodes("prop"),C,A);B.insertBefore(G=o.createElement("u"),B.firstChild).appendChild(o.createTextNode(" "));G.setAttribute("class","min");}else{apf.xmldb.nodeConnect(m,w,B,d);d.$getNewContext("cell");h=d.$headings[0];F=B.appendChild(d.$setStyleClass(d.$getLayoutNode("cell"),h.$className));apf.setNodeValue(d.$getLayoutNode("cell","caption",F),(w.getAttribute("caption")||"").trim()||"");if(A){F.firstChild.setAttribute("style","padding-left:"+(A*15)+"px");}d.$getNewContext("cell");h=d.$headings[1];F=B.appendChild(d.$setStyleClass(d.$getLayoutNode("cell"),h.$className));apf.setNodeValue(d.$getLayoutNode("cell","caption",F),((apf.lm.compile(w.getAttribute("value"),{nostring:true}))(d.xmlRoot)||"")||"");if((H=w.selectNodes("prop")).length){C=B.appendChild(o.createElement("blockquote"));C.setAttribute("style","display:none;overflow:hidden;height:0;");g(H,d.$getLayoutNode("heading","container",C),A+1);B.insertBefore(G=o.createElement("u"),B.firstChild).appendChild(o.createTextNode(" "));G.setAttribute("class","plus");}}if(!E){k.push(B);}else{E.appendChild(B);}}})(q.selectNodes("group|prop"),null,0);apf.insertHtmlNodes(k,this.$body);this.setProperty("root",this.xmlRoot);var r=q.selectSingleNode(".//prop");if(r){this.select(this.$findHtmlNode(r.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId));}if(this.filter&&this.$allowLoad!=2){delete this.$searchProperties;this.$propHandlers.filter.call(this,this.filter);}};this.$xmlUpdate=function(o,t,k,r){if(t!=this.xmlRoot){return;}if(r&&this.$lastEditor[0]==r.amlNode){this.$lastEditor[1].firstChild.innerHTML=((apf.lm.compile(this.$lastEditor[2].getAttribute("value"),{nostring:true}))(this.xmlRoot)||"")||"";}else{var g=this.$getProperties();if(!g){return;}var m,s,d=g.selectNodes(".//group/prop");for(var q=0,n=d.length;q<n;q++){m=d[q];s=this.$findHtmlNode(m.getAttribute(apf.xmldb.xmlIdTag)+"|"+this.$uniqueId);s.childNodes[s.firstChild.tagName=="U"?2:1].firstChild.innerHTML=((apf.lm.compile(m.getAttribute("value"),{nostring:true}))(this.xmlRoot)||"")||"";}}};this.$hideEditor=function(d){if(this.$lastEditor){this.$lastEditor[0].setProperty("visible",false);if(d){var n=this.$lastEditor[0].$ext.parentNode;n.removeChild(this.$lastEditor[0].$ext);n.removeAttribute("id");delete n.onresize;}var k=this.$lastEditor[1].childNodes;for(var m=0,g=k.length;m<g;m++){if(!k[m].host){k[m].style.display="";}}delete this.$lastEditor;}};this.clearSelection=function(){this.$setStyleClass(this.$selected,"",["selected"]);delete this.$selected;this.$hideEditor();};this.select=function(A){if(this.disabled){return;}if(this.$selected==A){return;}if(this.$selected){this.$setStyleClass(this.$selected,"",["selected"]);}this.$setStyleClass(A,"selected");this.$selected=A;this.$hideEditor();var g=apf.xmldb.getNode(A);var u=this;this.setProperty("selected",g);var w=this.$selected.childNodes[this.$selected.firstChild.tagName=="U"?2:1];var y,t=g.getAttribute("editor");var o=apf.lm.compile(t,{xpathmode:2});if(o.type==2){if(!this.$editors[t]){var x=apf.namespaces[apf.ns.aml].elements[t];var m="textarea|textbox|secret".indexOf(t)>-1;var k={htmlNode:w,width:"100%+2",height:19,style:"position:relative;",value:"[{"+this.id+".root}::"+(v=g.getAttribute("value")).substr(1,v.length-2)+"]",focussable:false,realtime:!m};if(m){k.focusselect=true;k.onkeydown=function(B){if(B.keyCode==13){this.change(this.getValue());}};}else{if(t=="checkbox"){k.values="true|false";}}if(x.prototype.hasFeature(apf.__MULTISELECT__)){k.caption="[text()]";k.eachvalue="[@value]";k.each="item";k.model="{apf.xmldb.getElementById('"+g.getAttribute(apf.xmldb.xmlIdTag)+"')}";}y=this.$editors[t]=new x(k);var s=apf.getBox(apf.getStyle(y.$ext,"margin"));if(s[1]||s[3]){y.setAttribute("width","100%+2-"+(s[1]+s[3]));}else{if(!s[3]){y.$ext.style.marginLeft="-1px";}}y.parentNode=this;y.$focusParent=this;y.setAttribute("focussable","true");y.$parentId=w.getAttribute("id");y.$parentRsz=w.onresize;y.$executeAction=function(H,D,F,E,G,C,B){if(H=="setAttribute"&&!D[2]){H="removeAttribute";}this.parentNode.$executeAction.call(this.parentNode,H,D,F,E,G,C,B);};}else{y=this.$editors[t];if(y.hasFeature(apf.__MULTISELECT__)){y.setAttribute("model","{apf.xmldb.getElementById('"+g.getAttribute(apf.xmldb.xmlIdTag)+"')}");}y.setAttribute("value","[{"+this.id+".root}::"+(v=g.getAttribute("value")).substr(1,v.length-2)+"]");y.setProperty("visible",true);if(y.$ext.parentNode&&y.$ext.parentNode.nodeType==1&&!apf.hasSingleResizeEvent){if(!y.$parentRsz){y.$parentRsz=y.$ext.parentNode.onresize;}y.$ext.parentNode.removeAttribute("id");delete y.$ext.parentNode.onresize;}w.appendChild(y.$ext);w.setAttribute("id",w.$parentId);if(y.$parentRsz&&!apf.hasSingleResizeEvent){w.onresize=y.$parentRsz;w.onresize();}}}else{var r=o.call(this,this.xmlRoot);if(r.localName=="template"){}else{}}var d=w.childNodes;for(var q=0,n=d.length;q<n;q++){if(!d[q].host){d[q].style.display="none";}}this.$lastEditor=[y,w,g];};this.addEventListener("$clear",function(d){this.$hideEditor(true);});this.$draw=function(){this.$ext=this.$getExternal();this.$body=this.$getLayoutNode("main","body",this.$ext);this.$head=this.$getLayoutNode("main","head",this.$ext);this.$pointer=this.$getLayoutNode("main","pointer",this.$ext);this.$container=this.$body;if(this.$head.firstChild){this.$head.removeChild(this.$head.firstChild);}if(this.$body.firstChild){this.$body.removeChild(this.$body.firstChild);}var g=this.$widthdiff=this.$getOption("main","widthdiff")||0;this.$defaultwidth=this.$getOption("main","defaultwidth")||"100";this.$useiframe=apf.isIE&&(apf.isTrue(this.$getOption("main","iframe"))||this.iframe);var d=this;if(this.$useiframe&&!this.oIframe){var k=this.$body.className;this.oIframe=this.$body.appendChild(document.createElement(apf.isIE?"<iframe frameborder='0'></iframe>":"iframe"));this.oIframe.frameBorder=0;this.oWin=this.oIframe.contentWindow;this.oDoc=this.oWin.document;this.oDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">                <html xmlns="http://www.w3.org/1999/xhtml">                    <head><script>                        apf = {                            lookup : function(uid){                                return window.parent.apf.lookup(uid);                            },                            Init : {add:function(){},run:function(){}}                        };<\/script>                    </head>                    <body></body>                </html>');this.$body=this.oDoc.body;this.$body.className=k;this.oDoc.documentElement.className=this.$ext.className;apf.skins.loadCssInWindow(this.skinName,this.oWin,this.mediaPath,this.iconPath);if(apf.isIE){this.$setStyleClass(this.oDoc.documentElement,this.$baseCSSname+"Focus");}apf.convertIframe(this.oIframe,true);if(apf.getStyle(this.oDoc.documentElement,"overflowY")=="auto"){this.oIframe.onresize=function(){d.$head.style.marginRight=d.oDoc.documentElement.scrollHeight>d.oDoc.documentElement.offsetHeight?"16px":"0";};this.addEventListener("afterload",this.oIframe.onresize);this.addEventListener("xmlupdate",this.oIframe.onresize);}this.oDoc.documentElement.onmousedown=function(m){if(!m){m=d.oWin.event;}if((m.srcElement||m.target).tagName=="HTML"){apf.popup.forceHide();}};this.oDoc.documentElement.onscroll=function(){if(d.$isFixedGrid){d.$head.scrollLeft=d.oDoc.documentElement.scrollLeft;}};}else{if(apf.getStyle(this.$body,"overflowY")=="auto"){this.$resize=function(){d.$head.style.marginRight=d.$body.scrollHeight>d.$body.offsetHeight?"16px":"0";};this.addEventListener("resize",this.$resize);this.addEventListener("afterload",this.$resize);this.addEventListener("xmlupdate",this.$resize);}this.$body.onmousedown=function(m){if(!m){m=event;}if((m.srcElement||m.target)==this){apf.popup.forceHide();}};this.$body.onscroll=function(){if(d.$isFixedGrid){d.$head.scrollLeft=d.$body.scrollLeft;}};}var d=this;this.$body.onmousedown=function(n){if(!n){n=event;}var m=n.srcElement||n.target;if(m==this){return;}if(m.tagName=="U"){d.$slideToggle(m);return;}while(m.host||(m.getAttribute(apf.xmldb.htmlIdTag)||"").indexOf("|")==-1){m=m.parentNode;if(m==this){return;}}d.select(m);};};this.$loadAml=function(d){this.$headings=[new apf.BindingColumnRule().$draw(this,"Property",this.$columns[0],"first"),new apf.BindingColumnRule().$draw(this,"Value",this.$columns[1])];};this.$destroy=function(){apf.popup.removeContent(this.$uniqueId);for(var d in this.$editors){this.$editors[d].destroy();}this.$ext.onclick=null;};}).call(apf.propedit.prototype=new apf.DataBinding());apf.aml.setElement("propedit",apf.propedit);apf.aml.setElement("column",apf.BindingColumnRule);apf.aml.setElement("description",apf.BindingRule);apf.aml.setElement("color",apf.BindingRule);apf.radiobutton=function(c,b){this.$init(b||"radiobutton",apf.NODE_VISIBLE,c);};(function(){this.implement(apf.ChildValue);this.$childProperty="label";this.$focussable=apf.KEYBOARD;this.$booleanProperties.checked=true;this.$supportedProperties.push("value","background","group","label","checked","tooltip","icon");this.$propHandlers.group=function(b){if(!this.$amlLoaded){return;}if(this.$group&&this.$group.$removeRadio){this.$group.$removeRadio(this);}if(!b){this.$group=null;return;}var c=typeof b=="string"?apf.nameserver.get("radiogroup",b):b;if(!c){c=apf.nameserver.register("radiogroup",b,new apf.$group());c.setAttribute("id",b);c.dispatchEvent("DOMNodeInsertedIntoDocument");c.parentNode=this;}this.$group=c;if(this.oInput){this.oInput.setAttribute("name",b);}this.$group.$addRadio(this);};this.$propHandlers.tooltip=function(b){this.$ext.setAttribute("title",b);};this.$propHandlers.icon=function(b){if(!this.oIcon){return;}if(b){this.$setStyleClass(this.$ext,this.$baseCSSname+"Icon");}else{this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Icon"]);}apf.skins.setIcon(this.oIcon,b,this.iconPath);};this.$propHandlers.label=function(b){if(b){this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Empty"]);}else{this.$setStyleClass(this.$ext,this.$baseCSSname+"Empty");}if(this.oLabel){this.oLabel.innerHTML=b;}};this.$propHandlers.checked=function(b){if(!this.$group){return;}if(b){this.$group.setProperty("value",this.value);}};this.$propHandlers.selected=function(b){this.setProperty("checked",b);};this.addEventListener("prop.model",function(b){if(this.$group){this.$group.setProperty("model",b.value);}});this.$propHandlers.background=function(d){var g=this.$getLayoutNode("main","background",this.$ext);if(d){var c=d.split("|");this.$background=c.concat(["vertical",2,16].slice(c.length-1));g.style.backgroundImage="url("+this.mediaPath+c[0]+")";g.style.backgroundRepeat="no-repeat";}else{g.style.backgroundImage="";g.style.backgroundRepeat="";this.$background=null;}};this.setValue=function(b){this.setProperty("value",b,false,true);};this.getValue=function(){return this.value;};this.select=this.check=function(){this.setProperty("checked",true,false,true);};this.uncheck=function(){this.setProperty("checked",false,false,true);};this.getGroup=function(){return this.$group;};this.$check=function(b){this.$setStyleClass(this.$ext,this.$baseCSSname+"Checked");this.checked=true;if(this.oInput){this.oInput.checked=true;}this.doBgSwitch(2);};this.$uncheck=function(){this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Checked"]);this.checked=false;if(this.oInput){this.oInput.checked=false;}this.doBgSwitch(1);};this.$enable=function(){if(this.oInput){this.oInput.disabled=false;}var b=this;this.$ext.onclick=function(c){if(!c){c=event;}if((c.srcElement||c.target)==this){return;}b.dispatchEvent("click",{htmlEvent:c});b.$group.change(b.value);};this.$ext.onmousedown=function(c){if(!c){c=event;}if((c.srcElement||c.target)==this){return;}apf.setStyleClass(this,b.$baseCSSname+"Down");};this.$ext.onmouseover=function(c){if(!c){c=event;}if((c.srcElement||c.target)==this){return;}apf.setStyleClass(this,b.$baseCSSname+"Over");};this.$ext.onmouseout=this.$ext.onmouseup=function(){apf.setStyleClass(this,"",[b.$baseCSSname+"Down",b.$baseCSSname+"Over"]);};};this.$disable=function(){if(this.oInput){this.oInput.disabled=true;}this.$ext.onclick=this.$ext.onmousedown=this.$ext.onmouseover=this.$ext.onmouseout=this.$ext.onmouseup=null;};this.doBgSwitch=function(c){if(this.bgswitch&&(this.bgoptions[1]>=c||c==4)){if(c==4){c=this.bgoptions[1]+1;}var b=this.bgoptions[0]=="vertical"?"0 -"+(parseInt(this.bgoptions[2])*(c-1))+"px":"-"+(parseInt(this.bgoptions[2])*(c-1))+"px 0";this.$getLayoutNode("main","background",this.$ext).style.backgroundPosition=b;}};this.$focus=function(){if(!this.$ext){return;}if(this.oInput&&this.oInput.disabled){return false;}this.$setStyleClass(this.$ext,this.$baseCSSname+"Focus");};this.$blur=function(){if(!this.$ext){return;}this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Focus"]);};this.addEventListener("keydown",function(d){var b=d.keyCode;if(b==13||b==32){this.$group.change(this.value);return false;}else{if(b==38){var c=this;while(c&&c.previousSibling){c=c.previousSibling;if(c.localName=="radiobutton"&&!c.disabled&&c.$group==this.$group){c.check();c.focus();return;}}}else{if(b==40){var c=this;while(c&&c.nextSibling){c=c.nextSibling;if(c.localName=="radiobutton"&&!c.disabled&&c.$group==this.$group){c.check();c.focus();return;}}}}}},true);this.$draw=function(){this.$ext=this.$getExternal();this.oInput=this.$getLayoutNode("main","input",this.$ext);this.oLabel=this.$getLayoutNode("main","label",this.$ext);this.oIcon=this.$getLayoutNode("main","icon",this.$ext);if(this.oLabel&&this.oLabel.nodeType!=1){this.oLabel=this.oLabel.parentNode;}this.$enable();};this.$childProperty="label";this.$loadAml=function(b){if(this.group){this.$propHandlers.group.call(this,this.group);}else{if(this.parentNode.localName=="group"){this.$propHandlers.group.call(this,this.parentNode);}}if(!this.$group){this.$propHandlers.group.call(this,"radiogroup"+this.parentNode.$uniqueId);}};this.$destroy=function(){if(this.$group){this.$group.$removeRadio(this);}};}).call(apf.radiobutton.prototype=new apf.Presentation());apf.aml.setElement("radiobutton",apf.radiobutton);apf.$group=function(g,b){this.$init(b||"radiogroup",apf.NODE_VISIBLE,g);this.implement(apf.StandardBinding,apf.DataAction);var d=[];this.$supportedProperties.push("value","selectedItem");this.$propHandlers.value=function(m){for(var k=0;k<d.length;k++){if(d[k].value==m){return this.setProperty("selectedItem",d[k]);}}return this.setProperty("selectedItem",null);};var c;this.$propHandlers.selectedItem=function(m){if(c){c.$uncheck();}if(!m){return;}m.$check();c=m;for(var k=0;k<d.length;k++){d[k].setProperty("selectedItem",m);}};this.$addRadio=function(k){var m=d.push(k)-1;if(!k.value){k.setProperty("value",m);}if(this.value&&k.value==this.value){this.setProperty("selectedItem",k);}else{if(k.checked){this.setProperty("value",k.value);}}};this.$removeRadio=function(k){d.remove(k);if(k.value===k.id){k.setProperty("value","");}if(k.selectedItem==k){this.setProperty("value",null);}};this.setValue=function(k){this.setProperty("value",k);};this.getValue=function(){return this.value;};this.$draw=function(){this.$ext=this.$int=this.$pHtmlNode;};};apf.$group.prototype=new apf.GuiElement();apf.aml.setElement("group",apf.$group);apf.rpc=function(c,b){this.$init(b||"rpc",apf.NODE_HIDDEN,c);if(!this.supportMulticall){this.multicall=false;}this.stack={};this.urls={};this.$methods={};};(function(){this.useHTTP=true;this.namedArguments=false;this["route-server"]=apf.host+"/cgi-bin/rpcproxy.cgi";this.autoroute=false;this.$auth=false;this.$booleanProperties.multicall=true;this.$supportedProperties.push("protocol","type","multicall","http-method");this.$propHandlers["route-server"]=function(c){this.autoroute=c?true:false;};this.$propHandlers.protocol=function(d){if(!d){return;}if(!apf[d]){return;}var c=this;$setTimeout(function(){c.implement(apf[d]);});};this.$propHandlers.type=function(c){this.$useXml=(typeof c=="string"&&c.toUpperCase()=="XML");};this.setCallback=function(c,d){this.$methods[c].callback=d;};this.setUrl=function(d,c){this.$methods[d].setProperty("url",c);};this.$convertArgs=function(n,m){if(!this.namedArguments){return Array.prototype.slice.call(m);}var g=this.$methods[n].names;if(!g||!g.length){return{};}var q,k,o,d,c={};for(k=0,o=0,d=g.length;o<d;o++){n=g[o].name;q=g[o].value;if(q){q=apf.parseExpression(q);}else{q=m[k++];if(apf.isNot(q)&&g[o]["default"]){q=apf.parseExpression(g[o]["default"]);}}q=apf.isTrue(g[o].encoded)?encodeURIComponent(q):q;c[n]=q;}return c;};function b(c){var g,d;if(typeof c.callback=="string"){g=c.callback.split("."),d=self[g.shift()];while(d&&g.length){d=d[g.shift()];}}else{d=c.callback;}return d||apf.K;}this.call=function(d,r,u){var t,n=this.$methods[d];if(typeof r[r.length-1]=="function"){r=Array.prototype.slice.call(r);t=r.pop();}else{t=b(n);}r=this.$convertArgs(d,r);if(this.multicall){if(!this.stack[this.url]){this.stack[this.url]=this.getMulticallObject?this.getMulticallObject():[];}this.getSingleCall(d,r,this.stack[this.url]);return true;}var s=this,q=u&&u.message?u.message:this.createMessage(n["method-name"]||d,r);function k(x,w,o){o.data=x;if(w!=apf.SUCCESS){t.call(s,null,w,o);}else{if(s.isValid&&!s.isValid(o)){t.call(s,null,apf.ERROR,o);}else{t.call(s,s.unserialize(o.data),w,o);}}}var m,c=apf.getAbsolutePath(this.baseurl||apf.config.baseurl,this.url),g=apf.extend({callback:k,async:n.async,userdata:n.userdata,nocache:(this.nocache===false)?false:true,data:q,useXML:this.$useXml||n.type=="xml",caching:n.caching,ignoreOffline:n["ignore-offline"]},u);return this.$get(c,g);};this.purge=function(q,o,g,r){var k=this.createMessage("multicall",[this.stack[this.url]]),c=apf.getAbsolutePath(this.baseurl||apf.config.baseurl,this.url);if(r){for(var n=[],m=0;m<r.length;m++){n.push(encodeURIComponent(r[m][0])+"="+encodeURIComponent(r[m][1]||""));}c=c+(c.match(/\?/)?"&":"?")+n.join("&");}var d=this.$get(c,{callback:q,async:g,userdata:o,nocache:true,data:k,useXML:this.$useXml});this.stack[this.url]=this.getMulticallObject?this.getMulticallObject():[];};this.revert=function(c){this.stack[c.url]=this.getMulticallObject?this.getMulticallObject():[];};this.getStackLength=function(){return this.stack[this.url]?this.stack[this.url].length:0;};this.$addMethod=function(m){if(m.localName!="method"){return false;}var g=m.name,c=m.receive||this.receive,k=0,d=m.childNodes.length,n;this[g]=function(){return this.call(g,arguments);};if(c){m.callback=c;}this.$methods[g]=m;if(!m.names){m.names=[];}for(;k<d;k++){n=m.childNodes[k];if(n.localName=="param"||n.localName=="variable"){m.names.push(n);}}return true;};this.$removeMethod=function(d){var c=d.name;delete this[c];delete this.$methods[c];};this.$setAuth=function(c){this.$auth=c;};this.exec=function(n,g,m,d){if(!d){d={};}if(d.multicall){this.forceMulticall=true;}var k=this.$methods[n];if(d.userdata){k.userdata=d.userdata;}if(!this.multicall){k.callback=m;}var c=this.call(n,g,d);if(this.multicall){return this.purge(m,"&@^%!@");}else{if(d.multicall){this.forceMulticall=false;return this;}}if(!this.multicall&&!k.async&&m){m(c,apf.SUCCESS,{tpModule:this});}};}).call(apf.rpc.prototype=new apf.Teleport());apf.config.$inheritProperties.baseurl=1;apf.aml.setElement("rpc",apf.rpc);apf.script=function(){this.$init("script",apf.NODE_HIDDEN);};(function(){this.$propHandlers.src=function(c){if(!this.type){this.type=this.getAttribute("type");}if(!this.type||this.type=="text/javascript"){if(apf.isOpera){$setTimeout(function(){apf.window.loadCodeFile(apf.hostPath+c);},1000);}else{apf.window.loadCodeFile(apf.getAbsolutePath(apf.hostPath,c));}}else{var b=this;apf.ajax(c,{callback:function(k,g,d){if(g!=apf.SUCCESS){return apf.console.warn("Could not load script "+c);}b.$execute(k);}});}};this.$execute=function(c,d){if(!this.type||this.type=="text/javascript"){apf.jsexec(c);}else{if(this.type.indexOf("livemarkup")>-1||this.type.indexOf("lm")>-1){var b=apf.lm.compile(c,{event:true,parsecode:true,funcglobal:true,nostring:true});b(d||{});}}};this.addEventListener("DOMNodeInserted",function(b){if(b.currentTarget.nodeType==3||b.currentTarget.nodeType==4){this.$execute(b.currentTarget.nodeValue,apf.isIE&&window.event);}});this.addEventListener("DOMNodeInsertedIntoDocument",function(m){var c=this.childNodes,g=[];for(var d=0,b=c.length;d<b;d++){g[g.length]=c[d].nodeValue;}var k=g.join("\n");this.$execute(k);});}).call(apf.script.prototype=new apf.AmlElement());apf.aml.setElement("script",apf.script);apf.scrollbar=function(c,b){this.$init(b||"scrollbar",apf.NODE_VISIBLE,c);};(function(){this.realtime=true;this.visible=false;this.$visible=true;this.overflow="scroll";this.$scrollSizeValue=0;this.$stepValue=0.03;this.$bigStepValue=0.1;this.$curValue=0;this.$timer=null;this.$scrollSizeWait;this.$slideMaxSize;this.addEventListener("focus",function(){if(this.$host.focus&&this.$host.$isWindowContainer!==true){this.$host.focus();}});this.$propHandlers.overflow=function(b){if(b=="auto"){this.$ext.style.display="none";this.$resize();}else{if(b=="scroll"){this.setProperty("visible",true);}}};this.$propHandlers["for"]=function(d){if(d){var c=typeof d=="string"?self[d]:d;if(!c||!c.$amlLoaded){var b=this;apf.queue.add("scrollbar"+this.$uniqueId,function(){if(!c){c=typeof d=="string"?self[d]:d;if(!c){throw new Error(apf.formatErrorString(0,b,"Attaching scrollbar to element","Could not find element to attach scrollbar to: "+d));}}b.$attach(c);});}else{this.$attach(c);}}};this.addEventListener("prop.visible",function(b){if(!this.$updating){this.$visible=b.value;}});this.$detach=function(){};this.attach=function(c,d,b){this.$attach(d);this.addEventListener("scroll",b);};this.$getHtmlHost=function(){var b=this.$host&&(this.$host.$int||this.$host.$container);return(b&&(b.tagName=="BODY"||b.tagName=="HTML")?(apf.isSafari||apf.isChrome?document.body:b.parentNode):b);};this.$getViewPort=function(b){return b.tagName=="HTML"||b.tagName=="BODY"?apf[this.$windowSize]():b[this.$offsetSize];};this.$getScrollHeight=function(b){return(apf.isIE&&b.lastChild?b.lastChild[this.$offsetPos]+b.lastChild[this.$offsetSize]+apf.getBox(apf.getStyle(b,"padding"))[2]+(parseInt(apf.getStyle(b,"marginBottom"))||0):b[this.$scrollSize]);};this.$attach=function(c){if(!c){return apf.console.warn("Scrollbar could not connect to amlNode");}if(c.host){c=c.host;}if(!c.nodeFunc&&c.style){this.$host={empty:true,$int:c};}else{this.$host=c;}this.$recalc();var k=function(o){if(o.returnValue===false){return;}m=apf.isIE;var n=b.$getHtmlHost();var q=(b.$getScrollHeight(n)-b.$getViewPort(n));if(q){if(n[b.$scrollPos]==0&&o.delta>0){if(b.$lastScrollState===0){return;}setTimeout(function(){b.$lastScrollState=0;},300);}else{if(n[b.$scrollPos]==b.$getScrollHeight(n)-n[b.$offsetSize]&&o.delta<0){if(b.$lastScrollState===1){return;}setTimeout(function(){b.$lastScrollState=1;},300);}}delete b.$lastScrollState;b.$curValue=(n[b.$scrollPos]+-1*o.delta*Math.min(45,apf[b.$getInner](n)/10))/q;b.setScroll();o.preventDefault();}};var b=this,m;if(!this.$host.empty){c.addEventListener("resize",function(){b.$update();});if(c.hasFeature(apf.__DATABINDING__)){c.addEventListener("afterload",function(){b.$update();});c.addEventListener("xmlupdate",function(){b.$update();});}c.addEventListener("prop.value",function(){b.$update();});if(c.$isTreeArch){c.addEventListener("collapse",function(){b.$update();});c.addEventListener("expand",function(){b.$update();});}if(!this.horizontal){c.addEventListener("mousescroll",k);}}else{if(!this.horizontal){apf.addEventListener("mousescroll",function(n){if(c==n.target||(c==document.documentElement&&n.target==document.body)){k(n);}});}}var g=b.$getHtmlHost();g.onscroll=function(){if(b.animating||!b.$visible){return;}if(!m){var o=b.$getHtmlHost();var n=b.$getScrollHeight(o)-b.$getViewPort(o);var q=o[b.$scrollPos]/n;if(Math.abs(b.$curValue-q)>1/n){b.$curValue=q;b.setScroll();}return false;}m=false;};if("HTML|BODY".indexOf(g.tagName)>-1){var d=g.scrollHeight;setInterval(function(){if(d!=g.scrollHeight){d=g.scrollHeight;b.$recalc();b.$update();}},100);}this.$update();return this;};this.$resize=function(){var b=this.$getHtmlHost();if(!b||!b.offsetHeight){return;}this.$recalc();this.$update();this.setScroll(null,true);};this.$recalc=function(){var b=this.$getHtmlHost();if(!b){return;}this.$viewheight=this.$getViewPort(b);this.$scrollSizeheight=this.$viewheight;this.$scrollSizeWait=0;this.$stepValue=(this.$viewheight/this.$scrollSizeheight)/20;this.$bigStepValue=this.$stepValue*3;this.$slideMaxSize=this.$caret.parentNode[this.$offsetSize]-(this.$btnDown?this.$btnDown[this.$offsetSize]:0)-(this.$btnUp?this.$btnUp[this.$offsetSize]:0);};this.$update=function(){if(this.animating||!this.$visible){return;}var d=this.$getHtmlHost();if(!d||!d.offsetHeight){return;}this.$updating=true;var b=this.$getViewPort(d);var g=this.$getScrollHeight(d);if(b>=g){if(this.overflow=="scroll"){this.$caret.style.display="none";this.disable();}else{if(this.visible){this.hide();}}}else{if(this.overflow=="scroll"){this.$caret.style.display="block";this.enable();}else{if(!this.visible){this.show();}}if(!this.$slideMaxSize){this.$recalc();}if(!this.$slideMaxSize){return;}this.$caret.style[this.$size]=(Math.max(5,(b/g*this.$slideMaxSize))-apf[this.$getDiff](this.$caret))+"px";this.$curValue=d[this.$scrollPos]/(g-b);var c=this.$btnUp?this.$btnUp[this.$offsetSize]:0;this.$caret.style[this.$pos]=(c+(apf[this.$getInner](this.$caret.parentNode)-(c*2)-this.$caret[this.$offsetSize])*this.$curValue)+"px";}this.$updating=false;};this.setScroll=function(c,d){if(this.$curValue>1){this.$curValue=1;}if(this.$curValue<0){this.$curValue=0;}if(this.$curValue==NaN){return;}var g=this.$btnUp?this.$btnUp[this.$offsetSize]:0;this.$caret.style[this.$pos]=(g+(apf[this.$getInner](this.$caret.parentNode)-(g*2)-this.$caret[this.$offsetSize])*this.$curValue)+"px";if(this.animating||!this.$visible){return;}if(!d){var k,n,b,m;if(this.$host){k=this.$getHtmlHost();n=k[this.$scrollPos];b=this.$getViewPort(k);m=(this.$getScrollHeight(k)-b)*this.$curValue;}if(this.$host){k[this.$scrollPos]=m;}(this.$host&&this.$host.dispatchEvent?this.$host:this).dispatchEvent("scroll",{timed:c,viewportSize:b,scrollPos:m,scrollSize:this.$getScrollHeight(k),from:n,pos:this.pos});}this.pos=this.$curValue;};this.scrollUp=function(b){if(b>this.$caret[this.$offsetPos]){return this.$ext.onmouseup();}this.$curValue-=this.$bigStepValue;this.setScroll();if(this.$slideFast){this.$slideFast.style[this.$size]=Math.max(1,this.$caret[this.$offsetPos]-this.$btnUp[this.$offsetSize])+"px";this.$slideFast.style[this.$pos]=this.$btnUp[this.$offsetSize]+"px";}};this.scrollDown=function(b){if(b<this.$caret[this.$offsetPos]+this.$caret[this.$offsetSize]){return this.$ext.onmouseup();}this.$curValue+=this.$bigStepValue;this.setScroll();if(this.$slideFast){this.$slideFast.style[this.$pos]=(this.$caret[this.$offsetPos]+this.$caret[this.$offsetSize])+"px";this.$slideFast.style[this.$size]=Math.max(1,apf[this.$getInner](this.$caret.parentNode)-this.$slideFast[this.$offsetPos]-this.$btnUp[this.$offsetSize])+"px";}};this.getPosition=function(){return this.pos;};this.setPosition=function(c,b){this.$curValue=c;setScroll(null,b);};this.updatePos=function(){if(this.animating||!this.$visible){return;}var c=this.$host;var b=Math.round(Math.max(10,(((c.limit-1)/c.length)*this.$slideMaxSize)));this.$caret.style[this.$pos]=(this.$curValue*(this.$slideMaxSize-b)+this.$btnUp[this.$offsetSize])+"px";};this.$onscroll=function(b,c){this.$host[this.$scrollPos]=(this.$host[this.$scrollSize]-this.$host[this.$offsetSize]+4)*this.$curValue;};this.$draw=function(){this.$getNewContext("main");this.$ext=this.$getExternal();this.$caret=this.$getLayoutNode("main","indicator",this.$ext);this.$slideFast=this.$getLayoutNode("main","slidefast",this.$ext);this.$btnUp=this.$getLayoutNode("main","btnup",this.$ext);this.$btnDown=this.$getLayoutNode("main","btndown",this.$ext);this.horizontal=apf.isTrue(this.$getOption("main","horizontal"));this.$windowSize=this.horizontal?"getWindowWidth":"getWindowHeight";this.$offsetSize=this.horizontal?"offsetWidth":"offsetHeight";this.$size=this.horizontal?"width":"height";this.$offsetPos=this.horizontal?"offsetLeft":"offsetTop";this.$pos=this.horizontal?"left":"top";this.$scrollSize=this.horizontal?"scrollWidth":"scrollHeight";this.$scrollPos=this.horizontal?"scrollLeft":"scrollTop";this.$getDiff=this.horizontal?"getWidthDiff":"getHeightDiff";this.$getInner=this.horizontal?"getHtmlInnerWidth":"getHtmlInnerHeight";this.$eventDir=this.horizontal?(apf.isIE||apf.isWebkit?"offsetX":"layerX"):(apf.isIE||apf.isWebkit?"offsetY":"layerY");this.$clientDir=this.horizontal?"clientX":"clientY";this.$posIndex=this.horizontal?0:1;this.$startPos=false;this.$caret.ondragstart=function(){return false;};var b=this;if(this.$btnUp){this.$btnUp.onmousedown=function(c){if(b.disabled){return;}if(!c){c=event;}this.className="btnup btnupdown";clearTimeout(b.$timer);b.$curValue-=b.$stepValue;b.setScroll();apf.stopPropagation(c);b.$timer=$setTimeout(function(){b.$timer=setInterval(function(){b.$curValue-=b.$stepValue;b.setScroll();},20);},300);};this.$btnUp.onmouseout=this.$btnUp.onmouseup=function(){if(b.disabled){return;}this.className="btnup";clearInterval(b.$timer);};}if(this.$btnDown){this.$btnDown.onmousedown=function(c){if(b.disabled){return;}if(!c){c=event;}this.className="btndown btndowndown";clearTimeout(b.$timer);b.$curValue+=b.$stepValue;b.setScroll();apf.stopPropagation(c);b.$timer=$setTimeout(function(){b.$timer=setInterval(function(){b.$curValue+=b.$stepValue;b.setScroll();},20);},300);};this.$btnDown.onmouseout=this.$btnDown.onmouseup=function(){if(b.disabled){return;}this.className="btndown";clearInterval(b.$timer);};}this.$caret.onmousedown=function(c){if(b.disabled){return;}if(!c){c=event;}var k=c.target||c.srcElement;var g=k!=this?[k.offsetLeft,k.offsetTop]:[0,0];var d=c[b.$eventDir]+g[b.$posIndex];b.$startPos=d+(b.$btnUp?b.$btnUp[b.$offsetSize]:0);if(this.setCapture){this.setCapture();}b.$setStyleClass(b.$ext,b.$baseCSSname+"Down");document.onmousemove=function(r){if(!r){r=event;}if(b.$startPos===false){return false;}var q=b.$btnUp?b.$btnUp[b.$offsetSize]:0;var o=q+(r[b.$clientDir]-b.$startPos+(apf.isWebkit?document.body:document.documentElement)[b.$scrollPos]-apf.getAbsolutePosition(b.$caret.parentNode)[b.horizontal?0:1]);var n=q;if(o<n){o=n;}var m=(apf[b.$getInner](b.$caret.parentNode)-q-b.$caret[b.$offsetSize]);if(o>m){o=m;}b.$curValue=(o-n)/(m-n);b.setScroll(true);};document.onmouseup=function(){b.$startPos=false;if(!b.realtime){b.setScroll();}if(this.releaseCapture){this.releaseCapture();}b.$setStyleClass(b.$ext,"",[b.$baseCSSname+"Down"]);document.onmouseup=document.onmousemove=null;};apf.stopPropagation(c);return false;};this.$ext.onmousedown=function(c){if(b.disabled){return;}if(!c){c=event;}clearInterval(b.$timer);var d;if(c[b.$eventDir]>b.$caret[b.$offsetPos]+b.$caret[b.$offsetSize]){b.$curValue+=b.$bigStepValue;b.setScroll(true);if(b.$slideFast){b.$slideFast.style.display="block";b.$slideFast.style[b.$pos]=(b.$caret[b.$offsetPos]+b.$caret[b.$offsetSize])+"px";b.$slideFast.style[b.$size]=(apf[b.$getInner](b.$caret.parentNode)-b.$slideFast[b.$offsetPos]-b.$btnUp[b.$offsetSize])+"px";}d=c[b.$eventDir];b.$timer=$setTimeout(function(){b.$timer=setInterval(function(){b.scrollDown(d);},20);},300);}else{if(c[b.$eventDir]<b.$caret[b.$offsetPos]){b.$curValue-=b.$bigStepValue;b.setScroll(true);if(b.$slideFast){b.$slideFast.style.display="block";b.$slideFast.style[b.$pos]=b.$btnUp[b.$offsetSize]+"px";b.$slideFast.style[b.$size]=(b.$caret[b.$offsetPos]-b.$btnUp[b.$offsetSize])+"px";}d=c[b.$eventDir];b.$timer=$setTimeout(function(){b.$timer=setInterval(function(){b.scrollUp(d);},20);},300);}}};this.$ext.onmouseup=function(){if(b.disabled){return;}clearInterval(b.$timer);if(!b.realtime){b.setScroll();}if(b.$slideFast){b.$slideFast.style.display="none";}};};this.$loadAml=function(){if(this.overflow=="scroll"){this.disable();}else{this.$caret.style.display="block";this.enable();}this.addEventListener("resize",this.$resize);this.$update();};}).call(apf.scrollbar.prototype=new apf.Presentation());apf.aml.setElement("scrollbar",apf.scrollbar);apf.services=function(c,b){this.$init(b||"services",apf.NODE_VISIBLE,c);this.addEventListener("DOMNodeInsertedIntoDocument",function(g){var d=this.parentNode;if(d.register){d.register(this);}});};apf.services.prototype=new apf.AmlElement();apf.aml.setElement("services",apf.services);apf.skin=function(c,b){this.$init(b||"skin",apf.NODE_HIDDEN,c);};apf.aml.setElement("skin",apf.skin);(function(){this.$parsePrio="002";this.$includesRemaining=0;this.$propHandlers.src=function(m){if(m.trim().charAt(0)=="<"){apf.skins.Init(apf.getXml(m),this,this.$path);return;}this.$path=apf.getAbsolutePath(apf.hostPath,m);b.call(this,this.$path);};this.$propHandlers.name=function(m){if(!this.attributes.getNamedItem("src")){this.$path=apf.getAbsolutePath(apf.hostPath,m)+"/index.xml";b.call(this,this.$path);}};function k(o){if(!o.ownerDocument.documentElement){return false;}var m=o.ownerDocument.documentElement.attributes;for(var q=false,n=0;n<m.length;n++){if(m[n].nodeValue==apf.ns.aml){q=true;break;}}return q;}function b(m){var o=this.ownerDocument.$domParser;if(!apf.skins.$first){apf.skins.$first=this;}var n=this.attributes.getNamedItem("defer");if(!n||!apf.isTrue(n.nodeValue)){o.$shouldWait++;this.$parseContext=o.$parseContext||[this.ownerDocument.documentElement];}d.call(this,m);}function g(m){if(m){apf.skins.Init(m,this,this.$path);}if(!this.defer){var n=this.ownerDocument.$domParser;n.$continueParsing.apply(n,this.$parseContext);}}function c(o,n,q){var m=this;apf.getData(apf.getAbsolutePath(q,o.getAttribute("src")),{callback:function(y,w,r){if(w!=apf.SUCCESS){throw new Error(apf.formatErrorString(0,m,"Loading skin includes","Could not load skin include: "+r.url));}var s=apf.getXml(y.substr(0,8)=="<a:skin "?y:'<a:skin xmlns:a="http://ajax.org/2005/aml">'+y+"</a:skin>");apf.mergeXml(s,n,{beforeNode:o});o.parentNode.removeChild(o);var u=$xmlns(s,"include",apf.ns.aml);m.$includesRemaining+=u.length;if(u.length){var x=apf.getDirname(r.url);for(var t=0;t<u.length;t++){c.call(m,u[t],n,x);}}else{if(--m.$includesRemaining==0){g.call(m,n);}}}});}function d(n){var m=this;apf.getData(n,{callback:function(w,t,o){if(t!=apf.SUCCESS){var x=new Error(apf.formatErrorString(1007,m,"Loading skin file","Could not load skin file '"+(u||m.src)+"'\nReason: "+o.message));if(o.tpModule.retryTimeout(o,t,null,x)===true){return true;}if(this.autoload){apf.console.warn("Could not autload skin.");return g.call(m);}throw x;}w=w.replace(/\<\!DOCTYPE[^>]*>/,"").replace(/^[\r\n\s]*/,"").replace(/xmlns\=\"[^"]*\"/g,"");if(!w){throw new Error(apf.formatErrorString(0,m,"Loading skin","Empty skin file. Maybe the file does not exist?",m));}var r=apf.getXml(w);if(!r){throw new Error(apf.formatErrorString(0,m,"Loading skin","Could not parse skin. Maybe the file does not exist?",m));}r.setAttribute("filename",o.url);var s=$xmlns(r,"include",apf.ns.aml);m.$includesRemaining+=s.length;if(s.length){var u=apf.getDirname(o.url);for(var q=0;q<s.length;q++){c.call(m,s[q],r,u);}return;}else{g.call(m,r);}},async:true,ignoreOffline:true});}this.addEventListener("DOMNodeInsertedIntoDocument",function(m){if(this.src||this.name){return;}apf.skins.Init(this.$aml||this);});}).call(apf.skin.prototype=new apf.AmlElement());apf.smartbinding=function(c,b){this.$init(b||"smartbinding",apf.NODE_HIDDEN,c);this.$bindNodes={};};(function(){this.$supportedProperties=["bindings","actions","model"];this.$handlePropSet=function(k,d,c){switch(k){case"model":if(typeof d=="string"){d=apf.nameserver.get("model",d);}this.model=apf.nameserver.register("model",this.name,d);var b;for(var g in this.$bindNodes){b=this.$bindNodes[g];this.model.unregister(b);this.model.register(b,this.$modelXpath[b.getHost?b.getHost().$uniqueId:b.$uniqueId]||this.modelBaseXpath);}break;case"bindings":if(this.$bindings){this.remove(this.$bindings);}this.$bindings=typeof d=="object"?d:apf.nameserver.lookup("bindings",d);this.add(this.$bindings);break;case"actions":if(this.$actions){this.remove(this.$actions);}this.$actions=typeof d=="object"?d:apf.nameserver.lookup("actions",d);this.add(this.$actions);break;}this[k]=d;};this.add=function(c){for(var b in this.$bindNodes){c.register(this.$bindNodes[b]);}this["$"+c.localName]=c;};this.remove=function(c){for(var b in this.$bindNodes){c.unregister(this.$bindNodes[b]);}};this.register=function(b){this.$bindNodes[b.$uniqueId]=b;if(this.$bindings){this.$bindings.register(b);}if(this.$actions){this.$actions.register(b);}if(this.$model){this.$model.register(b);}};this.unregister=function(b){this.$bindNodes[b.$uniqueId]=null;delete this.$bindNodes[b.$uniqueId];if(this.$bindings){this.$bindings.unregister(b);}if(this.$actions){this.$actions.unregister(b);}if(this.$model){this.$model.unregister(b);}};this.load=function(b){new apf.model().register(this).load(b);};this.clear=function(b){};this.addEventListener("DOMNodeInsertedIntoDocument",function(b){if(this.parentNode.hasFeature(apf.__DATABINDING__)){this.register(this.parentNode);}});}).call(apf.smartbinding.prototype=new apf.AmlElement());apf.aml.setElement("smartbinding",apf.smartbinding);apf.source=function(c,b){this.$init(b||"source",apf.NODE_HIDDEN,c);};(function(){this.$supportedProperties.push("src","type");this.addEventListener("DOMNodeInsertedIntoDocument",function(b){if(this.parentNode.$addSource){this.parentNode.$addSource(this);}});}).call(apf.source.prototype=new apf.AmlElement());apf.aml.setElement("source",apf.source);apf.spinner=function(c,b){this.$init(b||"spinner",apf.NODE_VISIBLE,c);this.max=64000;this.min=-64000;this.focused=false;this.value=0;this.realtime=false;};(function(){this.implement(apf.DataAction);this.$supportedProperties.push("width","value","max","min","caption","realtime");this.$booleanProperties.realtime=true;this.$propHandlers.value=function(b){b=parseInt(b)||0;this.value=this.oInput.value=(b>this.max?this.max:(b<this.min?this.min:b));};this.$propHandlers.min=function(b){if(!(b=parseInt(b))){return;}this.min=b;if(b>this.value){this.change(b);}};this.$propHandlers.max=function(b){if(!(b=parseInt(b))){return;}this.max=b;if(b<this.value){this.change(b);}};this.setValue=function(b){this.setProperty("value",b,false,true);};this.getValue=function(){return this.value;};this.increment=function(){this.change(parseInt(this.oInput.value)+1);};this.decrement=function(){this.change(parseInt(this.oInput.value)-1);};this.$enable=function(){this.oInput.disabled=false;this.$setStyleClass(this.oInput,"",["inputDisabled"]);};this.$disable=function(){this.oInput.disabled=true;this.$setStyleClass(this.oInput,"inputDisabled");};this.$focus=function(b){if(!this.$ext||this.focused){return;}if(apf.hasFocusBug){apf.sanitizeTextbox(this.oInput);}this.focused=true;this.$setStyleClass(this.oInput,"focus");this.$setStyleClass(this.$buttonPlus,"plusFocus");this.$setStyleClass(this.$buttonMinus,"minusFocus");if(this.oLeft){this.$setStyleClass(this.oLeft,"leftFocus");}};this.$blur=function(b){if(!this.$ext&&!this.focused){return;}this.$setStyleClass(this.oInput,"",["focus"]);this.$setStyleClass(this.$buttonPlus,"",["plusFocus"]);this.$setStyleClass(this.$buttonMinus,"",["minusFocus"]);if(this.oLeft){this.$setStyleClass(this.oLeft,""["leftFocus"]);}this.setValue(this.oInput.value);this.focused=false;};this.addEventListener("keydown",function(d){var b=d.keyCode,c=(b<8||(b>9&&b<37&&b!==12)||(b>40&&b<46)||(b>46&&b<48)||(b>57&&b<96)||(b>105&&b<109&&b!==107)||(b>109&&b!==189));if(c){return false;}switch(b){case 38:this.increment();break;case 40:this.decrement();break;}},true);this.addEventListener("keyup",function(b){},true);this.increment=function(){this.change(parseInt(this.oInput.value)+1);};this.decrement=function(){this.change(parseInt(this.oInput.value)-1);};this.$draw=function(){var b=this;this.$ext=this.$getExternal(null,null,function(m){m.setAttribute("onmousedown",'if (!this.host.disabled)                     this.host.dispatchEvent("mousedown", {htmlEvent : event});');m.setAttribute("onmouseup",'if (!this.host.disabled)                     this.host.dispatchEvent("mouseup", {htmlEvent : event});');m.setAttribute("onclick",'if (!this.host.disabled)                     this.host.dispatchEvent("click", {htmlEvent : event});');});this.$int=this.$getLayoutNode("main","container",this.$ext);this.oInput=this.$getLayoutNode("main","input",this.$ext);this.$buttonPlus=this.$getLayoutNode("main","buttonplus",this.$ext);this.$buttonMinus=this.$getLayoutNode("main","buttonminus",this.$ext);this.oLeft=this.$getLayoutNode("main","left",this.$ext);apf.sanitizeTextbox(this.oInput);var k,d=(!document.compatMode||document.compatMode=="CSS1Compat")?document.html:document.body,g=0;this.oInput.value=this.value;this.oInput.onmousedown=function(t){if(b.disabled){return;}t=t||window.event;clearTimeout(k);var m,x=parseInt(this.value)||0,n=0,r=t.clientY,s=b.$int.offsetTop,u=b.$int.offsetLeft,o=b.$int.offsetWidth,y=b.$int.offsetHeight,q=function(){clearTimeout(k);k=$setTimeout(q,10);if(!n){return;}m=x+n;if(m<=b.max&&m>=b.min){x+=n;x=Math.round(x);b.oInput.value=x;if(b.realtime){b.change(x);}}else{b.oInput.value=n<0?b.min:b.max;}};q();function w(C){C=C||window.event;var A=C.pageX||C.clientX+(d?d.scrollLeft:0),D=C.pageY||C.clientY+(d?d.scrollTop:0),B=r-D;if((D>s&&A>u)&&(D<s+y&&A<u+o)){n=0;return;}n=Math.pow(Math.min(200,Math.abs(B))/10,2)/10;if(B<0){n=-1*n;}}document.onmousemove=w;document.onmouseup=function(B){clearTimeout(k);var A=parseInt(b.oInput.value);if(A!=b.value){b.change(A);}document.onmousemove=document.onmouseup=null;};};var c=false;this.$buttonPlus.onmousedown=function(o){if(b.disabled){return;}o=o||window.event;c=true;var n=(parseInt(b.oInput.value)||0)+1,m=function(){clearTimeout(k);k=$setTimeout(m,50);g++;n+=Math.pow(Math.min(200,g)/10,2)/10;n=Math.round(n);b.oInput.value=n<=b.max?n:b.max;if(b.realtime){b.change(n<=b.max?n:b.max);}};apf.setStyleClass(this,"plusDown",["plusHover"]);m();};this.$buttonMinus.onmousedown=function(o){if(b.disabled){return;}o=o||window.event;c=true;var n=(parseInt(b.oInput.value)||0)-1,m=function(){clearTimeout(k);k=$setTimeout(m,50);g++;n-=Math.pow(Math.min(200,g)/10,2)/10;n=Math.round(n);b.oInput.value=n>=b.min?n:b.min;if(b.realtime){b.change(n>=b.min?n:b.min);}};apf.setStyleClass(this,"minusDown",["minusHover"]);m();};this.$buttonMinus.onmouseout=function(n){if(b.disabled){return;}clearTimeout(k);g=0;var m=parseInt(b.oInput.value);if(m!=b.value){b.change(m);}apf.setStyleClass(this,"",["minusHover"]);if(!b.focused){b.$blur(n);}};this.$buttonPlus.onmouseout=function(n){if(b.disabled){return;}clearTimeout(k);g=0;var m=parseInt(b.oInput.value);if(m!=b.value){b.change(m);}apf.setStyleClass(this,"",["plusHover"]);if(!b.focused){b.$blur(n);}};this.$buttonMinus.onmouseover=function(m){if(b.disabled){return;}apf.setStyleClass(this,"minusHover");};this.$buttonPlus.onmouseover=function(m){if(b.disabled){return;}apf.setStyleClass(this,"plusHover");};this.$buttonPlus.onmouseup=function(n){if(b.disabled){return;}n=n||event;apf.cancelBubble(n,this);apf.setStyleClass(this,"plusHover",["plusDown"]);clearTimeout(k);g=0;var m=parseInt(b.oInput.value);if(!c){m++;b.oInput.value=m;}else{c=false;}if(m!=b.value){b.change(m);}};this.$buttonMinus.onmouseup=function(n){if(b.disabled){return;}n=n||event;apf.cancelBubble(n,this);apf.setStyleClass(this,"minusHover",["minusDown"]);clearTimeout(k);g=0;var m=parseInt(b.oInput.value);if(!c){m--;b.oInput.value=m;}else{c=false;}if(m!=b.value){b.change(m);}};this.oInput.onselectstart=function(m){m=m||event;m.cancelBubble=true;};this.oInput.host=this;};this.$destroy=function(){this.oInput.onkeypress=this.oInput.onmousedown=this.oInput.onkeydown=this.oInput.onkeyup=this.oInput.onselectstart=this.$buttonPlus.onmouseover=this.$buttonPlus.onmouseout=this.$buttonPlus.onmousedown=this.$buttonPlus.onmouseup=this.$buttonMinus.onmouseover=this.$buttonMinus.onmouseout=this.$buttonMinus.onmousedown=this.$buttonMinus.onmouseup=null;};}).call(apf.spinner.prototype=new apf.StandardBinding());apf.aml.setElement("spinner",apf.spinner);apf.splitbutton=function(c,b){this.$init(b||"splitbutton",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;this.$propHandlers.caption=function(b){this.$button1.setProperty("caption",b);};this.$propHandlers.icon=function(b){this.$button1.setProperty("icon",b);};this.$propHandlers.disabled=function(b){this.$button1.setProperty("disabled",b);this.$button2.setProperty("disabled",b);};this.$propHandlers.submenu=function(c){this.$button2.setProperty("submenu",c);var b=this;self[c].addEventListener("display",function(){this.$ext.style.marginLeft="-"+b.$button1.$ext.offsetWidth+"px";});};this.$draw=function(){var b=this;this.$ext=this.$pHtmlNode.appendChild(document.createElement("div"));var c=this.getAttribute("skin")||this.localName;this.$button1=new apf.button({htmlNode:this.$ext,parentNode:this,skin:c,"class":"main",onmouseover:function(){apf.setStyleClass(this.$ext,"primary");b.$button2.$setState("Over",{});},onmouseout:function(){apf.setStyleClass(this.$ext,"",["primary"]);b.$button2.$setState("Out",{});},onclick:function(d){b.dispatchEvent("click");}});this.$button2=new apf.button({htmlNode:this.$ext,parentNode:this,skin:c,"class":"arrow",onmouseover:function(){apf.setStyleClass(this.$ext,"primary");b.$button1.$setState("Over",{});},onmouseout:function(){if(!b.$button2.value){apf.setStyleClass(this.$ext,"",["primary"]);b.$button1.$setState("Out",{});}else{apf.setStyleClass(this.$ext,"primary");b.$button1.$setState("Over",{});}}});};this.$loadAml=function(b){};}).call(apf.splitbutton.prototype=new apf.GuiElement());apf.aml.setElement("splitbutton",apf.splitbutton);apf.splitter=function(c,b){this.$init(b||"splitter",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;this.$splitter=true;this.$booleanProperties.realtime=true;this.$propHandlers.realtime=function(value){this.$setStyleClass(this.$ext,value&&(this.$baseCSSname+"Realtime")||"",[this.$baseCSSname+"Realtime"]);};this.$propHandlers.type=function(value){this.$setStyleClass(this.$ext,value,[value=="horizontal"?"vertical":"horizontal"]);if(value=="vertical"){this.$setStyleClass(this.$ext,"w-resize",["n-resize"]);}else{this.$setStyleClass(this.$ext,"n-resize",["w-resize"]);}if(value=="horizontal"){this.$info={pos:"top",opos:"left",size:"width",osize:"height",offsetPos:"offsetTop",offsetSize:"offsetHeight",oOffsetPos:"offsetLeft",oOffsetSize:"offsetWidth",clientPos:"clientY",d1:1,d2:0,x1:0,x2:2};}else{this.$info={pos:"left",opos:"top",size:"height",osize:"width",offsetPos:"offsetLeft",offsetSize:"offsetWidth",oOffsetPos:"offsetTop",oOffsetSize:"offsetHeight",clientPos:"clientX",d1:0,d2:1,x1:3,x2:1};}};this.addEventListener("DOMNodeInserted",function(e){if(e.currentTarget!=this){return;}this.init();});this.update=function(newPos,finalPass){with(this.$info){var max=this.$previous.$ext[offsetSize]+this.$next.$ext[offsetSize];var method=finalPass?"setAttribute":"setProperty";if(apf.hasFlexibleBox){newPos-=apf.getAbsolutePosition(this.$previous.$ext,this.parentNode.$int)[d1];}if((this.$previous.flex||this.$previous.flex===0)&&(this.$next.flex||this.$next.flex===0)){if(!finalPass&&!this.realtime){newPos-=this.$ext[offsetSize];}this.$previous[method]("flex",newPos);this.$next[method]("flex",this.$totalFlex-newPos);}else{if(!this.$next.flex){this.$next[method](osize,max-newPos);}if(!this.$previous.flex){this.$previous[method](osize,newPos);}}}if(apf.hasSingleResizeEvent){apf.layout.forceResize(this.$ext.parentNode);}};this.$setSiblings=function(){this.$previous=this.previousSibling;while(this.$previous&&(this.$previous.nodeType!=1||this.$previous.visible===false||this.$previous.nodeFunc!=apf.NODE_VISIBLE)){this.$previous=this.$previous.previousSibling;}this.$next=this.nextSibling;while(this.$next&&(this.$next.nodeType!=1||this.$next.visible===false||this.$next.nodeFunc!=apf.NODE_VISIBLE)){this.$next=this.$next.nextSibling;}};this.init=function(size,refNode,oItem){this.$setSiblings();this.$thickness=null;if(this.parentNode.$box){this.setProperty("type",this.parentNode.localName=="vbox"?"horizontal":"vertical");this.$thickness=parseInt(this.parentNode.padding);}with(this.$info){var diff=apf.getDiff(this.$ext);if(!this.parentNode.$box){var iSize=Math.max(this.$previous.$ext[offsetSize],this.$next.$ext[offsetSize]);this.$ext.style[size]=(iSize-diff[d1])+"px";}var iThick=this[osize]=this.$thickness||(this.$next[oOffsetPos]-this.$previous[oOffsetPos]-this.$previous[oOffsetSize]);this.$ext.style[osize]=(iThick-diff[d2])+"px";}return this;};this.$draw=function(){this.$ext=this.$getExternal();var _self=this;this.$ext.onmousedown=function(e){if(!e){e=event;}_self.$setSiblings();var changedPosition,pHtml=_self.parentNode.$int;if("absolute|fixed|relative".indexOf(apf.getStyle(pHtml,"position"))==-1){pHtml.style.position="relative";changedPosition=true;}_self.$totalFlex=0;with(_self.$info){var posPrev=apf.getAbsolutePosition(_self.$previous.$ext,_self.parentNode.$int);var min=posPrev[d1]||0;var posNext=apf.getAbsolutePosition(_self.$next.$ext,_self.parentNode.$int);var max=posNext[d1]+_self.$next.$ext[offsetSize]-this[offsetSize];if((_self.$previous.flex||_self.$previous.flex===0)&&(_self.$next.flex||_self.$next.flex===0)){var set=[],nodes=_self.parentNode.childNodes,padding=0;for(var node,i=0,l=nodes.length;i<l;i++){if((node=nodes[i]).visible===false||node.nodeFunc!=apf.NODE_VISIBLE||node.$splitter){continue;}if(node.flex){set.push(node,node.$ext[offsetSize]+(apf.hasFlexibleBox&&!_self.realtime&&node==_self.$previous?2*_self.parentNode.padding:0));}}for(var i=0,l=set.length;i<l;i+=2){set[i].setAttribute("flex",set[i+1]);}}_self.$totalFlex+=_self.$next.flex+_self.$previous.flex;var startPos,startOffset;if(apf.hasFlexibleBox){var coords=apf.getAbsolutePosition(this);startPos=e[clientPos]-coords[d1];if(!_self.realtime){if(apf.hasFlexibleBox){if(_self.$previous.flex&&!_self.$next.flex){var mBox=apf.getBox(_self.$next.margin);mBox[x1]=_self.parentNode.padding;_self.$next.$ext.style.margin=mBox.join("px ")+"px";}else{var mBox=apf.getBox(_self.$previous.margin);mBox[x2]=_self.parentNode.padding;_self.$previous.$ext.style.margin=mBox.join("px ")+"px";}}var diff=apf.getDiff(this);this.style.left=coords[0]+"px";this.style.top=coords[1]+"px";this.style.width=(this.offsetWidth-diff[0])+"px";this.style.height=(this.offsetHeight-diff[1])+"px";this.style.position="absolute";}}else{var coords=apf.getAbsolutePosition(this.offsetParent);startOffset=apf.getAbsolutePosition(_self.$previous.$ext)[d1];startPos=e[clientPos]-coords[d1];if(!_self.realtime){this.style.left="0px";this.style.top="0px";this.style.position="relative";}min=-1000;}}e.returnValue=false;e.cancelBubble=true;apf.plane.show(this);_self.$setStyleClass(this,_self.$baseCSSname+"Moving");_self.$setStyleClass(document.body,_self.type=="vertical"?"w-resize":"n-resize",[_self.type=="vertical"?"n-resize":"w-resize"]);document.onmouseup=function(e){if(!e){e=event;}with(_self.$info){var newPos;if(e[clientPos]>=0){var coords=apf.getAbsolutePosition(_self.$ext.offsetParent);newPos=(Math.min(max,Math.max(min,(e[clientPos]-coords[d1])-(apf.hasFlexibleBox?startPos:startOffset))));}}_self.$setStyleClass(_self.$ext,"",[_self.$baseCSSname+"Moving"]);_self.$setStyleClass(document.body,"",["n-resize","w-resize"]);if(changedPosition){pHtml.style.position="";}if(apf.hasFlexibleBox&&!_self.realtime){(_self.$previous.flex&&!_self.$next.flex?_self.$next:_self.$previous).$ext.style.margin=apf.getBox(_self.$previous.margin).join("px ")+"px";}if(newPos){_self.update(newPos,true);}apf.plane.hide();if(!_self.realtime){_self.$ext.style.left="";_self.$ext.style.top="";_self.$ext.style[_self.$info.size]="";_self.$ext.style.position="";}document.onmouseup=document.onmousemove=null;};document.onmousemove=function(e){if(!e){e=event;}with(_self.$info){var newPos;if(e[clientPos]>=0){var coords=apf.getAbsolutePosition(_self.$ext.offsetParent);newPos=(Math.min(max,Math.max(min,(e[clientPos]-coords[d1])-(apf.hasFlexibleBox||!_self.realtime?startPos:startOffset))));if(_self.realtime){_self.update(newPos);}else{_self.$ext.style[pos]=newPos+"px";}}}e.returnValue=false;e.cancelBubble=true;};};apf.queue.add("splitter"+this.$uniqueId,function(){_self.init();});};this.$loadAml=function(x){if(this.realtime!==false){this.$propHandlers.realtime.call(this,this.realtime=true);}};}).call(apf.splitter.prototype=new apf.Presentation());apf.aml.setElement("splitter",apf.splitter);apf.StateServer={states:{},groups:{},locs:{},removeGroup:function(b,c){this.groups[b].remove(c);if(!this.groups[b].length){if(self[b]){self[b].destroy();self[b]=null;}delete this.groups[b];}},addGroup:function(c,g,d){if(!this.groups[c]){this.groups[c]=[];var b=new apf.state({id:c});b.parentNode=d;b.toggle=function(){for(var m=0,k=0;k<apf.StateServer.groups[c].length;k++){if(apf.StateServer.groups[c][k].active){m=k+1;break;}}apf.StateServer.groups[c][(m==apf.StateServer.groups[c].length)?0:m].activate();};this.groups[c].pState=self[c]=b;}if(g){this.groups[c].push(g);}return this.groups[c].pState;},removeState:function(b){delete this.states[b.name];},addState:function(b){this.states[b.name]=b;}};apf.state=function(c,b){this.$init(b||"state",apf.NODE_HIDDEN,c);this.$signalElements=[];this.$groupAdded={};this.$locationAdded="";};(function(){this.$supportedProperties.push("active");this.$booleanProperties.active=true;this.$propHandlers.active=function(k){if(apf.isTrue(k)){if(this.group){var c=apf.StateServer.groups[this.group];if(!c){apf.StateServer.addGroup(this.group,this);c=apf.StateServer.groups[this.group];}for(var d=0;d<c.length;d++){if(c[d]!=this&&c[d].active!==false){c[d].deactivate();}}}var g=this.$signalElements;for(var d=0;d<g.length;d++){if(!self[g[d][0]]||!self[g[d][0]].setProperty){continue;}self[g[d][0]].setProperty(g[d][1],this[g[d].join(".")]);}if(this.group){var b=this.attributes;for(var d=0;d<b.length;d++){if(b[d].nodeName.match(/^on|^(?:group|id)$|^.*\..*$/)){continue;}self[this.group].setProperty(b[d].nodeName,b[d].nodeValue);}apf.StateServer.groups[this.group].pState.dispatchEvent("change");}this.dispatchEvent("activate");}else{this.setProperty("active",false);this.dispatchEvent("deactivate");}};this.setValue=function(b){this.active=9999;this.setProperty("active",b,false,true);};this.activate=function(){this.active=9999;this.setProperty("active",true,false,true);};this.deactivate=function(){this.setProperty("active",false,false,true);};this.$propHandlers.group=function(b){if(b){apf.StateServer.addGroup(b,this);this.$groupAdded={value:b,elState:this};}else{apf.StateServer.removeGroup(this.$groupAdded.value,this.$groupAdded.elState);this.$groupAdded={};}};this.$propHandlers.location=function(b){if(b){apf.StateServer.locs[b]=this;this.$locationAdded=b;}else{delete apf.StateServer.locs[this.$locationAdded];this.$locationAdded="";}};this.addEventListener("DOMNodeInsertedIntoDocument",function(g){apf.StateServer.addState(this);var b=this.attributes;for(var d,c=0;c<b.length;c++){d=b[c].nodeName.split(".");if(d.length==2){this.$signalElements.push(d);}}});this.addEventListener("DOMNodeRemovedFromDocument",function(){this.$signalElements=null;apf.StateServer.removeState(this);if(this.group){apf.StateServer.removeGroup(this.group,this);}});}).call(apf.state.prototype=new apf.AmlElement());apf.aml.setElement("state",apf.state);apf.statusbar=function(c,b){this.$init(b||"statusbar",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;var b;this.addEventListener("AMLRemoveChild",function(d,c){if(c){return;}});this.addEventListener("AMLInsert",b=function(g,c,d){if(g.tagName!="bar"){return;}g.$propHandlers.caption=function(k){apf.setNodeValue(this.$getLayoutNode("bar","caption",this.$ext),k);};g.$propHandlers.icon=function(k){var m=this.$getLayoutNode("bar","icon",this.$ext);if(!m){return;}if(k){this.$setStyleClass(this.$ext,this.$baseCSSname+"Icon");}else{this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Icon"]);}if(m.tagName=="img"){m.setAttribute("src",k?this.iconPath+k:"");}else{m.style.backgroundImage=k?"url("+this.iconPath+k+")":"";}};});this.$draw=function(){this.$ext=this.$getExternal();this.$int=this.$getLayoutNode("main","container",this.$ext);};this.$loadAml=function(c){var d=this.childNodes;for(var g=d.length-1;g>=0;g--){if(d[g].localName=="section"){d[g].addEventListener("DOMNodeInsertedIntoDocument",function(){this.$setStyleClass(this.$ext,this.$baseCSSname+"Last");});break;}}};}).call(apf.statusbar.prototype=new apf.Presentation());apf.aml.setElement("statusbar",apf.statusbar);apf["switch"]=function(c,b){this.$hasButtons=false;this.$init(b||"switch",apf.NODE_VISIBLE,c);};apf.pages=function(c,b){this.$hasButtons=false;this.$init(b||"pages",apf.NODE_VISIBLE,c);this.$focussable=false;};apf.tab=function(c,b){this.$hasButtons=true;this.$init(b||"tab",apf.NODE_VISIBLE,c);};(function(){this.$focussable=apf.KEYBOARD;this.$draw=function(b){this.$ext=this.$getExternal();this.$loadChildren();};}).call(apf.tab.prototype=new apf.BaseTab());apf["switch"].prototype=apf.pages.prototype=apf.tab.prototype;apf.aml.setElement("switch",apf["switch"]);apf.aml.setElement("pages",apf.pages);apf.aml.setElement("tab",apf.tab);apf.table=function(c,b){this.$init(b||"table",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;this.$useLateDom=true;this.$layout=true;this.columns=null;this.padding=2;this.$edge=[5,5,5,5];this.cellheight=19;this.$supportedProperties.push("columns","padding","edge","cellheight","span");this.$propHandlers.columns=function(t){if(!t.match(/^((?:\d+\%?|\*)\s*(?:,\s*|\s*$))+$/)){return;}var g,m=this.$columns=t.splitSafe(",");var s=0,r=this.$table.getElementsByTagName("col");if(r.length){for(var q,n=0,k=Math.min(r.length,m.length);n<k;n++){r[n].style.width=(q=m[n]).indexOf("%")>-1?q:q+"px";s+=parseInt(q);}}var d=r.length-m.length;if(d>0){for(var n=r.length-d;n<r.length;n++){r[n].parentNode.removeChild(r[n]);}}else{if(d<0){for(var n=m.length+d;n<m.length;n++){g=this.$table.appendChild(document.createElement("col"));g.style.width=(q=m[n]).indexOf("%")>-1?q:q+"px";g.setAttribute("valign","top");s+=parseInt(q);}}}this.$table.style.width=String(t).indexOf("%")>-1?"auto":(s+((m.length-1)*this.padding)+this.$edge[0]+this.$edge[2])+"px";var u=this.$tbody.firstChild.getElementsByTagName("td");for(var n=u.length-1;n>=0;n--){u[n].parentNode.removeChild(u[n]);}for(var o,n=0;n<m.length;n++){o=this.$tbody.firstChild.appendChild(document.createElement("td"));if(m[n].indexOf("%")>-1){o.appendChild(document.createElement("div")).style.width="50px";}}if(d&&this.$amlLoaded){b({sync:true,parentNode:this});}this.$resize();};this.$propHandlers.padding=function(r){if(!this.$columns){return;}var n=this.$table.getElementsByTagName("td");var k,q,g,d=this.$tbody.lastChild;for(var o=this.$columns.length,m=n.length;o<m;o++){k=(g=n[o]).parentNode.lastChild==g;q=g.parentNode==d;g.style.padding="0px "+(k?0:r)+"px "+(q?0:r)+"px 0px";}this.$resize();};this.$propHandlers.edge=function(d){this.$table.style.padding=(this.$edge=apf.getBox(d)).join("px ")+"px";this.$resize();};function b(F){var E=F.parentNode||this.parentNode;if(F.sync||F.value&&!this.$altExt||!F.value&&this.$altExt){var w=E.childNodes;var d=apf.getArrayFromNodelist(E.$tbody.getElementsByTagName("td"));var t=E.$tbody.getElementsByTagName("tr");var s=[],m=1,g,n,u=E.$columns.length;var q=E.$columns.length,A;for(var y,o,r,B=w.length,D=0;D<B;D++){if((y=w[D]).visible===false){continue;}o=y.$altExt=r=d[q++];if(!o){break;}if(!t[m]){E.$tbody.appendChild(document.createElement("tr"));}t[m].appendChild(o);o.appendChild(y.$ext);o.setAttribute("colspan",g=Math.min(u-(s[0]||0),parseInt(y.colspan||y.span||1)));o.setAttribute("rowspan",n=parseInt(y.rowspan||1));if(!s[0]){s[0]=0;}s[0]+=g;if(n>1){for(var C=1;C<n;C++){if(!s[C]){s[C]=0;}s[C]+=g;}}if(s[0]>=u){A=true;s.shift();m++;}else{A=false;}o.style.padding="0px "+(A?0:E.padding)+"px "+(D==B-1?0:E.padding)+"px 0px";}var x=t[t.length-1].getElementsByTagName("td");for(D=0,il=x.length;D<il;D++){x[D].style.padding="0 "+(D==il-1?0:E.padding)+"px 0 0";}for(;q<d.length;q++){d[q].parentNode.removeChild(d[q]);}if(F.sync){return;}if(F.value){E.$addTd(w[B-1]);}else{this.$altExt=null;}}}this.$addTd=function(n){var k=this.$table.getElementsByTagName("td");var q=0,g=this.$columns.length;for(var d,m=0;m<k.length;m++){q+=Math.min(g,(parseInt((d=k[m]).getAttribute("colspan")||1)*parseInt(d.getAttribute("rowspan")||1)));}if(q%g==0){var r=this.$tbody.appendChild(document.createElement("tr"));}else{r=k[k.length-1].parentNode;}var o=r.appendChild(document.createElement("td"));o.style.position="relative";if(n.colspan||n.span){o.setAttribute("colspan",n.colspan||n.span);}if(n.rowspan){o.setAttribute("rowspan",n.rowspan);}o.appendChild(n.$ext);n.$altExt=o;};var c={width:function(d){this.$ext.style.width="";},height:function(d){this.$ext.style.height=d?Math.max(0,d-apf.getHeightDiff(this.$ext))+"px":"";this.parentNode.$resize();},margin:function(d){this.$ext.style.margin=apf.getBox(d).join("px ")+"px";this.parentNode.$resize();},colspan:function(d){if(!d){this.$altExt.removeAttribute("colspan");}else{this.$altExt.setAttribute("colspan",d);}b.call(this,{sync:true});this.parentNode.$resize();},rowspan:function(d){if(!d){this.$altExt.removeAttribute("rowspan");}else{this.$altExt.setAttribute("rowspan",d);}b.call(this,{sync:true});this.parentNode.$resize();},valign:function(d){this.$altExt.valign=d;},align:function(d){if("left|right".indexOf(d)==-1){return;}this.$altExt.align=d;}};c.span=c.colspan;this.register=function(d){if(d.$altExt){return;}d.$propHandlers.left=d.$propHandlers.top=d.$propHandlers.right=d.$propHandlers.bottom=apf.K;for(var g in c){d.$propHandlers[g]=c[g];}d.addEventListener("prop.visible",b);this.$addTd(d);this.$noResize=true;if(d.margin){c.margin.call(d,d.margin);}if(d.$ext.tagName=="INPUT"){}else{d.$ext.style.width="auto";}if(this.lastChild==d){this.$propHandlers.padding.call(this,this.padding);}delete this.$noResize;};this.unregister=function(d){d.$propHandlers.left=d.$propHandlers.top=d.$propHandlers.right=d.$propHandlers.bottom=null;for(var g in c){delete d.$propHandlers[g];}d.removeEventListener("prop.visible",b);b.call(d,{value:false});if(d.margin){d.$ext.style.margin="";}if(d.width){d.$ext.style.width="";}};this.addEventListener("DOMNodeRemoved",function(d){if(d.$doOnlyAdmin||d.currentTarget==this){return;}if(d.relatedNode==this){this.unregister(d.currentTarget);}});this.addEventListener("DOMNodeInserted",function(d){if(d.currentTarget==this||d.currentTarget.nodeType!=1){return;}if(d.relatedNode==this){if(d.$isMoveWithinParent){b.call(d.currentTarget,{sync:true});}else{d.currentTarget.$setLayout("table");if(d.currentTarget.nextSibling){b.call(d.currentTarget,{sync:true});}}}});this.$draw=function(){this.$ext=apf.insertHtmlNode(null,this.$pHtmlNode,null,"<div><table cellSpacing='0' cellPadding='0'><tbody><tr class='first'></tr></tbody></table></div>");this.$table=this.$ext.firstChild;this.$tbody=this.$table.firstChild;this.$ext.className="table "+(this.getAttribute("class")||"");this.$int=this.$ext;this.$ext.host=this;if(this.getAttribute("class")){apf.setStyleClass(this.$ext,this.getAttribute("class"));}this.addEventListener("resize",this.$resize);this.$originalMin=[this.minwidth||0,this.minheight||0];};this.$resize=function(){if(!this.$amlLoaded||this.$noResize){return;}if(this.$table.offsetWidth>=this.$ext.offsetWidth){this.$ext.style.minWidth=(this.minwidth=Math.max(0,this.$table.offsetWidth-apf.getWidthDiff(this.$ext)))+"px";}else{this.$ext.style.minWidth="";this.minwidth=this.$originalMin[0];}if(this.$table.offsetHeight>=this.$ext.offsetHeight){this.$ext.style.minHeight=(this.minheight=Math.max(0,this.$table.offsetHeight-apf.getHeightDiff(this.$ext)))+"px";}else{this.$ext.style.minHeight="";this.minheight=this.$originalMin[1];}};this.$loadAml=function(d){this.$amlLoaded=false;if(!this.$columns){this.$propHandlers.columns.call(this,this.columns="150, 200");}this.$amlLoaded=true;};}).call(apf.table.prototype=new apf.GuiElement());apf.aml.setElement("table",apf.table);apf.aml.setElement("teleport",apf.AmlElement);apf.text=function(c,b){this.$init(b||"text",apf.NODE_VISIBLE,c);this.$nodes=[];};(function(){this.implement(apf.Cache,apf.ChildValue);this.$focussable=true;this.focussable=false;this.textselect=true;this.$hasStateMessages=true;this.$textTimer=this.$lastMsg=this.$lastClass=this.$changedHeight=null;this.$booleanProperties.scrolldown=true;this.$booleanProperties.secure=true;this.$booleanProperties.textselect=true;this.$supportedProperties.push("behavior","scrolldown","secure","value");this.$isTextInput=function(){return this.textselect;};this.$propHandlers.scrolldown=function(c){var b=this;if(c){this.$scrolldown=true;this.$scrollArea.onscroll=function(){b.$scrolldown=this.scrollTop>=this.scrollHeight-this.offsetHeight+apf.getVerBorders(this);};this.addEventListener("scroll",this.$scroll);this.addEventListener("afterload",this.$scroll);clearInterval(this.$textTimer);this.$textTimer=setInterval(function(){if(b.$scrollArea&&b.$scrolldown&&b.scrolldown){b.$scrollArea.scrollTop=b.$scrollArea.scrollHeight;}},1000);}else{this.removeEventListener("scroll",this.$scroll);this.removeEventListener("afterload",this.$scroll);clearInterval(this.$textTimer);if(this.$scrollArea){this.$scrollArea.onscoll=null;}}};this.$scroll=function(c){var b=this.$scrollArea;if(c.name=="afterload"){this.$scrolldown=true;b.scrollTop=b.scrollHeight;return;}this.$scrolldown=b.scrollTop>=b.scrollHeight-b.offsetHeight+apf.getVerBorders(b);};this.$propHandlers.value=function(c,g,b,d){if(this.each){return;}if(typeof c!="string"){if(c.nodeType){c=c.nodeType>1&&c.nodeType<5?c.nodeValue:c.firstChild&&c.firstChild.nodeValue||"";}else{c=c?c.toString():"";}}if(this.secure){c=c.replace(/<a /gi,"<a target='_blank' ").replace(/<object.*?\/object>/g,"").replace(/<script.*?\/script>/g,"").replace(new RegExp("ondblclick|onclick|onmouseover|onmouseout|onmousedown|onmousemove|onkeypress|onkeydown|onkeyup|onchange|onpropertychange","g"),"ona");}c=c.replace(/\<\?xml version="1\.0" encoding="UTF-16"\?\>/,"");if(d){apf.insertHtmlNodes(null,this.$container,null,c);if(!this.value){this.value="";}this.value+=c;}else{this.$container.innerHTML=c;}if(apf.cannotSizeIframe&&this.oIframe){this.oIframe.style.width=this.oIframe.offsetWidth+"px";}if(this.scrolldown&&this.$scrolldown){this.$scrollArea.scrollTop=this.$scrollArea.scrollHeight;}};this.$eachHandler=function(b){this.$attrExcludePropBind=apf.extend({},this.$attrExcludePropBind);this.$attrExcludePropBind.value=b?2:0;};this.addEventListener("prop.each",this.$eachHandler);this.addEventListener("$clear",function(){this.$container.innerHTML="";this.value="";this.dispatchEvent("prop.value",{value:""});});this.$moveNode=function(){};this.addValue=function(b){this.$propHandlers.value.call(this,b,null,null,true);this.dispatchEvent("prop.value",{value:this.value});};this.setValue=function(b){this.setProperty("value",b,false,true);};this.getValue=function(){return this.$container.innerHTML;};this.addEventListener("keydown",function(c){var b=c.keyCode;switch(b){case 33:this.$container.scrollTop-=this.$container.offsetHeight;break;case 34:this.$container.scrollTop+=this.$container.offsetHeight;break;case 35:this.$container.scrollTop=this.$container.scrollHeight;break;case 36:this.$container.scrollTop=0;break;case 38:this.$container.scrollTop-=10;break;case 40:this.$container.scrollTop+=10;break;default:return;}return false;},true);this.$canLoadData=function(){return this.$attrBindings.value?true:false;};this.$add=function(g,c,k,n,b){var m=this.$attrBindings.value.cvalue;var d=m(g);d="<div id='"+c+"'>"+d+"</div>";if(n){if(b){b.insertAdjacentHTML("beforebegin",d);}else{this.$container.insertAdjacentHTML("beforeend",d);}if(apf.cannotSizeIframe&&this.oIframe){this.oIframe.style.width=this.oIframe.offsetWidth+"px";}if(this.scrolldown&&this.$scrolldown){this.$scrollArea.scrollTop=this.$scrollArea.scrollHeight;}}else{this.$nodes.push(d);}};this.$fill=function(){this.$container.insertAdjacentHTML("beforeend",this.$nodes.join(""));this.$nodes=[];};this.$deInitNode=this.$updateNode=this.$moveNode=apf.K;this.$draw=function(){this.$ext=this.$getExternal();this.$container=this.$getLayoutNode("main","container",this.$ext);if(apf.hasCssUpdateScrollbarBug&&!apf.getStyle(this.$container,"padding")){this.$fixScrollBug();}this.$scrollArea=this.oFocus?this.oFocus.parentNode:this.$container;if(this.$container.tagName.toLowerCase()=="iframe"){if(apf.isIE){this.oIframe=this.$container;var c=this.skin.selectSingleNode("iframe_style");this.oIframe.contentWindow.document.write("<!DOCTYPE html>                    <head>                        <style>"+(c?c.firstChild.nodeValue:"")+"</style>                        <script>                            document.onkeydown = function(e){                                if (!e) e = event;                                if (top.apf.disableF5 && e.keyCode == 116) {                                    e.keyCode = 0;                                    return false;                                }                            }                        <\/script>                    </head>                    <body oncontextmenu='return false'></body>");this.$container=this.oIframe.contentWindow.document.body;}else{var b=document.createElement("div");this.$ext.parentNode.replaceChild(b,this.$ext);b.className=this.$ext.className;this.$ext=this.$container=b;}}if(this.getAttribute("each")){this.$eachHandler();}};this.addEventListener("DOMNodeRemovedFromDocument",function(){clearInterval(this.$textTimer);apf.destroyHtmlNode(this.oDrag);if(this.$scrollArea){this.$scrollArea.onscoll=this.$scrollArea=null;}this.oDrag=this.oIframe=this.oFocus=this.$container=this.$ext=null;});}).call(apf.text.prototype=new apf.MultiselectBinding());apf.aml.setElement("text",apf.text);apf.input=function(c,b){this.$init(b||"input",apf.NODE_VISIBLE,c);};apf.secret=function(c,b){this.$init(b||"secret",apf.NODE_VISIBLE,c);};apf.password=function(c,b){this.$init(b||"password",apf.NODE_VISIBLE,c);};apf.textarea=function(c,b){this.$init(b||"textarea",apf.NODE_VISIBLE,c);this.multiline=true;};apf.email=function(c,b){this.$init(b||"email",apf.NODE_VISIBLE,c);};apf.textbox=function(c,b){this.$init(b||"textbox",apf.NODE_VISIBLE,c);};(function(){this.implement(apf.DataAction);this.$focussable=true;this.$masking=false;this.$autoComplete=false;this.$childProperty="value";this.value="";this.$isTextInput=true;this.multiline=false;this.$booleanProperties.focusselect=true;this.$booleanProperties.realtime=true;this.$supportedProperties.push("value","mask","initial-message","focusselect","realtime","type");this.$propHandlers.value=function(g,k,d,c){if(!this.$input||!c&&this.getValue()==g){return;}if(!c&&!g&&!this.hasFocus()){return this.$clear();}else{if(this.isHTMLBox){if(this.$input.innerHTML!=g){this.$input.innerHTML=g;}}else{if(this.$input.value!=g){this.$input.value=g;}}}if(!c){apf.setStyleClass(this.$ext,"",[this.$baseCSSname+"Initial"]);}if(this.$button){this.$button.style.display=g&&!c?"block":"none";}};this.addEventListener("prop.maxlength",function(c){if(this.$input.tagName.toLowerCase().match(/input|textarea/)){this.$input.maxLength=parseInt(c.value)||null;}});this.addEventListener("prop.editable",function(c){if(apf.isIE){this.$input.unselectable=c.value?"On":"Off";}else{if(c.value){apf.addListener(this.$input,"mousedown",apf.preventDefault);}else{apf.removeListener(this.$input,"mousedown",apf.preventDefault);}}});this.$propHandlers.mask=function(c){if(this.mask.toLowerCase()=="password"){return;}if(!c){throw new Error("Not Implemented");}if(!this.$masking){this.$masking=true;this.implement(apf.textbox.masking);this.focusselect=false;}this.setMask(this.mask);};this.$propHandlers["initial-message"]=function(c){if(c){if(apf.hasFocusBug){this.$input.onblur();}}if(!this.value){this.$clear(true);}if(this.type=="password"&&this.$inputInitFix){this.$inputInitFix.innerHTML=c;apf.setStyleClass(this.$inputInitFix,"initFxEnabled");}};this.$propHandlers.focusselect=function(d){var c=this;this.$input.onmousedown=function(){c.focusselect=false;};this.$input.onmouseup=this.$input.onmouseout=function(){c.focusselect=d;};};this.$propHandlers.type=function(c){if(c&&"password|username".indexOf(c)>-1&&typeof this.focusselect=="undefined"){this.focusselect=true;this.$propHandlers.focusselect.call(this,true);}};this.$isTextInput=function(c){return true;};this.setValue=function(c){return this.setProperty("value",c,false,true);};this.clear=function(){this.setProperty("value","");};this.$clear=function(c){if(this["initial-message"]){apf.setStyleClass(this.$ext,this.$baseCSSname+"Initial");this.$propHandlers.value.call(this,this["initial-message"],null,null,true);}else{this.$propHandlers.value.call(this,"",null,null,true);}if(!c){this.dispatchEvent("clear");}};this.getValue=function(){var c=this.isHTMLBox?this.$input.innerHTML:this.$input.value;return c==this["initial-message"]?"":c.replace(/\r/g,"");};this.select=function(){try{this.$input.select();}catch(c){}};this.deselect=function(){this.$input.deselect();};this.$enable=function(){this.$input.disabled=false;};this.$disable=function(){this.$input.disabled=true;};this.$insertData=function(c){return this.setValue(c);};this.insert=function(g){if(apf.hasMsRangeObject){try{this.$input.focus();}catch(d){}var c=document.selection.createRange();if(this.oninsert){g=this.oninsert(g);}c.pasteHTML(g);c.collapse(true);c.select();}else{this.$input.value+=g;}};this.addEventListener("$clear",function(){this.value="";if(this["initial-message"]&&apf.document.activeElement!=this){this.$propHandlers.value.call(this,this["initial-message"],null,null,true);apf.setStyleClass(this.$ext,this.$baseCSSname+"Initial");}else{this.$propHandlers.value.call(this,"");}if(!this.$input.tagName.toLowerCase().match(/input|textarea/i)){if(apf.hasMsRangeObject){try{var c=document.selection.createRange();c.moveStart("sentence",-1);c.select();}catch(d){}}}this.dispatchEvent("clear");});this.$keyHandler=function(d,m,c,g,k){if(this.$button&&d==27){if(this.value){this.change("");k.stopPropagation();}}};this.$registerElement=function(c){if(!c){return;}if(c.localName=="autocomplete"){this.$autoComplete=c;}};var b;this.$focus=function(g){if(!this.$ext||this.$ext.disabled){return;}this.$setStyleClass(this.$ext,this.$baseCSSname+"Focus");if(this["initial-message"]&&this.$input.value==this["initial-message"]){this.$propHandlers.value.call(this,"",null,null,true);apf.setStyleClass(this.$ext,"",[this.$baseCSSname+"Initial"]);}var c=this;function d(){try{if(!b||document.activeElement!=c.$input){c.$input.focus();}else{clearInterval(b);return;}}catch(k){}if(c.$masking){c.setPosition();}if(c.focusselect){c.select();}}if((!g||g.mouse)&&apf.isIE){clearInterval(b);b=setInterval(d,1);}else{d();}};this.$blur=function(c){if(!this.$ext){return;}if(!this.realtime){this.change(this.getValue());}this.$setStyleClass(this.$ext,"",[this.$baseCSSname+"Focus","capsLock"]);if(this["initial-message"]&&this.$input.value==""){this.$propHandlers.value.call(this,this["initial-message"],null,null,true);apf.setStyleClass(this.$ext,this.$baseCSSname+"Initial");}try{if(apf.isIE||!c||c.srcElement!=apf.window){this.$input.blur();}}catch(c){}if(this.oContainer){$setTimeout("var o = apf.lookup("+this.$uniqueId+");                o.oContainer.style.display = 'none'",100);}clearInterval(b);};this.$draw=function(){var c=this,k=false;this.$ext=this.$getExternal(null,null,function(n){var m=this.getAttribute("mask");if((typeof m=="string"&&m.toLowerCase()=="password")||"secret|password".indexOf(this.localName)>-1){this.type="password";this.$getLayoutNode("main","input").setAttribute("type","password");}else{if(this.localName=="email"){this.datatype=(this.prefix?this.prefix+":":"")+"email";this.$propHandlers.datatype.call(this,this.datatype,"datatype");}else{if(this.localName=="url"){this.datatype=(this.prefix?this.prefix+":":"")+"url";this.$propHandlers.datatype.call(this,this.datatype,"datatype");}}}n.setAttribute("onmousedown","if (!this.host.disabled)                 this.host.dispatchEvent('mousedown', {htmlEvent : event});");n.setAttribute("onmouseup","if (!this.host.disabled)                 this.host.dispatchEvent('mouseup', {htmlEvent : event});");n.setAttribute("onclick","if (!this.host.disabled)                 this.host.dispatchEvent('click', {htmlEvent : event});");});this.$input=this.$getLayoutNode("main","input",this.$ext);this.$button=this.$getLayoutNode("main","button",this.$ext);this.$inputInitFix=this.$getLayoutNode("main","initialfix",this.$ext);if(this.type=="password"){this.$propHandlers.type.call(this,"password");}if(!apf.hasContentEditable&&"input|textarea".indexOf(this.$input.tagName.toLowerCase())==-1){var d=this.$input;this.$input=d.parentNode.insertBefore(document.createElement("textarea"),d);d.parentNode.removeChild(d);this.$input.className=d.className;if(this.$ext==d){this.$ext=this.$input;}}if(this.$button){this.$button.onmousedown=function(){c.$clear();c.change("");c.focus({mouse:true});};}if(this.$input.tagName.toLowerCase()=="textarea"){this.addEventListener("focus",function(m){});}this.$input.onselectstart=function(m){if(!m){m=event;}m.cancelBubble=true;};this.$input.host=this;this.$input.onkeydown=function(r){r=r||window.event;if(this.host.disabled){r.returnValue=false;return false;}if(!c.realtime){var o=c.getValue();if(r.keyCode==13&&o!=c.value){c.change(o);}}else{if(apf.isWebkit&&c.xmlRoot&&c.getValue()!=c.value){$setTimeout("var o = apf.lookup("+c.$uniqueId+");                    o.change(o.getValue())");}}if(c.multiline=="optional"&&r.keyCode==13&&!r.shiftKey||r.ctrlKey&&(r.keyCode==66||r.keyCode==73||r.keyCode==85)){r.returnValue=false;return false;}if(k&&this.getAttribute("type")=="password"&&this.value!=""){var m=(c.$ext.className.indexOf("capsLock")>-1),n=(r.keyCode===20);if(n){apf.setStyleClass(c.$ext,m?null:"capsLock",m?["capsLock"]:null);}}if(c.$autoComplete||c.oContainer){var q=r.keyCode;$setTimeout(function(){if(c.$autoComplete){c.$autoComplete.fillAutocomplete(q);}else{c.fillAutocomplete(q);}});}if(!c.mask){return c.$keyHandler(r.keyCode,r.ctrlKey,r.shiftKey,r.altKey,r);}};this.$input.onkeyup=function(n){if(!n){n=event;}if(this.host.disabled){return false;}var m=n.keyCode;if(c.$button){c.$button.style.display=this.value?"block":"none";}if(c.realtime){$setTimeout(function(){var o;if(!c.mask&&(o=c.getValue())!=c.value){c.change(o);}c.dispatchEvent("keyup",{keyCode:m});});}else{c.dispatchEvent("keyup",{keyCode:m});}if(c.isValid&&c.isValid()&&n.keyCode!=13&&n.keyCode!=17){c.clearError();}};if(apf.hasFocusBug){apf.sanitizeTextbox(this.$input);}if(apf.hasAutocompleteXulBug){this.$input.setAttribute("autocomplete","off");}if("INPUT|TEXTAREA".indexOf(this.$input.tagName)==-1){this.isHTMLBox=true;this.$input.unselectable="Off";this.$input.contentEditable=true;this.$input.style.width="1px";this.$input.select=function(){var m=document.selection.createRange();m.moveToElementText(this);m.select();};}this.$input.deselect=function(){if(!document.selection){return;}var m=document.selection.createRange();m.collapse();m.select();};var g;apf.addListener(this.$input,"keypress",g=function(n){if(c.$input.getAttribute("type")!="password"){return apf.removeListener(c.$input,"keypress",g);}n=n||window.event;var o=-1;if(n.which){o=n.which;}else{if(n.keyCode){o=n.keyCode;}}var m=false;if(n.shiftKey){m=n.shiftKey;}else{if(n.modifiers){m=!!(n.modifiers&4);}}if(((o>=65&&o<=90)&&!m)||((o>=97&&o<=122)&&m)){apf.setStyleClass(c.$ext,"capsLock");}else{apf.setStyleClass(c.$ext,null,["capsLock"]);}k=true;});};this.$loadAml=function(){if(typeof this["initial-message"]=="undefined"){this.$setInheritedAttribute("initial-message");}if(typeof this.realtime=="undefined"){this.$setInheritedAttribute("realtime");}};this.addEventListener("DOMNodeRemovedFromDocument",function(){if(this.$button){this.$button.onmousedown=null;}if(this.$input){this.$input.onkeypress=this.$input.onmouseup=this.$input.onmouseout=this.$input.onmousedown=this.$input.onkeydown=this.$input.onkeyup=this.$input.onselectstart=null;}});}).call(apf.textbox.prototype=new apf.StandardBinding());apf.config.$inheritProperties["initial-message"]=1;apf.config.$inheritProperties.realtime=1;apf.input.prototype=apf.secret.prototype=apf.password.prototype=apf.textarea.prototype=apf.email.prototype=apf.textbox.prototype;apf.aml.setElement("input",apf.input);apf.aml.setElement("secret",apf.secret);apf.aml.setElement("password",apf.password);apf.aml.setElement("textarea",apf.textarea);apf.aml.setElement("textbox",apf.textbox);apf.toolbar=function(c,b){this.$init(b||"toolbar",apf.NODE_VISIBLE,c);};(function(){this.$focussable=false;this.$draw=function(){this.$ext=this.$getExternal();this.$int=this.$getLayoutNode("main","container",this.$ext);};}).call(apf.toolbar.prototype=new apf.Presentation());apf.aml.setElement("toolbar",apf.toolbar);apf.tree=function(c,b){this.$init(b||"tree",apf.NODE_VISIBLE,c);};(function(){var b=1<<1,d=1<<2,k=1<<3,m=1<<4,c=this.$treeState;this.$mode=0;this.$propHandlers.mode=function(n){if("check|radio".indexOf(n)>-1){if(!this.hasFeature(apf.__MULTICHECK__)){this.implement(apf.MultiCheck);}this.addEventListener("afterrename",g);this.multicheck=n=="check";this.$mode=this.multicheck?1:2;}else{this.removeEventListener("afterrename",g);this.$mode=0;}};function g(){}this.$initNode=function(E,o,A){this.$getNewContext("item");var u=o&b||this.emptyMessage&&this.$applyBindRule("empty",E),y=this.$getLayoutNode("item");y.setAttribute("onmouseover","var o = apf.lookup("+this.$uniqueId+");            o.$setStyleClass(this, 'hover', null, true);");y.setAttribute("onmouseout","var o = apf.lookup("+this.$uniqueId+");            o.$setStyleClass(this, '', ['hover'], true);");this.$setStyleClass(this.$getLayoutNode("item","class"),c[o]).setAttribute(apf.xmldb.htmlIdTag,A);this.$setStyleClass(this.$getLayoutNode("item","container"),c[o]);var t=this.$getLayoutNode("item","openclose");if(t){t.setAttribute("children",u);t.setAttribute("onmousedown","if (this.getAttribute('children') == false) return;                var o = apf.lookup("+this.$uniqueId+");                o.slideToggle(this, null, null, true);                apf.cancelBubble(event, o);");t.setAttribute("ondblclick","event.cancelBubble = true");}if(this.$mode){var F=this.$getLayoutNode("item","check");if(F){F.setAttribute("onmousedown","var o = apf.lookup("+this.$uniqueId+");                    o.checkToggle(this, true);o.$skipSelect = true;");if(apf.isTrue(this.$applyBindRule("checked",E))){this.$checkedList.push(E);this.$setStyleClass(y,"checked");}else{if(this.isChecked(E)){this.$setStyleClass(y,"checked");}}}else{return false;}}var r=this.opencloseaction||"ondblclick";var B=this.$getLayoutNode("item","icon");if(B&&B!=t){if(r!="ondblclick"){B.setAttribute(r,"var o = apf.lookup("+this.$uniqueId+");"+(r=="onmousedown"?"o.select(this, event.ctrlKey, event.shiftKey, event.button);":"")+(true?"o.slideToggle(this, null, null, true);":""));}if(r!="onmousedown"){B.setAttribute("onmousedown","apf.lookup("+this.$uniqueId+").select(this, event.ctrlKey, event.shiftKey, event.button);");}B.setAttribute("ondblclick","var o = apf.lookup("+this.$uniqueId+");              o.choose();o.stopRename();"+(true&&!r=="ondblclick"?"o.slideToggle(this, null, null, true);":"")+"apf.cancelBubble(event,o);");}var s=this.$getLayoutNode("item","select"),D;if(this.hasFeature(apf.__RENAME__)||this.hasFeature(apf.__DRAGDROP__)){D="var o = apf.lookup("+this.$uniqueId+");                 var xmlNode = apf.xmldb.findXmlNode(this);                 var isSelected = o.isSelected(xmlNode);                 this.hasPassedDown = true;                 if (!o.renaming && o.hasFocus() && isSelected == 1)                     this.dorename = true;                 if (!o.hasFeature(apf.__DRAGDROP__) || !isSelected && !event.ctrlKey)                     o.select(this, event.ctrlKey, event.shiftKey, event.button);                 apf.cancelBubble(event, o);";s.setAttribute("onmouseout","this.hasPassedDown = false;"+(s.getAttribute("onmouseout")||""));s.setAttribute("onmouseup","if (!this.hasPassedDown) return;                var o = apf.lookup("+this.$uniqueId+");if (this.dorename && !o.mode)                    o.startDelayedRename(event, null, true);this.dorename = false;                 var xmlNode = apf.xmldb.findXmlNode(this);                 var isSelected = o.isSelected(xmlNode);                 if (o.hasFeature(apf.__DRAGDROP__))                     o.select(this, event.ctrlKey, event.shiftKey, event.button);");}else{D="o.select(this, event.ctrlKey, event.shiftKey, event.button);                            apf.cancelBubble(event, o);";}if(r!="ondblclick"){s.setAttribute(r,"var o = apf.lookup("+this.$uniqueId+");"+(r=="onmousedown"?D:"")+(true?"o.slideToggle(this, null, null, true);":""));}if(r!="onmousedown"){s.setAttribute("onmousedown","var o = apf.lookup("+this.$uniqueId+");"+D);}s.setAttribute("ondblclick","var o = apf.lookup("+this.$uniqueId+");          o.choose();o.stopRename();this.dorename=false;"+(r=="ondblclick"?"o.slideToggle(this, null, null, true);":"")+"apf.cancelBubble(event, o);");if(B){var x=this.$applyBindRule("icon",E);if(x){if(B.tagName.match(/^img$/i)){B.setAttribute("src",apf.getAbsolutePath(this.iconPath,x));}else{B.setAttribute("style","background-image:url("+apf.getAbsolutePath(this.iconPath,x)+")");}}}var C=this.$getLayoutNode("item","caption");if(C){if(C.nodeType==1&&this.$cbindings.caption&&this.$cbindings.caption.hasAml){var n=(this.$amlBindQueue||(this.$amlBindQueue={}));C.setAttribute("id","placeholder_"+this.$uniqueId+"_"+((n.caption||(n.caption=[])).push(E)-1));apf.setNodeValue(C,"");}else{apf.setNodeValue(C,this.$applyBindRule("caption",E));}}var w=this.$applyBindRule("tooltip",E);if(w){y.setAttribute("title",w);}var G=this.$applyBindRule("css",E);if(G){this.$setStyleClass(this.$getLayoutNode("item",null,y),G);this.$setStyleClass(this.$getLayoutNode("item","container",y),G);this.$dynCssClasses.push(G);}return y;};this.$updateNode=function(q,s){var o=this.$getLayoutNode("item","icon",s),r=this.$applyBindRule("icon",q);if(o&&r){if(o.tagName&&o.tagName.match(/^img$/i)){o.src=apf.getAbsolutePath(this.iconPath,r);}else{o.style.backgroundImage="url("+apf.getAbsolutePath(this.iconPath,r)+")";}}var u=this.$getLayoutNode("item","caption",s);if(u){if(u.nodeType==1){if(!this.$cbindings.caption||!this.$cbindings.caption.hasAml){u.innerHTML=this.$applyBindRule("caption",q);}}else{u.nodeValue=this.$applyBindRule("caption",q);}}var t=this.$applyBindRule("tooltip",q);if(t){s.setAttribute("title",t);}var n=this.$applyBindRule("css",q);if(n||this.$dynCssClasses.length){this.$setStyleClass(s,n,this.$dynCssClasses);if(n&&!this.$dynCssClasses.contains(n)){this.$dynCssClasses.push(n);}}};this.$draw=function(){this.$drawBase();};}).call(apf.tree.prototype=new apf.BaseTree());apf.aml.setElement("tree",apf.tree);apf.aml.setElement("checked",apf.BindingRule);apf.webdav=function(c,b){this.$init(b||"webdav",apf.NODE_HIDDEN,c);this.$locks={};this.$lockedStack=[];this.$lockId=0;this.$serverVars={};this.$fsCache={};};(function(){this.useHTTP=true;this.method="GET";this.$showHidden=false;this.$booleanProperties.showhidden=true;this.$supportedProperties.push("showhidden");this.$propHandlers.showhidden=function(w){this.$showHidden=w;};this.$regVar=function(w,x){this.$serverVars[w]=x;return x;};function m(){for(var w=0;w<arguments.length;w++){if(typeof this.$serverVars[arguments[w]]!="undefined"){this.$serverVars[arguments[w]]=null;delete this.$serverVars[arguments[w]];}}}this.$getVar=function(w){return this.$serverVars[w]||"";};this.doRequest=function(D,y,A,C,B,x){if(!this.$getVar("authenticated")){return b.call(this,{method:this.doRequest,context:this,args:arguments});}if(B){if(!C){C={};}C["Content-type"]="text/xml; charset=utf-8";}var w=this;return this.get(y||this.$server,{callback:function(H,G,E){if(G!=apf.SUCCESS){var K;K=t.call(w,"Url: "+E.url+"\nInfo: "+E.message);if(E.tpModule.retryTimeout(E,G,w,K)===true){return true;}if(D){return D.call(w,H,G,E);}else{throw K;}}var J=parseInt(E.status);if(J==401){return;}var F=(E.http.responseText||"");if(F.replace(/^[\s\n\r]+|[\s\n\r]+$/g,"")!=""&&F.indexOf("<?xml version=")==0){try{H=(E.http.responseXML&&E.http.responseXML.documentElement)?apf.xmlParseError(E.http.responseXML):apf.getXmlDom(E.http.responseText);if(!apf.supportNamespaces){H.setProperty("SelectionLanguage","XPath");}H=H.documentElement;E.data=H;}catch(I){if(D){return D.call(w,H,G,E);}else{throw t.call(w,"Received invalid XML\n\n"+I.message);}}}if(typeof D=="function"){D.call(w,H,G,E,x);}},nocache:false,useXML:false,ignoreOffline:true,data:A||"",headers:C,username:this.$getVar("auth-username")||null,password:this.$getVar("auth-password")||null});};function c(y){m.call(this,"auth-password");var x={username:this.$getVar("auth-username"),server:this.$server,message:y||"Access denied. Please check you username or password."};var w=this.$getVar("auth-callback");if(w){w(null,apf.ERROR,x);m.call(this,"auth-callback");}return this.dispatchEvent("authfailure",x);}function n(y){m.call(this,"auth-password");var x={username:this.$getVar("auth-username"),server:this.$server,message:y||"Could not connect to server, please contact your System Administrator."};var w=this.$getVar("auth-callback");if(w){w(null,apf.ERROR,x);m.call(this,"auth-callback");}return this.dispatchEvent("connectionerror",x);}function t(w){return new Error(apf.formatErrorString(0,this,"WebDAV Communication error",w));}function b(B){var w,A=false;if(apf.isIE){try{w=new ActiveXObject("Msxml2.DOMDocument");}catch(y){}}else{if(document.implementation&&document.implementation.createDocument){try{w=document.implementation.createDocument("","",null);}catch(y){}}}try{if(apf.isIE){w.async=false;w.load(this.$rootPath);}}catch(y){A=true;}var x=this.ownerDocument.getElementsByTagNameNS(apf.ns.apf,"auth")[0];if(A){x.authRequired(B);}else{this.$regVar("authenticated",true);if(B&&B.method){B.method.apply(B.context,B.args);}}}this.authenticate=function(A,w,y){this.$regVar("auth-username",A);this.$regVar("auth-password",w);this.$regVar("auth-callback",y);var x=apf.document.getElementsByTagNameNS(apf.ns.apf,"auth")[0];if(!x){return;}this.doRequest(function(E,D,C){if(C.status==401){return x.authRequired();}this.$regVar("authenticated",true);var B=this.$getVar("auth-callback");if(B){B(null,D,C);m.call(this,"auth-callback");}},this.$rootPath,null,{},false,null);};this.reset=function(){m.call(this,"authenticated");m.call(this,"auth-username");m.call(this,"auth-password");m.call(this,"auth-callback");};this.readFile=this.read=function(w,x){this.method="GET";this.doRequest(function(B,A,y){var D=parseInt(y.status);if(D==403){var C=t.call(this,"Unable to read file. Server says: "+apf.webdav.STATUS_CODES["403"]);if(this.dispatchEvent("error",{error:C,bubbles:true})===false){throw C;}}else{x?x.call(this,y.http.responseText,A,y):this.dispatchEvent("onfilecontents",{data:y.http.responseTex});}},w);};this.readdir=function(w,x){if(w.charAt(w.length-1)!="/"){w+="/";}return this.getProperties(w,1,x);};this.mkdir=function(x,y,B){if(y){var A=this.lock(x);if(!A.token){return k.call(this,A,"mkdir",arguments);}}var w=this;this.method="MKCOL";this.doRequest(function(E,D,C){y&&q.call(this,x);var G=parseInt(C.status);if(G==201){w.readdir(x.substr(0,x.lastIndexOf("/")),B);}else{if(G==403||G==405||G==409||G==415||G==507){var F=t.call(this,"Unable to create directory '"+x+"'. Server says: "+apf.webdav.STATUS_CODES[String(G)]);if(this.dispatchEvent("error",{error:F,bubbles:true})===false&&B){B(F);}}}},x,null,y&&A.token?{If:"<"+A.token+">"}:null,true);};this.list=function(w,x){return this.getProperties(w,0,x);};this.writeFile=this.write=function(x,y,A,C){if(A){var B=this.lock(x);if(!B.token){return k.call(this,B,"write",arguments);}}this.method="PUT";var w=this;this.doRequest(function(F,E,D){var H=parseInt(D.status);if(E!=apf.SUCCESS){var G=t.call(this,"Unable to write to file. Server says: "+apf.webdav.STATUS_CODES[String(H)]);if(this.dispatchEvent("error",{error:G,bubbles:true})===false){throw G;}C&&C.call(this,F,apf.ERROR,D);}else{w.getProperties(x,0,C);}},x,y,A&&B.token?{If:"<"+B.token+">"}:null);};this.copy=function(x,w,A,y,D){if(!w||x==w){return(D&&D("",apf.SUCCESS,{}));}if(y){var B=this.lock(x);if(!B.token){return k.call(this,B,"copy",arguments);}}this.method="COPY";var C={Destination:w||this.$server};if(typeof A=="undefined"){A=true;}if(!A){C.Overwrite="F";}if(y&&B.token){C.If="<"+B.token+">";}this.doRequest(function(G,F,E){y&&q.call(this,x);var I=parseInt(E.status);if(I==403||I==409||I==412||I==423||I==424||I==502||I==507){var H=t.call(this,"Unable to copy file '"+x+"' to '"+w+"'. Server says: "+apf.webdav.STATUS_CODES[String(I)]);if(this.dispatchEvent("error",{error:H,bubbles:true})===false){throw H;}}else{this.getProperties(w,0,D);}},x,null,C);};this.rename=this.move=function(x,w,A,y,D){if(!w||x==w){return(D&&D("",apf.SUCCESS,{}));}if(y){var B=this.lock(x);if(!B.token){return k.call(this,B,"move",arguments);}}this.method="MOVE";var C={Destination:w||this.$server};if(typeof A=="undefined"){A=true;}if(!A){C.Overwrite="F";}if(y&&B.token){C.If="<"+B.token+">";}this.doRequest(function(G,F,E){y&&q.call(this,x);var I=parseInt(E.status);if(I==403||I==409||I==412||I==423||I==424||I==502||I==500){var H=t.call(this,"Unable to move file '"+x+"' to '"+w+"'. Server says: "+apf.webdav.STATUS_CODES[String(I)]);if(this.dispatchEvent("error",{error:H,bubbles:true})===false){throw H;}}else{if(this.$fsCache[x]){this.$fsCache[w]=this.$fsCache[x];this.$fsCache[w].path=w;delete this.$fsCache[x];}}D&&D.call(this,G,F,E);},x,null,C);};this.remove=function(w,x,A){if(x){var y=this.lock(w);if(!y.token){return k.call(this,y,"remove",arguments);}}this.method="DELETE";this.doRequest(function(D,C,B){x&&q.call(this,w);var F=parseInt(B.status);if(F==423||F==424){var E=t.call(this,"Unable to remove file '"+w+"'. Server says: "+apf.webdav.STATUS_CODES[String(F)]);if(this.dispatchEvent("error",{error:E,bubbles:true})===false){throw E;}}A&&A.call(this,D,C,B);},w,null,x&&y.token?{If:"<"+y.token+">"}:null);};this.report=function(w,C,x,B){var y=['<?xml version="1.0" encoding="utf-8" ?>',"<D:"+C+' xmlns:D="',apf.webdav.NS.D,'">'];if(x){for(var A in x){y.push("<D:"+A,(x[A]?">"+apf.xmlentities(apf.escapeXML(x[A]))+"</D:"+A+">":"/>"));}}y.push("</D:",C,">");this.method="REPORT";this.doRequest(function(F,E,D){var H=parseInt(D.status);if(E!=apf.SUCCESS){var G=t.call(this,"Unable to fetch report on '"+w+"'. Server says: "+apf.webdav.STATUS_CODES[String(H)]);if(this.dispatchEvent("error",{error:G,bubbles:true})===false){throw G;}}B&&B.call(this,F,E,D);},w,y.join(""));};this.lock=function(x,w,D,C,E){var A=this.$locks[x];if(A&&A.token){return A;}this.method="LOCK";D=D?"Infinite, Second-4100000000":"Second-"+D;var B={Timeout:D};if(w){B.Depth=w||"Infinity";}if(C){B.If="<"+C+">";}var y='<?xml version="1.0" encoding="utf-8"?><D:lockinfo xmlns:D="'+apf.webdav.NS.D+'"><D:lockscope><D:exclusive /></D:lockscope><D:locktype><D:write /></D:locktype><D:owner><D:href>'+document.location.toString().escapeHTML()+ +"</D:href></D:owner></D:lockinfo>";this.doRequest(r,x,y,B,true,E);return g.call(this,x);};this.unlock=function(w,x){if(typeof w=="string"){w=this.$locks[w];}if(!w||!w.token){return;}this.method="UNLOCK";this.doRequest(function(B,A,y){q.call(this,y.url.replace(this.$server,""));},w.path,null,{"Lock-Token":"<"+w.token+">"},true,x);};function g(w){return this.$locks[w]={path:w,id:this.$lockId++,token:null};}function r(C,w,A){var D=parseInt(A.status),B=A.url.replace(this.$server,""),F=this.$locks[B]||g.call(this,B);if(D==409||D==423||D==412){q.call(this,A.url.replace(this.$server,""));var E=t.call(this,"Unable to apply lock to '"+B+"'. Server says: "+apf.webdav.STATUS_CODES[String(D)]);if(this.dispatchEvent("error",{error:E,bubbles:true})===false){throw E;}}var y=apf.webdav.NS,G=$xmlns(C,"owner",y.ns0)[0],x=$xmlns(C,"locktoken",y.D)[0];F.path=B;F.type="write";F.scope=$xmlns(C,"exclusive",y.D).length?"exclusive":"shared";F.depth=$xmlns(C,"depth",y.D)[0].firstChild.nodeValue;F.owner=$xmlns(G,"href",y.ns0)[0].firstChild.nodeValue;F.timeout=$xmlns(C,"timeout",y.D)[0].firstChild.nodeValue;F.token=$xmlns(x,"href",y.D)[0].firstChild.nodeValue.split(":")[1];s.call(this,F);}function q(w){var x=this.$locks[w];if(!x){return;}s.call(this,x,true);this.$locks[w]=x=null;delete this.$locks[w];}function k(x,w,y){return this.$lockedStack.push({lockId:x.id,func:w,args:y});}function s(y,w){for(var x=this.$lockedStack.length-1;x>=0;x--){if(this.$lockedStack[x].lockId!=y.id){continue;}if(!w){this[this.$lockedStack[x].func].apply(this,this.$lockedStack[x].args);}this.$lockedStack.remove(x);}}this.getProperties=function(x,w,B,A){this.method="PROPFIND";var y='<?xml version="1.0" encoding="utf-8" ?><D:propfind xmlns:D="'+apf.webdav.NS.D+'"><D:allprop /></D:propfind>';A=A||{};A.Depth=typeof w!="undefined"?w:1;this.doRequest(d,x,y,A,true,B);};this.setProperties=function(x,w,y,A){this.method="PROPPATCH";this.doRequest(function(D,C,B){},x,u.call(this,w,y),A?{If:"<"+A+">"}:null,true);};function u(x,A){var D=['<?xml version="1.0" encoding="utf-8" ?>','<D:propertyupdate xmlns:D="',apf.webdav.NS.D,'">'];var w=false,C,B,y;for(C in x){w=true;break;}if(w){D.push("<D:set>");for(C in x){for(B in x[C]){D.push("<D:prop>",x[C][B],"</D:prop>");}}D.push("</D:set>");}w=false;for(C in A){w=true;break;}if(w){D.push("<D:remove><D:prop>");for(C in A){for(B=0,y=A[C].length;B<y;B++){D.push("<",A[C][B],' xmlns="',C,'"/>');}}D.push("</D:prop></D:remove>");}D.push("</D:propertyupdate>");return D.join("");}function d(E,w,A,F){var C=parseInt(A.status);if(C==403||C==401||!E){return F?F.call(this,null,w,A):c.call(this);}var y=$xmlns(E,"response",apf.webdav.NS.D),x=[];if(y.length){this.$regVar("authenticated",true);}for(var D=1,B=y.length;D<B;D++){x.push(o.call(this,y[D]));}F&&F.call(this,"<files>"+x.join("")+"</files>",w,A);}function o(E){var y=apf.webdav.NS,A=decodeURIComponent($xmlns(E,"href",y.D)[0].firstChild.nodeValue.replace(/[\\\/]+$/,"")),B=A.split("/").pop(),D=(B.charAt(0)==".");if(!this.$showHidden&&D){return"";}var F,C,w=$xmlns(E,"collection",y.D).length>0?"folder":"file",G=$xmlns(E,"getcontenttype",y.D),x=$xmlns(E,"executable",y.lp2);C=this.$fsCache[A]=apf.extend(this.$fsCache[A]||{},{path:A,type:w,size:parseInt(w=="file"?(F=$xmlns(E,"getcontentlength",y.lp1)).length?F[0].firstChild.nodeValue:0:0),name:B,contentType:(w=="file"&&G.length?G[0].firstChild.nodeValue:""),creationDate:(F=$xmlns(E,"creationdate",y.lp1)).length?F[0].firstChild.nodeValue:"",lastModified:(F=$xmlns(E,"getlastmodified",y.lp1)).length?F[0].firstChild.nodeValue:"",etag:(F=$xmlns(E,"getetag",y.lp1)).length?F[0].firstChild.nodeValue:"",lockable:($xmlns(E,"locktype",y.D).length>0),executable:(x.length>0&&x[0].firstChild.nodeValue=="T")});return C.xml="<"+w+" path='"+A+"'  type='"+w+"' size='"+C.size+"' name='"+C.name+"' contenttype='"+C.contentType+"' creationdate='"+C.creationDate+"' lockable='"+C.lockable.toString()+"' hidden='"+D.toString()+"' executable='"+C.executable.toString()+"'/>";}this.exec=function(C,y,B){var w=function(F,E,D){D.originalArgs=y;if(typeof y[y.length-1]=="function"){y[y.length-1](F,E,D);}B&&B(F,E,D);};switch(C){case"login":case"authenticate":this.authenticate(y[0],y[1],w);break;case"logout":this.reset();break;case"read":this.readFile(y[0],w);break;case"create":var A=y[0]?y[0]:"";if(A.charAt(A.length-1)!="/"){A=A+"/";}this.writeFile(A+y[1],y[2],y[3]||false,w);break;case"write":case"store":case"save":this.writeFile(y[0],y[1],y[2]||false,w);break;case"copy":case"cp":this.copy(y[0],y[1],y[2]||true,y[3]||false,w);break;case"rename":var x=y[1].substr(0,y[1].lastIndexOf("/")+1);this.rename(y[1],x+y[0],y[2]||false,y[3]||false,w);break;case"move":case"mv":A=y[1];if(A.charAt(A.length-1)!="/"){A=A+"/";}this.rename(y[0],A+y[0].substr(y[0].lastIndexOf("/")+1),y[2]||false,y[3]||false,w);break;case"remove":case"rmdir":case"rm":this.remove(y[0],y[1]||false,w);break;case"readdir":case"scandir":this.readdir(y[0],w);break;case"getroot":this.getProperties(this.$rootPath,0,w);break;case"mkdir":A=y[0]?y[0]:"";if(A.charAt(A.length-1)!="/"){A=A+"/";}this.mkdir(A+y[1],y[2]||false,w);break;case"lock":this.lock(y[0],null,null,null,w);break;case"unlock":this.unlock(y[0],w);break;case"report":this.report(y[0],y[1],y[2],w);break;default:break;}};}).call(apf.webdav.prototype=new apf.Teleport());apf.aml.setElement("webdav",apf.webdav);apf.webdav.NS={D:"DAV:",ns0:"DAV:",lp1:"DAV:",lp2:"http://apache.org/dav/props/"};apf.webdav.STATUS_CODES={"100":"Continue","101":"Switching Protocols","102":"Processing","200":"OK","201":"Created","202":"Accepted","203":"None-Authoritive Information","204":"No Content","1223":"No Content","205":"Reset Content","206":"Partial Content","207":"Multi-Status","300":"Multiple Choices","301":"Moved Permanently","302":"Found","303":"See Other","304":"Not Modified","305":"Use Proxy","307":"Redirect","400":"Bad Request","401":"Unauthorized","402":"Payment Required","403":"Forbidden","404":"Not Found","405":"Method Not Allowed","406":"Not Acceptable","407":"Proxy Authentication Required","408":"Request Time-out","409":"Conflict","410":"Gone","411":"Length Required","412":"Precondition Failed","413":"Request Entity Too Large","414":"Request-URI Too Large","415":"Unsupported Media Type","416":"Requested range not satisfiable","417":"Expectation Failed","422":"Unprocessable Entity","423":"Locked","424":"Failed Dependency","500":"Internal Server Error","501":"Not Implemented","502":"Bad Gateway","503":"Service Unavailable","504":"Gateway Time-out","505":"HTTP Version not supported","507":"Insufficient Storage"};apf.UndoData=function(g,c){this.localName="UndoData";this.extra={};apf.extend(this,g);if(!this.timestamp){this.timestamp=(new Date()).getUTCTime();}if(c){this.at=c;}else{if(g&&g.tagName=="UndoData"){this.args=g.args.slice();}else{this.selNode=this.selNode||(this.action=="removeNode"?this.args[0]:(this.amlNode?this.amlNode.selected:null));}}var d,b=this;this.saveChange=function(m,k,q){if(this.action=="group"){var o=this.args[1];k.$addToQueue(o,m,true);return k.$queueNext(this);}var n;if(this.xmlActionNode){n=this.xmlActionNode.getAttribute(m?"undo":"set");if(m&&!n){n=this.xmlActionNode.getAttribute("set");}}if(!n){return k.$queueNext(this);}this.state=m?"restoring":"saving";if(!d.asyncs){return k.$receive(null,apf.SUCCESS,{amlNode:this.amlNode},this,q);}d.ignoreOffline=true;apf.saveData(n,d);};this.preparse=function(m,k,n,q){var o;if(this.xmlActionNode){o=this.xmlActionNode.getAttribute(m?"undo":"set");if(m&&!o){o=this.xmlActionNode.getAttribute("set");}}if(!o){return this;}d=apf.extend({xmlNode:this.action=="multicall"?this.args[0].xmlNode:this.selNode||this.xmlNode,userdata:apf.isTrue(this.xmlActionNode.getAttribute("ignore-fail")),multicall:n,undo:m,precall:true,callback:function(t,s,r){if(d.asyncs){r.amlNode=b.amlNode;return k.$receive(t,s,r,b,q);}}},this.extra);apf.saveData(o,d);return this;};};apf.actiontracker.actions={setTextNode:function(d,b){var c=d.args;if(!b){apf.xmldb.setTextNode(c[0],c[1],c[2],d);}else{apf.xmldb.setTextNode(c[0],d.extra.oldValue,c[2],d);}},setAttribute:function(d,b){var c=d.args;if(!b){d.extra.name=c[1];d.extra.oldValue=c[0].getAttribute(c[1]);apf.xmldb.setAttribute(c[0],c[1],c[2],c[3],d);}else{if(!d.extra.oldValue){apf.xmldb.removeAttribute(c[0],c[1],null,d);}else{apf.xmldb.setAttribute(c[0],c[1],d.extra.oldValue,c[3],d);}}},removeAttribute:function(d,b){var c=d.args;if(!b){d.extra.name=c[1];d.extra.oldValue=c[0].getAttribute(c[1]);apf.xmldb.removeAttribute(c[0],c[1],c[2],d);}else{apf.xmldb.setAttribute(c[0],c[1],d.extra.oldValue,c[2],d);}},replaceNode:function(d,b){var c=d.args;if(!b){apf.xmldb.replaceNode(c[0],c[1],c[2],d);}else{apf.xmldb.replaceNode(c[1],c[0],c[2],d);}},addChildNode:function(d,b){var c=d.args;if(!b){apf.xmldb.addChildNode(c[0],c[1],c[2],c[3],d);}else{apf.xmldb.removeNode(d.extra.addedNode,null,d);}},appendChild:function(d,b){var c=d.args;if(!b){apf.xmldb.appendChild(c[0],c[1],c[2],c[3],c[4],d);}else{apf.xmldb.removeNode(d.xmlNode,null,d);}},moveNode:function(d,b){var c=d.args;if(!b){apf.xmldb.moveNode(c[0],c[1],c[2],c[3],d);}else{apf.xmldb.moveNode(d.extra.oldParent,c[1],d.extra.beforeNode,c[3],d);}},removeNode:function(d,b){var c=d.args;if(!b){apf.xmldb.removeNode(c[0],c[1],d);}else{apf.xmldb.appendChild(d.extra.parent,d.extra.removedNode,d.extra.beforeNode,null,null,d);}},removeNodeList:function(k,b){if(b){var g=k.extra.removeList;for(var c=g.length-1;c>=0;c--){apf.xmldb.appendChild(g[c].pNode,g[c].removedNode,g[c].beforeNode,null,null,k);}}else{apf.xmldb.removeNodeList(k.args,k);}},group:function(g,d,b){if(!g.$undostack){var c=g.args[0];g.$undostack=c;g.$redostack=[];}b[d?"undo":"redo"](g.$undostack.length,false,g.$undostack,g.$redostack);},setValueByXpath:function(k,b){var d,g=k.args;if(!b){if(d=k.extra.newNode){if(d.nodeType==2){apf.xmldb.setAttribute(k.extra.ownerElement,d.nodeName,d.nodeValue);k.extra.newNode=k.extra.ownerElement.getAttributeNode(d.nodeName);}else{apf.xmldb.appendChild(k.extra.parentNode,k.extra.newNode,null,null,null,k);}}else{var c=[];apf.setNodeValue(g[0],g[1],true,{undoObj:k,xpath:g[2],newNodes:c,forceNew:g[3]});d=k.extra.newNode=c[0];if(d){if(d.nodeType==2){k.extra.ownerElement=d.ownerElement||d.selectSingleNode("..");}else{k.extra.parentNode=k.extra.newNode.parentNode;}}}}else{if(d=k.extra.newNode){if(d.nodeType==2){apf.xmldb.removeAttribute(k.extra.ownerElement,d.nodeName,null,k);}else{apf.xmldb.removeNode(k.extra.newNode,null,k);}}else{apf.setNodeValue(k.extra.appliedNode,k.extra.oldValue,true,{undoObj:k});}}},multicall:function(m,c,b){var k=m.args;var g=apf.xmldb.delayUpdate;apf.xmldb.delayUpdate=true;if(!c){for(var d=0;d<k.length;d++){if(!k[d].extra){k[d].extra={};}apf.actiontracker.actions[k[d].action](k[d],false,b);}}else{for(var d=k.length-1;d>=0;d--){apf.actiontracker.actions[k[d].action](k[d],true,b);}}apf.xmldb.delayUpdate=g;}};if(apf.hasRequireJS){require.def("apf/elements/dbg/chromedebughost",["debug/ChromeDebugMessageStream","debug/WSChromeDebugMessageStream","debug/DevToolsService","debug/V8DebuggerService","debug/V8Debugger","apf/elements/dbg/v8debugger"],function(g,k,d,m,c,n){var b=function(r,q,s,o){this.$hostname=r;this.$port=q;this.$o3obj=s;this.$ws=o;this.$debuggers={};this.$init();this.$connect(function(){});};(function(){this.$connect=function(s){var q=this;if(this.state=="connected"){return s.call(this);}else{this.addEventListener("connect",function(){q.removeEventListener("connect",arguments.callee);s.call(q);});}if(this.state=="connecting"){return;}this.state="connecting";if(!this.$ws){var o=this.$socket=new O3Socket(this.$hostname,this.$port,this.$o3obj);var r=new g(o);}else{var r=new k(this.$ws);}r.addEventListener("connect",function(){q.$dts=new d(r);q.$v8ds=new m(r);q.state="connected";q.dispatchEvent("connect");window.onunload=q.disconnect.bind(q);});r.connect();};this.loadTabs=function(q){var o=this;this.$connect(function(){o.$dts.listTabs(function(t){var r=[];for(var s=0;s<t.length;s++){r.push("<tab id='",t[s][0],"' url='",apf.escapeXML(t[s][1]+""),"' />");}q.load("<tabs>"+r.join("")+"</tabs>");});});};this.attach=function(r,s){var o;if(o=this.$debuggers[r]){return s(null,o);}var q=this;this.$connect(function(){q.$v8ds.attach(r,function(){o=new n(new c(r,q.$v8ds),this);q.$debuggers[r]=o;s(null,o);});});};this.detach=function(o,s){var q=this;for(var r in this.$debuggers){if(this.$debuggers[r]==o){this.$v8ds.detach(r,function(t){delete q.$debuggers[r];o.dispatchEvent("detach");s&&s(t);});break;}}};this.disconnect=function(t){var r=[];for(var s in this.$debuggers){r.push(s);}var q=this;var o=function(){if(r.length){var w=r.shift();var u=q.$debuggers[w];q.$v8ds.detach(w,function(){o();u.dispatchEvent("detach");});}else{q.$socket.close();q.$debuggers={};q.dispatchEvent("disconnect",{});t&&t();}};o();};}).call(b.prototype=new apf.Class());return b;});}if(apf.hasRequireJS){require.def("apf/elements/dbg/v8debugger",["debug/Breakpoint"],function(c){var b=function(g,k){this.$init();this.$debugger=g;this.$host=k;this.$breakpoints={};var d=this;g.addEventListener("changeRunning",function(m){d.dispatchEvent("changeRunning",m);if(g.isRunning()){d.setFrame(null);}});g.addEventListener("break",function(m){d.dispatchEvent("break",m);});g.addEventListener("afterCompile",function(m){d.dispatchEvent("afterCompile",{script:apf.getXml(d.$getScriptXml(m.data.script))});});this.setFrame(null);};(function(){var d={object:8,"function":4};this.stripPrefix="",this.setStrip=function(k){this.stripPrefix=k;};this.$strip=function(k){if(!this.stripPrefix){return k;}if(k.indexOf(this.stripPrefix)==0){return k.slice(this.stripPrefix.length);}else{return k;}};this.isRunning=function(){return this.$debugger.isRunning();};this.scripts=function(m,n){var k=this;this.$debugger.scripts(4,null,false,function(o){var r=[];for(var s=0;s<o.length;s++){var q=o[s];if(q.name&&q.name.indexOf("chrome-extension://")==0){continue;}r.push(k.$getScriptXml(q));}m.load("<sources>"+r.join("")+"</sources>");n();});};this.$getScriptXml=function(k){return["<file scriptid='",k.id,"' scriptname='",apf.escapeXML(k.name||"anonymous"),"' text='",this.$strip(apf.escapeXML(k.text||"anonymous")),"' lineoffset='",k.lineOffset,"' debug='true' />"].join("");};function g(k){return(k.func.name||k.func.inferredName||(k.line+k.position));}this.$isEqual=function(k,n){if(k.length!=n.length){return false;}var m=k[0];var o=n[0];if(m.getAttribute("scriptid")!=o.func.scriptId){return false;}if(m.getAttribute("id")!=g(o)){return false;}return true;};this.$updateFrame=function(o,r){o.setAttribute("line",r.line);o.setAttribute("column",r.column);var q=o.selectNodes("vars/item");var k=r.arguments;for(var n=1,m=0;m<k.length;m++){if(k[m].name){this.$updateVar(q[n++],k[m]);}}var k=r.locals;for(var m=0;m<r.locals.length;m++){if(k[m].name!==".arguments"){this.$updateVar(q[n++],k[m]);}}},this.$updateVar=function(m,k){m.setAttribute("value",this.$valueString(k.value));m.setAttribute("type",k.value.type);m.setAttribute("ref",k.value.ref);apf.xmldb.setAttribute(m,"children",d[k.value.type]?"true":"false");};this.$buildFrame=function(t,r,n){var k=r(t.script.ref);n.push("<frame index='",t.index,"' name='",apf.escapeXML(apf.escapeXML(this.$frameToString(t))),"' column='",t.column,"' id='",g(t),"' ref='",t.ref,"' line='",t.line,"' script='",this.$strip(k.name),"' scriptid='",t.func.scriptId,"'>");n.push("<vars>");var s={name:"this",value:t.receiver};n.push(this.$serializeVariable(s));for(var m=0;m<t.arguments.length;m++){if(t.arguments[m].name){n.push(this.$serializeVariable(t.arguments[m]));}}for(var m=0;m<t.locals.length;m++){if(t.locals[m].name!==".arguments"){n.push(this.$serializeVariable(t.locals[m]));}}n.push("<globals />");n.push("</vars>");n.push("<scopes>");var q=t.scopes;for(var m=0;m<q.length;m++){var o=q[m];n.push("<scope index='",o.index,"' type='",o.type,"' />");}n.push("</scopes>");n.push("</frame>");};this.backtrace=function(m,n){var k=this;this.$debugger.backtrace(null,null,null,true,function(o,q){function u(y){for(var x=0;x<q.length;x++){if(q[x].handle==y){return q[x];}}return{};}var w=o.frames;var s=m.queryNodes("frame");if(s.length&&k.$isEqual(s,w)){for(var t=0;t<w.length;t++){k.$updateFrame(s[t],w[t]);}k.setFrame(s[0]);}else{var r=[];for(var t=0;t<w.length;t++){k.$buildFrame(w[t],u,r);}m.load("<frames>"+r.join("")+"</frames>");k.setFrame(m.data.firstChild);}n();});};this.loadScript=function(m,o){var n=m.getAttribute("scriptid");var k=this;this.$debugger.scripts(4,[n],true,function(q){if(q.length){var r=q[0];o(r.source);}});};this.loadObjects=function(n,o){var m=n.getAttribute("ref");var k=this;this.$debugger.lookup([m],false,function(q){var r=[];var t=q[m].properties;for(var s=0;s<t.length;s++){r.push(t[s].ref);}k.$debugger.lookup(r,false,function(u){var w=["<item>"];for(var x=0;x<t.length;x++){t[x].value=u[t[x].ref];w.push(k.$serializeVariable(t[x]));}w.push("</item>");o(w.join(""));});});};this.loadFrame=function(m,w){var x=m.getElementsByTagName("scope");var k=parseInt(m.getAttribute("index"));var u=this;var n=0;var s=0;var q=["<vars>"];for(var o=0;o<x.length;o++){var y=x[o];var t=parseInt(y.getAttribute("type"));if(t>1){s+=1;var r=parseInt(y.getAttribute("index"));this.$debugger.scope(r,k,true,function(A){var B=A.object.properties;for(j=0;j<B.length;j++){q.push(u.$serializeVariable(B[j]));}n+=1;if(n==s){q.push("</vars>");w(q.join(""));}});}}if(s==0){return w("<vars />");}};this.setFrame=function(k){this.$activeFrame=k;this.dispatchEvent("changeFrame",{data:k});};this.getActiveFrame=function(){return this.$activeFrame;};this.setBreakpoints=function(m,o){var k=this;var n=m.queryNodes("breakpoint");k.$debugger.listbreakpoints(function(q){if(q.breakpoints){for(var w in k.$breakpoints){k.$breakpoints[w].destroy();}k.$breakpoints={};for(var u=0,s=q.breakpoints.length;u<s;u++){if(q.breakpoints[u].type=="scriptId"){continue;}var r=c.fromJson(q.breakpoints[u],k.$debugger);var w=r.source+"|"+r.line;k.$breakpoints[w]=r;m.removeXml("breakpoint[@script='"+r.source+"' and @line='"+r.line+"']");m.appendXml(k.$getBreakpointXml(r,0));}}var t=m.queryNodes("breakpoint")||[];apf.asyncForEach(Array.prototype.slice.call(t,0),function(C,A){var y=C.getAttribute("script");var x=C.getAttribute("line");var D=y+"|"+x;var B=k.$breakpoints[D];if(!B){B=k.$breakpoints[D]=new c(y,x,C.getAttribute("column"));B.condition=C.getAttribute("condition");B.ignoreCount=parseInt(C.getAttribute("ignorecount")||0);B.enabled=C.getAttribute("enabled")=="true";B.attach(k.$debugger,function(){if(C.parentNode){m.removeXml(C);}m.appendXml(k.$getBreakpointXml(B,0));A();});}else{if(C.parentNode){m.removeXml(C);}m.appendXml(k.$getBreakpointXml(B,0));A();}},o);});};this.toggleBreakpoint=function(t,q,o){var s=this;var k=t.getAttribute("scriptname");var n=parseInt(t.getAttribute("lineoffset")||"0");var u=n+q;var m=k+"|"+u;var r=this.$breakpoints[m];if(r){delete this.$breakpoints[m];r.clear(function(){o.removeXml(o.queryNode("breakpoint[@id="+r.$id+"]"));});}else{r=this.$breakpoints[m]=new c(k,u);r.attach(this.$debugger,function(){o.appendXml(s.$getBreakpointXml(r,n,t.getAttribute("scriptid")));});}};this.$getBreakpointXml=function(k,n,o){var m=[];m.push("<breakpoint"," id='",k.$id,"' text='",this.$strip(apf.escapeXML(k.source)),":",k.line,"' script='",apf.escapeXML(k.source),o?"' scriptid='"+o:"","' lineoffset='",n||0,"' line='",k.line,"' condition='",apf.escapeXML(k.condition||""),"' ignorecount='",k.ignoreCount||0,"' enabled='",k.enabled,"' />");return(m.join(""));};this.continueScript=function(k){this.$debugger.continueScript(null,null,k);};this.stepInto=function(k){this.$debugger.continueScript("in",1,k);};this.stepNext=function(k){this.$debugger.continueScript("next",1,k);};this.stepOut=function(k){this.$debugger.continueScript("out",1,k);};this.suspend=function(){this.$debugger.suspend();};this.changeLive=function(o,k,n,m){this.$debugger.changelive(o,k,n,m);};this.evaluate=function(o,n,m,k,q){this.$debugger.evaluate(o,n,m,k,function(r,s,u){var w=[];var t=o.trim().split(/;|\n/).pop().trim().replace(/"/g,"&quot;");if(u){w.push("<item type='.error' name=\"",apf.escapeXML(t),"\" value='",u.message,"' />");}else{w.push('<item name="',apf.escapeXML(t),"\" value='",apf.escapeXML(r.text),"' type='",r.type,"' ref='",r.handle,r.constructorFunction?"' constructor='"+r.constructorFunction.ref:"",r.prototypeObject?"' prototype='"+r.prototypeObject.ref:"",r.properties&&r.properties.length?"' children='true":"","' />");}q(apf.getXml(w.join("")),r,s,u);});};this.$valueString=function(k){switch(k.type){case"undefined":case"null":return k.type;case"boolean":case"number":case"string":return k.value+"";case"object":return"["+k.className+"]";case"function":return"function "+k.inferredName+"()";default:return k.type;}};this.$frameToString=function(r){var q=[];q.push(r.func.name||r.func.inferredName||"anonymous","(");var n=r.arguments;var m=[];for(var o=0;o<n.length;o++){var k=n[o];if(!k.name){continue;}m.push(k.name);}q.push(m.join(", "),")");return q.join("");};this.$serializeVariable=function(m,k){var n=[];n.push("<item name='",apf.escapeXML(k||m.name),"' value='",apf.escapeXML(this.$valueString(m.value)),"' type='",m.value.type,"' ref='",typeof m.value.ref=="number"?m.value.ref:m.value.handle,d[m.value.type]?"' children='true":"","' />");return n.join("");};}).call(b.prototype=new apf.Class());return b;});}if(apf.hasRequireJS){require.def("apf/elements/dbg/v8debughost",["debug/StandaloneV8DebuggerService","debug/V8Debugger","apf/elements/dbg/v8debugger"],function(c,b,g){var d=function(m,k,n){this.$hostname=m;this.$port=k;this.$o3obj=n;this.$debugger=null;this.$init();};(function(){this.$connect=function(n){var m=this;if(this.state=="connected"){return n.call(this);}else{this.addEventListener("connect",function(){m.removeEventListener("connect",arguments.callee);n.call(m);});}if(this.state=="connecting"){return;}this.state="connecting";var k=this.$socket=new O3Socket(this.$hostname,this.$port,this.$o3obj);this.$v8ds=new c(k);this.state="connected";this.dispatchEvent("connect");window.onunload=this.disconnect.bind(this);n.call(this);};this.loadTabs=function(k){k.load("<tabs><tab id='0'>V8</tab></tabs>");};this.attach=function(n,o){var k=this.$debugger;if(k){return o(null,k);}var m=this;this.$connect(function(){m.$v8ds.attach(0,function(){k=new g(new b(0,m.$v8ds),this);m.$debugger=k;o(null,k);});});};this.detach=function(k,n){if(!k||this.$debugger!==k){return n();}this.$debugger=null;var m=this;this.$v8ds.detach(0,function(o){k.dispatchEvent("detach");m.$socket.close();m.dispatchEvent("disconnect",{});n&&n(o);});};this.disconnect=function(k){this.detach(this.$debugger,k);};}).call(d.prototype=new apf.Class());return d;});}if(apf.hasRequireJS){require.def("apf/elements/dbg/v8websocketdebughost",["debug/WSV8DebuggerService","debug/V8Debugger","apf/elements/dbg/v8debugger"],function(c,b,g){var d=function(k){this.$socket=k;this.$debugger=null;this.$init();};(function(){this.$connect=function(k){if(this.state!="connected"){this.$v8ds=new c(this.$socket);}this.state="connected";this.dispatchEvent("connect");k.call(this);};this.loadTabs=function(k){k.load("<tabs><tab id='0'>V8</tab></tabs>");};this.attach=function(n,o){var k=this.$debugger;if(k){return o(null,k);}var m=this;this.$connect(function(){m.$v8ds.attach(0,function(){k=new g(new b(0,m.$v8ds),this);m.$debugger=k;o(null,k);});});};this.detach=function(k,n){if(!k||this.$debugger!==k){return n();}this.$debugger=null;var m=this;this.$v8ds.detach(0,function(o){k.dispatchEvent("detach");m.dispatchEvent("disconnect",{});n&&n(o);});};this.disconnect=function(k){this.detach(this.$debugger,k);};}).call(d.prototype=new apf.Class());return d;});}apf.cgi=function(){this.supportMulticall=false;this.namedArguments=true;this.unserialize=function(b){return b;};this.getSingleCall=function(c,b,d){d.push(b);};this.createMessage=function(g,b){var m,k=[];function d(u,n){if(u&&u.dataType==apf.ARRAY){for(var q=0;q<u.length;q++){d(u[q],n+"%5B"+q+"%5D");}}else{if(u&&typeof u=="object"){if(u.nodeType){try{var r=u.outerHTML||u.serialize&&u.serialize()||apf.getCleanCopy(u).xml;}catch(t){var r="Could not serialize object";}k.push(n+"="+encodeURIComponent(r));}else{for(m in u){if(typeof u[m]=="function"){continue;}d(u[m],n+"%5B"+encodeURIComponent(m)+"%5D");}}}else{if(typeof u!="undefined"&&u!==null){k.push(n+"="+encodeURIComponent(u));}}}}if(this.multicall){k.push("func="+this.mcallname);for(var c=0;c<b[0].length;c++){d(b[0][c],"f%5B"+c+"%5D");}}else{for(m in b){d(b[m],m);}}if(!this.baseUrl){this.baseUrl=this.url;}this.url=this.$methods[g].url?this.$methods[g].url:this.baseUrl;if(this.method!="GET"){return k.join("&");}this.url=this.url+(k.length?(this.url.indexOf("?")>-1?"&":"?")+k.join("&"):"");return"";};this.addEventListener("DOMNodeInsertedIntoDocument",function(){this.method=(this["http-method"]||"GET").toUpperCase();this.contentType=this.method=="GET"?null:"application/x-www-form-urlencoded";});this.submitForm=function(k,n){if(!this["postform"]){this.addMethod("postform",n);}var d=[];for(var g=0,b=k.elements.length;g<b;g++){if(!k.elements[g].name){continue;}if(k.elements[g].tagname=="input"&&(k.elements[g].type=="checkbox"||k.elements[g].type=="radio")&&!k.elements[g].checked){continue;}if(k.elements[g].tagname="select"&&k.elements[g].multiple){for(var c=0;c<k.elements[g].options.length;c++){if(k.elements[g].options[c].selected){d.push(k.elements[g].name+"="+encodeURIComponent(k.elements[g].options[c].value));}}}else{d.push(k.elements[g].name+"="+encodeURIComponent(k.elements[g].value));}}var m=(k.action||location.href);this.urls.postform=m+(m.indexOf("?")>-1?"&":"?")+d.join("&");this["postform"].call(this);return false;};};apf.textbox.masking=function(){var m=9128748732;var A={"0":"\\d","1":"[12]","9":"[\\d ]","#":"[\\d +-]",L:"[A-Za-z]","?":"[A-Za-z ]",A:"[A-Za-z0-9]",a:"[A-Za-z0-9 ]",X:"[0-9A-Fa-f]",x:"[0-9A-Fa-f ]","&":"[^s]",C:"."};var t=-1;var c=false;var d=this.$ext;var r,s=[],b,x,y,k;this.setPosition=function(B){w(B||t||0);};this.addEventListener("$clear",function(){this.value="";if(this.mask){return this.setValue("");}});this.$propHandlers.value=function(D){var C="";if(this.includeNonTypedChars){for(var B=0;B<r.length;B++){if(r.substr(B,1)!=D.substr(B,1)){C+=D.substr(B,1);}}}this.$insertData(C||D);};var g={"96":"0","97":"1","98":"2","99":"3","100":"4","101":"5","102":"6","103":"7","104":"8","105":"9","106":"*","107":"+","109":"-","110":".","110":"/"};this.addEventListener("keydown",function(F){var C=F.keyCode,B=false;switch(C){case 39:w(t+1);B=true;break;case 37:w(t-1);B=true;break;case 35:case 34:w(b.length);B=true;break;case 33:case 36:w(0);B=true;break;case 8:q(t-1);w(t-1);B=true;break;case 46:q(t);w(t);B=true;break;default:if(C==67&&F.ctrlKey){window.clipboardData.setData("Text",this.getValue());B=true;}break;}var D=g[C]||String.fromCharCode(C);if(u(D)){w(t+1);}var E,G=t;if(this.realtime&&(E=this.getValue())!=this.value){this.change(E);w(G);}if(apf.isCharacter(F.keyCode)||B){return false;}},true);this.$initMasking=function(){this.$keyHandler=null;c=true;this.$ext[apf.isIphone?"onclick":"onmouseup"]=function(B){var C=Math.min(o(),b.length);w(C);return false;};this.$ext.onpaste=function(B){B=B||window.event;B.returnValue=false;this.host.setValue(window.clipboardData.getData("Text")||"");$setTimeout(function(){w(t);},1);};this.getValue=function(){if(this.includeNonTypedChars){return r==this.$ext.value?"":this.$ext.value.replace(new RegExp(k,"g"),"");}else{return b.join("");}};this.setValue=function(D){if(this.includeNonTypedChars){for(var C="",B=0;B<r.length;B++){if(r.substr(B,1)!=D.substr(B,1)){C+=D.substr(B,1);}}}this.$insertData(C);};};this.setMask=function(E){if(!c){this.$initMasking();}E=E.split(";");k=E.pop();this.includeNonTypedChars=parseInt(E.pop())!==0;var K=E.join("");var F="",B="",D="-",J=false,C=false,G;s=[],x="",y="";for(var I=-1,H=0;H<K.length;H++){G=K.substr(H,1);if(!G.match(/[\!\'\"\>\<\\]/)){I++;}else{if(G=="!"){C=true;}else{if(G=="<"||G==">"){D=G;}else{if(G=="'"||G=='"'){J=!J;}}}continue;}if(!J&&A[G]){s.push(I);B+=k;x+=G;y+=D;F+=A[G];}else{B+=G;}}this.$ext.value=B;r=B;b=[];k=k;};function n(B,D){var C=x.substr(D,1);var E=y.substr(D,1);if(B.match(new RegExp(A[C]))==null){return m;}if(E==">"){return B.toUpperCase();}if(E=="<"){return B.toLowerCase();}return B;}function w(C){if(C<0){C=0;}if(apf.hasMsRangeObject){var B=d.createTextRange();B.expand("textedit");B.select();if(s[C]==null){B.collapse(false);B.select();t=s.length;return false;}B.collapse();B.moveStart("character",s[C]);B.moveEnd("character",1);B.select();}else{if(typeof s[C]=="undefined"){d.selectionStart=d.selectionEnd=s[s.length-1]+1;t=s.length;return false;}d.selectionStart=s[C];d.selectionEnd=s[C]+1;}t=C;}function u(D){if(s.length&&s[t]==null){return false;}D=n(D,t);if(D==m){return false;}if(apf.hasMsRangeObject){var C=d.createTextRange();C.expand("textedit");C.collapse();C.moveStart("character",s[t]);C.moveEnd("character",1);C.text=D;if(apf.document.activeElement==this){C.select();}}else{var E=d.value,F=d.selectionStart,B=d.selectionEnd;d.value=E.substr(0,F)+D+E.substr(B);d.selectionStart=F;d.selectionEnd=B;}b[t]=D;return true;}function q(D){if(s[D]==null){return false;}if(apf.hasMsRangeObject){var C=d.createTextRange();C.expand("textedit");C.collapse();C.moveStart("character",s[D]);C.moveEnd("character",1);C.text=k;C.select();}else{var E=d.value,F=s[D],B=s[D]+1;d.value=E.substr(0,F)+k+E.substr(B);d.selectionStart=F;d.selectionEnd=B;}b[D]=" ";}this.$insertData=function(G){if(G==this.getValue()){return;}var D,B;try{if(!apf.hasMsRangeObject&&d.selectionStart==d.selectionEnd){w(0);}}catch(C){if(!G){return;}var E,F;for(D=0,B=G.length;D<B;D++){t=D;if(s[t]==null){continue;}E=n(G.substr(D,1),D);if(E==m){continue;}F=d.value;d.value=F.substr(0,s[D])+E+F.substr(s[D]+1);}if(G.length){t++;}return;}G=this.dispatchEvent("insert",{data:G})||G;if(!G){if(!this.getValue()){return;}for(D=this.getValue().length-1;D>=0;D--){q(D);}w(0);return;}for(D=0,B=G.length;D<B;D++){t=D;u(G.substr(D,1));if(!apf.hasMsRangeObject){w(D+1);}}if(G.length){t++;}};function o(){var D,B=0;if(!apf.hasMsRangeObject){B=d.selectionStart;}else{D=document.selection.createRange();var C=D.duplicate();C.expand("textedit");C.setEndPoint("EndToStart",D);B=C.text.length;}for(var E=0;E<s.length;E++){if(s[E]>B){return(E==0)?0:E-1;}}return b.length;}};if(document.all){var oldWinError=window.onerror,z;window.onerror=z=function(b){apf.console.error("Error caught from early startup. Might be a html parser syntax error (not your fault). "+b);if(!arguments.caller){return true;}};}apf.Init.addConditional(function(){if(document.all&&window.onerror==z){window.onerror=oldWinError;}apf.dispatchEvent("domready");},null,["body","class"]);apf.addDomLoadEvent(function(){apf.Init.run("body");});if(window.require&&typeof require.def=="function"){require(["apf/elements/codeeditor","apf/elements/debugger","apf/elements/debughost"],function(){apf.start();});}else{apf.start();}